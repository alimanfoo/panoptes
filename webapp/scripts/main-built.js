/**
 * @license
 * Lo-Dash 1.3.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */

/*! jQuery v1.8.2 jquery.com | jquery.org/license */

// This file is part of DQX - (C) Copyright 2014, Paul Vauterin, Ben Jeffery, Alistair Miles <info@cggh.org>
// This program is free software licensed under the GNU Affero General Public License.
// You can find a copy of this license in LICENSE in the top directory of the source code or at <http://opensource.org/licenses/AGPL-3.0>

// This file is part of DQX - (C) Copyright 2014, Paul Vauterin, Ben Jeffery, Alistair Miles <info@cggh.org>

// This program is free software licensed under the GNU Affero General Public License.

// You can find a copy of this license in LICENSE in the top directory of the source code or at <http://opensource.org/licenses/AGPL-3.0>

/*!

 handlebars v2.0.0

 Copyright (C) 2011-2014 by Yehuda Katz

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.

 @license
 */

// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.0-alpha

// This file is part of Panoptes - (C) Copyright 2014, CGGH <info@cggh.org>
// This program is free software licensed under the GNU Affero General Public License. 
// You can find a copy of this license in LICENSE in the top directory of the source code or at <http://opensource.org/licenses/AGPL-3.0>

/**
 * @name StyledMarkerMaker
 * @version 0.5
 * @author Gabriel Schneider
 * @copyright (c) 2010 Gabriel Schneider
 * @fileoverview This gives you static functions for creating dynamically
 *     styled markers using Charts API outputs as well as an ability to
 *     extend with custom types.
 */

/**
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

// This file is part of Panoptes - (C) Copyright 2014, CGGH <info@cggh.org>
// This program is free software licensed under the GNU Affero General Public License.
// You can find a copy of this license in LICENSE in the top directory of the source code or at <http://opensource.org/licenses/AGPL-3.0>

/**
         * @license
         * Copyright 2013 Google Inc. All Rights Reserved.
         *
         * Licensed under the Apache License, Version 2.0 (the "License");
         * you may not use this file except in compliance with the License.
         * You may obtain a copy of the License at
         *
         *     http://www.apache.org/licenses/LICENSE-2.0
         *
         * Unless required by applicable law or agreed to in writing, software
         * distributed under the License is distributed on an "AS IS" BASIS,
         * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
         * See the License for the specific language governing permissions and
         * limitations under the License.
         */

(function(e){function q(e,t,n){var r=(n||0)-1,i=e.length;while(++r<i)if(e[r]===t)return r;return-1}function R(e,t){var n=typeof t;e=e.cache;if(n=="boolean"||t==null)return e[t];n!="number"&&n!="string"&&(n="object");var r=n=="number"?t:o+t;return e=e[n]||(e[n]={}),n=="object"?e[r]&&q(e[r],t)>-1?0:-1:e[r]?0:-1}function U(e){var t=this.cache,n=typeof e;if(n=="boolean"||e==null)t[e]=!0;else{n!="number"&&n!="string"&&(n="object");var r=n=="number"?e:o+e,i=t[n]||(t[n]={});n=="object"?(i[r]||(i[r]=[])).push(e)==this.array.length&&(t[n]=!1):i[r]=!0}}function z(e){return e.charCodeAt(0)}function W(e,t){var n=e.index,r=t.index;e=e.criteria,t=t.criteria;if(e!==t){if(e>t||typeof e=="undefined")return 1;if(e<t||typeof t=="undefined")return-1}return n<r?-1:1}function X(e){var t=-1,n=e.length,r=J();r["false"]=r["null"]=r["true"]=r["undefined"]=!1;var i=J();i.array=e,i.cache=r,i.push=U;while(++t<n)i.push(e[t]);return r.object===!1?(G(i),null):i}function V(e){return"\\"+B[e]}function $(){return n.pop()||[]}function J(){return r.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,leading:!1,maxWait:0,"null":!1,number:null,object:null,push:null,string:null,trailing:!1,"true":!1,"undefined":!1,value:null}}function K(){}function Q(e){e.length=0,n.length<a&&n.push(e)}function G(e){var t=e.cache;t&&G(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,r.length<a&&r.push(e)}function Y(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1,i=n-t||0,s=Array(i<0?0:i);while(++r<i)s[r]=e[t+r];return s}function Z(n){function Pt(e){return e&&typeof e=="object"&&!Xt(e)&&dt.call(e,"__wrapped__")?e:new Ht(e)}function Ht(e){this.__wrapped__=e}function jt(e,t,n,r){function a(){var r=arguments,f=s?this:t;i||(e=t[o]),n.length&&(r=r.length?(r=Ot.call(r),u?r.concat(n):n.concat(r)):n);if(this instanceof a){f=Ft(e.prototype);var l=e.apply(f,r);return dn(l)?l:f}return e.apply(f,r)}var i=pn(e),s=!n,o=t;if(s){var u=r;n=t}else if(!i){if(!r)throw new nt;t=e}return a}function Ft(e){return dn(e)?Et(e):{}}function It(e){return Jt[e]}function qt(e,t,n){var r=(r=Pt.indexOf)===tr?q:r;return r}function Rt(e){return function(n,r,i,s){return typeof r!="boolean"&&r!=null&&(s=i,i=!s||s[r]!==n?r:t,r=!1),i!=null&&(i=Pt.createCallback(i,s)),e(n,r,i,s)}}function Ut(e){var n,r;return!!e&&bt.call(e)==M&&(n=e.constructor,!pn(n)||n instanceof n)?(tn(e,function(e,t){r=t}),r===t||dt.call(e,r)):!1}function zt(e){return Kt[e]}function Wt(e){return bt.call(e)==T}function Gt(e,n,r,i,s,o){var u=e;typeof n!="boolean"&&n!=null&&(i=r,r=n,n=!1);if(typeof r=="function"){r=typeof i=="undefined"?r:Pt.createCallback(r,i,1),u=r(u);if(typeof u!="undefined")return u;u=e}var a=dn(u);if(a){var f=bt.call(u);if(!P[f])return u;var l=Xt(u)}if(!a||!n)return a?l?Y(u):Qt({},u):u;var c=Dt[f];switch(f){case C:case k:return new c(+u);case O:case D:return new c(u);case _:return c(u.source,d.exec(u))}var h=!s;s||(s=$()),o||(o=$());var p=s.length;while(p--)if(s[p]==e)return o[p];return u=l?c(u.length):{},l&&(dt.call(e,"index")&&(u.index=e.index),dt.call(e,"input")&&(u.input=e.input)),s.push(e),o.push(u),(l?Pn:nn)(e,function(e,i){u[i]=Gt(e,n,r,t,s,o)}),h&&(Q(s),Q(o)),u}function Yt(e,t,n){return Gt(e,!0,t,n)}function en(e,t,n){var r;return t=Pt.createCallback(t,n),nn(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function rn(e){var t=[];return tn(e,function(e,n){pn(e)&&t.push(n)}),t.sort()}function sn(e,t){return e?dt.call(e,t):!1}function on(e){var t=-1,n=$t(e),r=n.length,i={};while(++t<r){var s=n[t];i[e[s]]=s}return i}function un(e){return e===!0||e===!1||bt.call(e)==C}function an(e){return e?typeof e=="object"&&bt.call(e)==k:!1}function fn(e){return e?e.nodeType===1:!1}function ln(e){var t=!0;if(!e)return t;var n=bt.call(e),r=e.length;return n==N||n==D||n==T||n==M&&typeof r=="number"&&pn(e.splice)?!r:(nn(e,function(){return t=!1}),t)}function cn(e,t,n,r,i,o){var u=n===s;if(typeof n=="function"&&!u){n=Pt.createCallback(n,r,2);var a=n(e,t);if(typeof a!="undefined")return!!a}if(e===t)return e!==0||1/e==1/t;var f=typeof e,l=typeof t;if(e===e&&(!e||f!="function"&&f!="object")&&(!t||l!="function"&&l!="object"))return!1;if(e==null||t==null)return e===t;var c=bt.call(e),h=bt.call(t);c==T&&(c=M),h==T&&(h=M);if(c!=h)return!1;switch(c){case C:case k:return+e==+t;case O:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case _:case D:return e==tt(t)}var p=c==N;if(!p){if(dt.call(e,"__wrapped__ ")||dt.call(t,"__wrapped__"))return cn(e.__wrapped__||e,t.__wrapped__||t,n,r,i,o);if(c!=M)return!1;var d=e.constructor,v=t.constructor;if(d!=v&&!(pn(d)&&d instanceof d&&pn(v)&&v instanceof v))return!1}var m=!i;i||(i=$()),o||(o=$());var g=i.length;while(g--)if(i[g]==e)return o[g]==t;var y=0;a=!0,i.push(e),o.push(t);if(p){g=e.length,y=t.length,a=y==e.length;if(!a&&!u)return a;while(y--){var b=g,w=t[y];if(u){while(b--)if(a=cn(e[b],w,n,r,i,o))break}else if(!(a=cn(e[y],w,n,r,i,o)))break}return a}return tn(t,function(t,s,u){if(dt.call(u,s))return y++,a=dt.call(e,s)&&cn(e[s],t,n,r,i,o)}),a&&!u&&tn(e,function(e,t,n){if(dt.call(n,t))return a=--y>-1}),m&&(Q(i),Q(o)),a}function hn(e){return xt(e)&&!Tt(parseFloat(e))}function pn(e){return typeof e=="function"}function dn(e){return!!e&&!!H[typeof e]}function vn(e){return gn(e)&&e!=+e}function mn(e){return e===null}function gn(e){return typeof e=="number"||bt.call(e)==O}function bn(e){return e?typeof e=="object"&&bt.call(e)==_:!1}function wn(e){return typeof e=="string"||bt.call(e)==D}function En(e){return typeof e=="undefined"}function Sn(e,t,n){var r=arguments,i=0,o=2;if(!dn(e))return e;if(n===s)var u=r[3],a=r[4],f=r[5];else{var l=!0;a=$(),f=$(),typeof n!="number"&&(o=r.length),o>3&&typeof r[o-2]=="function"?u=Pt.createCallback(r[--o-1],r[o--],2):o>2&&typeof r[o-1]=="function"&&(u=r[--o])}while(++i<o)(Xt(r[i])?Pn:nn)(r[i],function(t,n){var r,i,o=t,l=e[n];if(t&&((i=Xt(t))||yn(t))){var c=a.length;while(c--)if(r=a[c]==t){l=f[c];break}if(!r){var h;if(u){o=u(l,t);if(h=typeof o!="undefined")l=o}h||(l=i?Xt(l)?l:[]:yn(l)?l:{}),a.push(t),f.push(l),h||(l=Sn(l,t,s,u,a,f))}}else u&&(o=u(l,t),typeof o=="undefined"&&(o=t)),typeof o!="undefined"&&(l=o);e[n]=l});return l&&(Q(a),Q(f)),e}function xn(e,t,n){var r=qt(),i=typeof t=="function",s={};if(i)t=Pt.createCallback(t,n);else var o=lt.apply(rt,Ot.call(arguments,1));return tn(e,function(e,n,u){if(i?!t(e,n,u):r(o,n)<0)s[n]=e}),s}function Tn(e){var t=-1,n=$t(e),i=n.length,s=r(i);while(++t<i){var o=n[t];s[t]=[o,e[o]]}return s}function Nn(e,t,n){var r={};if(typeof t!="function"){var i=-1,s=lt.apply(rt,Ot.call(arguments,1)),o=dn(e)?s.length:0;while(++i<o){var u=s[i];u in e&&(r[u]=e[u])}}else t=Pt.createCallback(t,n),tn(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r}function Cn(e,t,n,r){var i=Xt(e);t=Pt.createCallback(t,r,4);if(n==null)if(i)n=[];else{var s=e&&e.constructor,o=s&&s.prototype;n=Ft(o)}return(i?Pn:nn)(e,function(e,r,i){return t(n,e,r,i)}),n}function kn(e){var t=-1,n=$t(e),i=n.length,s=r(i);while(++t<i)s[t]=e[n[t]];return s}function Ln(e){var t=-1,n=lt.apply(rt,Ot.call(arguments,1)),i=n.length,s=r(i);while(++t<i)s[t]=e[n[t]];return s}function An(e,t,n){var r=-1,i=qt(),s=e?e.length:0,o=!1;return n=(n<0?Ct(0,s+n):n)||0,s&&typeof s=="number"?o=(wn(e)?e.indexOf(t,n):i(e,t,n))>-1:nn(e,function(e){if(++r>=n)return!(o=e===t)}),o}function On(e,t,n){var r={};return t=Pt.createCallback(t,n),Pn(e,function(e,n,i){n=tt(t(e,n,i)),dt.call(r,n)?r[n]++:r[n]=1}),r}function Mn(e,t,n){var r=!0;t=Pt.createCallback(t,n);var i=-1,s=e?e.length:0;if(typeof s=="number"){while(++i<s)if(!(r=!!t(e[i],i,e)))break}else nn(e,function(e,n,i){return r=!!t(e,n,i)});return r}function _n(e,t,n){var r=[];t=Pt.createCallback(t,n);var i=-1,s=e?e.length:0;if(typeof s=="number")while(++i<s){var o=e[i];t(o,i,e)&&r.push(o)}else nn(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function Dn(e,t,n){t=Pt.createCallback(t,n);var r=-1,i=e?e.length:0;if(typeof i!="number"){var o;return nn(e,function(e,n,r){if(t(e,n,r))return o=e,!1}),o}while(++r<i){var s=e[r];if(t(s,r,e))return s}}function Pn(e,t,n){var r=-1,i=e?e.length:0;t=t&&typeof n=="undefined"?t:Pt.createCallback(t,n);if(typeof i=="number"){while(++r<i)if(t(e[r],r,e)===!1)break}else nn(e,t);return e}function Hn(e,t,n){var r={};return t=Pt.createCallback(t,n),Pn(e,function(e,n,i){n=tt(t(e,n,i)),(dt.call(r,n)?r[n]:r[n]=[]).push(e)}),r}function Bn(e,t){var n=Ot.call(arguments,2),i=-1,s=typeof t=="function",o=e?e.length:0,u=r(typeof o=="number"?o:0);return Pn(e,function(e){u[++i]=(s?t:e[t]).apply(e,n)}),u}function jn(e,t,n){var i=-1,s=e?e.length:0;t=Pt.createCallback(t,n);if(typeof s=="number"){var o=r(s);while(++i<s)o[i]=t(e[i],i,e)}else o=[],nn(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function Fn(e,t,n){var r=-Infinity,i=r;if(!t&&Xt(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u>i&&(i=u)}}else t=!t&&wn(e)?z:Pt.createCallback(t,n),Pn(e,function(e,n,s){var o=t(e,n,s);o>r&&(r=o,i=e)});return i}function In(e,t,n){var r=Infinity,i=r;if(!t&&Xt(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u<i&&(i=u)}}else t=!t&&wn(e)?z:Pt.createCallback(t,n),Pn(e,function(e,n,s){var o=t(e,n,s);o<r&&(r=o,i=e)});return i}function qn(e,t){var n=-1,i=e?e.length:0;if(typeof i=="number"){var s=r(i);while(++n<i)s[n]=e[n][t]}return s||jn(e,t)}function Rn(e,t,n,r){if(!e)return n;var i=arguments.length<3;t=Pt.createCallback(t,r,4);var s=-1,o=e.length;if(typeof o=="number"){i&&(n=e[++s]);while(++s<o)n=t(n,e[s],s,e)}else nn(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function Un(e,t,n,r){var i=e,s=e?e.length:0,o=arguments.length<3;if(typeof s!="number"){var u=$t(e);s=u.length}return t=Pt.createCallback(t,r,4),Pn(e,function(e,r,a){r=u?u[--s]:--s,n=o?(o=!1,i[r]):t(n,i[r],r,a)}),n}function zn(e,t,n){return t=Pt.createCallback(t,n),_n(e,function(e,n,r){return!t(e,n,r)})}function Wn(e){var t=-1,n=e?e.length:0,i=r(typeof n=="number"?n:0);return Pn(e,function(e){var n=ct(At()*(++t+1));i[t]=i[n],i[n]=e}),i}function Xn(e){var t=e?e.length:0;return typeof t=="number"?t:$t(e).length}function Vn(e,t,n){var r;t=Pt.createCallback(t,n);var i=-1,s=e?e.length:0;if(typeof s=="number"){while(++i<s)if(r=t(e[i],i,e))break}else nn(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function $n(e,t,n){var i=-1,s=e?e.length:0,o=r(typeof s=="number"?s:0);t=Pt.createCallback(t,n),Pn(e,function(e,n,r){var s=o[++i]=J();s.criteria=t(e,n,r),s.index=i,s.value=e}),s=o.length,o.sort(W);while(s--){var u=o[s];o[s]=u.value,G(u)}return o}function Jn(e){return e&&typeof e.length=="number"?Y(e):kn(e)}function Qn(e){var t=-1,n=e?e.length:0,r=[];while(++t<n){var i=e[t];i&&r.push(i)}return r}function Gn(e){var t=-1,n=qt(),r=e?e.length:0,i=lt.apply(rt,Ot.call(arguments,1)),s=[],o=r>=u&&n===q;if(o){var a=X(i);a?(n=R,i=a):o=!1}while(++t<r){var f=e[t];n(i,f)<0&&s.push(f)}return o&&G(i),s}function Yn(e,t,n){var r=-1,i=e?e.length:0;t=Pt.createCallback(t,n);while(++r<i)if(t(e[r],r,e))return r;return-1}function Zn(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=null){var s=-1;t=Pt.createCallback(t,n);while(++s<i&&t(e[s],s,e))r++}else{r=t;if(r==null||n)return e[0]}return Y(e,0,kt(Ct(0,r),i))}}function tr(e,t,n){if(typeof n=="number"){var r=e?e.length:0;n=n<0?Ct(0,r+n):n||0}else if(n){var i=ar(e,t);return e[i]===t?i:-1}return e?q(e,t,n):-1}function nr(e,t,n){if(!e)return[];var r=0,i=e.length;if(typeof t!="number"&&t!=null){var s=i;t=Pt.createCallback(t,n);while(s--&&t(e[s],s,e))r++}else r=t==null||n?1:t||r;return Y(e,0,kt(Ct(0,i-r),i))}function rr(e){var t=arguments,n=t.length,r=-1,i=$(),s=-1,o=qt(),a=e?e.length:0,f=[],l=$();while(++r<n){var c=t[r];i[r]=o===q&&(c?c.length:0)>=u&&X(r?t[r]:l)}e:while(++s<a){var h=i[0];c=e[s];if((h?R(h,c):o(l,c))<0){r=n,(h||l).push(c);while(--r){h=i[r];if((h?R(h,c):o(t[r],c))<0)continue e}f.push(c)}}while(n--)h=i[n],h&&G(h);return Q(i),Q(l),f}function ir(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=null){var s=i;t=Pt.createCallback(t,n);while(s--&&t(e[s],s,e))r++}else{r=t;if(r==null||n)return e[i-1]}return Y(e,Ct(0,i-r))}}function sr(e,t,n){var r=e?e.length:0;typeof n=="number"&&(r=(n<0?Ct(0,r+n):kt(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function or(e,t,n){e=+e||0,n=+n||1,t==null&&(t=e,e=0);var i=-1,s=Ct(0,at((t-e)/n)),o=r(s);while(++i<s)o[i]=e,e+=n;return o}function ur(e,t,n){if(typeof t!="number"&&t!=null){var r=0,i=-1,s=e?e.length:0;t=Pt.createCallback(t,n);while(++i<s&&t(e[i],i,e))r++}else r=t==null||n?1:Ct(0,t);return Y(e,r)}function ar(e,t,n,r){var i=0,s=e?e.length:i;n=n?Pt.createCallback(n,r,1):Mr,t=n(t);while(i<s){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function fr(e){return Xt(e)||(arguments[0]=e?Ot.call(e):rt),lr(lt.apply(rt,arguments))}function cr(e){var t=-1,n=e?Fn(qn(e,"length")):0,i=r(n<0?0:n);while(++t<n)i[t]=qn(e,t);return i}function hr(e){return Gn(e,Ot.call(arguments,1))}function pr(e){return e?cr(arguments):[]}function dr(e,t){var n=-1,r=e?e.length:0,i={};while(++n<r){var s=e[n];t?i[s]=t[n]:i[s[0]]=s[1]}return i}function vr(e,t){return e<1?t():function(){if(--e<1)return t.apply(this,arguments)}}function mr(e,t){return Bt.fastBind||wt&&arguments.length>2?wt.call.apply(wt,arguments):jt(e,t,Ot.call(arguments,2))}function gr(e){var t=arguments.length>1?lt.apply(rt,Ot.call(arguments,1)):rn(e),n=-1,r=t.length;while(++n<r){var i=t[n];e[i]=mr(e[i],e)}return e}function yr(e,t){return jt(e,t,Ot.call(arguments,2),s)}function br(){var e=arguments;return function(){var t=arguments,n=e.length;while(n--)t=[e[n].apply(this,t)];return t[0]}}function wr(e,t,n){if(e==null)return Mr;var r=typeof e;if(r!="function"){if(r!="object")return function(t){return t[e]};var i=$t(e);return function(t){var n=i.length,r=!1;while(n--)if(!(r=cn(t[i[n]],e[i[n]],s)))break;return r}}return typeof t=="undefined"||m&&!m.test(ht.call(e))?e:n===1?function(n){return e.call(t,n)}:n===2?function(n,r){return e.call(t,n,r)}:n===4?function(n,r,i,s){return e.call(t,n,r,i,s)}:function(n,r,i){return e.call(t,n,r,i)}}function Er(e,t,n){function h(){ft(f),ft(l),o=0,f=l=null}function p(){var t=c&&(!v||o>1);h(),t&&(a!==!1&&(u=new L),i=e.apply(s,r))}function d(){h();if(c||a!==t)u=new L,i=e.apply(s,r)}var r,i,s,o=0,u=0,a=!1,f=null,l=null,c=!0;t=Ct(0,t||0);if(n===!0){var v=!0;c=!1}else dn(n)&&(v=n.leading,a="maxWait"in n&&Ct(t,n.maxWait||0),c="trailing"in n?n.trailing:c);return function(){r=arguments,s=this,o++,ft(l);if(a===!1)v&&o<2&&(i=e.apply(s,r));else{var n=new L;!f&&!v&&(u=n);var c=a-(n-u);c<=0?(ft(f),f=null,u=n,i=e.apply(s,r)):f||(f=yt(d,c))}return t!==a&&(l=yt(p,t)),i}}function Sr(e){var n=Ot.call(arguments,1);return yt(function(){e.apply(t,n)},1)}function xr(e,n){var r=Ot.call(arguments,2);return yt(function(){e.apply(t,r)},n)}function Tr(e,t){function n(){var r=n.cache,i=o+(t?t.apply(this,arguments):arguments[0]);return dt.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}return n.cache={},n}function Nr(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Cr(e){return jt(e,Ot.call(arguments,1))}function kr(e){return jt(e,Ot.call(arguments,1),null,s)}function Lr(e,t,n){var r=!0,i=!0;n===!1?r=!1:dn(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),n=J(),n.leading=r,n.maxWait=t,n.trailing=i;var s=Er(e,t,n);return G(n),s}function Ar(e,t){return function(){var n=[e];return vt.apply(n,arguments),t.apply(this,n)}}function Or(e){return e==null?"":tt(e).replace(w,It)}function Mr(e){return e}function _r(e){Pn(rn(e),function(t){var n=Pt[t]=e[t];Pt.prototype[t]=function(){var e=this.__wrapped__,t=[e];vt.apply(t,arguments);var r=n.apply(Pt,t);return e&&typeof e=="object"&&e===r?this:new Ht(r)}})}function Dr(){return n._=ot,this}function Hr(e,t){e==null&&t==null&&(t=1),e=+e||0,t==null?(t=e,e=0):t=+t||0;var n=At();return e%1||t%1?e+kt(n*(t-e+parseFloat("1e-"+((n+"").length-1))),t):e+ct(n*(t-e+1))}function Br(e,n){var r=e?e[n]:t;return pn(r)?e[n]():r}function jr(e,n,r){var i=Pt.templateSettings;e||(e=""),r=Zt({},r,i);var s=Zt({},r.imports,i.imports),o=$t(s),u=kn(s),a,h=0,d=r.interpolate||b,m="__p += '",g=K((r.escape||b).source+"|"+d.source+"|"+(d===v?p:b).source+"|"+(r.evaluate||b).source+"|$","g");e.replace(g,function(t,n,r,i,s,o){return r||(r=i),m+=e.slice(h,o).replace(E,V),n&&(m+="' +\n__e("+n+") +\n'"),s&&(a=!0,m+="';\n"+s+";\n__p += '"),r&&(m+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),h=o+t.length,t}),m+="';\n";var y=r.variable,w=y;w||(y="obj",m="with ("+y+") {\n"+m+"\n}\n"),m=(a?m.replace(f,""):m).replace(l,"$1").replace(c,"$1;"),m="function("+y+") {\n"+(w?"":y+" || ("+y+" = {});\n")+"var __t, __p = '', __e = _.escape"+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var S="\n/*\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+x++ +"]")+"\n*/";try{var T=B(o,"return "+m+S).apply(t,u)}catch(N){throw N.source=m,N}return n?T(n):(T.source=m,T)}function Fr(e,t,n){e=(e=+e)>-1?e:0;var i=-1,s=r(e);t=Pt.createCallback(t,n,1);while(++i<e)s[i]=t(i);return s}function Ir(e){return e==null?"":tt(e).replace(h,zt)}function qr(e){var t=++i;return tt(e==null?"":e)+t}function Rr(e,t){return t(e),e}function Ur(){return tt(this.__wrapped__)}function zr(){return this.__wrapped__}n=n?et.defaults(e.Object(),n,et.pick(e,S)):e;var r=n.Array,a=n.Boolean,L=n.Date,B=n.Function,j=n.Math,I=n.Number,U=n.Object,K=n.RegExp,tt=n.String,nt=n.TypeError,rt=[],it=U.prototype,st=tt.prototype,ot=n._,ut=K("^"+tt(it.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),at=j.ceil,ft=n.clearTimeout,lt=rt.concat,ct=j.floor,ht=B.prototype.toString,pt=ut.test(pt=U.getPrototypeOf)&&pt,dt=it.hasOwnProperty,vt=rt.push,mt=it.propertyIsEnumerable,gt=n.setImmediate,yt=n.setTimeout,bt=it.toString,wt=ut.test(wt=bt.bind)&&wt,Et=ut.test(Et=U.create)&&Et,St=ut.test(St=r.isArray)&&St,xt=n.isFinite,Tt=n.isNaN,Nt=ut.test(Nt=U.keys)&&Nt,Ct=j.max,kt=j.min,Lt=n.parseInt,At=j.random,Ot=rt.slice,Mt=ut.test(n.attachEvent),_t=wt&&!/\n|true/.test(wt+Mt),Dt={};Dt[N]=r,Dt[C]=a,Dt[k]=L,Dt[A]=B,Dt[M]=U,Dt[O]=I,Dt[_]=K,Dt[D]=tt,Ht.prototype=Pt.prototype;var Bt=Pt.support={};Bt.fastBind=wt&&!_t,Pt.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:v,variable:"",imports:{_:Pt}};var Xt=St,Vt=function(e){var t,n=e,r=[];if(!n)return r;if(!H[typeof e])return r;for(t in n)dt.call(n,t)&&r.push(t);return r},$t=Nt?function(e){return dn(e)?Nt(e):[]}:Vt,Jt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kt=on(Jt),Qt=function(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;if(a>3&&typeof o[a-2]=="function")var f=Pt.createCallback(o[--a-1],o[a--],2);else a>2&&typeof o[a-1]=="function"&&(f=o[--a]);while(++u<a){i=o[u];if(i&&H[typeof i]){var l=-1,c=H[typeof i]&&$t(i),h=c?c.length:0;while(++l<h)r=c[l],s[r]=f?f(s[r],i[r]):i[r]}}return s},Zt=function(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;while(++u<a){i=o[u];if(i&&H[typeof i]){var f=-1,l=H[typeof i]&&$t(i),c=l?l.length:0;while(++f<c)r=l[f],typeof s[r]=="undefined"&&(s[r]=i[r])}}return s},tn=function(e,t,n){var r,i=e,s=i;if(!i)return s;if(!H[typeof i])return s;t=t&&typeof n=="undefined"?t:Pt.createCallback(t,n);for(r in i)if(t(i[r],r,e)===!1)return s;return s},nn=function(e,t,n){var r,i=e,s=i;if(!i)return s;if(!H[typeof i])return s;t=t&&typeof n=="undefined"?t:Pt.createCallback(t,n);var o=-1,u=H[typeof i]&&$t(i),a=u?u.length:0;while(++o<a){r=u[o];if(t(i[r],r,e)===!1)return s}return s},yn=function(e){if(!e||bt.call(e)!=M)return!1;var t=e.valueOf,n=typeof t=="function"&&(n=pt(t))&&pt(n);return n?e==n||pt(e)==n:Ut(e)},Kn=_n,er=Rt(function Wr(e,t,n){var r=-1,i=e?e.length:0,s=[];while(++r<i){var o=e[r];n&&(o=n(o,r,e)),Xt(o)?vt.apply(s,t?o:Wr(o)):s.push(o)}return s}),lr=Rt(function(e,t,n){var r=-1,i=qt(),s=e?e.length:0,o=[],a=!t&&s>=u&&i===q,f=n||a?$():o;if(a){var l=X(f);l?(i=R,f=l):(a=!1,f=n?f:(Q(f),o))}while(++r<s){var c=e[r],h=n?n(c,r,e):c;if(t?!r||f[f.length-1]!==h:i(f,h)<0)(n||a)&&f.push(h),o.push(c)}return a?(Q(f.array),G(f)):n&&Q(f),o});_t&&F&&typeof gt=="function"&&(Sr=mr(gt,n));var Pr=Lt(g+"08")==8?Lt:function(e,t){return Lt(wn(e)?e.replace(y,""):e,t||0)};return Pt.after=vr,Pt.assign=Qt,Pt.at=Ln,Pt.bind=mr,Pt.bindAll=gr,Pt.bindKey=yr,Pt.compact=Qn,Pt.compose=br,Pt.countBy=On,Pt.createCallback=wr,Pt.debounce=Er,Pt.defaults=Zt,Pt.defer=Sr,Pt.delay=xr,Pt.difference=Gn,Pt.filter=_n,Pt.flatten=er,Pt.forEach=Pn,Pt.forIn=tn,Pt.forOwn=nn,Pt.functions=rn,Pt.groupBy=Hn,Pt.initial=nr,Pt.intersection=rr,Pt.invert=on,Pt.invoke=Bn,Pt.keys=$t,Pt.map=jn,Pt.max=Fn,Pt.memoize=Tr,Pt.merge=Sn,Pt.min=In,Pt.omit=xn,Pt.once=Nr,Pt.pairs=Tn,Pt.partial=Cr,Pt.partialRight=kr,Pt.pick=Nn,Pt.pluck=qn,Pt.range=or,Pt.reject=zn,Pt.rest=ur,Pt.shuffle=Wn,Pt.sortBy=$n,Pt.tap=Rr,Pt.throttle=Lr,Pt.times=Fr,Pt.toArray=Jn,Pt.transform=Cn,Pt.union=fr,Pt.uniq=lr,Pt.unzip=cr,Pt.values=kn,Pt.where=Kn,Pt.without=hr,Pt.wrap=Ar,Pt.zip=pr,Pt.zipObject=dr,Pt.collect=jn,Pt.drop=ur,Pt.each=Pn,Pt.extend=Qt,Pt.methods=rn,Pt.object=dr,Pt.select=_n,Pt.tail=ur,Pt.unique=lr,_r(Pt),Pt.chain=Pt,Pt.prototype.chain=function(){return this},Pt.clone=Gt,Pt.cloneDeep=Yt,Pt.contains=An,Pt.escape=Or,Pt.every=Mn,Pt.find=Dn,Pt.findIndex=Yn,Pt.findKey=en,Pt.has=sn,Pt.identity=Mr,Pt.indexOf=tr,Pt.isArguments=Wt,Pt.isArray=Xt,Pt.isBoolean=un,Pt.isDate=an,Pt.isElement=fn,Pt.isEmpty=ln,Pt.isEqual=cn,Pt.isFinite=hn,Pt.isFunction=pn,Pt.isNaN=vn,Pt.isNull=mn,Pt.isNumber=gn,Pt.isObject=dn,Pt.isPlainObject=yn,Pt.isRegExp=bn,Pt.isString=wn,Pt.isUndefined=En,Pt.lastIndexOf=sr,Pt.mixin=_r,Pt.noConflict=Dr,Pt.parseInt=Pr,Pt.random=Hr,Pt.reduce=Rn,Pt.reduceRight=Un,Pt.result=Br,Pt.runInContext=Z,Pt.size=Xn,Pt.some=Vn,Pt.sortedIndex=ar,Pt.template=jr,Pt.unescape=Ir,Pt.uniqueId=qr,Pt.all=Mn,Pt.any=Vn,Pt.detect=Dn,Pt.findWhere=Dn,Pt.foldl=Rn,Pt.foldr=Un,Pt.include=An,Pt.inject=Rn,nn(Pt,function(e,t){Pt.prototype[t]||(Pt.prototype[t]=function(){var t=[this.__wrapped__];return vt.apply(t,arguments),e.apply(Pt,t)})}),Pt.first=Zn,Pt.last=ir,Pt.take=Zn,Pt.head=Zn,nn(Pt,function(e,t){Pt.prototype[t]||(Pt.prototype[t]=function(t,n){var r=e(this.__wrapped__,t,n);return t==null||n&&typeof t!="function"?r:new Ht(r)})}),Pt.VERSION="1.3.1",Pt.prototype.toString=Ur,Pt.prototype.value=zr,Pt.prototype.valueOf=zr,Pn(["join","pop","shift"],function(e){var t=rt[e];Pt.prototype[e]=function(){return t.apply(this.__wrapped__,arguments)}}),Pn(["push","reverse","sort","unshift"],function(e){var t=rt[e];Pt.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Pn(["concat","slice","splice"],function(e){var t=rt[e];Pt.prototype[e]=function(){return new Ht(t.apply(this.__wrapped__,arguments))}}),Pt}var t,n=[],r=[],i=0,s={},o=+(new Date)+"",u=75,a=40,f=/\b__p \+= '';/g,l=/\b(__p \+=) '' \+/g,c=/(__e\(.*?\)|\b__t\)) \+\n'';/g,h=/&(?:amp|lt|gt|quot|#39);/g,p=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,d=/\w*$/,v=/<%=([\s\S]+?)%>/g,m=(m=/\bthis\b/)&&m.test(Z)&&m,g=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",y=RegExp("^["+g+"]*0+(?=.$)"),b=/($^)/,w=/[&<>"']/g,E=/['\n\r\t\u2028\u2029\\]/g,S=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],x=0,T="[object Arguments]",N="[object Array]",C="[object Boolean]",k="[object Date]",L="[object Error]",A="[object Function]",O="[object Number]",M="[object Object]",_="[object RegExp]",D="[object String]",P={};P[A]=!1,P[T]=P[N]=P[C]=P[k]=P[O]=P[M]=P[_]=P[D]=!0;var H={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},B={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},j=H[typeof exports]&&exports,F=H[typeof module]&&module&&module.exports==j&&module,I=H[typeof global]&&global;I&&(I.global===I||I.window===I)&&(e=I);var et=Z();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(e._=et,define("_",[],function(){return et})):j&&!j.nodeType?F?(F.exports=et)._=et:j._=et:e._=et})(this),function(e,t){function n(e){var t=dt[e]={};return Y.each(e.split(tt),function(e,n){t[n]=!0}),t}function r(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(mt,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:vt.test(r)?Y.parseJSON(r):r}catch(s){}Y.data(e,n,r)}else r=t}return r}function i(e){var t;for(t in e){if(t==="data"&&Y.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function s(){return!1}function o(){return!0}function u(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function a(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function f(e,t,n){t=t||0;if(Y.isFunction(t))return Y.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return Y.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=Y.grep(e,function(e){return e.nodeType===1});if(Bt.test(t))return Y.filter(t,r,!n);t=Y.filter(t,r)}return Y.grep(e,function(e,r){return Y.inArray(e,t)>=0===n})}function l(e){var t=It.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function c(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function h(e,t){if(t.nodeType!==1||!Y.hasData(e))return;var n,r,i,s=Y._data(e),o=Y._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)Y.event.add(t,n,u[n][r])}o.data&&(o.data=Y.extend({},o.data))}function p(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),Y.support.html5Clone&&e.innerHTML&&!Y.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Kt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(Y.expando)}function d(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function v(e){Kt.test(e.type)&&(e.defaultChecked=e.checked)}function m(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=yn.length;while(i--){t=yn[i]+n;if(t in e)return t}return r}function g(e,t){return e=t||e,Y.css(e,"display")==="none"||!Y.contains(e.ownerDocument,e)}function y(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=Y._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&g(n)&&(i[s]=Y._data(n,"olddisplay",S(n.nodeName)))):(r=nn(n,"display"),!i[s]&&r!=="none"&&Y._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function b(e,t,n){var r=cn.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function w(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=Y.css(e,n+gn[i],!0)),r?(n==="content"&&(s-=parseFloat(nn(e,"padding"+gn[i]))||0),n!=="margin"&&(s-=parseFloat(nn(e,"border"+gn[i]+"Width"))||0)):(s+=parseFloat(nn(e,"padding"+gn[i]))||0,n!=="padding"&&(s+=parseFloat(nn(e,"border"+gn[i]+"Width"))||0));return s}function E(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=Y.support.boxSizing&&Y.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=nn(e,t);if(r<0||r==null)r=e.style[t];if(hn.test(r))return r;i=s&&(Y.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+w(e,t,n||(s?"border":"content"),i)+"px"}function S(e){if(dn[e])return dn[e];var t=Y("<"+e+">").appendTo(R.body),n=t.css("display");t.remove();if(n==="none"||n===""){rn=R.body.appendChild(rn||Y.extend(R.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!sn||!rn.createElement)sn=(rn.contentWindow||rn.contentDocument).document,sn.write("<!doctype html><html><body>"),sn.close();t=sn.body.appendChild(sn.createElement(e)),n=nn(t,"display"),R.body.removeChild(rn)}return dn[e]=n,n}function x(e,t,n,r){var i;if(Y.isArray(t))Y.each(t,function(t,i){n||En.test(e)?r(e,i):x(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&Y.type(t)==="object")for(i in t)x(e+"["+i+"]",t[i],n,r);else r(e,t)}function T(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(tt),u=0,a=o.length;if(Y.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function N(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===jn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=N(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=N(e,n,r,i,"*",o)),u}function C(e,n){var r,i,s=Y.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&Y.extend(!0,e,i)}function k(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function L(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function A(){try{return new e.XMLHttpRequest}catch(t){}}function O(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function M(){return setTimeout(function(){Jn=t},0),Jn=Y.now()}function _(e,t){Y.each(t,function(t,n){var r=(er[t]||[]).concat(er["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function D(e,t,n){var r,i=0,s=0,o=Zn.length,u=Y.Deferred().always(function(){delete a.elem}),a=function(){var t=Jn||M(),n=Math.max(0,f.startTime+f.duration-t),r=1-(n/f.duration||0),i=0,s=f.tweens.length;for(;i<s;i++)f.tweens[i].run(r);return u.notifyWith(e,[f,r,n]),r<1&&s?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:Y.extend({},t),opts:Y.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Jn||M(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=Y.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;P(l,f.opts.specialEasing);for(;i<o;i++){r=Zn[i].call(f,e,l,f.opts);if(r)return r}return _(f,l),Y.isFunction(f.opts.start)&&f.opts.start.call(e,f),Y.fx.timer(Y.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function P(e,t){var n,r,i,s,o;for(n in e){r=Y.camelCase(n),i=t[r],s=e[n],Y.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=Y.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function H(e,t,n){var r,i,s,o,u,a,f,l,c=this,h=e.style,p={},d=[],v=e.nodeType&&g(e);n.queue||(f=Y._queueHooks(e,"fx"),f.unqueued==null&&(f.unqueued=0,l=f.empty.fire,f.empty.fire=function(){f.unqueued||l()}),f.unqueued++,c.always(function(){c.always(function(){f.unqueued--,Y.queue(e,"fx").length||f.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],Y.css(e,"display")==="inline"&&Y.css(e,"float")==="none"&&(!Y.support.inlineBlockNeedsLayout||S(e.nodeName)==="inline"?h.display="inline-block":h.zoom=1)),n.overflow&&(h.overflow="hidden",Y.support.shrinkWrapBlocks||c.done(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Qn.exec(s)){delete t[r];if(s===(v?"hide":"show"))continue;d.push(r)}}o=d.length;if(o){u=Y._data(e,"fxshow")||Y._data(e,"fxshow",{}),v?Y(e).show():c.done(function(){Y(e).hide()}),c.done(function(){var t;Y.removeData(e,"fxshow",!0);for(t in p)Y.style(e,t,p[t])});for(r=0;r<o;r++)i=d[r],a=c.createTween(i,v?u[i]:0),p[i]=u[i]||Y.style(e,i),i in u||(u[i]=a.start,v&&(a.end=a.start,a.start=i==="width"||i==="height"?1:0))}}function B(e,t,n,r,i){return new B.prototype.init(e,t,n,r,i)}function j(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=gn[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function F(e){return Y.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var I,q,R=e.document,U=e.location,z=e.navigator,W=e.jQuery,X=e.$,V=Array.prototype.push,$=Array.prototype.slice,J=Array.prototype.indexOf,K=Object.prototype.toString,Q=Object.prototype.hasOwnProperty,G=String.prototype.trim,Y=function(e,t){return new Y.fn.init(e,t,I)},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,it=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,st=/^[\],:{}\s]*$/,ot=/(?:^|:|,)(?:\s*\[)+/g,ut=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,at=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ft=/^-ms-/,lt=/-([\da-z])/gi,ct=function(e,t){return(t+"").toUpperCase()},ht=function(){R.addEventListener?(R.removeEventListener("DOMContentLoaded",ht,!1),Y.ready()):R.readyState==="complete"&&(R.detachEvent("onreadystatechange",ht),Y.ready())},pt={};Y.fn=Y.prototype={constructor:Y,init:function(e,n,r){var i,s,o,u;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?i=[null,e,null]:i=rt.exec(e);if(i&&(i[1]||!n)){if(i[1])return n=n instanceof Y?n[0]:n,u=n&&n.nodeType?n.ownerDocument||n:R,e=Y.parseHTML(i[1],u,!0),it.test(i[1])&&Y.isPlainObject(n)&&this.attr.call(e,n,!0),Y.merge(this,e);s=R.getElementById(i[2]);if(s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=R,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return Y.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),Y.makeArray(e,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return $.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=Y.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return Y.each(this,e,t)},ready:function(e){return Y.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack($.apply(this,arguments),"slice",$.call(arguments).join(","))},map:function(e){return this.pushStack(Y.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:[].sort,splice:[].splice},Y.fn.init.prototype=Y.fn,Y.extend=Y.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!Y.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(Y.isPlainObject(i)||(s=Y.isArray(i)))?(s?(s=!1,o=r&&Y.isArray(r)?r:[]):o=r&&Y.isPlainObject(r)?r:{},u[n]=Y.extend(l,o,i)):i!==t&&(u[n]=i)}return u},Y.extend({noConflict:function(t){return e.$===Y&&(e.$=X),t&&e.jQuery===Y&&(e.jQuery=W),Y},isReady:!1,readyWait:1,holdReady:function(e){e?Y.readyWait++:Y.ready(!0)},ready:function(e){if(e===!0?--Y.readyWait:Y.isReady)return;if(!R.body)return setTimeout(Y.ready,1);Y.isReady=!0;if(e!==!0&&--Y.readyWait>0)return;q.resolveWith(R,[Y]),Y.fn.trigger&&Y(R).trigger("ready").off("ready")},isFunction:function(e){return Y.type(e)==="function"},isArray:Array.isArray||function(e){return Y.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):pt[K.call(e)]||"object"},isPlainObject:function(e){if(!e||Y.type(e)!=="object"||e.nodeType||Y.isWindow(e))return!1;try{if(e.constructor&&!Q.call(e,"constructor")&&!Q.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||Q.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||R,(r=it.exec(e))?[t.createElement(r[1])]:(r=Y.buildFragment([e],t,n?null:[]),Y.merge([],(r.cacheable?Y.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=Y.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(st.test(t.replace(ut,"@").replace(at,"]").replace(ot,"")))return(new Function("return "+t))();Y.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&Y.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ft,"ms-").replace(lt,ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||Y.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:G&&!G.call("﻿ ")?function(e){return e==null?"":G.call(e)}:function(e){return e==null?"":(e+"").replace(nt,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=Y.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||Y.isWindow(e)?V.call(r,e):Y.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(J)return J.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof Y||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||Y.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),Y.isFunction(e)?(i=$.call(arguments,2),s=function(){return e.apply(n,i.concat($.call(arguments)))},s.guid=e.guid=e.guid||Y.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)Y.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&Y.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(Y(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),Y.ready.promise=function(t){if(!q){q=Y.Deferred();if(R.readyState==="complete")setTimeout(Y.ready,1);else if(R.addEventListener)R.addEventListener("DOMContentLoaded",ht,!1),e.addEventListener("load",Y.ready,!1);else{R.attachEvent("onreadystatechange",ht),e.attachEvent("onload",Y.ready);var n=!1;try{n=e.frameElement==null&&R.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!Y.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}Y.ready()}}()}}return q.promise(t)},Y.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){pt["[object "+t+"]"]=t.toLowerCase()}),I=Y(R);var dt={};Y.Callbacks=function(e){e=typeof e=="string"?dt[e]||n(e):Y.extend({},e);var r,i,s,o,u,a,f=[],l=!e.once&&[],c=function(t){r=e.memory&&t,i=!0,a=o||0,o=0,u=f.length,s=!0;for(;f&&a<u;a++)if(f[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}s=!1,f&&(l?l.length&&c(l.shift()):r?f=[]:h.disable())},h={add:function(){if(f){var t=f.length;(function n(t){Y.each(t,function(t,r){var i=Y.type(r);i==="function"&&(!e.unique||!h.has(r))?f.push(r):r&&r.length&&i!=="string"&&n(r)})})(arguments),s?u=f.length:r&&(o=t,c(r))}return this},remove:function(){return f&&Y.each(arguments,function(e,t){var n;while((n=Y.inArray(t,f,n))>-1)f.splice(n,1),s&&(n<=u&&u--,n<=a&&a--)}),this},has:function(e){return Y.inArray(e,f)>-1},empty:function(){return f=[],this},disable:function(){return f=l=r=t,this},disabled:function(){return!f},lock:function(){return l=t,r||h.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],f&&(!i||l)&&(s?l.push(t):c(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!i}};return h},Y.extend({Deferred:function(e){var t=[["resolve","done",Y.Callbacks("once memory"),"resolved"],["reject","fail",Y.Callbacks("once memory"),"rejected"],["notify","progress",Y.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Y.Deferred(function(n){Y.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](Y.isFunction(o)?function(){var e=o.apply(this,arguments);e&&Y.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?Y.extend(e,r):r}},i={};return r.pipe=r.then,Y.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=$.call(arguments),r=n.length,i=r!==1||e&&Y.isFunction(e.promise)?r:0,s=i===1?e:Y.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?$.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&Y.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),Y.support=function(){var t,n,r,i,s,o,u,a,f,l,c,h=R.createElement("div");h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=h.getElementsByTagName("*"),r=h.getElementsByTagName("a")[0],r.style.cssText="top:1px;float:left;opacity:.5";if(!n||!n.length)return{};i=R.createElement("select"),s=i.appendChild(R.createElement("option")),o=h.getElementsByTagName("input")[0],t={leadingWhitespace:h.firstChild.nodeType===3,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:o.value==="on",optSelected:s.selected,getSetAttribute:h.className!=="t",enctype:!!R.createElement("form").enctype,html5Clone:R.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:R.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,i.disabled=!0,t.optDisabled=!s.disabled;try{delete h.test}catch(p){t.deleteExpando=!1}!h.addEventListener&&h.attachEvent&&h.fireEvent&&(h.attachEvent("onclick",c=function(){t.noCloneEvent=!1}),h.cloneNode(!0).fireEvent("onclick"),h.detachEvent("onclick",c)),o=R.createElement("input"),o.value="t",o.setAttribute("type","radio"),t.radioValue=o.value==="t",o.setAttribute("checked","checked"),o.setAttribute("name","t"),h.appendChild(o),u=R.createDocumentFragment(),u.appendChild(h.lastChild),t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=o.checked,u.removeChild(o),u.appendChild(h);if(h.attachEvent)for(f in{submit:!0,change:!0,focusin:!0})a="on"+f,l=a in h,l||(h.setAttribute(a,"return;"),l=typeof h[a]=="function"),t[f+"Bubbles"]=l;return Y(function(){var n,r,i,s,o="padding:0;margin:0;border:0;display:block;overflow:hidden;",u=R.getElementsByTagName("body")[0];if(!u)return;n=R.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",u.insertBefore(n,u.firstChild),r=R.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=r.getElementsByTagName("td"),i[0].style.cssText="padding:0;margin:0;border:0;display:none",l=i[0].offsetHeight===0,i[0].style.display="",i[1].style.display="none",t.reliableHiddenOffsets=l&&i[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=u.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",s=R.createElement("div"),s.style.cssText=r.style.cssText=o,s.style.marginRight=s.style.width="0",r.style.width="1px",r.appendChild(s),t.reliableMarginRight=!parseFloat((e.getComputedStyle(s,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),u.removeChild(n),n=r=i=s=null}),u.removeChild(h),n=r=i=s=o=u=h=null,t}();var vt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,mt=/([A-Z])/g;Y.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(Y.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?Y.cache[e[Y.expando]]:e[Y.expando],!!e&&!i(e)},data:function(e,n,r,i){if(!Y.acceptData(e))return;var s,o,u=Y.expando,a=typeof n=="string",f=e.nodeType,l=f?Y.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=Y.deletedIds.pop()||Y.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=Y.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=Y.extend(l[c],n):l[c].data=Y.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[Y.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[Y.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!Y.acceptData(e))return;var r,s,o,u=e.nodeType,a=u?Y.cache:e,f=u?e[Y.expando]:Y.expando;if(!a[f])return;if(t){r=n?a[f]:a[f].data;if(r){Y.isArray(t)||(t in r?t=[t]:(t=Y.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(s=0,o=t.length;s<o;s++)delete r[t[s]];if(!(n?i:Y.isEmptyObject)(r))return}}if(!n){delete a[f].data;if(!i(a[f]))return}u?Y.cleanData([e],!0):Y.support.deleteExpando||a!=a.window?delete a[f]:a[f]=null},_data:function(e,t,n){return Y.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&Y.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),Y.fn.extend({data:function(e,n){var i,s,o,u,a,f=this[0],l=0,c=null;if(e===t){if(this.length){c=Y.data(f);if(f.nodeType===1&&!Y._data(f,"parsedAttrs")){o=f.attributes;for(a=o.length;l<a;l++)u=o[l].name,u.indexOf("data-")||(u=Y.camelCase(u.substring(5)),r(f,u,c[u]));Y._data(f,"parsedAttrs",!0)}}return c}return typeof e=="object"?this.each(function(){Y.data(this,e)}):(i=e.split(".",2),i[1]=i[1]?"."+i[1]:"",s=i[1]+"!",Y.access(this,function(n){if(n===t)return c=this.triggerHandler("getData"+s,[i[0]]),c===t&&f&&(c=Y.data(f,e),c=r(f,e,c)),c===t&&i[1]?this.data(i[0]):c;i[1]=n,this.each(function(){var t=Y(this);t.triggerHandler("setData"+s,i),Y.data(this,e,n),t.triggerHandler("changeData"+s,i)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){Y.removeData(this,e)})}}),Y.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y._data(e,t),n&&(!r||Y.isArray(n)?r=Y._data(e,t,Y.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=Y.queue(e,t),r=n.length,i=n.shift(),s=Y._queueHooks(e,t),o=function(){Y.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y._data(e,n)||Y._data(e,n,{empty:Y.Callbacks("once memory").add(function(){Y.removeData(e,t+"queue",!0),Y.removeData(e,n,!0)})})}}),Y.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?Y.queue(this[0],e):n===t?this:this.each(function(){var t=Y.queue(this,e,n);Y._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&Y.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Y.dequeue(this,e)})},delay:function(e,t){return e=Y.fx?Y.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=Y.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=Y._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var gt,yt,bt,wt=/[\t\r\n]/g,Et=/\r/g,St=/^(?:button|input)$/i,xt=/^(?:button|input|object|select|textarea)$/i,Tt=/^a(?:rea|)$/i,Nt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Ct=Y.support.getSetAttribute;Y.fn.extend({attr:function(e,t){return Y.access(this,Y.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Y.removeAttr(this,e)})},prop:function(e,t){return Y.access(this,Y.prop,e,t,arguments.length>1)},removeProp:function(e){return e=Y.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(Y.isFunction(e))return this.each(function(t){Y(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(tt);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=Y.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(Y.isFunction(e))return this.each(function(t){Y(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(tt);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(wt," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?Y.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return Y.isFunction(e)?this.each(function(n){Y(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=Y(this),u=t,a=e.split(tt);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&Y._data(this,"__className__",this.className),this.className=this.className||e===!1?"":Y._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(wt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=Y.valHooks[s.type]||Y.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(Et,""):r==null?"":r);return}return i=Y.isFunction(e),this.each(function(r){var s,o=Y(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":Y.isArray(s)&&(s=Y.map(s,function(e){return e==null?"":e+""})),n=Y.valHooks[this.type]||Y.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),Y.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,s=e.selectedIndex,o=[],u=e.options,a=e.type==="select-one";if(s<0)return null;n=a?s:0,r=a?s+1:u.length;for(;n<r;n++){i=u[n];if(i.selected&&(Y.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!Y.nodeName(i.parentNode,"optgroup"))){t=Y(i).val();if(a)return t;o.push(t)}}return a&&!o.length&&u.length?Y(u[s]).val():o},set:function(e,t){var n=Y.makeArray(t);return Y(e).find("option").each(function(){this.selected=Y.inArray(Y(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&Y.isFunction(Y.fn[n]))return Y(e)[n](r);if(typeof e.getAttribute=="undefined")return Y.prop(e,n,r);u=a!==1||!Y.isXMLDoc(e),u&&(n=n.toLowerCase(),o=Y.attrHooks[n]||(Nt.test(n)?yt:gt));if(r!==t){if(r===null){Y.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(tt);for(;o<r.length;o++)i=r[o],i&&(n=Y.propFix[i]||i,s=Nt.test(i),s||Y.attr(e,i,""),e.removeAttribute(Ct?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(St.test(e.nodeName)&&e.parentNode)Y.error("type property can't be changed");else if(!Y.support.radioValue&&t==="radio"&&Y.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return gt&&Y.nodeName(e,"button")?gt.get(e,t):t in e?e.value:null},set:function(e,t,n){if(gt&&Y.nodeName(e,"button"))return gt.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!Y.isXMLDoc(e),o&&(n=Y.propFix[n]||n,s=Y.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):xt.test(e.nodeName)||Tt.test(e.nodeName)&&e.href?0:t}}}}),yt={get:function(e,n){var r,i=Y.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?Y.removeAttr(e,n):(r=Y.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},Ct||(bt={name:!0,id:!0,coords:!0},gt=Y.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(bt[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=R.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},Y.each(["width","height"],function(e,t){Y.attrHooks[t]=Y.extend(Y.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),Y.attrHooks.contenteditable={get:gt.get,set:function(e,t,n){t===""&&(t="false"),gt.set(e,t,n)}}),Y.support.hrefNormalized||Y.each(["href","src","width","height"],function(e,n){Y.attrHooks[n]=Y.extend(Y.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),Y.support.style||(Y.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),Y.support.optSelected||(Y.propHooks.selected=Y.extend(Y.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),Y.support.enctype||(Y.propFix.enctype="encoding"),Y.support.checkOn||Y.each(["radio","checkbox"],function(){Y.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),Y.each(["radio","checkbox"],function(){Y.valHooks[this]=Y.extend(Y.valHooks[this],{set:function(e,t){if(Y.isArray(t))return e.checked=Y.inArray(Y(e).val(),t)>=0}})});var kt=/^(?:textarea|input|select)$/i,Lt=/^([^\.]*|)(?:\.(.+)|)$/,At=/(?:^|\s)hover(\.\S+|)\b/,Ot=/^key/,Mt=/^(?:mouse|contextmenu)|click/,_t=/^(?:focusinfocus|focusoutblur)$/,Dt=function(e){return Y.event.special.hover?e:e.replace(At,"mouseenter$1 mouseleave$1")};Y.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=Y._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=Y.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof Y=="undefined"||!!e&&Y.event.triggered===e.type?t:Y.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=Y.trim(Dt(n)).split(" ");for(f=0;f<n.length;f++){l=Lt.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),m=Y.event.special[c]||{},c=(s?m.delegateType:m.bindType)||c,m=Y.event.special[c]||{},p=Y.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&Y.expr.match.needsContext.test(s),namespace:h.join(".")},d),v=a[c];if(!v){v=a[c]=[],v.delegateCount=0;if(!m.setup||m.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}m.add&&(m.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?v.splice(v.delegateCount++,0,p):v.push(p),Y.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=Y.hasData(e)&&Y._data(e);if(!m||!(h=m.events))return;t=Y.trim(Dt(t||"")).split(" ");for(s=0;s<t.length;s++){o=Lt.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)Y.event.remove(e,u+t[s],n,r,!0);continue}p=Y.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)v=d[c],(i||a===v.origType)&&(!n||n.guid===v.guid)&&(!f||f.test(v.namespace))&&(!r||r===v.selector||r==="**"&&v.selector)&&(d.splice(c--,1),v.selector&&d.delegateCount--,p.remove&&p.remove.call(e,v));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,m.handle)===!1)&&Y.removeEvent(e,u,m.handle),delete h[u])}Y.isEmptyObject(h)&&(delete m.handle,Y.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,s){if(!i||i.nodeType!==3&&i.nodeType!==8){var o,u,a,f,l,c,h,p,d,v,m=n.type||n,g=[];if(_t.test(m+Y.event.triggered))return;m.indexOf("!")>=0&&(m=m.slice(0,-1),u=!0),m.indexOf(".")>=0&&(g=m.split("."),m=g.shift(),g.sort());if((!i||Y.event.customEvent[m])&&!Y.event.global[m])return;n=typeof n=="object"?n[Y.expando]?n:new Y.Event(m,n):new Y.Event(m),n.type=m,n.isTrigger=!0,n.exclusive=u,n.namespace=g.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c=m.indexOf(":")<0?"on"+m:"";if(!i){o=Y.cache;for(a in o)o[a].events&&o[a].events[m]&&Y.event.trigger(n,r,o[a].handle.elem,!0);return}n.result=t,n.target||(n.target=i),r=r!=null?Y.makeArray(r):[],r.unshift(n),h=Y.event.special[m]||{};if(h.trigger&&h.trigger.apply(i,r)===!1)return;d=[[i,h.bindType||m]];if(!s&&!h.noBubble&&!Y.isWindow(i)){v=h.delegateType||m,f=_t.test(v+m)?i:i.parentNode;for(l=i;f;f=f.parentNode)d.push([f,v]),l=f;l===(i.ownerDocument||R)&&d.push([l.defaultView||l.parentWindow||e,v])}for(a=0;a<d.length&&!n.isPropagationStopped();a++)f=d[a][0],n.type=d[a][1],p=(Y._data(f,"events")||{})[n.type]&&Y._data(f,"handle"),p&&p.apply(f,r),p=c&&f[c],p&&Y.acceptData(f)&&p.apply&&p.apply(f,r)===!1&&n.preventDefault();return n.type=m,!s&&!n.isDefaultPrevented()&&(!h._default||h._default.apply(i.ownerDocument,r)===!1)&&(m!=="click"||!Y.nodeName(i,"a"))&&Y.acceptData(i)&&c&&i[m]&&(m!=="focus"&&m!=="blur"||n.target.offsetWidth!==0)&&!Y.isWindow(i)&&(l=i[c],l&&(i[c]=null),Y.event.triggered=m,i[m](),Y.event.triggered=t,l&&(i[c]=l)),n.result}return},dispatch:function(n){n=Y.event.fix(n||e.event);var r,i,s,o,u,a,f,l,c,h,p=(Y._data(this,"events")||{})[n.type]||[],d=p.delegateCount,v=$.call(arguments),m=!n.exclusive&&!n.namespace,g=Y.event.special[n.type]||{},y=[];v[0]=n,n.delegateTarget=this;if(g.preDispatch&&g.preDispatch.call(this,n)===!1)return;if(d&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<d;r++)l=p[r],c=l.selector,u[c]===t&&(u[c]=l.needsContext?Y(c,this).index(s)>=0:Y.find(c,this,null,[s]).length),u[c]&&f.push(l);f.length&&y.push({elem:s,matches:f})}p.length>d&&y.push({elem:this,matches:p.slice(d)});for(r=0;r<y.length&&!n.isPropagationStopped();r++){a=y[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){l=a.matches[i];if(m||!n.namespace&&!l.namespace||n.namespace_re&&n.namespace_re.test(l.namespace))n.data=l.data,n.handleObj=l,o=((Y.event.special[l.origType]||{}).handle||l.handler).apply(a.elem,v),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return g.postDispatch&&g.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,o=n.button,u=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||R,i=r.documentElement,s=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),!e.which&&o!==t&&(e.which=o&1?1:o&2?3:o&4?2:0),e}},fix:function(e){if(e[Y.expando])return e;var t,n,r=e,i=Y.event.fixHooks[e.type]||{},s=i.props?this.props.concat(i.props):this.props;e=Y.Event(r);for(t=s.length;t;)n=s[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||R),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){Y.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=Y.extend(new Y.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?Y.event.trigger(i,null,t):Y.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},Y.event.handle=Y.event.dispatch,Y.removeEvent=R.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},Y.Event=function(e,t){if(!(this instanceof Y.Event))return new Y.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?o:s):this.type=e,t&&Y.extend(this,t),this.timeStamp=e&&e.timeStamp||Y.now(),this[Y.expando]=!0},Y.Event.prototype={preventDefault:function(){this.isDefaultPrevented=o;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=o;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=o,this.stopPropagation()},isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s},Y.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Y.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!Y.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),Y.support.submitBubbles||(Y.event.special.submit={setup:function(){if(Y.nodeName(this,"form"))return!1;Y.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=Y.nodeName(n,"input")||Y.nodeName(n,"button")?n.form:t;r&&!Y._data(r,"_submit_attached")&&(Y.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),Y._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&Y.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(Y.nodeName(this,"form"))return!1;Y.event.remove(this,"._submit")}}),Y.support.changeBubbles||(Y.event.special.change={setup:function(){if(kt.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")Y.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),Y.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),Y.event.simulate("change",this,e,!0)});return!1}Y.event.add(this,"beforeactivate._change",function(e){var t=e.target;kt.test(t.nodeName)&&!Y._data(t,"_change_attached")&&(Y.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&Y.event.simulate("change",this.parentNode,e,!0)}),Y._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return Y.event.remove(this,"._change"),!kt.test(this.nodeName)}}),Y.support.focusinBubbles||Y.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){Y.event.simulate(t,e.target,Y.event.fix(e),!0)};Y.event.special[t]={setup:function(){n++===0&&R.addEventListener(e,r,!0)},teardown:function(){--n===0&&R.removeEventListener(e,r,!0)}}}),Y.fn.extend({on:function(e,n,r,i,o){var u,a;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=s;else if(!i)return this;return o===1&&(u=i,i=function(e){return Y().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=Y.guid++)),this.each(function(){Y.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,Y(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(o in e)this.off(o,n,e[o]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=s),this.each(function(){Y.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return Y(this.context).on(e,this.selector,t,n),this},die:function(e,t){return Y(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){Y.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return Y.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||Y.guid++,r=0,i=function(n){var i=(Y._data(this,"lastToggle"+e.guid)||0)%r;return Y._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Y.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Y.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Ot.test(t)&&(Y.event.fixHooks[t]=Y.event.keyHooks),Mt.test(t)&&(Y.event.fixHooks[t]=Y.event.mouseHooks)}),function(e,t){function n(e,t,n,r){n=n||[],t=t||M;var i,s,o,u,a=t.nodeType;if(!e||typeof e!="string")return n;if(a!==1&&a!==9)return[];o=E(t);if(!o&&!r)if(i=nt.exec(e))if(u=i[1]){if(a===9){s=t.getElementById(u);if(!s||!s.parentNode)return n;if(s.id===u)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(u))&&S(t,s)&&s.id===u)return n.push(s),n}else{if(i[2])return B.apply(n,j.call(t.getElementsByTagName(e),0)),n;if((u=i[3])&&dt&&t.getElementsByClassName)return B.apply(n,j.call(t.getElementsByClassName(u),0)),n}return v(e.replace(G,"$1"),t,n,r,o)}function r(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function i(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function s(e){return I(function(t){return t=+t,I(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function o(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function u(e,t){var r,i,s,o,u,a,f,l=U[A][e];if(l)return t?0:l.slice(0);u=e,a=[],f=b.preFilter;while(u){if(!r||(i=Z.exec(u)))i&&(u=u.slice(i[0].length)),a.push(s=[]);r=!1;if(i=et.exec(u))s.push(r=new O(i.shift())),u=u.slice(r.length),r.type=i[0].replace(G," ");for(o in b.filter)(i=ft[o].exec(u))&&(!f[o]||(i=f[o](i,M,!0)))&&(s.push(r=new O(i.shift())),u=u.slice(r.length),r.type=o,r.matches=i);if(!r)break}return t?u.length:u?n.error(e):U(e,a).slice(0)}function a(e,t,n){var r=t.dir,i=n&&t.dir==="parentNode",s=P++;return t.first?function(t,n,s){while(t=t[r])if(i||t.nodeType===1)return e(t,n,s)}:function(t,n,o){if(!o){var u,a=D+" "+s+" ",f=a+g;while(t=t[r])if(i||t.nodeType===1){if((u=t[A])===f)return t.sizset;if(typeof u=="string"&&u.indexOf(a)===0){if(t.sizset)return t}else{t[A]=f;if(e(t,n,o))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[r])if(i||t.nodeType===1)if(e(t,n,o))return t}}function f(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function l(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function c(e,t,n,r,i,s){return r&&!r[A]&&(r=c(r)),i&&!i[A]&&(i=c(i,s)),I(function(s,o,u,a){if(s&&i)return;var f,c,h,p=[],v=[],m=o.length,g=s||d(t||"*",u.nodeType?[u]:u,[],s),y=e&&(s||!t)?l(g,p,e,u,a):g,b=n?i||(s?e:m||r)?[]:o:y;n&&n(y,b,u,a);if(r){h=l(b,v),r(h,[],u,a),f=h.length;while(f--)if(c=h[f])b[v[f]]=!(y[v[f]]=c)}if(s){f=e&&b.length;while(f--)if(c=b[f])s[p[f]]=!(o[p[f]]=c)}else b=l(b===o?b.splice(m,b.length):b),i?i(null,o,b,a):B.apply(o,b)})}function h(e){var t,n,r,i=e.length,s=b.relative[e[0].type],o=s||b.relative[" "],u=s?1:0,l=a(function(e){return e===t},o,!0),p=a(function(e){return F.call(t,e)>-1},o,!0),d=[function(e,n,r){return!s&&(r||n!==C)||((t=n).nodeType?l(e,n,r):p(e,n,r))}];for(;u<i;u++)if(n=b.relative[e[u].type])d=[a(f(d),n)];else{n=b.filter[e[u].type].apply(null,e[u].matches);if(n[A]){r=++u;for(;r<i;r++)if(b.relative[e[r].type])break;return c(u>1&&f(d),u>1&&e.slice(0,u-1).join("").replace(G,"$1"),n,u<r&&h(e.slice(u,r)),r<i&&h(e=e.slice(r)),r<i&&e.join(""))}d.push(n)}return f(d)}function p(e,t){var r=t.length>0,i=e.length>0,s=function(o,u,a,f,c){var h,p,d,v=[],m=0,y="0",w=o&&[],E=c!=null,S=C,x=o||i&&b.find.TAG("*",c&&u.parentNode||u),T=D+=S==null?1:Math.E;E&&(C=u!==M&&u,g=s.el);for(;(h=x[y])!=null;y++){if(i&&h){for(p=0;d=e[p];p++)if(d(h,u,a)){f.push(h);break}E&&(D=T,g=++s.el)}r&&((h=!d&&h)&&m--,o&&w.push(h))}m+=y;if(r&&y!==m){for(p=0;d=t[p];p++)d(w,v,u,a);if(o){if(m>0)while(y--)!w[y]&&!v[y]&&(v[y]=H.call(f));v=l(v)}B.apply(f,v),E&&!o&&v.length>0&&m+t.length>1&&n.uniqueSort(f)}return E&&(D=T,C=S),w};return s.el=0,r?I(s):s}function d(e,t,r,i){var s=0,o=t.length;for(;s<o;s++)n(e,t[s],r,i);return r}function v(e,t,n,r,i){var s,o,a,f,l,c=u(e),h=c.length;if(!r&&c.length===1){o=c[0]=c[0].slice(0);if(o.length>2&&(a=o[0]).type==="ID"&&t.nodeType===9&&!i&&b.relative[o[1].type]){t=b.find.ID(a.matches[0].replace(at,""),t,i)[0];if(!t)return n;e=e.slice(o.shift().length)}for(s=ft.POS.test(e)?-1:o.length-1;s>=0;s--){a=o[s];if(b.relative[f=a.type])break;if(l=b.find[f])if(r=l(a.matches[0].replace(at,""),it.test(o[0].type)&&t.parentNode||t,i)){o.splice(s,1),e=r.length&&o.join("");if(!e)return B.apply(n,j.call(r,0)),n;break}}}return x(e,c)(r,t,i,n,it.test(e)),n}function m(){}var g,y,b,w,E,S,x,T,N,C,k=!0,L="undefined",A=("sizcache"+Math.random()).replace(".",""),O=String,M=e.document,_=M.documentElement,D=0,P=0,H=[].pop,B=[].push,j=[].slice,F=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},I=function(e,t){return e[A]=t==null||t,e},q=function(){var e={},t=[];return I(function(n,r){return t.push(n)>b.cacheLength&&delete e[t.shift()],e[n]=r},e)},R=q(),U=q(),z=q(),W="[\\x20\\t\\r\\n\\f]",X="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",V=X.replace("w","w#"),$="([*^$|!~]?=)",J="\\["+W+"*("+X+")"+W+"*(?:"+$+W+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+V+")|)|)"+W+"*\\]",K=":("+X+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+J+")|[^:]|\\\\.)*|.*))\\)|)",Q=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+W+"*((?:-\\d)?\\d*)"+W+"*\\)|)(?=[^-]|$)",G=new RegExp("^"+W+"+|((?:^|[^\\\\])(?:\\\\.)*)"+W+"+$","g"),Z=new RegExp("^"+W+"*,"+W+"*"),et=new RegExp("^"+W+"*([\\x20\\t\\r\\n\\f>+~])"+W+"*"),tt=new RegExp(K),nt=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,rt=/^:not/,it=/[\x20\t\r\n\f]*[+~]/,st=/:not\($/,ot=/h\d/i,ut=/input|select|textarea|button/i,at=/\\(?!\\)/g,ft={ID:new RegExp("^#("+X+")"),CLASS:new RegExp("^\\.("+X+")"),NAME:new RegExp("^\\[name=['\"]?("+X+")['\"]?\\]"),TAG:new RegExp("^("+X.replace("w","w*")+")"),ATTR:new RegExp("^"+J),PSEUDO:new RegExp("^"+K),POS:new RegExp(Q,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+W+"*(even|odd|(([+-]|)(\\d*)n|)"+W+"*(?:([+-]|)"+W+"*(\\d+)|))"+W+"*\\)|)","i"),needsContext:new RegExp("^"+W+"*[>+~]|"+Q,"i")},lt=function(e){var t=M.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},ct=lt(function(e){return e.appendChild(M.createComment("")),!e.getElementsByTagName("*").length}),ht=lt(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==L&&e.firstChild.getAttribute("href")==="#"}),pt=lt(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),dt=lt(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),vt=lt(function(e){e.id=A+0,e.innerHTML="<a name='"+A+"'></a><div name='"+A+"'></div>",_.insertBefore(e,_.firstChild);var t=M.getElementsByName&&M.getElementsByName(A).length===2+M.getElementsByName(A+0).length;return y=!M.getElementById(A),_.removeChild(e),t});try{j.call(_.childNodes,0)[0].nodeType}catch(mt){j=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){return n(t,null,null,[e]).length>0},w=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=w(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=w(t);return n},E=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},S=n.contains=_.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:_.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},n.attr=function(e,t){var n,r=E(e);return r||(t=t.toLowerCase()),(n=b.attrHandle[t])?n(e):r||pt?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},b=n.selectors={cacheLength:50,createPseudo:I,match:ft,attrHandle:ht?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:y?function(e,t,n){if(typeof t.getElementById!==L&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==L&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==L&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:ct?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:vt&&function(e,t){if(typeof t.getElementsByName!==L)return t.getElementsByName(name)},CLASS:dt&&function(e,t,n){if(typeof t.getElementsByClassName!==L&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(at,""),e[3]=(e[4]||e[5]||"").replace(at,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||n.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&n.error(e[0]),e},PSEUDO:function(e){var t,n;if(ft.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])tt.test(t)&&(n=u(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:y?function(e){return e=e.replace(at,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(at,""),function(t){var n=typeof t.getAttributeNode!==L&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace(at,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=R[A][e];return t||(t=R(e,new RegExp("(^|"+W+")"+e+"("+W+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")}},ATTR:function(e,t,r){return function(i,s){var o=n.attr(i,e);return o==null?t==="!=":t?(o+="",t==="="?o===r:t==="!="?o!==r:t==="^="?r&&o.indexOf(r)===0:t==="*="?r&&o.indexOf(r)>-1:t==="$="?r&&o.substr(o.length-r.length)===r:t==="~="?(" "+o+" ").indexOf(r)>-1:t==="|="?o===r||o.substr(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var r,i=b.pseudos[e]||b.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return i[A]?i(t):i.length>1?(r=[e,e,"",t],b.setFilters.hasOwnProperty(e.toLowerCase())?I(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=F.call(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,r)}):i}},pseudos:{not:I(function(e){var t=[],n=[],r=x(e.replace(G,"$1"));return r[A]?I(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:I(function(e){return function(t){return n(e,t).length>0}}),contains:I(function(e){return function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!b.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return ot.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:r("radio"),checkbox:r("checkbox"),file:r("file"),password:r("password"),image:r("image"),submit:i("submit"),reset:i("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return ut.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&(!!e.type||!!e.href)},active:function(e){return e===e.ownerDocument.activeElement},first:s(function(e,t,n){return[0]}),last:s(function(e,t,n){return[t-1]}),eq:s(function(e,t,n){return[n<0?n+t:n]}),even:s(function(e,t,n){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:s(function(e,t,n){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:s(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:s(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},T=_.compareDocumentPosition?function(e,t){return e===t?(N=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return N=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],u=e.parentNode,a=t.parentNode,f=u;if(u===a)return o(e,t);if(!u)return-1;if(!a)return 1;while(f)i.unshift(f),f=f.parentNode;f=a;while(f)s.unshift(f),f=f.parentNode;n=i.length,r=s.length;for(var l=0;l<n&&l<r;l++)if(i[l]!==s[l])return o(i[l],s[l]);return l===n?o(e,s[l],-1):o(i[l],t,1)},[0,0].sort(T),k=!N,n.uniqueSort=function(e){var t,n=1;N=k,e.sort(T);if(N)for(;t=e[n];n++)t===e[n-1]&&e.splice(n--,1);return e},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},x=n.compile=function(e,t){var n,r=[],i=[],s=z[A][e];if(!s){t||(t=u(e)),n=t.length;while(n--)s=h(t[n]),s[A]?r.push(s):i.push(s);s=z(e,p(i,r))}return s},M.querySelectorAll&&function(){var e,t=v,r=/'|\\/g,i=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,s=[":focus"],o=[":active",":focus"],a=_.matchesSelector||_.mozMatchesSelector||_.webkitMatchesSelector||_.oMatchesSelector||_.msMatchesSelector;lt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||s.push("\\["+W+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||s.push(":checked")}),lt(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&s.push("[*^$]="+W+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||s.push(":enabled",":disabled")}),s=new RegExp(s.join("|")),v=function(e,n,i,o,a){if(!o&&!a&&(!s||!s.test(e))){var f,l,c=!0,h=A,p=n,d=n.nodeType===9&&e;if(n.nodeType===1&&n.nodeName.toLowerCase()!=="object"){f=u(e),(c=n.getAttribute("id"))?h=c.replace(r,"\\$&"):n.setAttribute("id",h),h="[id='"+h+"'] ",l=f.length;while(l--)f[l]=h+f[l].join("");p=it.test(e)&&n.parentNode||n,d=f.join(",")}if(d)try{return B.apply(i,j.call(p.querySelectorAll(d),0)),i}catch(v){}finally{c||n.removeAttribute("id")}}return t(e,n,i,o,a)},a&&(lt(function(t){e=a.call(t,"div");try{a.call(t,"[test!='']:sizzle"),o.push("!=",K)}catch(n){}}),o=new RegExp(o.join("|")),n.matchesSelector=function(t,r){r=r.replace(i,"='$1']");if(!E(t)&&!o.test(r)&&(!s||!s.test(r)))try{var u=a.call(t,r);if(u||e||t.document&&t.document.nodeType!==11)return u}catch(f){}return n(r,null,null,[t]).length>0})}(),b.pseudos.nth=b.pseudos.eq,b.filters=m.prototype=b.pseudos,b.setFilters=new m,n.attr=Y.attr,Y.find=n,Y.expr=n.selectors,Y.expr[":"]=Y.expr.pseudos,Y.unique=n.uniqueSort,Y.text=n.getText,Y.isXMLDoc=n.isXML,Y.contains=n.contains}(e);var Pt=/Until$/,Ht=/^(?:parents|prev(?:Until|All))/,Bt=/^.[^:#\[\.,]*$/,jt=Y.expr.match.needsContext,Ft={children:!0,contents:!0,next:!0,prev:!0};Y.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return Y(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(Y.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,Y.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=Y(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(Y.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(f(this,e,!1),"not",e)},filter:function(e){return this.pushStack(f(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?jt.test(e)?Y(e,this.context).index(this[0])>=0:Y.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=jt.test(e)||typeof e!="string"?Y(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:Y.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?Y.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?Y.inArray(this[0],Y(e)):Y.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?Y(e,t):Y.makeArray(e&&e.nodeType?[e]:e),r=Y.merge(this.get(),n);return this.pushStack(u(n[0])||u(r[0])?r:Y.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),Y.fn.andSelf=Y.fn.addBack,Y.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return Y.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Y.dir(e,"parentNode",n)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Y.dir(e,"nextSibling")},prevAll:function(e){return Y.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Y.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Y.dir(e,"previousSibling",n)},siblings:function(e){return Y.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Y.sibling(e.firstChild)},contents:function(e){return Y.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:Y.merge([],e.childNodes)}},function(e,t){Y.fn[e]=function(n,r){var i=Y.map(this,t,n);return Pt.test(e)||(r=n),r&&typeof r=="string"&&(i=Y.filter(r,i)),i=this.length>1&&!Ft[e]?Y.unique(i):i,this.length>1&&Ht.test(e)&&(i=i.reverse()),this.pushStack(i,e,$.call(arguments).join(","))}}),Y.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?Y.find.matchesSelector(t[0],e)?[t[0]]:[]:Y.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!Y(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var It="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",qt=/ jQuery\d+="(?:null|\d+)"/g,Rt=/^\s+/,Ut=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,zt=/<([\w:]+)/,Wt=/<tbody/i,Xt=/<|&#?\w+;/,Vt=/<(?:script|style|link)/i,$t=/<(?:script|object|embed|option|style)/i,Jt=new RegExp("<(?:"+It+")[\\s/>]","i"),Kt=/^(?:checkbox|radio)$/,Qt=/checked\s*(?:[^=]|=\s*.checked.)/i,Gt=/\/(java|ecma)script/i,Yt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},en=l(R),tn=en.appendChild(R.createElement("div"));Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,Y.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),Y.fn.extend({text:function(e){return Y.access(this,function(e){return e===t?Y.text(this):this.empty().append((this[0]&&this[0].ownerDocument||R).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(Y.isFunction(e))return this.each(function(t){Y(this).wrapAll(e.call(this,t))});if(this[0]){var t=Y(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return Y.isFunction(e)?this.each(function(t){Y(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Y(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Y.isFunction(e);return this.each(function(n){Y(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Y.nodeName(this,"body")||Y(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!u(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=Y.clean(arguments);return this.pushStack(Y.merge(e,this),"before",this.selector)}},after:function(){if(!u(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=Y.clean(arguments);return this.pushStack(Y.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||Y.filter(e,[n]).length)!t&&n.nodeType===1&&(Y.cleanData(n.getElementsByTagName("*")),Y.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&Y.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return Y.clone(this,e,t)})},html:function(e){return Y.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(qt,""):t;if(typeof e=="string"&&!Vt.test(e)&&(Y.support.htmlSerialize||!Jt.test(e))&&(Y.support.leadingWhitespace||!Rt.test(e))&&!Zt[(zt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ut,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(Y.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return u(this[0])?this.length?this.pushStack(Y(Y.isFunction(e)?e():e),"replaceWith",e):this:Y.isFunction(e)?this.each(function(t){var n=Y(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=Y(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;Y(this).remove(),t?Y(t).before(e):Y(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],h=this.length;if(!Y.support.checkClone&&h>1&&typeof f=="string"&&Qt.test(f))return this.each(function(){Y(this).domManip(e,n,r)});if(Y.isFunction(f))return this.each(function(i){var s=Y(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=Y.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&Y.nodeName(s,"tr");for(u=i.cacheable||h-1;a<h;a++)r.call(n&&Y.nodeName(this[a],"table")?c(this[a],"tbody"):this[a],a===u?o:Y.clone(o,!0,!0))}o=s=null,l.length&&Y.each(l,function(e,t){t.src?Y.ajax?Y.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):Y.error("no ajax"):Y.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Yt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),Y.buildFragment=function(e,n,r){var i,s,o,u=e[0];return n=n||R,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof u=="string"&&u.length<512&&n===R&&u.charAt(0)==="<"&&!$t.test(u)&&(Y.support.checkClone||!Qt.test(u))&&(Y.support.html5Clone||!Jt.test(u))&&(s=!0,i=Y.fragments[u],o=i!==t),i||(i=n.createDocumentFragment(),Y.clean(e,n,i,r),s&&(Y.fragments[u]=o&&i)),{fragment:i,cacheable:s}},Y.fragments={},Y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Y.fn[e]=function(n){var r,i=0,s=[],o=Y(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),Y(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),Y.extend({clone:function(e,t,n){var r,i,s,o;Y.support.html5Clone||Y.isXMLDoc(e)||!Jt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(tn.innerHTML=e.outerHTML,tn.removeChild(o=tn.firstChild));if((!Y.support.noCloneEvent||!Y.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!Y.isXMLDoc(e)){p(e,o),r=d(e),i=d(o);for(s=0;r[s];++s)i[s]&&p(r[s],i[s])}if(t){h(e,o);if(n){r=d(e),i=d(o);for(s=0;r[s];++s)h(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var i,s,o,u,a,f,c,h,p,d,m,g,y=t===R&&en,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=R;for(i=0;(o=e[i])!=null;i++){typeof o=="number"&&(o+="");if(!o)continue;if(typeof o=="string")if(!Xt.test(o))o=t.createTextNode(o);else{y=y||l(t),c=t.createElement("div"),y.appendChild(c),o=o.replace(Ut,"<$1></$2>"),u=(zt.exec(o)||["",""])[1].toLowerCase(),a=Zt[u]||Zt._default,f=a[0],c.innerHTML=a[1]+o+a[2];while(f--)c=c.lastChild;if(!Y.support.tbody){h=Wt.test(o),p=u==="table"&&!h?c.firstChild&&c.firstChild.childNodes:a[1]==="<table>"&&!h?c.childNodes:[];for(s=p.length-1;s>=0;--s)Y.nodeName(p[s],"tbody")&&!p[s].childNodes.length&&p[s].parentNode.removeChild(p[s])}!Y.support.leadingWhitespace&&Rt.test(o)&&c.insertBefore(t.createTextNode(Rt.exec(o)[0]),c.firstChild),o=c.childNodes,c.parentNode.removeChild(c)}o.nodeType?b.push(o):Y.merge(b,o)}c&&(o=c=y=null);if(!Y.support.appendChecked)for(i=0;(o=b[i])!=null;i++)Y.nodeName(o,"input")?v(o):typeof o.getElementsByTagName!="undefined"&&Y.grep(o.getElementsByTagName("input"),v);if(n){m=function(e){if(!e.type||Gt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(i=0;(o=b[i])!=null;i++)if(!Y.nodeName(o,"script")||!m(o))n.appendChild(o),typeof o.getElementsByTagName!="undefined"&&(g=Y.grep(Y.merge([],o.getElementsByTagName("script")),m),b.splice.apply(b,[i+1,0].concat(g)),i+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=Y.expando,a=Y.cache,f=Y.support.deleteExpando,l=Y.event.special;for(;(i=e[o])!=null;o++)if(t||Y.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?Y.event.remove(i,s):Y.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,Y.deletedIds.push(r))}}}}),function(){var e,t;Y.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=Y.uaMatch(z.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),Y.browser=t,Y.sub=function(){function e(t,n){return new e.fn.init(t,n)}Y.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function n(n,r){return r&&r instanceof Y&&!(r instanceof e)&&(r=e(r)),Y.fn.init.call(this,n,r,t)},e.fn.init.prototype=e.fn;var t=e(R);return e}}();var nn,rn,sn,on=/alpha\([^)]*\)/i,un=/opacity=([^)]*)/,an=/^(top|right|bottom|left)$/,fn=/^(none|table(?!-c[ea]).+)/,ln=/^margin/,cn=new RegExp("^("+Z+")(.*)$","i"),hn=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),pn=new RegExp("^([-+])=("+Z+")","i"),dn={},vn={position:"absolute",visibility:"hidden",display:"block"},mn={letterSpacing:0,fontWeight:400},gn=["Top","Right","Bottom","Left"],yn=["Webkit","O","Moz","ms"],bn=Y.fn.toggle;Y.fn.extend({css:function(e,n){return Y.access(this,function(e,n,r){return r!==t?Y.style(e,n,r):Y.css(e,n)},e,n,arguments.length>1)},show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(e,t){var n=typeof e=="boolean";return Y.isFunction(e)&&Y.isFunction(t)?bn.apply(this,arguments):this.each(function(){(n?e:g(this))?Y(this).show():Y(this).hide()})}}),Y.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":Y.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=Y.camelCase(n),f=e.style;n=Y.cssProps[a]||(Y.cssProps[a]=m(f,a)),u=Y.cssHooks[n]||Y.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=pn.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(Y.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!Y.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=Y.camelCase(n);return n=Y.cssProps[a]||(Y.cssProps[a]=m(e.style,a)),u=Y.cssHooks[n]||Y.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=nn(e,n)),s==="normal"&&n in mn&&(s=mn[n]),r||i!==t?(o=parseFloat(s),r||Y.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?nn=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u[n],r===""&&!Y.contains(t.ownerDocument,t)&&(r=Y.style(t,n)),hn.test(r)&&ln.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:R.documentElement.currentStyle&&(nn=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),hn.test(i)&&!an.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),Y.each(["height","width"],function(e,t){Y.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&fn.test(nn(e,"display"))?Y.swap(e,vn,function(){return E(e,t,r)}):E(e,t,r)},set:function(e,n,r){return b(e,n,r?w(e,t,r,Y.support.boxSizing&&Y.css(e,"boxSizing")==="border-box"):0)}}}),Y.support.opacity||(Y.cssHooks.opacity={get:function(e,t){return un.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=Y.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&Y.trim(s.replace(on,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=on.test(s)?s.replace(on,i):s+" "+i}}),Y(function(){Y.support.reliableMarginRight||(Y.cssHooks.marginRight={get:function(e,t){return Y.swap(e,{display:"inline-block"},function(){if(t)return nn(e,"marginRight")})}}),!Y.support.pixelPosition&&Y.fn.position&&Y.each(["top","left"],function(e,t){Y.cssHooks[t]={get:function(e,n){if(n){var r=nn(e,t);return hn.test(r)?Y(e).position()[t]+"px":r}}}})}),Y.expr&&Y.expr.filters&&(Y.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!Y.support.reliableHiddenOffsets&&(e.style&&e.style.display||nn(e,"display"))==="none"},Y.expr.filters.visible=function(e){return!Y.expr.filters.hidden(e)}),Y.each({margin:"",padding:"",border:"Width"},function(e,t){Y.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+gn[r]+t]=i[r]||i[r-2]||i[0];return s}},ln.test(e)||(Y.cssHooks[e+t].set=b)});var wn=/%20/g,En=/\[\]$/,Sn=/\r?\n/g,xn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Tn=/^(?:select|textarea)/i;Y.fn.extend({serialize:function(){return Y.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?Y.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Tn.test(this.nodeName)||xn.test(this.type))}).map(function(e,t){var n=Y(this).val();return n==null?null:Y.isArray(n)?Y.map(n,function(e,n){return{name:t.name,value:e.replace(Sn,"\r\n")}}):{name:t.name,value:n.replace(Sn,"\r\n")}}).get()}}),Y.param=function(e,n){var r,i=[],s=function(e,t){t=Y.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=Y.ajaxSettings&&Y.ajaxSettings.traditional);if(Y.isArray(e)||e.jquery&&!Y.isPlainObject(e))Y.each(e,function(){s(this.name,this.value)});else for(r in e)x(r,e[r],n,s);return i.join("&").replace(wn,"+")};var Nn,Cn,kn=/#.*$/,Ln=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,An=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,On=/^(?:GET|HEAD)$/,Mn=/^\/\//,_n=/\?/,Dn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Pn=/([?&])_=[^&]*/,Hn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Bn=Y.fn.load,jn={},Fn={},In=["*/"]+["*"];try{Cn=U.href}catch(qn){Cn=R.createElement("a"),Cn.href="",Cn=Cn.href}Nn=Hn.exec(Cn.toLowerCase())||[],Y.fn.load=function(e,n,r){if(typeof e!="string"&&Bn)return Bn.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),Y.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),Y.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?Y("<div>").append(e.replace(Dn,"")).find(i):e)}),this},Y.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){Y.fn[t]=function(e){return this.on(t,e)}}),Y.each(["get","post"],function(e,n){Y[n]=function(e,r,i,s){return Y.isFunction(r)&&(s=s||i,i=r,r=t),Y.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),Y.extend({getScript:function(e,n){return Y.get(e,t,n,"script")},getJSON:function(e,t,n){return Y.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?C(e,Y.ajaxSettings):(t=e,e=Y.ajaxSettings),C(e,t),e},ajaxSettings:{url:Cn,isLocal:An.test(Nn[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":In},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":Y.parseJSON,"text xml":Y.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:T(jn),ajaxTransport:T(Fn),ajax:function(e,n){function r(e,n,r,o){var f,c,y,b,E,x=n;if(w===2)return;w=2,a&&clearTimeout(a),u=t,s=o||"",S.readyState=e>0?4:0,r&&(b=k(h,S,r));if(e>=200&&e<300||e===304)h.ifModified&&(E=S.getResponseHeader("Last-Modified"),E&&(Y.lastModified[i]=E),E=S.getResponseHeader("Etag"),E&&(Y.etag[i]=E)),e===304?(x="notmodified",f=!0):(f=L(h,b),x=f.state,c=f.data,y=f.error,f=!y);else{y=x;if(!x||e)x="error",e<0&&(e=0)}S.status=e,S.statusText=(n||x)+"",f?v.resolveWith(p,[c,x,S]):v.rejectWith(p,[S,x,y]),S.statusCode(g),g=t,l&&d.trigger("ajax"+(f?"Success":"Error"),[S,h,f?c:y]),m.fireWith(p,[S,x]),l&&(d.trigger("ajaxComplete",[S,h]),--Y.active||Y.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var i,s,o,u,a,f,l,c,h=Y.ajaxSetup({},n),p=h.context||h,d=p!==h&&(p.nodeType||p instanceof Y)?Y(p):Y.event,v=Y.Deferred(),m=Y.Callbacks("once memory"),g=h.statusCode||{},y={},b={},w=0,E="canceled",S={readyState:0,setRequestHeader:function(e,t){if(!w){var n=e.toLowerCase();e=b[n]=b[n]||e,y[e]=t}return this},getAllResponseHeaders:function(){return w===2?s:null},getResponseHeader:function(e){var n;if(w===2){if(!o){o={};while(n=Ln.exec(s))o[n[1].toLowerCase()]=n[2]}n=o[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return w||(h.mimeType=e),this},abort:function(e){return e=e||E,u&&u.abort(e),r(0,e),this}};v.promise(S),S.success=S.done,S.error=S.fail,S.complete=m.add,S.statusCode=function(e){if(e){var t;if(w<2)for(t in e)g[t]=[g[t],e[t]];else t=e[S.status],S.always(t)}return this},h.url=((e||h.url)+"").replace(kn,"").replace(Mn,Nn[1]+"//"),h.dataTypes=Y.trim(h.dataType||"*").toLowerCase().split(tt),h.crossDomain==null&&(f=Hn.exec(h.url.toLowerCase())||!1,h.crossDomain=f&&f.join(":")+(f[3]?"":f[1]==="http:"?80:443)!==Nn.join(":")+(Nn[3]?"":Nn[1]==="http:"?80:443)),h.data&&h.processData&&typeof h.data!="string"&&(h.data=Y.param(h.data,h.traditional)),N(jn,h,n,S);if(w===2)return S;l=h.global,h.type=h.type.toUpperCase(),h.hasContent=!On.test(h.type),l&&Y.active++===0&&Y.event.trigger("ajaxStart");if(!h.hasContent){h.data&&(h.url+=(_n.test(h.url)?"&":"?")+h.data,delete h.data),i=h.url;if(h.cache===!1){var x=Y.now(),T=h.url.replace(Pn,"$1_="+x);h.url=T+(T===h.url?(_n.test(h.url)?"&":"?")+"_="+x:"")}}(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(i=i||h.url,Y.lastModified[i]&&S.setRequestHeader("If-Modified-Since",Y.lastModified[i]),Y.etag[i]&&S.setRequestHeader("If-None-Match",Y.etag[i])),S.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+(h.dataTypes[0]!=="*"?", "+In+"; q=0.01":""):h.accepts["*"]);for(c in h.headers)S.setRequestHeader(c,h.headers[c]);if(!h.beforeSend||h.beforeSend.call(p,S,h)!==!1&&w!==2){E="abort";for(c in{success:1,error:1,complete:1})S[c](h[c]);u=N(Fn,h,n,S);if(!u)r(-1,"No Transport");else{S.readyState=1,l&&d.trigger("ajaxSend",[S,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){S.abort("timeout")},h.timeout));try{w=1,u.send(y,r)}catch(C){if(!(w<2))throw C;r(-1,C)}}return S}return S.abort()},active:0,lastModified:{},etag:{}});var Rn=[],Un=/\?/,zn=/(=)\?(?=&|$)|\?\?/,Wn=Y.now();Y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Rn.pop()||Y.expando+"_"+Wn++;return this[e]=!0,e}}),Y.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&zn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&zn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=Y.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(zn,"$1"+s):h?n.data=a.replace(zn,"$1"+s):l&&(n.url+=(Un.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||Y.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Rn.push(s)),u&&Y.isFunction(o)&&o(u[0]),u=o=t}),"script"}),Y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return Y.globalEval(e),e}}}),Y.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),Y.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=R.head||R.getElementsByTagName("head")[0]||R.documentElement;return{send:function(i,s){n=R.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||s(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Xn,Vn=e.ActiveXObject?function(){for(var e in Xn)Xn[e](0,1)}:!1,$n=0;Y.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&A()||O()}:A,function(e){Y.extend(Y.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(Y.ajaxSettings.xhr()),Y.support.ajax&&Y.ajaxTransport(function(n){if(!n.crossDomain||Y.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=Y.noop,Vn&&delete Xn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(e){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++$n,Vn&&(Xn||(Xn={},Y(e).unload(Vn)),Xn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var Jn,Kn,Qn=/^(?:toggle|show|hide)$/,Gn=new RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Yn=/queueHooks$/,Zn=[H],er={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=Gn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(Y.cssNumber[e]?"":"px");if(r!=="px"&&u){u=Y.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,Y.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};Y.Animation=Y.extend(D,{tweener:function(e,t){Y.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],er[n]=er[n]||[],er[n].unshift(t)},prefilter:function(e,t){t?Zn.unshift(e):Zn.push(e)}}),Y.Tween=B,B.prototype={constructor:B,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(Y.cssNumber[n]?"":"px")},cur:function(){var e=B.propHooks[this.prop];return e&&e.get?e.get(this):B.propHooks._default.get(this)},run:function(e){var t,n=B.propHooks[this.prop];return this.options.duration?this.pos=t=Y.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):B.propHooks._default.set(this),this}},B.prototype.init.prototype=B.prototype,B.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=Y.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){Y.fx.step[e.prop]?Y.fx.step[e.prop](e):e.elem.style&&(e.elem.style[Y.cssProps[e.prop]]!=null||Y.cssHooks[e.prop])?Y.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},B.propHooks.scrollTop=B.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Y.each(["toggle","show","hide"],function(e,t){var n=Y.fn[t];Y.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&Y.isFunction(r)&&Y.isFunction(i)?n.apply(this,arguments):this.animate(j(t,!0),r,i,s)}}),Y.fn.extend({fadeTo:function(e,t,n,r){return this.filter(g).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=Y.isEmptyObject(e),s=Y.speed(t,n,r),o=function(){var t=D(this,Y.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=Y.timers,o=Y._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Yn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&Y.dequeue(this,e)})}}),Y.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Y.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),Y.speed=function(e,t,n){var r=e&&typeof e=="object"?Y.extend({},e):{complete:n||!n&&t||Y.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Y.isFunction(t)&&t};r.duration=Y.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in Y.fx.speeds?Y.fx.speeds[r.duration]:Y.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){Y.isFunction(r.old)&&r.old.call(this),r.queue&&Y.dequeue(this,r.queue)},r},Y.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Y.timers=[],Y.fx=B.prototype.init,Y.fx.tick=function(){var e,t=Y.timers,n=0;for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||Y.fx.stop()},Y.fx.timer=function(e){e()&&Y.timers.push(e)&&!Kn&&(Kn=setInterval(Y.fx.tick,Y.fx.interval))},Y.fx.interval=13,Y.fx.stop=function(){clearInterval(Kn),Kn=null},Y.fx.speeds={slow:600,fast:200,_default:400},Y.fx.step={},Y.expr&&Y.expr.filters&&(Y.expr.filters.animated=function(e){return Y.grep(Y.timers,function(t){return e===t.elem}).length});var tr=/^(?:body|html)$/i;Y.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){Y.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?Y.offset.bodyOffset(l):(n=c.documentElement,Y.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=F(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},Y.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return Y.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(Y.css(e,"marginTop"))||0,n+=parseFloat(Y.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=Y.css(e,"position");r==="static"&&(e.style.position="relative");var i=Y(e),s=i.offset(),o=Y.css(e,"top"),u=Y.css(e,"left"),a=(r==="absolute"||r==="fixed")&&Y.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),Y.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},Y.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=tr.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(Y.css(e,"marginTop"))||0,n.left-=parseFloat(Y.css(e,"marginLeft"))||0,r.top+=parseFloat(Y.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(Y.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||R.body;while(e&&!tr.test(e.nodeName)&&Y.css(e,"position")==="static")e=e.offsetParent;return e||R.body})}}),Y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);Y.fn[e]=function(i){return Y.access(this,function(e,i,s){var o=F(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?Y(o).scrollLeft():s,r?s:Y(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),Y.each({Height:"height",Width:"width"},function(e,n){Y.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){Y.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return Y.access(this,function(n,r,i){var s;return Y.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?Y.css(n,r,i,u):Y.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=Y,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return Y})}(window),$.ajaxTransport("+*",function(e,t,n){if(window.FormData&&(e.dataType&&(e.dataType=="blob"||e.dataType=="arraybuffer")||e.data&&(window.Blob&&e.data instanceof Blob||window.ArrayBuffer&&e.data instanceof ArrayBuffer)))return{send:function(t,n){var r=new XMLHttpRequest,i=e.url||window.location.href,s=e.type||"GET",o=e.dataType||"text",u=e.data||null,a=e.async||!0;r.addEventListener("load",function(){var e={};e[o]=r.response,n(r.status,r.statusText,e,r.getAllResponseHeaders())}),r.open(s,i,a),r.responseType=o,r.send(u)},abort:function(){n.abort()}}}),define("DQX/Msg",[],function(){var e={};return e._listeners=[],e._listeneridmap={},e.broadcast=function(t,n){var r=0;for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]!=null){var s=e._listeners[i].scopeFilter,o=!0;for(var u in s){u in t?s[u]!=t[u]&&(o=!1):o=!1;if(!o)break}o&&(e._listeners[i].callbackFunction.call(e._listeners[i].context,t,n),r++)}return r},e.send=function(t,n){var r=e.broadcast(t,n);r>1&&DQX.reportError("Message was processed by more than one recipient"),r==0&&DQX.reportError("Message was not processed by any recipient")},e.listen=function(t,n,r,i){typeof t!="string"&&DQX.reportError("Listener event id not provided"),r||DQX.reportError("No callback function provided for event listener");if(t!=""&&t in e._listeneridmap){var s=e._listeneridmap[t];e._listeners[s].scopeFilter=n,e._listeners[s].callbackFunction=r,e._listeners[s].context=i;return}t!=""&&(e._listeneridmap[t]=e._listeners.length),e._listeners.push({eventid:t,scopeFilter:n,callbackFunction:r,context:i})},e.delListener=function(t){if(t in e._listeneridmap){var n=e._listeneridmap[t];e._listeners[n]=null,delete e._listeneridmap[t]}},e}),define("DQX/DocEl",[],function(){var e={};return e._Element=function(t,n){this.myType=t,this.myAttributes={},this.myStyles={},this.myComponents=[],typeof n!="undefined"&&("id"in n&&this.setID(n.id),"parent"in n&&(n.parent instanceof e._Element||DQX.reportError("DocEl parent is not a DocEl"),n.parent.addElem(this)))},e._Element.prototype.setID=function(e){this.myID=e,this.addAttribute("id",e)},e._Element.prototype.getID=function(){return this.myID},e._Element.prototype.addAttribute=function(e,t){return this.myAttributes[e]=""+t,this},e._Element.prototype.addStyle=function(e,t){return this.myStyles[e]=""+t.toString(),this},e._Element.prototype.addElem=function(e){return this.myComponents.push(e),this},e._Element.prototype.getElem=function(e){return this.myComponents[e]},e._Element.prototype.addHint=function(e){return this.addAttribute("title",e),this},e._Element.prototype.setCssClass=function(e){return this.addAttribute("class",e),this},e._Element.prototype.makeVisibleHorizontalScroller=function(e){return this.addStyle("overflow-x","scroll"),e&&this.addStyle("-webkit-overflow-scrolling","touch"),this},e._Element.prototype.makeAutoHorizontalScroller=function(e){return this.addStyle("overflow-x","auto"),e&&this.addStyle("-webkit-overflow-scrolling","touch"),this},e._Element.prototype.makeAutoVerticalScroller=function(e){return this.addStyle("overflow-y","auto"),e&&this.addStyle("-webkit-overflow-scrolling","touch"),this},e._Element.prototype.setBackgroundColor=function(e){return this.addStyle("background-color",e.toString()),this},e._Element.prototype.setColor=function(e){return this.addStyle("color",e.toString()),this},e._Element.prototype.setWidthPx=function(e){return this.addStyle("width",e.toString()+"px"),this},e._Element.prototype.setWidthPc=function(e){return this.addStyle("width",e.toString()+"%"),this},e._Element.prototype.setWidthFull=function(){return this.addStyle("width","100%"),this},e._Element.prototype.setHeightPx=function(e){return this.addStyle("height",e.toString()+"px"),this},e._Element.prototype.setShadow=function(e,t,n,r){return this.addStyle("box-shadow",e.toString()+"px "+t.toString()+"px "+n.toString()+"px "+r.toString()),this},e._Element.prototype.makeFloatLeft=function(){return this.addStyle("float","left"),this},e._Element.prototype.setOnClick=function(e){this.addAttribute("onclick",e)},e._Element.prototype.setOnChange=function(e){this.addAttribute("onchange",e)},e._Element.prototype.setOnKeyUp=function(e){this.addAttribute("onkeyup",e)},e._Element.prototype.toString=function(){var e="<"+this.myType;for(id in this.myAttributes)e+=" ",e+=id+'="'+this.myAttributes[id]+'"',t=!1;e+=' style="';var t=!0;for(id in this.myStyles)t||(e+=";"),e+=id+":"+this.myStyles[id],t=!1;return e+='"',e+=">",e+=this.CreateInnerHtml(),e+="</"+this.myType+">",e},e._Element.prototype.CreateInnerHtml=function(){var e="";for(var t=0;t<this.myComponents.length;t++)e+=this.myComponents[t].toString();return e},e.Create=function(t,n){var r=new e._Element(t,n);return r},e.Span=function(t){var n=e.Create("span",t);return n},e.Div=function(t){var n=e.Create("div",t);return n},e.Select=function(t,n,r){var i=e.Create("select",r),s="",o="";for(var u in t){"id"in t[u]||DQX.reportError("Select option list should have id properties"),"name"in t[u]||DQX.reportError("Select option list should have name properties");var a=t[u].group||"";a!=o&&(o&&(s+="</optgroup>"),o=a,a&&(s+='<optgroup = label="{name}">'.DQXformat({name:a}))),s+='<option value="'+t[u].id+'"',n==t[u].id&&(s+='selected="selected"'),s+=">"+t[u].name+"</option>"}return o&&(s+="</optgroup>"),i.addElem(s),i.SetChangeEvent=function(e){this.addAttribute("onchange",e)},i},e.Edit=function(t,n){var r=e.Create("input",n);return r.addAttribute("type","text"),r.addAttribute("value",t),n&&n.placeHolder&&r.addAttribute("placeholder",n.placeHolder),r},e.Check=function(t){var n=e.Create("input",t);return n.addAttribute("type","checkbox"),n},e.Label=function(t){var n=e.Create("label",t);return"target"in t&&n.addAttribute("for",t.target),n},e.JavaScriptlink=function(t,n,r){var i=e.Create("a",r);return i.addAttribute("href","javascript:void(0)"),i.addAttribute("onclick",n),i.addElem(t),i},e.JavaScriptBitmaplinkTransparent=function(t,n,r,i){return e.JavaScriptlink('<IMG SRC="'+t+'" border=0 class="DQXBitmapLinkTransparent" ALT="'+n+'" TITLE="'+n+'">',r,i)},e.JavaScriptBitmaplink=function(t,n,r,i){return e.JavaScriptlink('<IMG SRC="'+t+'" border=0 class="DQXBitmapLink" ALT="'+n+'" TITLE="'+n+'">',r,i)},e.StyledText=function(t,n){var r=e.Span();return r.setCssClass(n),r.addElem(t),r},e}),function(e,t){typeof define=="function"&&define.amd?define("handlebars",[],t):typeof exports=="object"?module.exports=t():e.Handlebars=e.Handlebars||t()}(this,function(){var e=function(){"use strict";function t(e){this.string=e}var e;return t.prototype.toString=function(){return""+this.string},e=t,e}(),t=function(e){"use strict";function o(e){return r[e]}function u(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function c(e){return e instanceof n?e.toString():e==null?"":e?(e=""+e,s.test(e)?e.replace(i,o):e):e+""}function h(e){return!e&&e!==0?!0:l(e)&&e.length===0?!0:!1}function p(e,t){return(e?e+".":"")+t}var t={},n=e,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,s=/[&<>"'`]/;t.extend=u;var a=Object.prototype.toString;t.toString=a;var f=function(e){return typeof e=="function"};f(/x/)&&(f=function(e){return typeof e=="function"&&a.call(e)==="[object Function]"});var f;t.isFunction=f;var l=Array.isArray||function(e){return e&&typeof e=="object"?a.call(e)==="[object Array]":!1};return t.isArray=l,t.escapeExpression=c,t.isEmpty=h,t.appendContextPath=p,t}(e),n=function(){"use strict";function n(e,n){var r;n&&n.firstLine&&(r=n.firstLine,e+=" - "+r+":"+n.firstColumn);var i=Error.prototype.constructor.call(this,e);for(var s=0;s<t.length;s++)this[t[s]]=i[t[s]];r&&(this.lineNumber=r,this.column=n.firstColumn)}var e,t=["description","fileName","lineNumber","message","name","number","stack"];return n.prototype=new Error,e=n,e}(),r=function(e,t){"use strict";function h(e,t){this.helpers=e||{},this.partials=t||{},p(this)}function p(e){e.registerHelper("helperMissing",function(){if(arguments.length===1)return undefined;throw new i("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var i=n.inverse,s=n.fn;if(t===!0)return s(this);if(t===!1||t==null)return i(this);if(a(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var o=m(n.data);o.contextPath=r.appendContextPath(n.data.contextPath,n.name),n={data:o}}return s(t,n)}),e.registerHelper("each",function(e,t){if(!t)throw new i("Must pass iterator to #each");var n=t.fn,s=t.inverse,o=0,u="",l,c;t.data&&t.ids&&(c=r.appendContextPath(t.data.contextPath,t.ids[0])+"."),f(e)&&(e=e.call(this)),t.data&&(l=m(t.data));if(e&&typeof e=="object")if(a(e))for(var h=e.length;o<h;o++)l&&(l.index=o,l.first=o===0,l.last=o===e.length-1,c&&(l.contextPath=c+o)),u+=n(e[o],{data:l});else for(var p in e)e.hasOwnProperty(p)&&(l&&(l.key=p,l.index=o,l.first=o===0,c&&(l.contextPath=c+p)),u+=n(e[p],{data:l}),o++);return o===0&&(u=s(this)),u}),e.registerHelper("if",function(e,t){return f(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){f(e)&&(e=e.call(this));var n=t.fn;if(!r.isEmpty(e)){if(t.data&&t.ids){var i=m(t.data);i.contextPath=r.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}return t.inverse(this)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var n={},r=e,i=t,s="2.0.0";n.VERSION=s;var o=6;n.COMPILER_REVISION=o;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};n.REVISION_CHANGES=u;var a=r.isArray,f=r.isFunction,l=r.toString,c="[object Object]";n.HandlebarsEnvironment=h,h.prototype={constructor:h,logger:d,log:v,registerHelper:function(e,t){if(l.call(e)===c){if(t)throw new i("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){l.call(e)===c?r.extend(this.partials,e):this.partials[e]=t},unregisterPartial:function(e){delete this.partials[e]}};var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(d.level<=e){var n=d.methodMap[e];typeof console!="undefined"&&console[n]&&console[n].call(console,t)}}};n.logger=d;var v=d.log;n.log=v;var m=function(e){var t=r.extend({},e);return t._parent=e,t};return n.createFrame=m,n}(t,n),i=function(e,t,n){"use strict";function f(e){var t=e&&e[0]||1,n=o;if(t!==n){if(t<n){var r=u[n],i=u[t];throw new s("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new s("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function l(e,t){if(!t)throw new s("No environment passed to template");if(!e||!e.main)throw new s("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n=function(n,r,o,u,a,f,l,c,h){a&&(u=i.extend({},u,a));var p=t.VM.invokePartial.call(this,n,o,u,f,l,c,h);if(p==null&&t.compile){var d={helpers:f,partials:l,data:c,depths:h};l[o]=t.compile(n,{data:c!==undefined,compat:e.compat},t),p=l[o](u,d)}if(p!=null){if(r){var v=p.split("\n");for(var m=0,g=v.length;m<g;m++){if(!v[m]&&m+1===g)break;v[m]=r+v[m]}p=v.join("\n")}return p}throw new s("The partial "+o+" could not be compiled when running in runtime-only mode")},r={lookup:function(e,t){var n=e.length;for(var r=0;r<n;r++)if(e[r]&&e[r][t]!=null)return e[r][t]},lambda:function(e,t){return typeof e=="function"?e.call(t):e},escapeExpression:i.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n){var r=this.programs[e],i=this.fn(e);return t||n?r=c(this,e,i,t,n):r||(r=this.programs[e]=c(this,e,i)),r},data:function(e,t){while(e&&t--)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=i.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler},o=function(t,n){n=n||{};var i=n.data;o._setup(n),!n.partial&&e.useData&&(i=d(t,i));var s;return e.useDepths&&(s=n.depths?[t].concat(n.depths):[t]),e.main.call(r,t,r.helpers,r.partials,i,s)};return o.isTop=!0,o._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,t.helpers),e.usePartial&&(r.partials=r.merge(n.partials,t.partials)))},o._child=function(t,n,i){if(e.useDepths&&!i)throw new s("must pass parent depths");return c(r,t,e[t],n,i)},o}function c(e,t,n,r,i){var s=function(t,s){return s=s||{},n.call(e,t,e.helpers,e.partials,s.data||r,i&&[t].concat(i))};return s.program=t,s.depth=i?i.length:0,s}function h(e,t,n,r,i,o,u){var a={partial:!0,helpers:r,partials:i,data:o,depths:u};if(e===undefined)throw new s("The partial "+t+" could not be found");if(e instanceof Function)return e(n,a)}function p(){return""}function d(e,t){if(!t||!("root"in t))t=t?a(t):{},t.root=e;return t}var r={},i=e,s=t,o=n.COMPILER_REVISION,u=n.REVISION_CHANGES,a=n.createFrame;return r.checkRevision=f,r.template=l,r.program=c,r.invokePartial=h,r.noop=p,r}(t,n,r),s=function(e,t,n,r,i){"use strict";var s,o=e,u=t,a=n,f=r,l=i,c=function(){var e=new o.HandlebarsEnvironment;return f.extend(e,o),e.SafeString=u,e.Exception=a,e.Utils=f,e.escapeExpression=f.escapeExpression,e.VM=l,e.template=function(t){return l.template(t,e)},e},h=c();return h.create=c,h["default"]=h,s=h,s}(r,e,n,t,i),o=function(e){"use strict";function r(e){e=e||{},this.firstLine=e.first_line,this.firstColumn=e.first_column,this.lastColumn=e.last_column,this.lastLine=e.last_line}var t,n=e,i={ProgramNode:function(e,t,n){r.call(this,n),this.type="program",this.statements=e,this.strip=t},MustacheNode:function(e,t,n,s,o){r.call(this,o),this.type="mustache",this.strip=s;if(n!=null&&n.charAt){var u=n.charAt(3)||n.charAt(2);this.escaped=u!=="{"&&u!=="&"}else this.escaped=!!n;e instanceof i.SexprNode?this.sexpr=e:this.sexpr=new i.SexprNode(e,t),this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(e,t,n){r.call(this,n),this.type="sexpr",this.hash=t;var i=this.id=e[0],s=this.params=e.slice(1);this.isHelper=!!s.length||!!t,this.eligibleHelper=this.isHelper||i.isSimple},PartialNode:function(e,t,n,i,s){r.call(this,s),this.type="partial",this.partialName=e,this.context=t,this.hash=n,this.strip=i,this.strip.inlineStandalone=!0},BlockNode:function(e,t,n,i,s){r.call(this,s),this.type="block",this.mustache=e,this.program=t,this.inverse=n,this.strip=i,n&&!t&&(this.isInverse=!0)},RawBlockNode:function(e,t,s,o){r.call(this,o);if(e.sexpr.id.original!==s)throw new n(e.sexpr.id.original+" doesn't match "+s,this);t=new i.ContentNode(t,o),this.type="block",this.mustache=e,this.program=new i.ProgramNode([t],{},o)},ContentNode:function(e,t){r.call(this,t),this.type="content",this.original=this.string=e},HashNode:function(e,t){r.call(this,t),this.type="hash",this.pairs=e},IdNode:function(e,t){r.call(this,t),this.type="ID";var i="",s=[],o=0,u="";for(var a=0,f=e.length;a<f;a++){var l=e[a].part;i+=(e[a].separator||"")+l;if(l===".."||l==="."||l==="this"){if(s.length>0)throw new n("Invalid path: "+i,this);l===".."?(o++,u+="../"):this.isScoped=!0}else s.push(l)}this.original=i,this.parts=s,this.string=s.join("."),this.depth=o,this.idName=u+this.string,this.isSimple=e.length===1&&!this.isScoped&&o===0,this.stringModeValue=this.string},PartialNameNode:function(e,t){r.call(this,t),this.type="PARTIAL_NAME",this.name=e.original},DataNode:function(e,t){r.call(this,t),this.type="DATA",this.id=e,this.stringModeValue=e.stringModeValue,this.idName="@"+e.stringModeValue},StringNode:function(e,t){r.call(this,t),this.type="STRING",this.original=this.string=this.stringModeValue=e},NumberNode:function(e,t){r.call(this,t),this.type="NUMBER",this.original=this.number=e,this.stringModeValue=Number(e)},BooleanNode:function(e,t){r.call(this,t),this.type="BOOLEAN",this.bool=e,this.stringModeValue=e==="true"},CommentNode:function(e,t){r.call(this,t),this.type="comment",this.comment=e,this.strip={inlineStandalone:!0}}};return t=i,t}(n),u=function(){"use strict";var e,t=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,CONTENT:12,COMMENT:13,openRawBlock:14,END_RAW_BLOCK:15,OPEN_RAW_BLOCK:16,sexpr:17,CLOSE_RAW_BLOCK:18,openBlock:19,block_option0:20,closeBlock:21,openInverse:22,block_option1:23,OPEN_BLOCK:24,CLOSE:25,OPEN_INVERSE:26,inverseAndProgram:27,INVERSE:28,OPEN_ENDBLOCK:29,path:30,OPEN:31,OPEN_UNESCAPED:32,CLOSE_UNESCAPED:33,OPEN_PARTIAL:34,partialName:35,param:36,partial_option0:37,partial_option1:38,sexpr_repetition0:39,sexpr_option0:40,dataName:41,STRING:42,NUMBER:43,BOOLEAN:44,OPEN_SEXPR:45,CLOSE_SEXPR:46,hash:47,hash_repetition_plus0:48,hashSegment:49,ID:50,EQUALS:51,DATA:52,pathSegments:53,SEP:54,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return i.prepareProgram(o[a-1].statements,!0),o[a-1];case 2:this.$=new i.ProgramNode(i.prepareProgram(o[a]),{},this._$);break;case 3:this.$=o[a];break;case 4:this.$=o[a];break;case 5:this.$=o[a];break;case 6:this.$=o[a];break;case 7:this.$=new i.ContentNode(o[a],this._$);break;case 8:this.$=new i.CommentNode(o[a],this._$);break;case 9:this.$=new i.RawBlockNode(o[a-2],o[a-1],o[a],this._$);break;case 10:this.$=new i.MustacheNode(o[a-1],null,"","",this._$);break;case 11:this.$=i.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!1,this._$);break;case 12:this.$=i.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!0,this._$);break;case 13:this.$=new i.MustacheNode(o[a-1],null,o[a-2],i.stripFlags(o[a-2],o[a]),this._$);break;case 14:this.$=new i.MustacheNode(o[a-1],null,o[a-2],i.stripFlags(o[a-2],o[a]),this._$);break;case 15:this.$={strip:i.stripFlags(o[a-1],o[a-1]),program:o[a]};break;case 16:this.$={path:o[a-1],strip:i.stripFlags(o[a-2],o[a])};break;case 17:this.$=new i.MustacheNode(o[a-1],null,o[a-2],i.stripFlags(o[a-2],o[a]),this._$);break;case 18:this.$=new i.MustacheNode(o[a-1],null,o[a-2],i.stripFlags(o[a-2],o[a]),this._$);break;case 19:this.$=new i.PartialNode(o[a-3],o[a-2],o[a-1],i.stripFlags(o[a-4],o[a]),this._$);break;case 20:this.$=new i.PartialNode(o[a-2],undefined,o[a-1],i.stripFlags(o[a-3],o[a]),this._$);break;case 21:this.$=new i.SexprNode([o[a-2]].concat(o[a-1]),o[a],this._$);break;case 22:this.$=new i.SexprNode([o[a]],null,this._$);break;case 23:this.$=o[a];break;case 24:this.$=new i.StringNode(o[a],this._$);break;case 25:this.$=new i.NumberNode(o[a],this._$);break;case 26:this.$=new i.BooleanNode(o[a],this._$);break;case 27:this.$=o[a];break;case 28:o[a-1].isHelper=!0,this.$=o[a-1];break;case 29:this.$=new i.HashNode(o[a],this._$);break;case 30:this.$=[o[a-2],o[a]];break;case 31:this.$=new i.PartialNameNode(o[a],this._$);break;case 32:this.$=new i.PartialNameNode(new i.StringNode(o[a],this._$),this._$);break;case 33:this.$=new i.PartialNameNode(new i.NumberNode(o[a],this._$));break;case 34:this.$=new i.DataNode(o[a],this._$);break;case 35:this.$=new i.IdNode(o[a],this._$);break;case 36:o[a-2].push({part:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 37:this.$=[{part:o[a]}];break;case 38:this.$=[];break;case 39:o[a-1].push(o[a]);break;case 48:this.$=[];break;case 49:o[a-1].push(o[a]);break;case 52:this.$=[o[a]];break;case 53:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){function s(e,t){return n.yytext=n.yytext.substr(e,n.yyleng-t)}var o=i;switch(r){case 0:n.yytext.slice(-2)==="\\\\"?(s(0,1),this.begin("mu")):n.yytext.slice(-1)==="\\"?(s(0,1),this.begin("emu")):this.begin("mu");if(n.yytext)return 12;break;case 1:return 12;case 2:return this.popState(),12;case 3:return n.yytext=n.yytext.substr(5,n.yyleng-9),this.popState(),15;case 4:return 12;case 5:return s(0,4),this.popState(),13;case 6:return 45;case 7:return 46;case 8:return 16;case 9:return this.popState(),this.begin("raw"),18;case 10:return 34;case 11:return 24;case 12:return 29;case 13:return this.popState(),28;case 14:return this.popState(),28;case 15:return 26;case 16:return 26;case 17:return 32;case 18:return 31;case 19:this.popState(),this.begin("com");break;case 20:return s(3,5),this.popState(),13;case 21:return 31;case 22:return 51;case 23:return 50;case 24:return 50;case 25:return 54;case 26:break;case 27:return this.popState(),33;case 28:return this.popState(),25;case 29:return n.yytext=s(1,2).replace(/\\"/g,'"'),42;case 30:return n.yytext=s(1,2).replace(/\\'/g,"'"),42;case 31:return 52;case 32:return 44;case 33:return 44;case 34:return 43;case 35:return 50;case 36:return n.yytext=s(1,2),50;case 37:return"INVALID";case 38:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,38],inclusive:!0}},e}();return e.lexer=t,n.prototype=e,e.Parser=n,new n}();return e=t,e}(),a=function(e){"use strict";function r(e,t){return{left:e.charAt(2)==="~",right:t.charAt(t.length-3)==="~"}}function i(e,t,r,i,s,l){if(e.sexpr.id.original!==i.path.original)throw new n(e.sexpr.id.original+" doesn't match "+i.path.original,e);var c=r&&r.program,h={left:e.strip.left,right:i.strip.right,openStandalone:u(t.statements),closeStandalone:o((c||t).statements)};e.strip.right&&a(t.statements,null,!0);if(c){var p=r.strip;p.left&&f(t.statements,null,!0),p.right&&a(c.statements,null,!0),i.strip.left&&f(c.statements,null,!0),o(t.statements)&&u(c.statements)&&(f(t.statements),a(c.statements))}else i.strip.left&&f(t.statements,null,!0);return s?new this.BlockNode(e,c,t,h,l):new this.BlockNode(e,t,c,h,l)}function s(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n],s=i.strip;if(!s)continue;var l=o(e,n,t,i.type==="partial"),c=u(e,n,t),h=s.openStandalone&&l,p=s.closeStandalone&&c,d=s.inlineStandalone&&l&&c;s.right&&a(e,n,!0),s.left&&f(e,n,!0),d&&(a(e,n),f(e,n)&&i.type==="partial"&&(i.indent=/([ \t]+$)/.exec(e[n-1].original)?RegExp.$1:"")),h&&(a((i.program||i.inverse).statements),f(e,n)),p&&(a(e,n),f((i.inverse||i.program).statements))}return e}function o(e,t,n){t===undefined&&(t=e.length);var r=e[t-1],i=e[t-2];if(!r)return n;if(r.type==="content")return(i||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(r.original)}function u(e,t,n){t===undefined&&(t=-1);var r=e[t+1],i=e[t+2];if(!r)return n;if(r.type==="content")return(i||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(r.original)}function a(e,t,n){var r=e[t==null?0:t+1];if(!r||r.type!=="content"||!n&&r.rightStripped)return;var i=r.string;r.string=r.string.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),r.rightStripped=r.string!==i}function f(e,t,n){var r=e[t==null?e.length-1:t-1];if(!r||r.type!=="content"||!n&&r.leftStripped)return;var i=r.string;return r.string=r.string.replace(n?/\s+$/:/[ \t]+$/,""),r.leftStripped=r.string!==i,r.leftStripped}var t={},n=e;return t.stripFlags=r,t.prepareBlock=i,t.prepareProgram=s,t}(n),f=function(e,t,n,r){"use strict";function l(e){return e.constructor===o.ProgramNode?e:(s.yy=f,s.parse(e))}var i={},s=e,o=t,u=n,a=r.extend;i.parser=s;var f={};return a(f,u,o),i.parse=l,i}(u,o,a,t),l=function(e,t){"use strict";function o(){}function u(e,t,n){if(e==null||typeof e!="string"&&e.constructor!==n.AST.ProgramNode)throw new r("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var i=n.parse(e),s=(new n.Compiler).compile(i,t);return(new n.JavaScriptCompiler).compile(s,t)}function a(e,t,n){function s(){var r=n.parse(e),i=(new n.Compiler).compile(r,t),s=(new n.JavaScriptCompiler).compile(i,t,undefined,!0);return n.template(s)}if(e==null||typeof e!="string"&&e.constructor!==n.AST.ProgramNode)throw new r("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var i,o=function(e,t){return i||(i=s()),i.call(this,e,t)};return o._setup=function(e){return i||(i=s()),i._setup(e)},o._child=function(e,t,n){return i||(i=s()),i._child(e,t,n)},o}function f(e,t){if(e===t)return!0;if(i(e)&&i(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(!f(e[n],t[n]))return!1;return!0}}var n={},r=e,i=t.isArray,s=[].slice;return n.Compiler=o,o.prototype={compiler:o,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||!f(r.args,i.args))return!1}t=this.children.length;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.accept(e)},accept:function(e){return this[e.type](e)},program:function(e){var t=e.statements;for(var n=0,r=t.length;n<r;n++)this.accept(t[n]);return this.isSimple=r===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=t.sexpr,s=this.classifySexpr(i);s==="helper"?this.helperSexpr(i,n,r):s==="simple"?(this.simpleSexpr(i),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",i.id.original)):(this.ambiguousSexpr(i,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("pushHash");for(n=0,r=t.length;n<r;n++)this.pushParam(t[n][1]);while(n--)this.opcode("assignToHash",t[n][0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.hash?this.accept(e.hash):this.opcode("push","undefined"),e.context?this.accept(e.context):(this.opcode("getContext",0),this.opcode("pushContext")),this.opcode("invokePartial",t.name,e.indent||""),this.opcode("append")},content:function(e){e.string&&this.opcode("appendContent",e.string)},mustache:function(e){this.sexpr(e.sexpr),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(e,t,n){var r=e.id,i=r.parts[0],s=t!=null||n!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.ID(r),this.opcode("invokeAmbiguous",i,s)},simpleSexpr:function(e){var t=e.id;t.type==="DATA"?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,n){var i=this.setupFullMustacheParams(e,t,n),s=e.id,o=s.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",i.length,o);else{if(this.options.knownHelpersOnly)throw new r("You specified knownHelpersOnly, but used the unknown helper "+o,e);s.falsy=!0,this.ID(s),this.opcode("invokeHelper",i.length,s.original,s.isSimple)}},sexpr:function(e){var t=this.classifySexpr(e);t==="simple"?this.simpleSexpr(e):t==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts,e.falsy,e.isScoped):this.opcode("pushContext")},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id.depth,e.id.parts)},STRING:function(e){this.opcode("pushString",e.string)},NUMBER:function(e){this.opcode("pushLiteral",e.number)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:s.call(arguments,1)})},addDepth:function(e){if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifySexpr:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){for(var t=0,n=e.length;t<n;t++)this.pushParam(e[t])},pushParam:function(e){this.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.stringModeValue,e.type),e.type==="sexpr"&&this.sexpr(e)):(this.trackIds&&this.opcode("pushId",e.type,e.idName||e.stringModeValue),this.accept(e))},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}},n.precompile=u,n.compile=a,n}(n,t),c=function(e,t){"use strict";function o(e){this.value=e}function u(){}var n,r=e.COMPILER_REVISION,i=e.REVISION_CHANGES,s=t;u.prototype={nameLookup:function(e,t){return u.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},depthedLookup:function(e){return this.aliases.lookup="this.lookup",'lookup(depths, "'+e+'")'},compilerInfo:function(){var e=r,t=i[e];return[e,t]},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,r){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!r,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.depths.list.length||this.options.compat;var i=e.opcodes,o,u,a;for(u=0,a=i.length;u<a;u++)o=i[u],this[o.opcode].apply(this,o.args);this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new s("Compile completed with content left on stack");var f=this.createFunctionContext(r);if(!this.isChild){var l={compiler:this.compilerInfo(),main:f},c=this.context.programs;for(u=0,a=c.length;u<a;u++)c[u]&&(l[u]=c[u]);return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.options.compat&&(l.compat=!0),r||(l.compiler=JSON.stringify(l.compiler),l=this.objectLiteral(l)),l}return f},preamble:function(){this.lastContext=0,this.source=[]},createFunctionContext:function(e){var t="",n=this.stackVars.concat(this.registers.list);n.length>0&&(t+=", "+n.join(", "));for(var r in this.aliases)this.aliases.hasOwnProperty(r)&&(t+=", "+r+"="+this.aliases[r]);var i=["depth0","helpers","partials","data"];this.useDepths&&i.push("depths");var s=this.mergeSource(t);return e?(i.push(s),Function.apply(this,i)):"function("+i.join(",")+") {\n  "+s+"}"},mergeSource:function(e){var t="",n,r=!this.forceBuffer,i;for(var s=0,o=this.source.length;s<o;s++){var u=this.source[s];u.appendToBuffer?n?n=n+"\n    + "+u.content:n=u.content:(n&&(t?t+="buffer += "+n+";\n  ":(i=!0,t=n+";\n  "),n=undefined),t+=u+"\n  ",this.environment.isSimple||(r=!1))}if(r){if(n||!t)t+="return "+(n||'""')+";\n"}else e+=", buffer = "+(i?"":this.initializeBuffer()),n?t+="return buffer + "+n+";\n":t+="return buffer;\n";return e&&(t="var "+e.substring(2)+(i?"":";\n  ")+t),t},blockValue:function(e){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=[this.contextName(0)];this.setupParams(e,0,t);var n=this.popStack();t.splice(1,0,n),this.push("blockHelperMissing.call("+t.join(", ")+")")},ambiguousBlockValue:function(){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=[this.contextName(0)];this.setupParams("",0,e,!0),this.flushInline();var t=this.topStack();e.splice(1,0,t),this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.pendingContent=e},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if ("+e+" != null) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,n){var r=0,i=e.length;!n&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(e[r++])):this.pushContext();for(;r<i;r++)this.replaceStack(function(n){var i=this.nameLookup(n,e[r],"context");return t?" && "+i:" != null ? "+i+" : "+n})},lookupData:function(e,t){e?this.pushStackLiteral("this.data(data, "+e+")"):this.pushStackLiteral("data");var n=t.length;for(var r=0;r<n;r++)this.replaceStack(function(e){return" && "+this.nameLookup(e,t[r],"data")})},resolvePossibleLambda:function(){this.aliases.lambda="this.lambda",this.push("lambda("+this.popStack()+", "+this.contextName(0)+")")},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),t!=="sexpr"&&(typeof e=="string"?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(){this.pushStackLiteral("{}"),this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push("{"+e.ids.join(",")+"}"),this.stringParams&&(this.push("{"+e.contexts.join(",")+"}"),this.push("{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t,n){this.aliases.helperMissing="helpers.helperMissing";var r=this.popStack(),i=this.setupHelper(e,t),s=(n?i.name+" || ":"")+r+" || helperMissing";this.push("(("+s+").call("+i.callParams+"))")},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.aliases.functionType='"function"',this.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var n=this.popStack();this.emptyHash();var r=this.setupHelper(0,e,t),i=this.lastHelper=this.nameLookup("helpers",e,"helper");this.push("((helper = (helper = "+i+" || "+n+") != null ? helper : helperMissing"+(r.paramsInit?"),("+r.paramsInit:"")+"),"+"(typeof helper === functionType ? helper.call("+r.callParams+") : helper))")},invokePartial:function(e,t){var n=[this.nameLookup("partials",e,"partial"),"'"+t+"'","'"+e+"'",this.popStack(),this.popStack(),"helpers","partials"];this.options.data?n.push("data"):this.options.compat&&n.push("undefined"),this.options.compat&&n.push("depths"),this.push("this.invokePartial("+n.join(", ")+")")},assignToHash:function(e){var t=this.popStack(),n,r,i;this.trackIds&&(i=this.popStack()),this.stringParams&&(r=this.popStack(),n=this.popStack());var s=this.hash;n&&s.contexts.push("'"+e+"': "+n),r&&s.types.push("'"+e+"': "+r),i&&s.ids.push("'"+e+"': "+i),s.values.push("'"+e+"': ("+t+")")},pushId:function(e,t){e==="ID"||e==="DATA"?this.pushString(t):e==="sexpr"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:u,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler;var u=this.matchExistingProgram(r);u==null?(this.context.programs.push(""),u=this.context.programs.length,r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context,!this.precompile),this.context.environments[u]=r,this.useDepths=this.useDepths||i.useDepths):(r.index=u,r.name="program"+u)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){var t=this.environment.children[e],n=t.depths.list,r=this.useDepths,i,s=[t.index,"data"];return r&&s.push("depths"),"this.program("+s.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new o(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t="",n=this.isInline(),r,i,u;if(!this.isInline())throw new s("replaceStack on non-inline");var a=this.popStack(!0);if(a instanceof o)t=r=a.value,u=!0;else{i=!this.stackSlot;var f=i?this.incrStack():this.topStackName();t="("+this.push(f)+" = "+a+")",r=this.topStack()}var l=e.call(this,r);u||this.popStack(),i&&this.stackSlot--,this.push("("+t+l+")")},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];r instanceof o?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof o)return n.value;if(!t){if(!this.stackSlot)throw new s("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof o?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(this.quotedString(n)+":"+e[n]);return"{"+t.join(",")+"}"},setupHelper:function(e,t,n){var r=[],i=this.setupParams(t,e,r,n),s=this.nameLookup("helpers",t,"helper");return{params:r,paramsInit:i,name:s,callParams:[this.contextName(0)].concat(r).join(", ")}},setupOptions:function(e,t,n){var r={},i=[],s=[],o=[],u,a,f;r.name=this.quotedString(e),r.hash=this.popStack(),this.trackIds&&(r.hashIds=this.popStack()),this.stringParams&&(r.hashTypes=this.popStack(),r.hashContexts=this.popStack()),a=this.popStack(),f=this.popStack();if(f||a)f||(f="this.noop"),a||(a="this.noop"),r.fn=f,r.inverse=a;var l=t;while(l--)u=this.popStack(),n[l]=u,this.trackIds&&(o[l]=this.popStack()),this.stringParams&&(s[l]=this.popStack(),i[l]=this.popStack());return this.trackIds&&(r.ids="["+o.join(",")+"]"),this.stringParams&&(r.types="["+s.join(",")+"]",r.contexts="["+i.join(",")+"]"),this.options.data&&(r.data="data"),r},setupParams:function(e,t,n,r){var i=this.objectLiteral(this.setupOptions(e,t,n));return r?(this.useRegister("options"),n.push("options"),"options="+i):(n.push(i),"")}};var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),f=u.RESERVED_WORDS={};for(var l=0,c=a.length;l<c;l++)f[a[l]]=!0;return u.isValidJavaScriptVariableName=function(e){return!u.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},n=u,n}(r,n),h=function(e,t,n,r,i){"use strict";var s,o=e,u=t,a=n.parser,f=n.parse,l=r.Compiler,c=r.compile,h=r.precompile,p=i,d=o.create,v=function(){var e=d();return e.compile=function(t,n){return c(t,n,e)},e.precompile=function(t,n){return h(t,n,e)},e.AST=u,e.Compiler=l,e.JavaScriptCompiler=p,e.Parser=a,e.parse=f,e};return o=v(),o.create=v,o["default"]=o,s=o,s}(s,o,f,l,c);return h}),define("DQX/Utils",["require","jquery","DQX/Msg","DQX/DocEl","handlebars"],function(e,t,n,r,i){function s(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;return n==r&&(r=t.clientWidth),document.body.removeChild(t),n-r}return DQX={},DQX.Scheduler=function(){var e={};return e.scheduledFunctions=[],e.completedTokens={},e.add=function(t,n){e.scheduledFunctions.push({requiredList:t,func:n})},e.setCompleted=function(t){e.completedTokens[t]=!0},e.setOnFullyCompleted=function(t){e._onFullyCompleted=t},e._tryNext=function(){var n=null,r=!0;t.each(e.scheduledFunctions,function(i,s){if(!s.started){r=!1;var o=!0;t.each(s.requiredList,function(t,n){e.completedTokens[n]||(o=!1)}),o&&(n=s)}}),n&&(n.started=!0,n.func()),r?e._onFullyCompleted&&e._onFullyCompleted():setTimeout(e._tryNext,50)},e.execute=function(){e._tryNext()},e},DQX.getRGB=function(e,t,n,r){return e!=null&&n==null&&(r=t,n=e&255,t=e>>8&255,e=e>>16&255),e=Math.round(e),t=Math.round(t),n=Math.round(n),r==null?"rgb("+e+","+t+","+n+")":"rgba("+e+","+t+","+n+","+r+")"},DQX.roundedRect=function(e,t,n,r,i,s){e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+r-s,n),e.quadraticCurveTo(t+r,n,t+r,n+s),e.lineTo(t+r,n+i-s),e.quadraticCurveTo(t+r,n+i,t+r-s,n+i),e.lineTo(t+s,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+s,n),e.closePath()},DQX.polyStar=function(e,t,n,r,i,s,o){e.beginPath(),s==null&&(s=0),s=1-s,o==null?o=0:o/=180/Math.PI;var u=Math.PI/i;e.moveTo(t+Math.cos(o)*r,n+Math.sin(o)*r);for(var a=0;a<i;a++)o+=u,s!=1&&e.lineTo(t+Math.cos(o)*r*s,n+Math.sin(o)*r*s),o+=u,e.lineTo(t+Math.cos(o)*r,n+Math.sin(o)*r);e.closePath()},DQX.debounce=function(e,t){var n=null;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(r,i)},t)}},DQX.BMP=function(t){return e.toUrl("./Bitmaps/"+t)},DQX._globalUniqueID=0,DQX.getNextUniqueID=function(){return DQX._globalUniqueID++,"UID"+DQX._globalUniqueID},DQX.reportError=function(e){alert("ERROR: "+DQX.interpolate(e));if(_debug_)debugger;throw e},DQX.ByProperty=function(e){return function(t,n){return typeof t[e]=="number"?t[e]-n[e]:t[e]<n[e]?-1:t[e]>n[e]?1:0}},DQX.ByPropertyReverse=function(e){return function(t,n){return typeof n[e]=="number"?n[e]-t[e]:n[e]<t[e]?-1:n[e]>t[e]?1:0}},DQX.highlightText=function(e,t){function n(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}return e.replace(new RegExp("("+n(t)+")","gi"),'<span class="DQXHighlight">$1</span>')},DQX.pluralise=function(e,t){return t!=1?e+"s":e},DQX.truncateString=function(e,t,n){if(e.length<=t)return e;n=n||"...";var r=n.length,i=t-r,s=Math.ceil(i/2),o=Math.floor(i/2);return e.substr(0,s)+n+e.substr(e.length-o)},DQX.isStandaloneApp=function(){return"navigator"in window&&"standalone"in window.navigator?window.navigator.standalone:!1},DQX.getUrlSearchString=function(e){var t=window.location.search.substring(1).split("&");for(var n=0;n<t.length;n++)if(t[n]){var r=t[n].split("=");if(r[0]==e)return r[1]}return null},DQX.serverDataStore=function(e,n,r){t.ajax({url:e+"?datatype=storedata",type:"post",data:n,success:function(e){var t=DQX.parseResponse(e);if("Error"in t){DQX.reportError("Failed to store server data: "+t.Error);return}var n=t.id;r&&r(n)},error:function(e){DQX.reportError("Failed to store server data")}})},DQX.serverDataStoreLong=function(e,n,r){t.ajax({url:e+"?datatype=storedatalong",type:"post",data:n,success:function(e){var t=DQX.parseResponse(e);if("Error"in t){DQX.reportError("Failed to store server data: "+t.Error);return}var n=t.id;r&&r(n)},error:function(e){DQX.reportError("Failed to store server data")}})},DQX.serverDataFetch=function(e,n,r){t.ajax({url:e+"?datatype=fetchstoredata&id="+n,success:function(e){var t=DQX.parseResponse(e);if("Error"in t){DQX.reportError("Failed to fetch server data: "+t.Error);return}var n=t.content;r&&r(n)},error:function(e){DQX.reportError("Failed to fetch server data")}})},DQX.customRequest=function(e,n,r,i,s){var o=e+"?datatype=custom&respmodule="+n+"&respid="+r;t.each(i,function(e,t){o+="&"+e+"="+t}),t.ajax({url:o,success:function(e){var t=DQX.parseResponse(e);typeof t!="object"&&(e.indexOf("Authentication")>0&&DQX.reportError("Client is not authenticated"),DQX.reportError("Invalid server response type"));if("Error"in t)if(t.Error=="NotAuthenticated"){if(confirm("The application is currently not authenticated.\nDo you want to reload now?")){location.reload();return}alert("Application has been stopped")}else alert("Error: "+t.Error);s&&s(t)},error:function(e){DQX.reportError("Failed to launch request {module} {id}:\n{rsp}".DQXformat({module:n,id:r,rsp:JSON.stringify(e)}))}})},DQX.timeoutRetry=3e4,DQX.timeoutAjax=12e4,DQX.DrawUtil={},DQX.TextOrig=function(e){var n=t("#Snippets").children("#"+e);return n.length==0&&DQX.reportError("Invalid snippet ID "+e),n.html()},DQX.Text=function(e){return DQX.interpolate(DQX.TextOrig(e))},DQX.hasMember=function(e,t){return typeof e!="object"?!1:t in e},DQX.requireMember=function(e,t){typeof e!="object"&&DQX.reportError("variable cannot have a member because it is not an object"),t in e||DQX.reportError('Object should have member "{memb}"'.DQXformat({memb:t}))},DQX.requireMemberFunction=function(e,t){DQX.requireMember(e,t),DQX.checkIsFunction(e[t])},DQX.checkIsString=function(e){typeof e!="string"&&DQX.reportError("Expected string value")},DQX.checkIsBoolean=function(e){typeof e!="boolean"&&DQX.reportError("Expected boolean value")},DQX.checkIsNumber=function(e){typeof e!="number"&&DQX.reportError("Expected number value")},DQX.checkIsFunction=function(e){typeof e!="function"&&DQX.reportError("Expected function")},String.prototype.DQXformat=function(e){var t=this;for(var n in e)t=t.replace("{"+n+"}",e[n]);return t},DQX.assertPresence=function(e,t){t in e||DQX.reportError("Expected member '"+t+"'")},DQX.ranseed=0,DQX.random=function(){return DQX.ranseed=(DQX.ranseed*9301+49297)%233280,DQX.ranseed/233280},DQX.Timer=function(){var e={},t=new Date;return e.ticks0=t.getTime(),e.Elapsed=function(){var t=new Date;return(t.getTime()-e.ticks0)/1e3},e},DQX.parseResponse=function(e){return lst=e,lst},DQX._activityList=[],DQX._updateActivityStatus=function(){if(DQX._activityList.length>0){if(t("#DQXActivityBox").length==0){var n=e("DQX/DocEl"),r=n.Div({id:"DQXActivityBox"});r.addStyle("position","absolute"),r.addStyle("left","0px"),r.addStyle("top","0px"),r.addStyle("background-color","rgb(255,128,128)"),t("#DQXUtilContainer").append(r.toString())}var i=[];t.each(DQX._activityList,function(e,t){i+=t+"<br>"}),t("#DQXActivityBox").html(i)}else t("#DQXActivityBox").remove()},DQX.pushActivity=function(e){DQX._activityList.push(e),DQX._updateActivityStatus()},DQX.popActivity=function(){DQX._activityList.pop(),DQX._updateActivityStatus()},DQX.executeActivity=function(e,t){DQX.pushActivity(e),t(),DQX.popActivity()},DQX._processingRequestCount=0,DQX.setProcessing=function(n){if(DQX._processingRequestCount==0){var r=e("DQX/DocEl"),i=r.Div({id:"InfoBoxProcessing"});i.addStyle("position","absolute"),i.addStyle("left","0px"),i.addStyle("top","0px"),i.addStyle("width","100%"),i.addStyle("height","100%"),i.addStyle("cursor","wait"),i.addStyle("z-index","9999");var s=r.Div({id:"Box",parent:i});s.addStyle("position","fixed"),s.addStyle("top","50%"),s.addStyle("left","50%"),s.addStyle("margin-top","-30px"),s.addStyle("margin-left","-30px"),s.addElem('<img src="Bitmaps/ProgressAnimation3.gif" alt="Progress animation" />'),t("#DQXUtilContainer").append(i.toString())}DQX._processingRequestCount++},DQX.executeProcessing=function(e){DQX.setProcessing(),setTimeout(function(){e(),DQX.stopProcessing()},20)},DQX.stopProcessing=function(){DQX._processingRequestCount==1&&t("#InfoBoxProcessing").remove(),DQX._processingRequestCount--,DQX._processingRequestCount<0&&(DQX._processingRequestCount=0)},DQX.createFailFunction=function(e){return function(){DQX.stopProcessing(),alert(e)}},DQX.createMessageFailFunction=function(){return function(e){DQX.stopProcessing(),alert(e)}},DQX.Url=function(e){var n={};return n.name=e,n.queryitems=[],n.addUrlQueryItem=function(e,t){this.queryitems.push({name:e,content:t})},n.delUrlQueryItem=function(e){t.each(n.queryitems,function(t,r){r.name==e&&n.queryitems.splice(t,1)})},n.toString=function(){var e=this.name;if(this.queryitems.length>0){e+="?";for(var t in this.queryitems)t>0&&(e+="&"),e+=this.queryitems[t].name+"="+this.queryitems[t].content}return e},n},DQX.colourFromString=function(e){var n=e.match(/\((.*?)\)/),r;return n?r=n[1].split(","):(r=[.5,.5,.5],DQX.reportError("Badly formatted colour:"+e)),r=t.map(r,function(e){return parseFloat(e)}),console.log(r),r.length==3?DQX.Color(r[0]/255,r[1]/255,r[2]/255):r.length==4?DQX.Color(r[0]/255,r[1]/255,r[2]/255,r[3]/255):(DQX.reportError("Badly formatted colour:"+e),DQX.Color(.5,.5,.5))},DQX.Color=function(e,t,n,r){var i={};return i.r=typeof e=="undefined"?0:e,i.g=typeof t=="undefined"?0:t,i.b=typeof n=="undefined"?0:n,i.a=typeof r=="undefined"?1:r,i.f=1,i.getR=function(){return this.r/this.f},i.getG=function(){return this.g/this.f},i.getB=function(){return this.b/this.f},i.getA=function(){return this.a/this.f},i.toString=function(){return this.a>.999?"rgb("+Math.round(this.getR()*255)+","+Math.round(this.getG()*255)+","+Math.round(this.getB()*255)+")":"rgb("+this.getR().toFixed(3)+","+this.getG().toFixed(3)+","+this.getB().toFixed(3)+","+this.getA().toFixed(3)+")"},i.toStringCanvas=function(){return this.a>.999?"rgb("+Math.round(this.getR()*255)+","+Math.round(this.getG()*255)+","+Math.round(this.getB()*255)+")":"rgba("+Math.round(this.getR()*255)+","+Math.round(this.getG()*255)+","+Math.round(this.getB()*255)+","+this.getA().toFixed(3)+")"},i.toStringHEX=function(){return Math.round(this.getR()*255).toString(16)+Math.round(this.getG()*255).toString(16)+Math.round(this.getB()*255).toString(16)},i.isBlack=function(){return i.r<1e-9&&i.g<1e-9&&i.b<1e-9},i.darken=function(e){var t=1-e;return DQX.Color(t*this.r,t*this.g,t*this.b,this.a)},i.lighten=function(e){var t=e;return DQX.Color((1-t)*this.r+t,(1-t)*this.g+t,(1-t)*this.b+t,this.a)},i.changeOpacity=function(e){return DQX.Color(this.getR(),this.getG(),this.getB(),e)},i},DQX.HSL2Color=function(e,t,n){var r,i,s;if(t==0)r=i=s=n;else{function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var u=n<.5?n*(1+t):n+t-n*t,a=2*n-u;r=o(a,u,e+1/3),i=o(a,u,e),s=o(a,u,e-1/3)}return DQX.Color(r,i,s)},DQX.parseColorString=function(e,t){try{var n=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return n&&n.length>=2&&n[1].length>0&&n[2].length>0&&n[3].length>0?DQX.Color(parseFloat(n[1])/255,parseFloat(n[2])/255,parseFloat(n[3])/255):typeof t!="undefined"?t:DQX.Color(0,0,0)}catch(r){DQX.reportError("Invalid color string: "+e)}},DQX.niceColours=["#204a87","#a40000","#d3d7cf","#5c3566","#ce5c00","#4e9a06","#e9b96e","#c4a000","#729fcf","#2e3436"],DQX.standardColors=[DQX.Color(.2,.2,1),DQX.Color(1,.3,.3),DQX.Color(.2,.6,.7),DQX.Color(.9,.5,0),DQX.Color(0,.8,0),DQX.Color(.8,.2,.8),DQX.Color(0,0,.7),DQX.Color(.7,0,0),DQX.Color(0,.5,0),DQX.Color(.5,0,.5),DQX.Color(.3,.4,.5),DQX.Color(.5,.5,.8),DQX.Color(.8,.5,.5),DQX.Color(.7,.6,.4),DQX.Color(.4,.7,.4),DQX.Color(.3,.3,.5),DQX.Color(.5,.3,.3),DQX.Color(.5,.4,.2),DQX.Color(.2,.4,.2),DQX.Color(.5,.3,.5),DQX.Color(.3,.5,.5),DQX.Color(.6,.6,.7),DQX.Color(.7,.6,.6),DQX.Color(.7,.7,.5),DQX.Color(.7,.5,.7),DQX.Color(.5,.7,.7),DQX.Color(.5,.6,.5),DQX.Color(.6,.6,.6)],DQX.PersistentAssociator=function(e){var n={};return n.itemCount=e,n.associations={},n.map=function(e){var r={};for(var i=0;i<n.itemCount;i++)r[i]=1;t.each(e,function(e,t){e<n.itemCount&&t in n.associations&&delete r[t]});var s=[];for(var i=0;i<n.itemCount;i++)r[i]==1&&s.push(i);var o=0,u={};t.each(e,function(e,t){if(e<n.itemCount){var r=!1;t in n.associations?n.associations[t]in u&&(r=!0):r=!0,r&&(n.associations[t]=s[o],o++),u[n.associations[t]]=1}}),n.mapped=!0},n.getAssociations=function(){return n.associations},n.get=function(e){return e in n.associations?n.associations[e]:-1},n},DQX.scrollHelper=function(e){var n={};if(DQX.scrollBarWidth>2)return n.update=function(){},n;var i="",s=r.Div();s.setCssClass("ScrollUpIndicator"),s.addStyle("position","absolute"),s.addStyle("left","0px"),s.addStyle("top","0px"),s.addStyle("opacity","0.4"),s.addStyle("pointer-events","none"),s.addElem('<img src="'+DQX.BMP("scrollup3.png")+'" />'),i+=s.toString();var o=r.Div();return o.setCssClass("ScrollDownIndicator"),o.addStyle("position","absolute"),o.addStyle("left","0px"),o.addStyle("bottom","1px"),o.addStyle("opacity","0.4"),o.addStyle("pointer-events","none"),o.addElem('<img src="'+DQX.BMP("scrolldown3.png")+'" />'),i+=o.toString(),t(e).parent().append(i),n._adjustScrollFeedback=function(){var n=t(e).scrollTop();n>0?t(e).parent().find(".ScrollUpIndicator").show():t(e).parent().find(".ScrollUpIndicator").hide();var r=t(e)[0].scrollHeight,i=t(e).height();r-n>i?t(e).parent().find(".ScrollDownIndicator").show():t(e).parent().find(".ScrollDownIndicator").hide()},n.update=function(){if(DQX.scrollBarWidth>2)return;n._adjustScrollFeedback();var r=t(e).position(),i=t(e).width(),s=t(e).height();t(e).parent().find(".ScrollUpIndicator").css("top",r.top+"px"),t(e).parent().find(".ScrollDownIndicator").css("top",r.top+s-16+"px"),t(e).parent().find(".ScrollUpIndicator").css("left",r.left+i/2-20+"px"),t(e).parent().find(".ScrollDownIndicator").css("left",r.left+i/2-20+"px")},t(e).scroll(n._adjustScrollFeedback),n.update(),n},DQX.ObjectMapper={},DQX.ObjectMapper.Objects=[],DQX.ObjectMapper._idx=0,DQX.ObjectMapper.Add=function(e){DQX.ObjectMapper.Objects[DQX.ObjectMapper._idx]=e,e._MapIdx=DQX.ObjectMapper._idx,DQX.ObjectMapper._idx++},DQX.ObjectMapper.get=function(e){return DQX.ObjectMapper.Objects[e]},DQX.ObjectMapper.CreateCallBackFunctionString=function(e,t,n){"_MapIdx"in e||DQX.reportError("Object was not added to DQX.ObjectMapper");var r="DQX.ObjectMapper.get("+e._MapIdx+")."+t+"("+n.toString()+")";return r},DQX.augmentTouchEvents=function(e,n,r,i){var s=!1,o=function(e){e.touches||DQX.reportError("No touch event"),e.touches.length<1&&DQX.reportError("Invalid touch event");var r=e.touches[0],i={elemX:r.pageX-t("#"+n).offset().left,elemY:r.pageY-t("#"+n).offset().top,pageX:r.pageX,pageY:r.pageY};return i.x=i.elemX,i.y=i.elemY,i},u=function(t){if(t.touches.length==1){s=!0;var n=o(t);t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),e.handleTouchStart&&e.handleTouchStart(n,t),e.touchPositionMoved=!1,e.touchStartElemX=n.elemX,e.touchStartElemY=n.elemY,e.touchInfoStart=n}},a=function(t){if(t.touches.length==1&&s){var n=o(t);t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),Math.abs(n.elemX-e.touchStartElemX)+Math.abs(n.elemY-e.touchStartElemY)>10&&(e.touchPositionMoved=!0,e.handleTouchMove&&e.handleTouchMove(n,t))}},f=function(t){s&&(s=!1,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),e.handleTouchEnd&&e.handleTouchEnd(t),e.touchPositionMoved||e.handleTouchClick&&e.handleTouchClick(e.touchInfoStart,t))},l=function(t){s&&(s=!1,e.handleTouchEnd&&e.handleTouchEnd())},c=function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),e.handleGestureStart&&e.handleGestureStart(t)},h=function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),e.handleGestureChange&&e.handleGestureChange(t)},p=function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),e.handleGestureEnd&&e.handleGestureEnd(t)},d=window.navigator.msPointerEnabled,v=document.getElementById(n);v||DQX.reportError("Invalid element "+n),r&&(v.addEventListener("touchstart",u,!1),v.addEventListener("touchmove",a,!1),v.addEventListener("touchend",f,!1),v.addEventListener("touchcancel",l,!1)),i&&(v.addEventListener("gesturestart",c,!1),v.addEventListener("gesturechange",h,!1),v.addEventListener("gestureend",p,!1))},DQX.mousePosX=0,DQX.mousePosY=0,DQX._mouseEventReceiverList=[],DQX._onError=function(e,n,r){var i={type:"JSException",message:e,source:n,linenr:r,browser:navigator.userAgent};if(_debug_){var s="";t.each(i,function(e,t){s+=e+"= "+t+"\n"}),alert(s)}return!0},DQX.Init=function(){DQX.scrollBarWidth=s(),jQuery.support.cors=!0,t.ajaxSetup({timeout:DQX.timeoutAjax}),t(document).click(DQX._handleMouseClick),t(document).mousedown(DQX._handleMouseDown),t(document).mouseup(DQX._handleMouseUp),t(document).mousemove(DQX._handleMouseMove),t(document).mousemove(function(e){DQX.mousePosX=e.pageX,DQX.mousePosY=e.pageY}),t(document).keydown(DQX._handleKeyDown)},DQX.createHelpLink=function(e,t){var n=r.Span({id:e});return n.setCssClass("DQXHelpLink"),n.addElem(t),n.toString()},DQX._initInterpolation=function(){if(DQX._interpolationInitialised)return;DQX.interpolationStrings={};var e=[];t("#InterpolationSnippets").children("span").each(function(){var n=t(this).attr("id");e.push(n),DQX.interpolationStrings[n]=t(this).html()}),t.each(e,function(e,t){var n=DQX.interpolationStrings[t],r=t.charAt(0).toUpperCase()+t.slice(1),i=t+"s",s=r+"s";DQX.interpolationStrings[r]||(DQX.interpolationStrings[r]=n.charAt(0).toUpperCase()+n.slice(1)),DQX.interpolationStrings[i]||(DQX.interpolationStrings[i]=n+"s");if(!DQX.interpolationStrings[s]){var o=DQX.interpolationStrings[i];DQX.interpolationStrings[s]=o.charAt(0).toUpperCase()+o.slice(1)}}),DQX._interpolationInitialised=!0},DQX.interpolate=function(e){DQX.checkIsString(e),DQX._initInterpolation();for(;!0;){var n=!1,r=e.match(/\[\@.*?\]/g);r&&t.each(r,function(t,r){var i=r.substring(2,r.length-1);DQX.interpolationStrings[i]?(e=e.replace(r,DQX.interpolationStrings[i]),n=!0):_debug_&&DQX.reportError("Interpolation identifier not found: "+i)});if(!n)return e}},DQX.initPostCreate=function(){t(".DQXInclude").each(function(e,n){var r=t(this).html();t("#"+r).length==0&&DQX.reportError("Broken include link "+r),t(this).html(t("#"+r).html())})},DQX._handleHelpLink=function(e){var t=0},DQX._globalKeyDownReceiverStack=[],DQX._globalKeyDownReceiverIndex=0,DQX.registerGlobalKeyDownReceiver=function(e,t){return t||(DQX._globalKeyDownReceiverIndex++,t=DQX._globalKeyDownReceiverIndex),DQX._globalKeyDownReceiverStack.unshift({id:t,handler:e}),t},DQX.unRegisterGlobalKeyDownReceiver=function(e){for(var t=0;t<DQX._globalKeyDownReceiverStack.length;t++)DQX._globalKeyDownReceiverStack[t].id==e&&DQX._globalKeyDownReceiverStack.splice(t,1)},DQX._onHoverKeyReceivers={},DQX._handleKeyDown=function(e){e.keyCode==27&&(e.isEscape=!0);if(DQX._globalKeyDownReceiverStack.length>0){DQX._globalKeyDownReceiverStack[0].handler(e);return}for(var t in DQX._onHoverKeyReceivers)if(DQX._onHoverKeyReceivers[t]&&DQX._onHoverKeyReceivers[t](e))return!1},DQX.setOnHoverKeyDownReceiver=function(e,n){t("#"+e).length==0&&DQX.reportError("Unable to register keydown receiver: DOM element "+e+" not found");var r=e;t("#"+e).mouseover(function(e){DQX._onHoverKeyReceivers[r]=n}),t("#"+e).mouseout(function(e){delete DQX._onHoverKeyReceivers[r]})},DQX.getMouseWheelDelta=function(e){var t=0,n=e;return e.originalEvent&&(n=e.originalEvent),n.wheelDeltaX!==undefined&&n.wheelDelta&&Math.abs(n.wheelDeltaX)>=Math.abs(n.wheelDelta)?0:(n.wheelDelta?t=n.wheelDelta/120:n.detail&&(t=-n.detail/3),t)},DQX.getMouseWheelDeltaX=function(e){var t=e;return e.originalEvent&&(t=e.originalEvent),t.wheelDeltaX!==undefined&&t.wheelDelta&&Math.abs(t.wheelDeltaX)>=Math.abs(t.wheelDelta)?t.wheelDeltaX/120:0},DQX.addMouseEventReceiver=function(e){this._mouseEventReceiverList.push(e)},DQX._registerStaticLinkHandlers=function(){t(".DQXStaticDocLink").each(function(e,r){t(this).click(function(){var e=t(this).attr("href");return n.send({type:"ShowStaticDoc"},e),!1})})},DQX._registerActionLinkHandlers=function(){t(".DQXActionLink").each(function(e,r){t(this).click(function(){var e=t(this).attr("href");return n.send({type:e}),!1})})},DQX._handleMouseClick=function(e){var r=e.target,i=0;while(r&&i<=1){if(r.className&&typeof r.className=="string"&&r.className.slice(0,11)=="DQXHelpLink"){var s=t(r).attr("href");return n.send({type:"ShowHelp"},s),e.preventDefault(),!1}r=r.parentElement,i++}},DQX._handleMouseDown=function(e){},DQX._handleMouseUp=function(e){for(var t in DQX._mouseEventReceiverList)DQX._mouseEventReceiverList[t]._mousedown&&(DQX._mouseEventReceiverList[t]._onMouseUp(e),DQX._mouseEventReceiverList[t]._mousedown=!1)},DQX._findMouseEventReceiver=function(e){for(var t in DQX._mouseEventReceiverList)if(DQX._mouseEventReceiverList[t].myCanvasID==e)return DQX._mouseEventReceiverList[t];return null},DQX._lastMouseHoverTarget=null,DQX._handleMouseMove=function(e){for(var t in DQX._mouseEventReceiverList)if(DQX._mouseEventReceiverList[t]._mousedown){DQX._mouseEventReceiverList[t]._onMouseMove(e);return}var n=DQX._findMouseEventReceiver(e.target.id);n!=null?(n._onMouseHover(e),DQX._lastMouseHoverTarget=n):(DQX._lastMouseHoverTarget!=null&&DQX._lastMouseHoverTarget.onLeaveMouse(e),DQX._lastMouseHoverTarget=null)},DQX.canvasBackingScale=function(){return"devicePixelRatio"in window&&window.devicePixelRatio>1?window.devicePixelRatio:1},DQX.CanvasElement=function(e){var n={};return n.myCanvasID=e,n.getMyCanvasElement=function(){return t("#"+e+"")[0]},n.registerHandlers=function(e){DQX.addMouseEventReceiver(this),t(e).mousedown(t.proxy(this._handleOnMouseDown,this))},n._handleOnMouseDown=function(e){return this._mousedown=!0,this._onMouseDown(e),e.returnValue=!1,!1},n.getEventPosX=function(e){return e.pageX-t(this.getMyCanvasElement()).offset().left},n.getEventPosY=function(e){return e.pageY-t(this.getMyCanvasElement()).offset().top},n._onMouseHover=function(e){},n.onLeaveMouse=function(e){},n._onMouseDown=function(e){},n._onMouseUp=function(e){},n._onMouseMove=function(e){},n},DQX.DrawUtil.getScaleJump=function(e){var t=[{Jump1:1,JumpReduc:5},{Jump1:2,JumpReduc:5},{Jump1:5,JumpReduc:4}],n=1e99,r;for(JumpPrototypeNr in t){q=Math.floor(Math.log(e/t[JumpPrototypeNr].Jump1)/Math.log(10));var i=Math.pow(10,q)*t[JumpPrototypeNr].Jump1,s=Math.pow(10,q+1)*t[JumpPrototypeNr].Jump1;Math.abs(i-e)<n&&(n=Math.abs(i-e),r={Jump1:i,JumpReduc:t[JumpPrototypeNr].JumpReduc}),Math.abs(s-e)<n&&(n=Math.abs(s-e),r={Jump1:s,JumpReduc:t[JumpPrototypeNr].JumpReduc})}if(!r)return-1;var o=-(Math.log(r.Jump1*r.JumpReduc)/Math.log(10));return r.textDecimalCount=Math.max(0,Math.ceil(o)),r.value2String=function(e){return Math.abs(e)>=1e5?e.toExponential():e.toFixed(this.textDecimalCount)},r},DQX.getWindowClientW=function(){var e=window.innerWidth;return e||(e=document.body.clientWidth),e},DQX.getWindowClientH=function(){var e=window.innerHeight;return e||(e=document.body.clientHeight),e},DQX.CreateKeyValueTable=function(e){var t="<table>";for(key in e)t+="<tr>",t+="<td><b>"+key+"</b></td>",t+='<td style="padding-left:5px;max-width:300px;word-wrap:break-word;">'+e[key]+"</td>",t+="</tr>";return t+="</table>",t},DQX.identity=function(e){return e},DQX.return_arg=function(e){return function(){return arguments[e]}},DQX.functor=function(e){return typeof e=="function"?e:function(){return e}},DQX.chain=function(){var e=arguments;return function(t){var n=t;for(var r=0;r<e.length;r++)n=e[r](n);return n}},DQX.attr=function(e){return function(t){return t[e]}},DQX.comp_attr=function(e,t){return function(n,r){return t(n[e],r[e])}},DQX.attrMap=function(e,t){var n={};return e.forEach(function(e){n[e[t]]=e}),n},DQX.ratelimit=function(e,t){var n=(new Date).getTime(),r=null;return function(i){var s=(new Date).getTime();s-n>t?(n=s,clearTimeout(r),e(i)):(clearTimeout(r),r=setTimeout(function(){e(i)},t+t*.15))}},DQX.canvas_smoothing=function(e,t){e.webkitImageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.imageSmoothingEnabled=t},DQX.canvas_smooth_scaling_only=function(){if(DQX._canvas_smooth_scaling_only==undefined){var e=document.createElement("canvas");e.width=2,e.height=1;var t=e.getContext("2d"),n=t.createImageData(e.width,e.height),r=n.data;[255,255,255,255,0,0,0,255].forEach(function(e,t){r[t]=e}),t.putImageData(n,0,0);var i=document.createElement("canvas");i.width=3,i.height=1,t=i.getContext("2d"),t.setTransform(i.width/e.width,0,0,1,0,0),DQX.canvas_smoothing(t,!1),t.drawImage(e,0,0),r=t.getImageData(0,0,i.width,i.height).data;var s=r[5]+r[6]+r[7];DQX._canvas_smooth_scaling_only=s!=255*3&&s!=0}return DQX._canvas_smooth_scaling_only},DQX.vendorPropName=function(e,n){n=t.camelCase(n);var r=["Webkit","O","Moz","ms"];if(n in e)return n.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()});var i=n.charAt(0).toUpperCase()+n.slice(1),s=n,o=r.length;while(o--){n=r[o]+i;if(n in e){var u=n.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()});return r[o]=="ms"?"-"+u:u}}return s.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},DQX.vendor_name=function(e,t){DQX.vendor_name_cache=DQX.vendor_name_cache||{};if(e+t in DQX.vendor_name_cache)return DQX.vendor_name_cache[e+t];var n=document.createElement(e);return DQX.vendor_name_cache[e+t]=DQX.vendorPropName(n.style,t)},DQX.JD2DateTime=function(e){return new Date((e-2440587.5)*24*60*60*1e3)},DQX.DateTime2JD=function(e){return e.getTime()/864e5+2440587.5},i.fields_used=function(e,n){var r=i.create();r.registerHelper("if",function(e,t){e&&e(),t.fn(this),t.inverse(this)}),r.registerHelper("with",function(e,t){e&&e()}),r.registerHelper("each",function(e,t){e&&e()}),r.registerHelper("map",function(e,t,n,r){e()});var s=r.compile(e),o={},u=[];return t.each(n,function(e,t){o[t]=function(){u.push(t)}}),s(o),_.unique(u)},DQX}),define("DQX/Scroller",["jquery","DQX/DocEl","DQX/Msg"],function(e,t,n){var r={};return r.HScrollBar=function(t){var n=DQX.CanvasElement(t);return n.myID=t,n.sizeX=n.getMyCanvasElement().width,n.sizeY=n.getMyCanvasElement().height,n.rangeMin=0,n.rangeMax=1,n.scrollPos=0,n.ScrollSize=.05,n.minScrollSize=5e-4,n.units="",n.myConsumer=null,n.drawIndicators=!0,this._scaleDistance=null,n.zoomareafraction=.3,n.zoomLogFactor=1e3,n.zoomDragging=!1,n.scrollerDragging=!1,n.registerHandlers(n.getMyCanvasElement()),DQX.augmentTouchEvents(n,n.myCanvasID,!0,!1),n.setMinScrollSize=function(e){this.minScrollSize=e,n.zoomLogFactor=10/Math.max(1e-9,e)},n.setUnits=function(e){this.units=e},n.setScaleDistance=function(e){this._scaleDistance=e},n.setValue=function(e,t){this.scrollPos=e,t!=null&&(this.ScrollSize=t),this.draw()},n.setRange=function(e,t){this.rangeMin=e,this.rangeMax=t,this.draw()},n.getZoomFrac=function(){var e=(Math.min(this.minScrollSize/this.ScrollSize)-this.minScrollSize)/(1-this.minScrollSize);return Math.log(1+n.zoomLogFactor*e)/Math.log(1+n.zoomLogFactor)},n.canScrollRight=function(){return this.scrollPos+this.ScrollSize<1},n.resize=function(t){this.sizeX=t,e("#"+this.myID).width(t),this.getMyCanvasElement().width=t,this.draw()},n._drawTriangle=function(e,t,n){var r=Math.round(this.sizeY/2),i=Math.round(this.sizeY/4);e.beginPath(),e.moveTo(t,r-i),e.lineTo(t+n*i,r),e.lineTo(t,r+i),e.closePath(),e.fill()},n.draw=function(){var e=7,t=this.getMyCanvasElement(),r=t.getContext("2d"),i=r.createLinearGradient(0,0,0,this.sizeY);i.addColorStop(0,"rgb(230,230,230)"),i.addColorStop(.4,"rgb(255,255,255)"),i.addColorStop(1,"rgb(220,220,220)");var s=r.createLinearGradient(0,0,0,this.sizeY);s.addColorStop(0,"rgb(200,200,200)"),s.addColorStop(.4,"rgb(250,250,250)"),s.addColorStop(1,"rgb(170,170,170)"),r.fillStyle=i,r.fillRect(0,0,this.sizeX,this.sizeY),this.ScrollAreaStartX=Math.round(this.sizeX*this.zoomareafraction)+e,this.ScrollAreaSizeX=this.sizeX-this.ScrollAreaStartX-e,this.ZoomAreaStartX=e,this.ZoomAreaSizeX=this.ScrollAreaStartX-this.ZoomAreaStartX-e;var o=this.ZoomAreaStartX,u=this.ZoomAreaStartX+Math.round(this.getZoomFrac()*this.ZoomAreaSizeX);u=Math.min(u,this.ZoomAreaStartX+this.ZoomAreaSizeX),r.globalAlpha=.55;var a=r.createLinearGradient(0,5,0,this.sizeY-5);a.addColorStop(0,"rgb(0,130,142)"),a.addColorStop(.3,"rgb(101,218,229)"),a.addColorStop(1,"rgb(0,130,152)"),r.fillStyle=a,r.fillRect(o,4,u-o,this.sizeY-8),r.fillStyle="rgb(71,168,177)",this._drawTriangle(r,u+3,1),r.fillStyle="rgb(54,132,139)",this._drawTriangle(r,u-3,-1);var f="Zoom: "+(1/n.ScrollSize).toFixed(n.ScrollSize>.1?1:0)+"x";r.globalAlpha=1,r.fillStyle="black",r.font="13px sans-serif",r.textBaseline="middle",r.shadowColor="white",r.shadowBlur=3,u+15+r.measureText(f).width<this.ZoomAreaStartX+this.ZoomAreaSizeX?(r.textAlign="left",r.fillText(f,u+15,this.sizeY/2)):(r.textAlign="right",r.fillText(f,u-15,this.sizeY/2)),r.shadowColor="transparent";var o=this.ScrollAreaStartX+Math.round(this.scrollPos*this.ScrollAreaSizeX),u=this.ScrollAreaStartX+Math.round((this.scrollPos+this.ScrollSize)*this.ScrollAreaSizeX);o<this.ScrollAreaStartX&&(o=this.ScrollAreaStartX),u>this.ScrollAreaStartX+this.ScrollAreaSizeX&&(u=this.ScrollAreaStartX+this.ScrollAreaSizeX);if(u<=o+3){var l=(o+u)/2;o=l-1.5,u=l+1.5}if(n.drawIndicators){r.globalAlpha=1,r.fillStyle="black",r.font="11px sans-serif",r.textBaseline="top",r.textAlign="center",r.shadowColor="white",r.shadowBlur=3;if(!this._scaleDistance)var c=DQX.DrawUtil.getScaleJump(20/this.sizeX*(this.rangeMax-this.rangeMin)),h=c.Jump1*c.JumpReduc,p=c.textDecimalCount;else var h=this._scaleDistance,p=Math.max(0,-Math.floor(Math.log(h)/Math.log(10)));var d=(this.rangeMax-this.rangeMin)/h;for(var v=0;v<d;v++){var m=v*h,g=this.ScrollAreaStartX+Math.round((m-this.rangeMin)/(this.rangeMax-this.rangeMin)*this.ScrollAreaSizeX);g>this.ScrollAreaStartX+10&&g<this.ScrollAreaStartX+this.ScrollAreaSizeX-10&&r.fillText(m.toFixed(p)+n.units,g,this.sizeY/2-7)}r.shadowColor="transparent"}var a=r.createLinearGradient(o,0,u,0);a.addColorStop(0,"rgba(20,142,162,0.7)"),a.addColorStop(.25,"rgba(106,201,210,0.3)"),a.addColorStop(.75,"rgba(106,201,210,0.3)"),a.addColorStop(1,"rgba(20,142,162,0.7)"),r.fillStyle=a,r.fillRect(o,2,u-o,this.sizeY-4),r.globalAlpha=.7,r.fillStyle="rgb(0,150,164)",this._drawTriangle(r,u+3,1),this._drawTriangle(r,o-3,-1),r.globalAlpha=1,r.fillStyle=s,r.fillRect(0,0,e,this.sizeY),r.fillRect(this.ScrollAreaStartX-e,0,e,this.sizeY),r.fillRect(this.ScrollAreaStartX+this.ScrollAreaSizeX,0,e,this.sizeY)},n._onMouseDown=function(e){var t=this.getEventPosX(e);this.scrollerDragging=!1,this.zoomDragging=!1;if(t>=this.ScrollAreaStartX&&t<=this.ScrollAreaStartX+this.ScrollAreaSizeX){this.scrollerDragging=!0;var n=this.ScrollAreaStartX+Math.round(this.scrollPos*this.ScrollAreaSizeX);this.dragxoffset=t-n}t>=this.ZoomAreaStartX&&t<=this.ZoomAreaStartX+this.ZoomAreaSizeX&&(this.zoomDragging=!0,this.dragstartx=t,this.dragstartzoompos=this.ZoomAreaStartX+Math.round(this.getZoomFrac()*this.ZoomAreaSizeX))},n._onMouseMove=function(e){var t=this.getEventPosX(e);if(this.scrollerDragging){var r=t-this.dragxoffset;this.scrollPos=(r-this.ScrollAreaStartX)*1/this.ScrollAreaSizeX,this.scrollPos<0&&(this.scrollPos=0),this.scrollPos+this.ScrollSize>1&&(this.scrollPos=1-this.ScrollSize),this.draw(),"myConsumer"in this&&this.myConsumer!=null&&this.myConsumer.scrollTo(this.scrollPos)}if(this.zoomDragging){var i=t-this.dragstartx+this.dragstartzoompos,s=(i-this.ZoomAreaStartX)/this.ZoomAreaSizeX;s=Math.max(0,s),s=Math.min(1,s),s=(Math.exp(s*Math.log(1+n.zoomLogFactor))-1)/n.zoomLogFactor;var o=this.minScrollSize/(s*(1-this.minScrollSize)+this.minScrollSize);o=Math.min(1,o),o=Math.max(this.minScrollSize,o),this.scrollPos=this.scrollPos+this.ScrollSize/2-o/2,this.ScrollSize=o,this.scrollPos+this.ScrollSize>1&&(this.scrollPos=1-this.ScrollSize),this.scrollPos<0&&(this.scrollPos=0),this.draw(),this.myConsumer&&this.myConsumer.zoomScrollTo(this.scrollPos,this.ScrollSize)}},n._onMouseUp=function(e){"scrollFinished"in this.myConsumer&&this.myConsumer.scrollFinished()},n._onMouseHover=function(t){var n=this.getEventPosX(t),r=!1;n>=this.ScrollAreaStartX&&n<=this.ScrollAreaStartX+this.ScrollAreaSizeX&&(r=!0),n>=this.ZoomAreaStartX&&n<=this.ZoomAreaStartX+this.ZoomAreaSizeX&&(r=!0),e("#"+this.myCanvasID).css("cursor",r?"col-resize":"auto")},n.handleTouchStart=function(e,t){t.pageX=e.pageX,t.pageY=e.pageY,this._onMouseDown(t)},n.handleTouchMove=function(e,t){t.pageX=e.pageX,t.pageY=e.pageY,this._onMouseMove(t)},n.handleTouchEnd=function(e){this._onMouseUp(e)},n.handleTouchCancel=function(e){this._onMouseUp(e)},n},r.vScrollWidth=20,r.VScrollBar=function(t){var n=DQX.CanvasElement(t);return n.myID=t,n.sizeX=n.getMyCanvasElement().width,n.sizeY=n.getMyCanvasElement().height,n.rangeMin=0,n.rangeMax=1,n.scrollPos=0,n.ScrollSize=.1,n.minScrollSize=5e-4,n.myConsumer=null,n.scrollerDragging=!1,n.registerHandlers(n.getMyCanvasElement()),n.setValue=function(e,t){this.scrollPos=e,this.ScrollSize=t,this.draw()},n.setRange=function(e,t){this.rangeMin=e,this.rangeMax=t,this.draw()},n.getZoomFrac=function(){var e=(Math.min(this.minScrollSize/this.ScrollSize)-this.minScrollSize)/(1-this.minScrollSize);return Math.log(1+100*e)/Math.log(101)},n.resize=function(t){this.sizeY=t,e("#"+this.myID).height(t),e("#"+this.myID)[0].height=t,this.draw()},n._drawTriangle=function(e,t,n){var r=Math.round(this.sizeY/2),i=Math.round(this.sizeY/4);e.beginPath(),e.moveTo(t,r-i),e.lineTo(t+n*i,r),e.lineTo(t,r+i),e.closePath(),e.fill()},n.draw=function(){var e=15,t=this.getMyCanvasElement().getContext("2d"),n=t.createLinearGradient(0,0,this.sizeX,0);n.addColorStop(0,"rgb(170,170,170)"),n.addColorStop(.35,"rgb(250,250,250)"),n.addColorStop(1,"rgb(130,130,130)");var r=t.createLinearGradient(0,0,this.sizeX,0);r.addColorStop(0,"rgb(140,140,140)"),r.addColorStop(.35,"rgb(230,230,230)"),r.addColorStop(1,"rgb(100,100,100)"),t.fillStyle=n,t.fillRect(0,0,this.sizeX,this.sizeY),this.ScrollAreaStartY=+e,this.ScrollAreaSizeY=this.sizeY-this.ScrollAreaStartY-e;var i=this.ScrollAreaStartY+Math.round(this.scrollPos*this.ScrollAreaSizeY),s=this.ScrollAreaStartY+Math.round((this.scrollPos+this.ScrollSize)*this.ScrollAreaSizeY);i<this.ScrollAreaStartY&&(i=this.ScrollAreaStartY),s>this.ScrollAreaStartY+this.ScrollAreaSizeY&&(s=this.ScrollAreaStartY+this.ScrollAreaSizeY);var o=t.createLinearGradient(0,i,0,s);o.addColorStop(0,"rgba(50,50,240,0.65)"),o.addColorStop(.25,"rgba(160,160,255,0.3)"),o.addColorStop(.75,"rgba(160,160,255,0.3)"),o.addColorStop(1,"rgba(50,50,240,0.65)"),t.fillStyle=o,t.fillRect(2,i,this.sizeX-4,s-i),t.globalAlpha=1,t.fillStyle=r,t.fillRect(0,0,this.sizeX,e),t.fillRect(0,this.ScrollAreaStartY-e,this.sizeX,e),t.fillRect(0,this.ScrollAreaStartY+this.ScrollAreaSizeY,this.sizeX,e)},n._onMouseDown=function(e){var t=this.getEventPosY(e);this.scrollerDragging=!1;if(t>=this.ScrollAreaStartY&&t<=this.ScrollAreaStartY+this.ScrollAreaSizeY){this.scrollerDragging=!0;var n=this.ScrollAreaStartY+Math.round(this.scrollPos*this.ScrollAreaSizeY);this.dragyoffset=t-n}},n._onMouseMove=function(e){var t=this.getEventPosY(e);if(this.scrollerDragging){var n=t-this.dragyoffset;this.scrollPos=(n-this.ScrollAreaStartY)*1/this.ScrollAreaSizeY,this.scrollPos<0&&(this.scrollPos=0),this.scrollPos+this.ScrollSize>1&&(this.scrollPos=1-this.ScrollSize),this.draw(),"myConsumer"in this&&this.myConsumer!=null&&this.myConsumer.scrollTo(this.scrollPos)}},n._onMouseUp=function(e){},n._onMouseHover=function(t){var n=this.getEventPosY(t),r=!1;n>=this.ScrollAreaStartY&&n<=this.ScrollAreaStartY+this.ScrollAreaSizeY&&(r=!0),n>=this.ZoomAreaStartY&&n<=this.ZoomAreaStartY+this.ZoomAreaSizeY&&(r=!0),e("#"+this.myCanvasID).css("cursor",r?"row-resize":"auto")},n.handleTouchStart=function(e,t){},n.handleTouchMove=function(e,t){},n.handleTouchEnd=function(e){},n.handleTouchCancel=function(e){},n},r}),define("DQX/Popup",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/Controls"],function(e,t,n,r,i){var s={};return s.activePopupList=[],s._checkBackgroundBlockNeeded=function(){var t=!1;e("#DQXBackBlocker").find(".DQXFloatBox").each(function(e,n){t=!0}),t||e("#DQXBackBlocker").remove()},t.ClosePopup=function(n){var r=s.activePopupList.indexOf(n);r<0&&_debug_&&t.reportError("Unable to find popup"),s.activePopupList.splice(r,1),e("#"+n).remove(),t.unRegisterGlobalKeyDownReceiver(n),s._checkBackgroundBlockNeeded()},t._popupIndex=0,t.SwitchPinned=function(n){var r=e("#"+n),i=!s.isPinned(n);i&&(e("#"+n).appendTo("#DQXUtilContainer"),s._checkBackgroundBlockNeeded(),r.find(".DQXPinBoxUnpinned").remove(),r.find(".DQXPinBoxPinned").remove(),r.append(s._createPinBox(n,i)),t.unRegisterGlobalKeyDownReceiver(n))},s._floatBoxMaxIndex=99,s.makeDraggable=function(n){var r=e("#"+n);r.length==0&&t.reportError("Draggable container not found");var i=r.find(".DQXDragHeader");i.length==0&&t.reportError("Draggable container has no header element");var o=i.attr("id"),u=0,a=0,f=0,l=0,c=function(e){var n=e.pageX+u,i=e.pageY+a;n=Math.min(n,t.getWindowClientW()-f-10),i=Math.min(i,t.getWindowClientH()-40);var n=Math.max(0,n),i=Math.max(10,i);return r.css({left:n,top:i}),!1},h=function(t){return e(document).unbind("mousemove.drag",c),e(document).unbind("mouseup.drag",h),r.css("opacity",1),!1};i.bind("mousedown.drag",function(t){var n=r.position().left,i=r.position().top,o=t.pageX,p=t.pageY;return u=n-o,a=i-p,f=r.outerWidth(),l=r.outerHeight(),e(document).bind("mousemove.drag",c),e(document).bind("mouseup.drag",h),r.css("opacity",.7),s._floatBoxMaxIndex++,r.css("z-index",s._floatBoxMaxIndex),!1});var p={handleTouchStart:function(e,t){var n=r.position().left,i=r.position().top,o=e.pageX,c=e.pageY;f=r.outerWidth(),l=r.outerHeight(),u=n-o,a=i-c,r.css("opacity",.7),s._floatBoxMaxIndex++,r.css("z-index",s._floatBoxMaxIndex)},handleTouchMove:function(e,t){c(e)},handleTouchEnd:function(){r.css("opacity",1)}};t.augmentTouchEvents(p,o,!0,!1)},s.isPinned=function(t){var n=e("#"+t);return n.find(".DQXPinBoxPinned").length>0},s.closeIfNeeded=function(e){s.isPinned(e)||t.ClosePopup(e)},s.closeUnPinnedPopups=function(){e.each(s.activePopupList,function(e,t){s.closeIfNeeded(t)})},s.pinUnPinnedPopups=function(){e.each(s.activePopupList,function(e,n){s.isPinned(n)||t.SwitchPinned(n)})},s._createPinBox=function(e,r){var i=r?t.BMP("pin3.png"):t.BMP("pin4.png"),s=n.JavaScriptBitmaplink(i,"Keep this info box visible","DQX.SwitchPinned('"+e+"')");return s.setCssClass(r?"DQXPinBoxPinned":"DQXPinBoxUnpinned"),s.addStyle("position","absolute"),s.addStyle("left",r?"0px":"4px"),s.addStyle("top",r?"-11px":"-8px"),s.toString()},s._createBackBlocker=function(){if(e("#DQXBackBlocker").length>0)return;var t=n.Div({id:"DQXBackBlocker"});t.addStyle("position","absolute"),t.addStyle("left","0px"),t.addStyle("top","0px"),t.addStyle("width","100%"),t.addStyle("height","100%");var r="rgba(100,100,100,0.4)";t.addStyle("background-color",r),t.addStyle("z-index","2000"),e("#DQXUtilContainer").append(t.toString()),e("#DQXBackBlocker").mousedown(function(t){t.target.id=="DQXBackBlocker"&&(e("#DQXBackBlocker").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#DQXBackBlocker").css("background-color",r),setTimeout(function(){e("#DQXBackBlocker").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#DQXBackBlocker").css("background-color",r)},150)},150)},150))})},s.create=function(i,o,u,a){var f=!0;a&&"canClose"in a&&(f=a.canClose);var l=!1,c="";e(".DQXFloatBox").each(function(n,r){l||e(this).find(".DQXPinBoxUnpinned").length>0&&(e(this).find(".DQXFloatBoxHeader").html(i),e(this).find(".DQXFloatBoxContent").html(o),t.ExecPostCreateHtml(),l=!0,c=e(this).attr("id"))});if(l)return c;s._createBackBlocker();var h=t.mousePosX+10,p=t.mousePosY+10;t._popupIndex++;var d="DXPopup"+t._popupIndex,v=n.Div({id:d});v.setCssClass("DQXFloatBox"),v.addStyle("position","absolute"),v.addStyle("left","0px"),v.addStyle("top","0px");var m=n.Div({id:d+"Handler",parent:v});m.setCssClass("DQXFloatBoxHeader DQXDragHeader"),m.addElem(t.interpolate(i));var g=n.Div({parent:v});g.setCssClass("DQXFloatBoxContent"),g.addStyle("max-width",t.getWindowClientW()-100+"px"),g.addStyle("max-height",t.getWindowClientH()-100+"px"),g.addStyle("overflow-x","hidden"),g.makeAutoVerticalScroller(),g.addElem(t.interpolate(o));if(f){var y=n.JavaScriptBitmaplink(t.BMP("close2.png"),"Close","DQX.ClosePopup('"+d+"')");v.addElem(y),y.addStyle("position","absolute"),y.addStyle("right","-13px"),y.addStyle("top","-13px")}f&&v.addElem(s._createPinBox(d,!1)),u&&v.addElem('<IMG SRC="{bmp}" border=0 class="DQXBitmapLink Helpbutton" ALT="Help" TITLE="Help" style="opacity:0.70;position:absolute;right:35px;top:0px;">'.DQXformat({bmp:t.BMP("info2.png")}));var o=v.toString();e("#DQXBackBlocker").append(o),s.makeDraggable(d);var b=e("#"+d).width(),w=e("#"+d).height(),E=e(window).width(),S=e(window).height();return e("#"+d).offset({left:(E-b)/2,top:(S-w)/2}),t.ExecPostCreateHtml(),t.registerGlobalKeyDownReceiver(function(e){e.isEscape&&t.ClosePopup(d)},d),u&&e("#"+d).find(".Helpbutton").click(function(){r.send({type:"ShowHelp"},u)}),s.activePopupList.push(d),d},s}),define("DQX/Documentation",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/Popup"],function(e,t,n,r,i){var s={};return s.topicStack=[],s.topicStackPointer=-1,s._onCancel=function(){e("#DocuBoxBackGround").remove(),t.unRegisterGlobalKeyDownReceiver("DocuBox")},closeDocumentation=function(){s._onCancel()},s._onPrevious=function(){s.topicStackPointer>0&&(s.topicStackPointer--,s._displayHelp(s.topicStack[s.topicStackPointer].url,s.topicStack[s.topicStackPointer].scrollPos))},s._onNext=function(){s.topicStackPointer<s.topicStack.length-1&&(s.topicStackPointer++,s._displayHelp(s.topicStack[s.topicStackPointer].url,s.topicStack[s.topicStackPointer].scrollPos))},s._createBox=function(){if(e("#DocuBoxBackGround").length>0)return;s.topicStack=[],s.topicStackPointer=-1;var r=n.Div({id:"DocuBoxBackGround"});r.addStyle("position","absolute"),r.addStyle("left","0px"),r.addStyle("top","0px"),r.addStyle("width","100%"),r.addStyle("height","100%");var o="rgba(100,100,100,0.4)";r.addStyle("background-color",o),r.addStyle("z-index","2000"),e("#DQXUtilContainer").append(r.toString()),e("#DocuBoxBackGround").mousedown(function(t){t.target.id=="DocuBoxBackGround"&&(e("#DocuBoxBackGround").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#DocuBoxBackGround").css("background-color",o),setTimeout(function(){e("#DocuBoxBackGround").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#DocuBoxBackGround").css("background-color",o)},150)},150)},150))});var u=t.getWindowClientW(),a=t.getWindowClientH(),f=Math.min(800,u-100),l=n.Div({id:"DocuBox"});l.addStyle("position","absolute"),l.addStyle("left",(u-f)/2+"px"),l.addStyle("top","50px"),l.addStyle("width",f+"px"),l.setCssClass("DQXDocuBox");var c=n.JavaScriptBitmaplink(t.BMP("close2.png"),"Close","closeDocumentation();");l.addElem(c),c.addStyle("position","absolute"),c.addStyle("right","-16px"),c.addStyle("top","-16px");var h=n.Div({id:"DocuBoxHeader",parent:l});h.setCssClass("DQXDocuBoxHeader DQXDragHeader");var p=n.Div({id:"DocuBoxFooter",parent:l});p.setCssClass("DQXDocuBoxFooter");var d=n.Div({id:"DocuBoxButtons",parent:p}),v=[{id:"DocuBoxButtonPrevious",name:"",bitmap:t.BMP("arrow5left.png"),handler:s._onPrevious},{id:"DocuBoxButtonNext",name:"",bitmap:t.BMP("arrow5right.png"),handler:s._onNext}];for(var m=0;m<v.length;m++){var g=v[m],y=n.Div({id:g.id,parent:d});y.setCssClass("DQXDocuButton"),y.addElem('<IMG SRC="'+g.bitmap+'" border=0 ALT="" style="margin-right:3px;margin-left:3px"></IMG>'),y.addElem(g.name)}var b=n.Div({id:"DocuBoxContent",parent:l});b.setCssClass("DQXDocuBoxBody"),b.addStyle("max-height",a-100-100+"px"),e("#DocuBoxBackGround").append(l.toString()),i.makeDraggable("DocuBox");for(var m=0;m<v.length;m++){var g=v[m];e("#"+g.id).click(e.proxy(g.handler,this))}t.registerGlobalKeyDownReceiver(function(e){e.isEscape&&s._onCancel("DocuBox")},"DocuBox")},s.showHelp=function(t){s.topicStackPointer>=0&&(s.topicStack[s.topicStackPointer].scrollPos=e("#DocuBoxContent").scrollTop()),s._createBox(),s.topicStack=s.topicStack.slice(0,s.topicStackPointer+1),s.topicStack.push({url:t,scrollPos:0}),s.topicStackPointer=s.topicStack.length-1,s._displayHelp(t,0)},s._displayHelp=function(n,r){e("#DocuBoxButtonPrevious").css("opacity",s.topicStackPointer>0?1:.3),e("#DocuBoxButtonNext").css("opacity",s.topicStackPointer<s.topicStack.length-1?1:.3),t.setProcessing("Downloading..."),e.get(n,{}).done(function(n){t.stopProcessing(),e("#DocuBoxContent").html(e("<div/>").append(t.interpolate(n)).find(".DQXHelpContent").html()),r?e("#DocuBoxContent").scrollTop(r):e("#DocuBoxContent").scrollTop(0)}).fail(function(){t.stopProcessing(),alert("Failed to download documentation item '"+n+"'")})},r.listen("",{type:"ShowHelp"},function(e,t){s.showHelp(t)}),s}),function(e,t,n){function f(e,t,n){var r=[];for(var i=0;i<e.length;i++){var s=tinycolor(e[i]),u=s.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";u+=tinycolor.equals(t,e[i])?" sp-thumb-active":"";var a=o?"background-color:"+s.toRgbString():"filter:"+s.toFilter();r.push('<span title="'+s.toRgbString()+'" data-color="'+s.toRgbString()+'" class="'+u+'"><span class="sp-thumb-inner" style="'+a+';" /></span>')}return"<div class='sp-cf "+n+"'>"+r.join("")+"</div>"}function l(){for(var e=0;e<i.length;e++)i[e]&&i[e].hide()}function c(e,n){var i=t.extend({},r,e);return i.callbacks={move:m(i.move,n),change:m(i.change,n),show:m(i.show,n),hide:m(i.hide,n),beforeShow:m(i.beforeShow,n)},i}function h(r,h){function gt(){d.showPaletteOnly&&(d.showPalette=!0),J.toggleClass("sp-flat",m),J.toggleClass("sp-input-disabled",!d.showInput),J.toggleClass("sp-alpha-enabled",d.showAlpha),J.toggleClass("sp-buttons-disabled",!d.showButtons),J.toggleClass("sp-palette-disabled",!d.showPalette),J.toggleClass("sp-palette-only",d.showPaletteOnly),J.toggleClass("sp-initial-disabled",!d.showInitial),J.addClass(d.className),jt()}function yt(){function o(e){return e.data&&e.data.ignore?(Ot(t(this).data("color")),Dt()):(Ot(t(this).data("color")),Bt(!0),Dt(),Lt()),!1}s&&J.find("*:not(input)").attr("unselectable","on"),gt(),at&&X.after(ft).hide();if(m)X.after(J).hide();else{var n=d.appendTo==="parent"?X.parent():t(d.appendTo);n.length!==1&&(n=t("body")),n.append(J)}if(w&&e.localStorage){try{var r=e.localStorage[w].split(",#");r.length>1&&(delete e.localStorage[w],t.each(r,function(e,t){bt(t)}))}catch(i){}try{I=e.localStorage[w].split(";")}catch(i){}}lt.bind("click.spectrum touchstart.spectrum",function(e){V||Ct(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(X.is(":disabled")||d.disabled===!0)&&Rt(),J.click(v),nt.change(Nt),nt.bind("paste",function(){setTimeout(Nt,1)}),nt.keydown(function(e){e.keyCode==13&&Nt()}),st.text(d.cancelText),st.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Lt("cancel")}),ot.text(d.chooseText),ot.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),_t()&&(Bt(!0),Lt())}),g(et,function(e,t,n){B=e/O,n.shiftKey&&(B=Math.round(B*10)/10),Dt()}),g(G,function(e,t){D=parseFloat(t/L),Dt()},xt,Tt),g(K,function(e,t,n){if(!n.shiftKey)U=null;else if(!U){var r=P*N,i=C-H*C,s=Math.abs(e-r)>Math.abs(t-i);U=s?"x":"y"}var o=!U||U==="x",u=!U||U==="y";o&&(P=parseFloat(e/N)),u&&(H=parseFloat((C-t)/C)),Dt()},xt,Tt),ht?(Ot(ht),Pt(),vt=dt||tinycolor(ht).format,bt(ht)):Pt(),m&&kt();var u=s?"mousedown.spectrum":"click.spectrum touchstart.spectrum";rt.delegate(".sp-thumb-el",u,o),it.delegate(".sp-thumb-el:nth-child(1)",u,{ignore:!0},o)}function bt(n){if(b){var r=tinycolor(n).toRgbString();if(t.inArray(r,I)===-1){I.push(r);while(I.length>q)I.shift()}if(w&&e.localStorage)try{e.localStorage[w]=I.join(";")}catch(i){}}}function wt(){var e=[],t=I,n={},r;if(d.showPalette){for(var i=0;i<F.length;i++)for(var s=0;s<F[i].length;s++)r=tinycolor(F[i][s]).toRgbString(),n[r]=!0;for(i=0;i<t.length;i++)r=tinycolor(t[i]).toRgbString(),n.hasOwnProperty(r)||(e.push(t[i]),n[r]=!0)}return e.reverse().slice(0,d.maxSelectionSize)}function Et(){var e=Mt(),n=t.map(F,function(t,n){return f(t,e,"sp-palette-row sp-palette-row-"+n)});I&&n.push(f(wt(),e,"sp-palette-row sp-palette-row-selection")),rt.html(n.join(""))}function St(){if(d.showInitial){var e=pt,t=Mt();it.html(f([e,t],t,"sp-palette-row-initial"))}}function xt(){(C<=0||N<=0||L<=0)&&jt(),J.addClass(R),U=null}function Tt(){J.removeClass(R)}function Nt(){var e=tinycolor(nt.val());e.ok?Ot(e):nt.addClass("sp-validation-error")}function Ct(){T?Lt():kt()}function kt(){var n=t.Event("beforeShow.spectrum");if(T){jt();return}X.trigger(n,[Mt()]);if(S.beforeShow(Mt())===!1||n.isDefaultPrevented())return;l(),T=!0,t(z).bind("click.spectrum",Lt),t(e).bind("resize.spectrum",x),ft.addClass("sp-active"),J.removeClass("sp-hidden"),d.showPalette&&Et(),jt(),Pt(),pt=Mt(),St(),S.show(pt),X.trigger("show.spectrum",[pt])}function Lt(n){if(n&&n.type=="click"&&n.button==2)return;if(!T||m)return;T=!1,t(z).unbind("click.spectrum",Lt),t(e).unbind("resize.spectrum",x),ft.removeClass("sp-active"),J.addClass("sp-hidden");var r=!tinycolor.equals(Mt(),pt);r&&(mt&&n!=="cancel"?Bt(!0):At()),S.hide(Mt()),X.trigger("hide.spectrum",[Mt()])}function At(){Ot(pt,!0)}function Ot(e,t){if(tinycolor.equals(e,Mt()))return;var n=tinycolor(e),r=n.toHsv();D=r.h%360/360,P=r.s,H=r.v,B=r.a,Pt(),n.ok&&!t&&(vt=dt||n.format)}function Mt(e){return e=e||{},tinycolor.fromRatio({h:D,s:P,v:H,a:Math.round(B*100)/100},{format:e.format||vt})}function _t(){return!nt.hasClass("sp-validation-error")}function Dt(){Pt(),S.move(Mt()),X.trigger("move.spectrum",[Mt()])}function Pt(){nt.removeClass("sp-validation-error"),Ht();var e=tinycolor.fromRatio({h:D,s:1,v:1});K.css("background-color",e.toHexString());var t=vt;B<1&&(t==="hex"||t==="hex3"||t==="hex6"||t==="name")&&(t="rgb");var n=Mt({format:t}),r=n.toHexString(),i=n.toRgbString();o||n.alpha===1?ct.css("background-color",i):(ct.css("background-color","transparent"),ct.css("filter",n.toFilter()));if(d.showAlpha){var u=n.toRgb();u.a=0;var a=tinycolor(u).toRgbString(),f="linear-gradient(left, "+a+", "+r+")";s?Z.css("filter",tinycolor(a).toFilter({gradientType:1},r)):(Z.css("background","-webkit-"+f),Z.css("background","-moz-"+f),Z.css("background","-ms-"+f),Z.css("background",f))}d.showInput&&nt.val(n.toString(t)),d.showPalette&&Et(),St()}function Ht(){var e=P,t=H,n=e*N,r=C-t*C;n=Math.max(-k,Math.min(N-k,n-k)),r=Math.max(-k,Math.min(C-k,r-k)),Q.css({top:r,left:n});var i=B*O;tt.css({left:i-M/2});var s=D*L;Y.css({top:s-_})}function Bt(e){var t=Mt();ut&&X.val(t.toString(vt));var n=!tinycolor.equals(t,pt);pt=t,bt(t),e&&n&&(S.change(t),X.trigger("change",[t]))}function jt(){N=K.width(),C=K.height(),k=Q.height(),A=G.width(),L=G.height(),_=Y.height(),O=et.width(),M=tt.width(),m||(J.css("position","absolute"),J.offset(p(J,lt))),Ht()}function Ft(){X.show(),lt.unbind("click.spectrum touchstart.spectrum"),J.remove(),ft.remove(),i[Ut.id]=null}function It(e,r){if(e===n)return t.extend({},d);if(r===n)return d[e];d[e]=r,gt()}function qt(){V=!1,X.attr("disabled",!1),lt.removeClass("sp-disabled")}function Rt(){Lt(),V=!0,X.attr("disabled",!0),lt.addClass("sp-disabled")}var d=c(h,r),m=d.flat,b=d.showSelectionPalette,w=d.localStorageKey,E=d.theme,S=d.callbacks,x=y(jt,10),T=!1,N=0,C=0,k=0,L=0,A=0,O=0,M=0,_=0,D=0,P=0,H=0,B=1,j=d.palette.slice(0),F=t.isArray(j[0])?j:[j],I=d.selectionPalette.slice(0),q=d.maxSelectionSize,R="sp-dragging",U=null,z=r.ownerDocument,W=z.body,X=t(r),V=!1,J=t(a,z).addClass(E),K=J.find(".sp-color"),Q=J.find(".sp-dragger"),G=J.find(".sp-hue"),Y=J.find(".sp-slider"),Z=J.find(".sp-alpha-inner"),et=J.find(".sp-alpha"),tt=J.find(".sp-alpha-handle"),nt=J.find(".sp-input"),rt=J.find(".sp-palette"),it=J.find(".sp-initial"),st=J.find(".sp-cancel"),ot=J.find(".sp-choose"),ut=X.is("input"),at=ut&&!m,ft=at?t(u).addClass(E).addClass(d.className):t([]),lt=at?ft:X,ct=ft.find(".sp-preview-inner"),ht=d.color||ut&&X.val(),pt=!1,dt=d.preferredFormat,vt=dt,mt=!d.showButtons||d.clickoutFiresChange;yt();var Ut={show:kt,hide:Lt,toggle:Ct,reflow:jt,option:It,enable:qt,disable:Rt,set:function(e){Ot(e),Bt()},get:Mt,destroy:Ft,container:J};return Ut.id=i.push(Ut)-1,Ut}function p(e,n){var r=0,i=e.outerWidth(),s=e.outerHeight(),o=n.outerHeight(),u=e[0].ownerDocument,a=u.documentElement,f=a.clientWidth+t(u).scrollLeft(),l=a.clientHeight+t(u).scrollTop(),c=n.offset();return c.top+=o,c.left-=Math.min(c.left,c.left+i>f&&f>i?Math.abs(c.left+i-f):0),c.top-=Math.min(c.top,c.top+s>l&&l>s?Math.abs(s+o-r):r),c}function d(){}function v(e){e.stopPropagation()}function m(e,t){var n=Array.prototype.slice,r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}function g(n,r,i,o){function d(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function v(e){if(a){if(s&&document.documentMode<9&&!e.button)return g();var t=e.originalEvent.touches,i=t?t[0].pageX:e.pageX,o=t?t[0].pageY:e.pageY,u=Math.max(0,Math.min(i-f.left,c)),p=Math.max(0,Math.min(o-f.top,l));h&&d(e),r.apply(n,[u,p,e])}}function m(e){var r=e.which?e.which==3:e.button==2,s=e.originalEvent.touches;!r&&!a&&i.apply(n,arguments)!==!1&&(a=!0,l=t(n).height(),c=t(n).width(),f=t(n).offset(),t(u).bind(p),t(u.body).addClass("sp-dragging"),h||v(e),d(e))}function g(){a&&(t(u).unbind(p),t(u.body).removeClass("sp-dragging"),o.apply(n,arguments)),a=!1}r=r||function(){},i=i||function(){},o=o||function(){};var u=n.ownerDocument||document,a=!1,f={},l=0,c=0,h="ontouchstart"in e,p={};p.selectstart=d,p.dragstart=d,p["touchmove mousemove"]=v,p["touchend mouseup"]=g,t(n).bind("touchstart mousedown",m)}function y(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,e.apply(i,s)};n&&clearTimeout(r);if(n||!r)r=setTimeout(o,t)}}function b(){e.console&&(Function.prototype.bind?b=Function.prototype.bind.call(console.log,console):b=function(){Function.prototype.apply.call(console.log,console,arguments)},b.apply(this,arguments))}var r={beforeShow:d,move:d,change:d,show:d,hide:d,color:!1,flat:!1,showInput:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"sp-light",palette:["fff","000"],selectionPalette:[],disabled:!1},i=[],s=!!/msie/i.exec(e.navigator.userAgent),o=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div"),n=t.style;return n.cssText="background-color:rgba(0,0,0,.5)",e(n.backgroundColor,"rgba")||e(n.backgroundColor,"hsla")}(),u=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),a=function(){var e="";if(s)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),w="spectrum.id";t.fn.spectrum=function(e,n){if(typeof e=="string"){var r=this,s=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=i[t(this).data(w)];if(n){var o=n[e];if(!o)throw new Error("Spectrum: no such method: '"+e+"'");e=="get"?r=n.get():e=="container"?r=n.container:e=="option"?r=n.option.apply(n,s):e=="destroy"?(n.destroy(),t(this).removeData(w)):o.apply(n,s)}}),r}return this.spectrum("destroy").each(function(){var n=h(this,e);t(this).data(w,n.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=g,t.fn.spectrum.defaults=r,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var e=t("<input type='color' value='!' />")[0],n=e.type==="color"&&e.value!="!";n||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function f(e,t){e=e?e:"",t=t||{};if(typeof e=="object"&&e.hasOwnProperty("_tc_id"))return e;var n=l(e),i=n.r,o=n.g,u=n.b,a=n.a,c=s(100*a)/100,p=t.format||n.format;return i<1&&(i=s(i)),o<1&&(o=s(o)),u<1&&(u=s(u)),{ok:n.ok,format:p,_tc_id:r++,alpha:a,getAlpha:function(){return a},setAlpha:function(e){a=w(e),c=s(100*a)/100},toHsv:function(){var e=d(i,o,u);return{h:e.h*360,s:e.s,v:e.v,a:a}},toHsvString:function(){var e=d(i,o,u),t=s(e.h*360),n=s(e.s*100),r=s(e.v*100);return a==1?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+c+")"},toHsl:function(){var e=h(i,o,u);return{h:e.h*360,s:e.s,l:e.l,a:a}},toHslString:function(){var e=h(i,o,u),t=s(e.h*360),n=s(e.s*100),r=s(e.l*100);return a==1?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+c+")"},toHex:function(e){return m(i,o,u,e)},toHexString:function(e){return"#"+m(i,o,u,e)},toRgb:function(){return{r:s(i),g:s(o),b:s(u),a:a}},toRgbString:function(){return a==1?"rgb("+s(i)+", "+s(o)+", "+s(u)+")":"rgba("+s(i)+", "+s(o)+", "+s(u)+", "+c+")"},toPercentageRgb:function(){return{r:s(E(i,255)*100)+"%",g:s(E(o,255)*100)+"%",b:s(E(u,255)*100)+"%",a:a}},toPercentageRgbString:function(){return a==1?"rgb("+s(E(i,255)*100)+"%, "+s(E(o,255)*100)+"%, "+s(E(u,255)*100)+"%)":"rgba("+s(E(i,255)*100)+"%, "+s(E(o,255)*100)+"%, "+s(E(u,255)*100)+"%, "+c+")"},toName:function(){return a===0?"transparent":y[m(i,o,u,!0)]||!1},toFilter:function(e){var n=m(i,o,u),r=n,s=Math.round(parseFloat(a)*255).toString(16),l=s,c=t&&t.gradientType?"GradientType = 1, ":"";if(e){var h=f(e);r=h.toHex(),l=Math.round(parseFloat(h.alpha)*255).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+c+"startColorstr=#"+C(s)+n+",endColorstr=#"+C(l)+r+")"},toString:function(e){var t=!!e;e=e||this.format;var n=!1,r=!t&&a<1&&a>0,i=r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="name");e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString());if(e==="hex"||e==="hex6")n=this.toHexString();return e==="hex3"&&(n=this.toHexString(!0)),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),i?this.toRgbString():n||this.toHexString()}}}function l(e){var t={r:0,g:0,b:0},n=1,r=!1,i=!1;return typeof e=="string"&&(e=A(e)),typeof e=="object"&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=c(e.r,e.g,e.b),r=!0,i=String(e.r).substr(-1)==="%"?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=k(e.s),e.v=k(e.v),t=v(e.h,e.s,e.v),r=!0,i="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=k(e.s),e.l=k(e.l),t=p(e.h,e.s,e.l),r=!0,i="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=w(n),{ok:r,format:e.format||i,r:o(255,u(t.r,0)),g:o(255,u(t.g,0)),b:o(255,u(t.b,0)),a:n}}function c(e,t,n){return{r:E(e,255)*255,g:E(t,255)*255,b:E(n,255)*255}}function h(e,t,n){e=E(e,255),t=E(t,255),n=E(n,255);var r=u(e,t,n),i=o(e,t,n),s,a,f=(r+i)/2;if(r==i)s=a=0;else{var l=r-i;a=f>.5?l/(2-r-i):l/(r+i);switch(r){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return{h:s,s:a,l:f}}function p(e,t,n){function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var r,i,s;e=E(e,360),t=E(t,100),n=E(n,100);if(t===0)r=i=s=n;else{var u=n<.5?n*(1+t):n+t-n*t,a=2*n-u;r=o(a,u,e+1/3),i=o(a,u,e),s=o(a,u,e-1/3)}return{r:r*255,g:i*255,b:s*255}}function d(e,t,n){e=E(e,255),t=E(t,255),n=E(n,255);var r=u(e,t,n),i=o(e,t,n),s,a,f=r,l=r-i;a=r===0?0:l/r;if(r==i)s=0;else{switch(r){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return{h:s,s:a,v:f}}function v(e,t,n){e=E(e,360)*6,t=E(t,100),n=E(n,100);var r=i.floor(e),s=e-r,o=n*(1-t),u=n*(1-s*t),a=n*(1-(1-s)*t),f=r%6,l=[n,u,o,o,a,n][f],c=[a,n,n,u,o,o][f],h=[o,o,a,n,n,u][f];return{r:l*255,g:c*255,b:h*255}}function m(e,t,n,r){var i=[C(s(e).toString(16)),C(s(t).toString(16)),C(s(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function b(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function w(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1)e=1;return e}function E(e,t){T(e)&&(e="100%");var n=N(e);return e=o(t,u(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function S(e){return o(1,u(0,e))}function x(e){return parseInt(e,16)}function T(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function N(e){return typeof e=="string"&&e.indexOf("%")!=-1}function C(e){return e.length==1?"0"+e:""+e}function k(e){return e<=1&&(e=e*100+"%"),e}function A(e){e=e.replace(t,"").replace(n,"").toLowerCase();var r=!1;if(g[e])e=g[e],r=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=L.rgb.exec(e))?{r:i[1],g:i[2],b:i[3]}:(i=L.rgba.exec(e))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=L.hsl.exec(e))?{h:i[1],s:i[2],l:i[3]}:(i=L.hsla.exec(e))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=L.hsv.exec(e))?{h:i[1],s:i[2],v:i[3]}:(i=L.hex6.exec(e))?{r:x(i[1]),g:x(i[2]),b:x(i[3]),format:r?"name":"hex"}:(i=L.hex3.exec(e))?{r:x(i[1]+""+i[1]),g:x(i[2]+""+i[2]),b:x(i[3]+""+i[3]),format:r?"name":"hex"}:!1}var t=/^[\s,#]+/,n=/\s+$/,r=0,i=Math,s=i.round,o=i.min,u=i.max,a=i.random;f.fromRatio=function(e,t){if(typeof e=="object"){var n={};for(var r in e)e.hasOwnProperty(r)&&(r==="a"?n[r]=e[r]:n[r]=k(e[r]));e=n}return f(e,t)},f.equals=function(e,t){return!e||!t?!1:f(e).toRgbString()==f(t).toRgbString()},f.random=function(){return f.fromRatio({r:a(),g:a(),b:a()})},f.desaturate=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.s-=t/100,n.s=S(n.s),f(n)},f.saturate=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.s+=t/100,n.s=S(n.s),f(n)},f.greyscale=function(e){return f.desaturate(e,100)},f.lighten=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.l+=t/100,n.l=S(n.l),f(n)},f.darken=function(e,t){t=t===0?0:t||10;var n=f(e).toHsl();return n.l-=t/100,n.l=S(n.l),f(n)},f.complement=function(e){var t=f(e).toHsl();return t.h=(t.h+180)%360,f(t)},f.triad=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+120)%360,s:t.s,l:t.l}),f({h:(n+240)%360,s:t.s,l:t.l})]},f.tetrad=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+90)%360,s:t.s,l:t.l}),f({h:(n+180)%360,s:t.s,l:t.l}),f({h:(n+270)%360,s:t.s,l:t.l})]},f.splitcomplement=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+72)%360,s:t.s,l:t.l}),f({h:(n+216)%360,s:t.s,l:t.l})]},f.analogous=function(e,t,n){t=t||6,n=n||30;var r=f(e).toHsl(),i=360/n,s=[f(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,s.push(f(r));return s},f.monochromatic=function(e,t){t=t||6;var n=f(e).toHsv(),r=n.h,i=n.s,s=n.v,o=[],u=1/t;while(t--)o.push(f({h:r,s:i,v:s})),s=(s+u)%1;return o},f.readability=function(e,t){var n=f(e).toRgb(),r=f(t).toRgb(),i=(n.r*299+n.g*587+n.b*114)/1e3,s=(r.r*299+r.g*587+r.b*114)/1e3,o=Math.max(n.r,r.r)-Math.min(n.r,r.r)+Math.max(n.g,r.g)-Math.min(n.g,r.g)+Math.max(n.b,r.b)-Math.min(n.b,r.b);return{brightness:Math.abs(i-s),color:o}},f.readable=function(e,t){var n=f.readability(e,t);return n.brightness>125&&n.color>500},f.mostReadable=function(e,t){var n=null,r=0,i=!1;for(var s=0;s<t.length;s++){var o=f.readability(e,t[s]),u=o.brightness>125&&o.color>500,a=3*(o.brightness/125)+o.color/500;if(u&&!i||u&&i&&a>r||!u&&!i&&a>r)i=u,r=a,n=f(t[s])}return n};var g=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},y=f.hexNames=b(g),L=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();e.tinycolor=f}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})}(window,jQuery),define("DQX/Externals/spectrum",function(){}),define("DQX/Controls",["DQX/Utils","DQX/Msg","DQX/DocEl","DQX/Scroller","DQX/Documentation","DQX/Externals/spectrum"],function(e,t,n,r,i){var s={};return s.autoCreateListeners=!1,s._currentControlNr=0,s._getNextControlID=function(){return s._currentControlNr++,"AutoControlID_"+s._currentControlNr},s._postCreateWaitList={},s._addToControlPostCreateWaitList=function(e){s._postCreateWaitList[e.getID()]=e},s._removeFromControlPostCreateWaitList=function(e){delete s._postCreateWaitList[e.getID()]},s.ExecPostCreateHtml=function(){$.each(s._postCreateWaitList,function(e,t){t.isRendered()&&(t.postCreateHtml(),delete s._postCreateWaitList[e])}),e._registerStaticLinkHandlers(),e._registerActionLinkHandlers()},e.ExecPostCreateHtml=function(){s.ExecPostCreateHtml()},s._surveillance=function(){$.each(s._postCreateWaitList,function(t,n){e.reportError("Post Html creation not executed for control "+t)}),setTimeout(s._surveillance,6e3)},_debug_&&s._surveillance(),s.storeSettings=function(e){var t={};return e.applyOnControls(function(e){if(e.getValue){var n=e.classID;n&&(t[n]=e.getValue())}}),t},s.recallSettings=function(e,t,n){e.applyOnControls(function(e){if(e.modifyValue){var r=e.classID;r&&t[r]!=null&&e.modifyValue(t[r],n)}})},s.Wrapper=function(e,t){var r={};return r._control=e,r.myID=s._getNextControlID(),r._wrapperStyle=t,r.getID=function(){return r.myID},r.renderHtml=function(){var e=n.Div({id:this.myID});return e.setCssClass(r._wrapperStyle),e.addElem(this._control.renderHtml()),e.toString()},r.postCreateHtml=function(){this._control.postCreateHtml()},r.applyOnControls=function(e){"applyOnControls"in r._control&&r._control.applyOnControls(e)},r.tearDown=function(){"tearDown"in r._control&&r._control.tearDown()},r.setContextID=function(e){"setContextID"in r._control&&r._control.setContextID(e)},r},s.ShowHide=function(e){var t={};return t._control=e,t.myID=s._getNextControlID(),t._visible=!0,t.getID=function(){return t.myID},t.setVisible=function(e){return e!=t._visible&&(t._visible=e,e?$("#"+t.myID).show():$("#"+t.myID).hide()),this},t.renderHtml=function(){var e=n.Div({id:this.myID});return e.addStyle("display","inline-block"),e.addElem(this._control.renderHtml()),e.toString()},t.postCreateHtml=function(){t._visible||$("#"+t.myID).hide(),this._control.postCreateHtml()},t.applyOnControls=function(e){"applyOnControls"in t._control&&t._control.applyOnControls(e)},t.tearDown=function(){"tearDown"in t._control&&t._control.tearDown()},t},s.AlignCenter=function(e){var t={};return t._control=e,t.getID=function(){return t._control.getID()},t.renderHtml=function(){var e=n.Div({});e.addStyle("text-align","center");var t=n.Div({parent:e});return t.addStyle("display","inline-block"),t.addStyle("text-align","left"),t.addElem(this._control.renderHtml()),e.toString()},t.postCreateHtml=function(){this._control.postCreateHtml()},t.applyOnControls=function(e){"applyOnControls"in t._control&&t._control.applyOnControls(e)},t.tearDown=function(){"tearDown"in t._control&&t._control.tearDown()},t.setContextID=function(e){"setContextID"in t._control&&t._control.setContextID(e)},t},s.AlignRight=function(e){var t={};return t._control=e,t.getID=function(){return t._control.getID()},t.renderHtml=function(){var e=n.Div({id:this.myID});return e.addStyle("display","inline-block"),e.addStyle("float","right"),e.addElem(this._control.renderHtml()),e.toString()},t.postCreateHtml=function(){this._control.postCreateHtml()},t.applyOnControls=function(e){"applyOnControls"in t._control&&t._control.applyOnControls(e)},t.tearDown=function(){"tearDown"in t._control&&t._control.tearDown()},t.setContextID=function(e){"setContextID"in t._control&&t._control.setContextID(e)},t},s.CompoundGenericList=function(t){var n={};return n._legend="",n._controls=[],n.myID=s._getNextControlID(),n._visible=!0,n._autoFillX=!0,n._legendClass="DQXFormFieldSet",n.clear=function(){n.tearDown(),n._controls=[]},n.setAutoFillX=function(e){return this._autoFillX=e,this},n.setID=function(e){return n.myCustomID=e,n},n.addControl=function(t){return e.requireMemberFunction(t,"getID"),n._controls.push(t),t},n.addControlTop=function(t){return e.requireMemberFunction(t,"getID"),n._controls.unshift(t),t},n.tearDown=function(){$.each(n._controls,function(e,t){"tearDown"in t&&t.tearDown()})},t&&$.each(t,function(e,t){n.addControl(t)}),n.setLegend=function(e){return this._legend=e,this},n.setLegendSimple=function(){return n._legendClass="DQXFormFieldSetSimple",this},n.setLegendClass=function(e){return n._legendClass=e,this},n.getID=function(){return n.myCustomID?n.myCustomID:(this._controls.length==0&&e.reportError("Compound control has no components"),this._controls[0].getID(id))},n.setContextID=function(e){for(var t=0;t<this._controls.length;t++)this._controls[t].setContextID(e)},n.modifyEnabled=function(e){for(var t=0;t<this._controls.length;t++)this._controls[t].modifyEnabled(id);return n},n.postCreateHtml=function(){for(var e=0;e<this._controls.length;e++)this._controls[e].postCreateHtml(id);setTimeout(function(){for(var e=0;e<n._controls.length;e++)n._controls[e]._hasDefaultFocus&&n._controls[e].setFocus()},200)},n.findControl=function(e){for(var t=0;t<this._controls.length;t++){var n=this._controls[t].findControl(e);if(n!=null)return n}return null},n.applyOnControls=function(e){$.each(n._controls,function(t,n){"applyOnControls"in n&&n.applyOnControls(e)})},n},s.CompoundHor=function(e){var t=s.CompoundGenericList(e);return t.renderHtml=function(){var e="";t._autoFillX||(e+='<div style="display:inline-block">'),this._legend.length>0&&(e+='<fieldset class="{cls}">'.DQXformat({cls:t._legendClass}),e+="<legend>"+this._legend+"</legend>");for(var n=0;n<this._controls.length;n++)e+=this._controls[n].renderHtml();return this._legend.length>0&&(e+="</fieldset>"),t._autoFillX||(e+="</div>"),e},t},s.CompoundFloat=function(e){var t=s.CompoundGenericList(e);return t.renderHtml=function(){var e="";e+='<div style="display:inline-block">';for(var t=0;t<this._controls.length;t++)t===0?e+='<div style="float:left">':e+="<div>",e+=this._controls[t].renderHtml(),t===0&&(e+="</div>");return e+="</div>",e},t},s.CompoundVert=function(t){var r=s.CompoundGenericList(t);return r.treatAsBlock=!1,r._margin=3,r._leftIndent=0,r.setMargin=function(e){return r._margin=e,r},r.setLeftIndent=function(t){return r._leftIndent=t,r.treatAsBlock||e.reportError("Invalid combination of settings"),r},r.setTreatAsBlock=function(){return r.treatAsBlock=!0,r},r.renderHtml=function(){var e="";if(r.treatAsBlock||!r._autoFillX)e+='<div style="display:inline-block;vertical-align:top;margin-left:{marginleft}px">'.DQXformat({marginleft:r._leftIndent});this._legend.length>0&&(e+='<fieldset class="{cls}">'.DQXformat({cls:r._legendClass}),e+="<legend>"+this._legend+"</legend>");for(var t=0;t<this._controls.length;t++){var i=n.Div({});r._margin>0&&(t>0&&i.addStyle("margin-top",(t>0?this._margin:this._margin/2)+"px"),t<this._controls.length-1&&i.addStyle("margin-bottom",(t<this._controls.length-1?this._margin:this._margin/2)+"px")),i.addElem(this._controls[t].renderHtml()),e+=i.toString()}this._legend.length>0&&(e+="</fieldset>");if(r.treatAsBlock||!r._autoFillX)e+="</div>";return e},r},s.BaseCustom=function(e){if(!e)var t=s.CompoundHor([]);else var t=s.CompoundVert([]);return t},s.Section=function(e,t){var r={};return r._control=e,r.myID=s._getNextControlID(),r._visible=!0,r._headerStyleClass="DQXControlSectionHeader",r._bodyStyleClass="DQXControlSectionBody",r._title=t.title,r._canCollapse=!0,r._defaultCollapsed=!1,t.headerStyleClass&&(r._headerStyleClass=t.headerStyleClass),t.bodyStyleClass&&(r._bodyStyleClass=t.bodyStyleClass),t.canCollapse===!1&&(r._canCollapse=!1),t.defaultCollapsed&&(r._visible=!1),r.getID=function(){return r.myID},r._createButtonHtml=function(e){return'<span class="fa {ic}" style="font-size: 12px"></span>'.DQXformat({ic:e?"fa-plus-circle":"fa-minus-circle"})},r.renderHtml=function(){r.myIDHeader=r.myID+"header",r.myIDButton=r.myID+"collapserbutton",r.myIDBody=r.myID+"body";var e=n.Div({id:this.myID}),t=n.Div({parent:e,id:r.myIDHeader});t.setCssClass(r._headerStyleClass);if(r._canCollapse){t.addStyle("cursor","pointer");var i=n.Div({parent:t,id:r.myIDButton});i.addStyle("width","20px"),i.addStyle("height","15px"),i.setCssClass("DQXTreeButton"),i.addElem(r._createButtonHtml(!r._visible))}t.addElem(r._title);var s=n.Div({parent:e,id:r.myIDBody});return s.setCssClass(r._bodyStyleClass),r._visible||s.addStyle("display","none"),s.addElem(this._control.renderHtml()),e.toString()},r.postCreateHtml=function(){if(r._canCollapse){var e=$("#"+r.myIDHeader);e.click(function(){r._visible=!r._visible;var e=$("#"+r.myIDBody);r._visible?(e.slideDown(250),r.onExpanding&&r.onExpanding()):(e.slideUp(250),r.onCollapsing&&r.onCollapsing()),setTimeout(function(){$("#"+r.myIDButton).html(r._createButtonHtml(!r._visible))},300)})}this._control.postCreateHtml()},r.applyOnControls=function(e){"applyOnControls"in r._control&&r._control.applyOnControls(e)},r.tearDown=function(){"tearDown"in r._control&&r._control.tearDown()},r},s.CompoundGrid=function(){var t={};return t._controlRows=[],t.sepH=12,t.sepV=5,t._legend=null,t._autoFillX=!0,t.clear=function(){t._controlRows=[]},t.setSeparation=function(e,n){return t.sepH=e,t.sepV=n,t},t.setLegend=function(e){return this._legend=e,this},t.setID=function(e){return t.myCustomID=e,t},t.setAutoFillX=function(e){return this._autoFillX=e,this},t.setItem=function(t,n,r){e.requireMemberFunction(r,"getID");while(this._controlRows.length<=t)this._controlRows.push([]);while(this._controlRows[t].length<=n)this._controlRows[t].push(null);return this._controlRows[t][n]=r,r},t.getItem=function(e,t){return e<0||e>=this._controlRows.length?null:t<0||t>=this._controlRows[e].length?null:this._controlRows[e][t]},t._loopItems=function(e){for(var t=0;t<this._controlRows.length;t++)for(var n=0;n<this._controlRows[t].length;n++)this._controlRows[t][n]!=null&&e(this._controlRows[t][n])},t.applyOnControls=function(e){for(var t=0;t<this._controlRows.length;t++)for(var n=0;n<this._controlRows[t].length;n++)this._controlRows[t][n]!=null&&"applyOnControls"in this._controlRows[t][n]&&this._controlRows[t][n].applyOnControls(e)},t.getID=function(){return t.myCustomID?t.myCustomID:(this.getItem(0,0)||e.reportError("Compound control has no components"),this.getItem(0,0).getID(id))},t.setContextID=function(e){this._loopItems(function(t){t.setContextID(e)})},t.modifyEnabled=function(e){return this._loopItems(function(e){e.modifyEnabled(id)}),t},t.renderHtml=function(){var e="";this._autoFillX||(e+='<div style="display:inline-block">'),this._legend&&(e+='<fieldset class="{cls}">'.DQXformat({cls:t._legendClass}),e+="<legend>"+this._legend+"</legend>"),e+='<table style="padding-top:{pt}px;">'.DQXformat({pt:this.sepV});for(var n=0;n<this._controlRows.length;n++){e+="<tr>";for(var r=0;r<this._controlRows[n].length;r++){e+='<td style="padding-right:{sepH}px;padding-bottom:{sepV}px;">'.DQXformat({sepH:this.sepH,sepV:this.sepV});var i=this.getItem(n,r);i!=null&&(e+=i.renderHtml()),e+="</td>"}e+="</tr>"}return e+="</table>",this._legend&&(e+="</fieldset>"),this._autoFillX||(e+="</div>"),e},t.postCreateHtml=function(){this._loopItems(function(e){e.postCreateHtml()})},t.findControl=function(e){return this._loopItems(function(t){var n=t.findControl(e);if(n!=null)return n}),null},t},s.Label=function(t){var n={};return n._content=e.interpolate(t),n.getID=function(){return""},n.setContextID=function(e){},n.modifyEnabled=function(e){},n.renderHtml=function(){return this._content},n.postCreateHtml=function(){},n.applyOnControls=function(e){},n.findControl=function(e){return null},n},s.HorizontalSeparator=function(e){var t={};return t._size=e,t.getID=function(){return""},t.setContextID=function(e){},t.modifyEnabled=function(e){},t.renderHtml=function(){return'<div style="width:{sz}px;display:inline-block"></div>'.DQXformat({sz:this._size})},t.postCreateHtml=function(){},t.findControl=function(e){return null},t.applyOnControls=function(e){},t},s.VerticalSeparator=function(e){var t={};return t._size=e,t.getID=function(){return""},t.setContextID=function(e){},t.modifyEnabled=function(e){},t.renderHtml=function(){return'<div style="height:{sz}px;width:100%;clear:both"></div>'.DQXformat({sz:this._size})},t.postCreateHtml=function(){},t.findControl=function(e){return null},t.applyOnControls=function(e){},t},s.Control=function(n){var r={};r.myID=n,n||(r.myID=s._getNextControlID()),r.myContextID="",r._enabled=!0,r._controlExtensionList=[""],r._hasDefaultFocus=!1,r._eventids=[],_debug_&&$("#"+n).length>0&&e.reportError("Control creation error: element with ID "+n+" is already present in the DOM tree"),r.setHasDefaultFocus=function(){return this._hasDefaultFocus=!0,this},r.setClassID=function(e){return r.classID=e,r},r.getID=function(){return this.myID},r.getFullID=function(e){return this.myContextID+this.myID+e},r._reactModifyValue=function(e,t){e.contextid==this.myContextID&&this.modifyValue(t)};if(s.autoCreateListeners){var i=e.getNextUniqueID();r._eventids.push(i),t.listen(i,{type:"CtrlModifyValue",id:r.myID},$.proxy(r._reactModifyValue,r))}r._reactModifyEnabled=function(e,t){e.contextid==this.myContextID&&this.modifyEnabled(t)};if(s.autoCreateListeners){var i=e.getNextUniqueID();r._eventids.push(i),t.listen(i,{type:"CtrlModifyEnabled",id:r.myID},$.proxy(r._reactModifyEnabled,r))}return r.tearDown=function(){$.each(r._eventids,function(e,n){t.delListener(n)})},r.setContextID=function(t){this.myContextID!=""&&this.myContextID!==t&&e.reportError("Control context id is already set"),this.myContextID=t},r.renderHtml=function(){return s._addToControlPostCreateWaitList(this),this._postCreateHtmlExecuted=!1,this._execRenderHtml()},r.applyOnControls=function(e){e(r)},r.getJQElement=function(e){return $("#"+this.getFullID(e))},r.modifyEnabled=function(e){this._enabled=e;for(var t=0;t<this._controlExtensionList.length;t++)this._enabled?this.getJQElement(this._controlExtensionList[t]).removeAttr("disabled"):this.getJQElement(this._controlExtensionList[t]).attr("disabled","disabled");return r},r.addValueChangedListener=function(e){t.listen("",{type:"CtrlValueChanged",id:this.getID()},e)},r.setOnChanged=function(e){return this.onChanged=e,this},r._notifyChanged=function(){this.onChanged&&this.onChanged(this.myID,this),t.broadcast({type:"CtrlValueChanged",id:this.myID,contextid:this.myContextID},this)},r.findControl=function(e){return e==this.myID?this:null},r.isRendered=function(){return this.getJQElement("").length>0},r.setFocus=function(){this.isRendered()||e.reportError("Control is not rendered"),document.getElementById(this.getFullID("")).focus()},r.postCreateHtml=function(){if(!this._postCreateHtmlExecuted){_debug_&&(this.isRendered()||e.reportError("PostCreate called on unrendered control: "+this.myID));var t=this.getJQElement().length;s._removeFromControlPostCreateWaitList(this),this._execPostCreateHtml(),this._postCreateHtmlExecuted=!0,this.modifyEnabled(this._enabled),this._backgroundColorString&&this.getJQElement("").css("background-color",this._backgroundColorString)}},r.setBackgroundColor=function(e){this._backgroundColorString=e.toString(),this.getJQElement("").css("background-color",this._backgroundColorString)},r.bindToModel=function(e,t,n,i){return n=n||function(e){return e},i=i||function(e){return e},r.modifyValue(e.get(t),!0),e.on({change:t},function(){r.modifyValue(i(e.get(t)),!0)}),r.setOnChanged(function(){e.set(t,n(r.getValue()))}),r},r},s.Static=function(t){var r=s.Control(null);return r.myContent=e.interpolate(t),r._isComment=!1,r.makeComment=function(){return this._isComment=!0,this},r._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});return e.addStyle("padding-top","2px"),e.addStyle("padding-bottom","2px"),e.addStyle("display","inline-block"),this._isComment&&e.setCssClass("DQXFormComment"),e.addElem(this.myContent),e.toString()},r._execPostCreateHtml=function(){},r._onChange=function(){},r.getValue=function(){return null},r.findControl=function(e){return null},r},s.Html=function(t,r,i){e.checkIsString(r);var o=s.Control(t);return o.myContent=e.interpolate(r),o._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});return i?e.setCssClass(i):(e.addStyle("padding-top","2px"),e.addStyle("padding-bottom","2px"),e.addStyle("display","inline-block")),e.addElem(this.myContent),e.toString()},o._execPostCreateHtml=function(){},o._onChange=function(){},o.getValue=function(){return null},o.modifyValue=function(t){o.myContent=e.interpolate(t),this.getJQElement("").html(o.myContent),s.ExecPostCreateHtml()},o},s.Check=function(t,r){var i=s.Control(t);return e.requireMember(r,"label"),i.myLabel=e.interpolate(r.label),i.isChecked=!1,r.value&&(i.isChecked=r.value),i._hint=!1,r.hint&&(i._hint=e.interpolate(r.hint)),i._execRenderHtml=function(){var e=n.Check({id:this.getFullID("")});this.hint&&e.addHint(this.hint),i.isChecked&&e.addAttribute("checked","checked");var t=n.Label({target:this.getFullID("")});return this._hint&&t.addHint(this._hint),t.addElem(this.myLabel),e.toString()+t.toString()},i._execPostCreateHtml=function(){var e="change.controlevent";this.getJQElement("").unbind(e).bind(e,$.proxy(i._onChange,i))},i._onChange=function(){var e=this.isChecked,t=this.getValue();t!=e&&(this.isChecked=t,this._notifyChanged())},i.getValue=function(){return this.getJQElement("").length>0&&(this.isChecked=this.getJQElement("").is(":checked")),this.isChecked},i.modifyValue=function(e,t){return e==this.getValue()?!1:(this.isChecked=e,this.isChecked?this.getJQElement("").attr("checked","checked"):this.getJQElement("").removeAttr("checked"),t||this._notifyChanged(),!0)},i.modifyEnabled=function(e){this._enabled=e;for(var t=0;t<this._controlExtensionList.length;t++)if(this._enabled){var n=this.getJQElement(this._controlExtensionList[t]);n.removeAttr("disabled"),n.next().css("opacity",1)}else{var n=this.getJQElement(this._controlExtensionList[t]);n.attr("disabled","disabled"),n.next().css("opacity",.4)}},i},s.Button=function(t,r){var i=s.Control(t);i.content="<No content>";var o="";r.description&&(o=e.interpolate(r.description)),r.content&&!r.bitmap&&(i.content='<span class="_DQXButtonText" TITLE="{description}">'.DQXformat({description:o})+e.interpolate(r.content)+"</span>"),r.bitmap&&!r.content&&(i.content='<IMG SRC="'+r.bitmap+'" border=0 ALT="'+o+'" TITLE="'+o+'" style="padding-right:5px;float:left">');if((r.bitmap||r.icon)&&r.content){var u=r.iconWidth||28,a="100%";r.width&&r.height&&(a=r.width-u-5+"px"),i.content="",i.content+='<div style="display:inline-block;vertical-align:middle;width:1px;height:100%"></div>',r.bitmap&&(i.content+='<div style="display:inline-block;line-height: inherit;font-size: 22px;width:{iconwidth}px;vertical-align:middle;text-align:left">'.DQXformat({iconwidth:u}),i.content+='<IMG SRC="'+r.bitmap+'" border=0 ALT="'+o+'" TITLE="'+o+'" style="vertical-align:middle;',r.bitmapHeight?i.content+="max-height:{h}px;".DQXformat({h:r.bitmapHeight}):i.content+="max-width:{w}px;".DQXformat({w:u-6}),i.content+='">',i.content+="</div>"),r.icon&&(i.content+='<div class="fa {icon} buttonicon" style="display:inline-block;line-height: inherit;width:{iconwidth}px;vertical-align:middle;text-align:left;{colorToken}'.DQXformat({icon:r.icon,iconwidth:u,colorToken:r.iconColor?"color:"+r.iconColor.toString():""}),r.height?i.content+="font-size: {height}px;".DQXformat({height:Math.min(20,r.height)}):i.content+="font-size: 20px;",i.content+='"></div>'),i.content+='<div class="_DQXButtonText" style="display:inline-block;width:{textw};vertical-align:middle">'.DQXformat({textw:a})+e.interpolate(r.content)+"</div>"}return r.icon&&!r.content&&(i.content+='<div class="fa {icon} buttonicon" style="'.DQXformat({icon:r.icon}),r.height&&(i.content+="font-size: {height}px;".DQXformat({height:r.height})),i.content+='display:inline-block;line-height: inherit;vertical-align:middle;"></div>'),r.hint&&(i._hint=r.hint),i._buttonClass="DQXWizardButton",r.buttonClass&&(i._buttonClass=r.buttonClass),r.width&&(i._width=r.width),r.height&&(i._height=r.height),r.fastTouch&&(i._fastTouch=r.fastTouch),i._enabled=!0,i._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});return this._hint&&e.addHint(this._hint),e.addStyle("display","inline-block"),r.floatright&&e.addStyle("float","right"),e.setCssClass(this._buttonClass),e.addElem(i.content),this._width&&e.setWidthPx(this._width),this._height&&e.setHeightPx(this._height),e.toString()},i._execPostCreateHtml=function(){this.getJQElement("").click($.proxy(i._onChange,i));if(i._fastTouch){var e=document.getElementById(this.getFullID(""));e.addEventListener("touchstart",i._onTouchStart,!1)}},i._onTouchStart=function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),setTimeout(function(){i.getJQElement("").addClass("DQXBitmapButtonHighlight"),setTimeout(function(){i.getJQElement("").removeClass("DQXBitmapButtonHighlight")},500)},50),i._onChange()},i._onChange=function(){this._enabled&&this._notifyChanged()},i.enable=function(e){return this._enabled=e,this._enabled?this.getJQElement("").css("opacity",1):this.getJQElement("").css("opacity",.4),this},i.changeContent=function(e){this.getJQElement("").html(e)},i.changeIcon=function(e,t,n){var i=this.getJQElement("").find(".fa");i.removeClass(r.icon),i.addClass(e),i.css("color",t.toString()),n!=null&&this.getJQElement("").find("._DQXButtonText").html(n),r.icon=e},i.modifyEnabled=function(e){i.enable(e)},i},s.Hyperlink=function(t,r){var i=s.Control(t);return e.requireMember(r,"content"),i.content=r.content,r.hint&&(i._hint=r.hint),i._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});return this._hint&&e.addHint(this._hint),e.addStyle("display","inline-block"),e.setCssClass("DQXHyperlink"),e.addElem(i.content),e.addStyle("padding-top","2px"),e.addStyle("padding-bottom","2px"),e.toString()},i._execPostCreateHtml=function(){this.getJQElement("").click($.proxy(i._onChange,i))},i._onChange=function(){this._notifyChanged()},i.modifyValue=function(e){i.content=e,this.getJQElement("").html(i.content)},i},s.Edit=function(t,r){var i=s.Control(t);return i.myLabel=r.label,i.value="","value"in r&&(i.value=r.value),i.size=6,"size"in r&&(i.size=r.size),r.hint&&(i._hint=r.hint),i._notifyEnter=null,r.class&&(i._class=r.class),i.setNotifyEnter=function(t){e.checkIsFunction(t),this._notifyEnter=t},i._execRenderHtml=function(){var e=n.Edit(i.value,{id:this.getFullID("")});this._hint&&e.addHint(this._hint),e.addAttribute("size",i.size),e.addAttribute("name",this.getFullID("")),e.addAttribute("autocorrect","off"),e.addAttribute("autocapitalize","off"),e.addAttribute("autocomplete","off"),i._class&&e.setCssClass(i._class);var t="";if(this.myLabel){var r=n.Label({target:this.getFullID("")});r.addElem(this.myLabel),i._class&&r.setCssClass(i._class),t=r.toString()+" "}return t+e.toString()},i._execPostCreateHtml=function(){this.getJQElement("").bind("propertychange input paste",$.proxy(i._onChange,i)),this.getJQElement("").bind("keyup",$.proxy(i._onKeyUp,i)),i._hasDefaultFocus&&this.getJQElement("").select()},i._onKeyUp=function(e){this._onChange(),e.keyCode==13&&this._notifyEnter&&this._notifyEnter()},i._onChange=function(){var e=this.value,t=this.getValue();t!=e&&(this.value=t,this._notifyChanged())},i.getValue=function(){return this.isRendered()&&(this.value=this.getJQElement("").val()),this.value},i.modifyValue=function(e,t){if(e===this.getValue())return;this.value=e,this.getJQElement("").val(e),t||this._notifyChanged()},i},s.Textarea=function(t,r){var i=s.Control(t);return i.myLabel=r.label,i.value="","value"in r&&(i.value=r.value),i.size=6,"size"in r&&(i.size=r.size),i.linecount=2,"linecount"in r&&(i.linecount=r.linecount),r.hint&&(i._hint=r.hint),r.fixedfont&&(i._fixedfont=r.fixedfont),r.noWrap&&(i._noWrap=r.noWrap),r.accepttabs&&(i._accepttabs=r.accepttabs),i._notifyEnter=null,i.setNotifyEnter=function(t){e.checkIsFunction(t),this._notifyEnter=t},i._execRenderHtml=function(){var e=n.Create("textarea",{id:this.getFullID("")});e.addElem(i.value),this._hint&&e.addHint(this._hint),e.addAttribute("cols",i.size),e.addAttribute("rows",i.linecount),e.addAttribute("name",this.getFullID("")),e.addAttribute("autocorrect","off"),e.addAttribute("autocapitalize","off"),e.addAttribute("autocomplete","off"),this._noWrap&&(e.addStyle("overflow-x","scroll"),e.addStyle("white-space","pre"),e.addAttribute("wrap","off")),i._fixedfont?e.addStyle("font-family","Courier"):e.addStyle("font-family","Verdana, Arial, Helvetica, sans-serif");var t="";if(this.myLabel){var r=n.Label({target:this.getFullID("")});r.addElem(this.myLabel),t=r.toString()+" "}return t+e.toString()},i._execPostCreateHtml=function(){this.getJQElement("").bind("propertychange input paste",$.proxy(i._onChange,i)),i._accepttabs&&this.getJQElement("").bind("keydown",i._onKeyDown),this.getJQElement("").bind("keyup",$.proxy(i._onKeyUp,i)),i._hasDefaultFocus&&this.getJQElement("").select()},i._onKeyDown=function(e){if(i._accepttabs&&e.keyCode===9){var t=this.selectionStart,n=this.selectionEnd,r=$(this),s=r.val();r.val(s.substring(0,t)+"	"+s.substring(n)),this.selectionStart=this.selectionEnd=t+1,e.preventDefault()}},i._onKeyUp=function(e){this._onChange(),e.keyCode==13&&this._notifyEnter&&this._notifyEnter()},i._onChange=function(){var e=this.value,t=this.getValue();t!=e&&(this.value=t,this._notifyChanged())},i.getValue=function(){return this.value=this.getJQElement("").val(),this.value},i.modifyValue=function(e,t){if(e==this.getValue())return;this.value=e,this.getJQElement("").val(e),t||this._notifyChanged()},i},s.Combo=function(t,r){var i=s.Control(t);return e.requireMember(r,"label"),e.requireMember(r,"states"),i.myLabel=r.label,i.myStates=r.states,i._selectedState="","value"in r&&(i._selectedState=r.value),r.hint&&(i._hint=r.hint),"width"in r&&(i._width=r.width),i._buildStatesMap=function(){this._statesMap={},$.each(this.myStates,function(t,n){e.requireMember(n,"id"),e.requireMember(n,"name"),i._statesMap[n.id]=n.name})},i._buildStatesMap(),i.isState=function(e){return"_statesMap"in this?e in this._statesMap:!1},i.setItems=function(t,n){this.myStates=[],$.each(t,function(t,n){e.requireMember(n,"id"),e.requireMember(n,"name"),i.myStates.push(n)}),i._selectedState=n,this.getJQElement("").html(i._buildSelectContent()),i._buildStatesMap()},i._buildSelectContent=function(){var e="",t="";for(var n=0;n<this.myStates.length;n++){var r=this.myStates[n].group||"";r!=t&&(t&&(e+="</optgroup>"),t=r,r&&(e+='<optgroup = label="{name}">'.DQXformat({name:r}))),e+='<option value="{id}" {selected}>{name}</option>'.DQXformat({id:this.myStates[n].id,name:this.myStates[n].name,selected:this.myStates[n].id==this._selectedState?'selected="selected"':""})}return t&&(e+="</optgroup>"),e},i._execRenderHtml=function(){var e=n.Div();e.addStyle("display","inline-block"),e.setCssClass("DQXSelectWrapper");var t=n.Create("select",{id:this.getFullID(""),parent:e});i._width&&t.addStyle("width",i._width+"px"),this._hint&&t.addHint(this._hint),t.addElem(this._buildSelectContent());var r=n.Label({target:this.getFullID("Label")});return r.addElem(this.myLabel),r.toString()+" "+e.toString()},i._execPostCreateHtml=function(){var e="change.controlevent";this.getJQElement("").unbind(e).bind(e,$.proxy(i._onChange,i))},i._onChange=function(){this._selectedState=this.getValue(),this._notifyChanged()},i.getValue=function(){var e=this.getJQElement("").find(":selected");return e.length>0&&(this._selectedState=e.attr("value")),this._selectedState},i.modifyValue=function(t,n){if(t==this.getValue())return;this.isState(t)||e.reportError("Invalid combo box state: "+t),this._selectedState=t,this.getJQElement("").val(this._selectedState),n||this._notifyChanged()},i},s.LinkButton=function(t,n){var r=s.Control(t);return r.myBitmap=n.bitmap,r.text=n.text,r.description="",r._hint="",n.hint&&(r._hint=n.hint),r._vertShift=0,n.vertShift&&(r._vertShift=n.vertShift),r._opacity=1,n.opacity&&(r._opacity=n.opacity),r._smartLink=!1,n.smartLink&&(r.myBitmap=e.BMP("link1.png"),r._vertShift=-2),r._execRenderHtml=function(){var e='<a id={id} TITLE="{desc2}" >'.DQXformat({id:this.getFullID(""),desc2:r._hint});e+='<span style="white-space:nowrap;">';if(this.myBitmap){var t='<IMG SRC="'+this.myBitmap+'" border=0 class="DQXBitmapLink" ALT="{desc1}" TITLE="{desc2}" style="position:relative;top:{shift}px;opacity:{opacity}"/>';t=t.DQXformat({desc1:r.description,desc2:r._hint,shift:-this._vertShift,opacity:this._opacity}),e+=t}return this.text&&(this.myBitmap&&(e+="&thinsp;"),e+='<span style="white-space:normal;">'+this.text+"</span>"),e+="</span>",e+="</a>",e},r._execPostCreateHtml=function(){var e="click.controlevent";this.getJQElement("").unbind(e).bind(e,$.proxy(r._onClick,r))},r._onClick=function(){this._notifyChanged()},r.getValue=function(){return""},r.modifyValue=function(e){},r},s.ImageButton=function(e,t){var n=s.Control(e);return n.myBitmap=t.bitmap,n._hint="",t.hint&&(n._hint=t.hint),n._vertShift=0,t.vertShift&&(n._vertShift=t.vertShift),n._execRenderHtml=function(){var e='<span id={id} TITLE="{desc2}" >'.DQXformat({id:this.getFullID(""),desc2:n._hint});e+='<span style="white-space:nowrap;">';if(this.myBitmap){var t='<IMG SRC="'+this.myBitmap+'" border=0 class="DQXBitmapLinkTransparent" ALT="{desc1}" TITLE="{desc2}" style="position:relative;top:{shift}px"/>';t=t.DQXformat({desc1:n.description,desc2:n._hint,shift:-this._vertShift,opacity:this._opacity}),e+=t}return this.text&&(this.myBitmap&&(e+="&thinsp;"),e+='<span style="white-space:normal;">'+this.text+"</span>"),e+="</span>",e+="</span>",e},n._execPostCreateHtml=function(){var e="click.controlevent";this.getJQElement("").unbind(e).bind(e,$.proxy(n._onClick,n))},n._onClick=function(){this._notifyChanged()},n.getValue=function(){return""},n.modifyValue=function(e){},n},s.HelpButton=function(t,n){n.bitmap=e.BMP("info4.png");var r=s.LinkButton(null,n);return r.setOnChanged(function(){i.showHelp(t)}),r},s.RadioGroup=function(t,r){var i=s.Control(t);return e.requireMember(r,"states"),i.myLabel=r.label,i.myStates=r.states,i._selectedState="","value"in r&&(i._selectedState=r.value),r.hint&&(i._hint=r.hint),i._buildStatesMap=function(){this._statesMap={},$.each(this.myStates,function(t,n){e.requireMember(n,"id"),e.requireMember(n,"name"),i._statesMap[n.id]=n.name})},i._buildStatesMap(),i.isState=function(e){return"_statesMap"in this?e in this._statesMap:!1},i._buildSelectContent=function(){var e="";for(var t=0;t<this.myStates.length;t++){var n=this.myStates[t].id;e+='<div style="padding:5px">',e+='<input type="radio" name={controlid} id={id2} value="{id}" {selected} {disabled}></input>'.DQXformat({controlid:this.getFullID(""),id:n,id2:this.getFullID(n),selected:this.myStates[t].id==this._selectedState?'checked="yes"':"",disabled:this.myStates[t].disabled?'disabled="yes"':""}),e+='<label for="{id}">{title}</label>'.DQXformat({id:this.getFullID(n),title:this.myStates[t].name}),e+="</div>"}return e},i._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});e.addStyle("display","inline-block"),parentElem=e;if(i.myLabel){var t=n.Create("fieldset",{parent:e});t.setCssClass("DQXFormFieldSet"),t.addElem("<legend>"+i.myLabel+"</legend>"),parentElem=t}return parentElem.addElem(this._buildSelectContent()),e.toString()},i._execPostCreateHtml=function(){var e="change.controlevent";this.getJQElement("").unbind(e).bind(e,$.proxy(i._onChange,i))},i._onChange=function(){this._selectedState=this.getValue(),this._notifyChanged()},i.getValue=function(){var e=this.getJQElement("").find(":checked");return e.length>0&&(this._selectedState=e.attr("value")),this._selectedState},i.modifyValue=function(t,n){if(t==this.getValue())return;this.isState(t)||e.reportError("Invalid combo box state"),this._selectedState=t,$.each(i.myStates,function(e,n){n.id==t?i.getJQElement(n.id).attr("checked","yes"):i.getJQElement(n.id).removeAttr("checked")}),n||this._notifyChanged()},i.modifyItemEnabled=function(e,t){$.each(i.myStates,function(n,r){r.id==e&&(r.enabled=t,t?i.getJQElement(e).removeAttr("disabled"):i.getJQElement(e).attr("disabled","yes"))})},i},s.List=function(t,r){var i=s.Control(t);return i._width=300,i._height=200,"width"in r&&(i._width=r.width),"height"in r&&(i._height=r.height),i._checkList=!1,"checkList"in r&&(i._checkList=r.checkList),i._allowSelectItem=!0,"allowSelectItem"in r&&(i._allowSelectItem=r.allowSelectItem),i._items=[],i._activeItem=null,i._getLineID=function(e){return this.getFullID("_item_"+e)},i._getCheckID=function(e){return this.getFullID("_check_"+e)},i._renderItems=function(){var e="";for(var t=0;t<this._items.length;t++){var r=this._items[t],i=n.Div({id:this._getLineID(r.id)});this._activeItem==r.id?i.setCssClass("DQXLargeListItemSelected"):i.setCssClass("DQXLargeListItem");if(this._checkList){var s=n.Div({parent:i});s.addStyle("float","left"),s.addStyle("margin-right","7px");var o=n.Check({id:this._getCheckID(r.id),parent:s});r.checked&&o.addAttribute("checked","checked")}i.addElem(r.content),e+=i.toString()}return e},i.setItems=function(t,n){this._items=[],$.each(t,function(t,n){e.requireMember(n,"id"),e.requireMember(n,"content"),i._items.push(n)}),this._itemsMap={};for(var r=0;r<this._items.length;r++)this._itemsMap[this._items[r].id]=this._items[r];typeof n!="undefined"&&(this._activeItem=n),this._items.length==0&&(this._activeItem=null),this.getJQElement("").html(this._renderItems()),this.scrollHelper&&this.scrollHelper.update()},i.findItem=function(t){this._itemsMap||e.reportError("List items not initialised");var n=this._itemsMap[t];return n||e.reportError("Item not present in the list: "+t),n},i._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});return e.setCssClass("DQXFormControl"),e.makeAutoVerticalScroller(!0),this._width>0?e.setWidthPx(this._width):e.addStyle("width","100%"),e.setHeightPx(this._height),e.addElem(this._renderItems()),e.toString()},i._execPostCreateHtml=function(){this.scrollHelper=e.scrollHelper(this.getJQElement(""));var t="mousedown.itemevent";this.getJQElement("").unbind(t).bind(t,$.proxy(i._onChange,i));var t="dblclick.itemevent";this.getJQElement("").unbind(t).bind(t,$.proxy(i._onDoubleClick,i));var t="change.itemevent";this.getJQElement("").unbind(t).bind(t,$.proxy(i._onChangeCheck,i))},i._event2ListItem=function(e){rs={itemID:null,inCheckBox:!1};var t=e.target.id;t==""&&(t=$(e.target).parent().attr("id"));for(var n=0;n<this._items.length;n++){var r=this._items[n];if(t==this._getLineID(r.id)||t==this._getCheckID(r.id))rs.itemID=r.id,t==this._getCheckID(r.id)&&(rs.inCheckBox=!0)}return rs},i.setOnDoubleClick=function(t){e.checkIsFunction(t),i._handleDoubleClick=t},i._onDoubleClick=function(e){return i._handleDoubleClick&&i._handleDoubleClick(),!1},i._onChangeCheck=function(e){var t=this._event2ListItem(e).itemID;t&&(this.findItem(t).checked=$("#"+this._getCheckID(t)).is(":checked"),this._notifyChanged())},i._onChange=function(e){var t=this._event2ListItem(e),n=t.itemID;if(n!=null)if(this._allowSelectItem)this.modifyValue(n);else if(!t.inCheckBox){var r=$("#"+this._getCheckID(n)),i=checked=r.is(":checked");i?r.removeAttr("checked"):r.attr("checked","checked"),this._notifyChanged()}return!1},i.getValue=function(){return this._activeItem},i.modifyValue=function(e,t){this._activeItem!=null&&this.getJQElement("").children("#"+this._getLineID(this._activeItem)).addClass("DQXLargeListItem").removeClass("DQXLargeListItemSelected"),this.getJQElement("").children("#"+this._getLineID(e)).removeClass("DQXLargeListItem").addClass("DQXLargeListItemSelected"),this._activeItem=e,t||this._notifyChanged()},i.getCheckedItems=function(){var e=[];for(var t=0;t<this._items.length;t++){var n=this._items[t];$("#"+this._getCheckID(n.id)).is(":checked")&&e.push(n.id)}return e},i},s.ValueSlider=function(t,n){var i=s.Control(t);return i._width=300,"width"in n&&(i._width=n.width),i._height=20,"height"in n&&(i._height=n.height),e.requireMember(n,"label"),i._label=n.label,e.requireMember(n,"minval"),e.requireMember(n,"maxval"),i._minval=n.minval,i._maxval=n.maxval,n.scaleDistance&&(i.scaleDistance=n.scaleDistance),i._value=i._minval,n.value&&(i._value=n.value),i.digits=0,n.digits&&(i.digits=n.digits),i.minIsNone=!1,n.minIsNone&&(i.minIsNone=n.minIsNone),i._notifyOnFinished=!1,i._drawIndicators=!0,n.drawIndicators===!1&&(i._drawIndicators=!1),i.setNotifyOnFinished=function(){return i._notifyOnFinished=!0,i},i._controlExtensionList.push("Canvas"),i._execRenderHtml=function(){return st="",st+='<div style="display:inline-block">',st+='<div id="{id}" style="width:{width}px">'.DQXformat({id:this.getFullID(""),width:this._width}),st+='<span class="SupportingText">{content}</span>'.DQXformat({content:i._label}),st+='<span id="{id}" style="float:right">1</span>'.DQXformat({id:this.getFullID("Value")}),st+="</div>",st+='<div><canvas id="{id}" width="{width}"  height="{height}"></canvas></div>'.DQXformat({id:this.getFullID("Canvas"),width:this._width,height:this._height}),st+="</div>",st},i.showValue=function(){if(!i.customValueMapper)var e=this._value.toFixed(this.digits);else var e=i.customValueMapper(this._value);this.minIsNone&&this._value==this._minval&&(e="None"),$("#"+this.getFullID("Value")).html(e)},i._execPostCreateHtml=function(){this._scroller=r.HScrollBar(this.getFullID("Canvas")),this._scroller.drawIndicators=i._drawIndicators,this._scroller.myConsumer=this,this._scroller.zoomareafraction=1e-5,i.scaleDistance&&this._scroller.setScaleDistance(i.scaleDistance),this._scroller.setRange(this._minval,this._maxval),this._scroller.setValue((this._value-this._minval)/(this._maxval-this._minval),0),this.showValue(),this._scroller.draw()},i.scrollTo=function(){this._value=this._scroller.rangeMin+this._scroller.scrollPos*(this._scroller.rangeMax-this._scroller.rangeMin),this.showValue(),i._notifyOnFinished||this._notifyChanged()},i.scrollFinished=function(){i._notifyOnFinished&&this._notifyChanged()},i.getValue=function(){if(this.minIsNone&&this._value==this._minval)return null;var e=Math.pow(10,this.digits);return Math.round(this._value*e)*1/e},i.modifyValue=function(e,t){if(e==this.getValue())return;this._value=e,this.showValue(),this._scroller.setValue((this._value-this._minval)/(this._maxval-this._minval),.02),this._scroller.draw(),t||this._notifyChanged()},i},s.FileUpload=function(t,r){var i=s.Control(t);return e.requireMember(r,"serverUrl"),i._serverUrl=r.serverUrl,i._autoUpload=!0,i._uploadedFileId=null,i._execRenderHtml=function(){var e=n.Div({id:this.getFullID("")});this._hint&&e.addHint(this._hint),e.addStyle("display","inline-block"),e.addStyle("vertical-align","top"),e.addElem('<input id="{id}" type="file" name="filedata"/>'.DQXformat({id:this.getFullID("input")})),e.addElem("<br>");var t=n.Div({id:this.getFullID("status"),parent:e});t.addStyle("width","150px"),t.addElem('<span style="color:rgb(150,150,150)">Not uploaded</span>');var r=e.toString();return r},i._execPostCreateHtml=function(){$("#"+this.getFullID("input")).change(function(){i._uploadedFileId=null,i._autoUpload&&i._uploadFile()})},i._uploadFile=function(){i._uploadedFileId=null;var e=document.getElementById(this.getFullID("input")),t=e.files[0];i._fileName=t.name;var r=new XMLHttpRequest,s=function(e){var t=e.loaded/e.total*99.89,r=n.Div({});r.addStyle("width","100%"),r.addStyle("background-color","rgb(220,220,220)");var s=n.Div({parent:r});s.addStyle("width",t+"%"),s.addStyle("background-color","rgb(150,150,255)"),s.addElem(t.toFixed(1)+"%"),$("#"+i.getFullID("status")).html(r.toString())};r.upload.addEventListener("progress",s,!1),r.onreadystatechange=function(){if(r.readyState==4){i._uploadedFileId=null;var e=JSON.parse(r.responseText);i._uploadedFileId=e.filename,i._uploadedFileId?$("#"+i.getFullID("status")).html('<span style="color:rgb(0,192,0)"><b>Uploaded</b></span>'):$("#"+i.getFullID("status")).html('<span style="color:rgb(255,0,0)"><b>Failed</b></span>'),i._notifyChanged()}},r.open("POST",i._serverUrl+"?datatype=uploadfile",!0),r.send(t)},i.getValue=function(){return i._uploadedFileId},i.getFileName=function(){return i._fileName},i},s.ColorPicker=function(t,n){var r=s.Control(t);return r.myLabel=null,"label"in n&&(r.myLabel=e.interpolate(n.label)),r.colorValue=e.Color(.5,0,0),"value"in n&&(r.colorValue=n.value),r._execRenderHtml=function(){var e="";return r.myLabel&&(e+=r.myLabel+"&nbsp;"),e+=' <input type="text" id="{id}" />'.DQXformat({id:this.getFullID("")}),e},r._execPostCreateHtml=function(){$("#"+this.getFullID("")).spectrum({color:r.colorValue.toString(),showPalette:!0,palette:["fff","000","rgb(230,0,0)","rgb(0,170,0)","rgb(80,80,255)","rgb(210,120,0)","rgb(200,0,200)"],change:function(t){var n=t.toRgb();r.colorValue=e.Color(n.r/255,n.g/255,n.b/255),r._notifyChanged()}})},r.getValue=function(){return r.colorValue},r},s}),define("DQX/FramePanel",["jquery","DQX/DocEl","DQX/Msg"],function(e,t,n){return function(t){var n={};return n.getID=function(){return this.myID},DQX.hasMember(t,"getClientDivID")&&(n.myParentFrame=t,n.myDivID=t.getClientDivID(),t.setClientObject(n)),n.myDivID||(n.myDivID=t),n.myDivID.length==0&&DQX.reportError("Invalid parent reference"),e("#"+n.myDivID).length==0&&DQX.reportError("Invalid Gui component "+n.myDivID),n.myID=n.myDivID,n.setID=function(e){return this.myID=e,this},n.getDivID=function(){return this.myDivID},n.getSubId=function(e){return this.myDivID+e},n.getRootElem=function(){return e("#"+n.myDivID)},n.getScrollPosVert=function(){return e("#"+n.myDivID).scrollTop()},n.setScrollPosVert=function(t){return e("#"+n.myDivID).scrollTop(t)},n.handleResize=function(){"onResize"in n&&n.getRootElem().width()>5&&n.getRootElem().height()>5&&(n._lastResizedSizeX!=n.getRootElem().width()||n._lastResizedSizeY!=n.getRootElem().height())&&(n.onResize(),n._lastResizedSizeX=n.getRootElem().width(),n._lastResizedSizeY=n.getRootElem().height())},n.execPostInitialise=function(){this._onPostInitialise&&this._onPostInitialise()},n.setPostInitialiseHandler=function(e){this._onPostInitialise=e},n}}),define("DQX/HistoryManager",["jquery","DQX/Msg"],function(e,t){var n={_callBackChangeState:null,stateKeys:null,views:[],viewsMap:{},addView:function(e){n.views.push(e),e.getStateID()&&(e.getStateID()in n.viewsMap&&DQX.reportError("Duplicate view state id"),n.viewsMap[e.getStateID()]=e)},setCallBackChangeState:function(e){this._callBackChangeState=e},init:function(){n._onChanged()},updateState:function(){if(!this.stateKeys||e.isEmptyObject(this.stateKeys)){if(!this.viewsMap.start)return;this.viewsMap.start.activateState(this.stateKeys);return}var t=null;for(var n=0;n<this.views.length;n++)this.views[n].getStateID()in this.stateKeys&&(t!=null&&DQX.reportError("Duplicate applicable view"),t=this.views[n]);t!=null&&t.activateState(this.stateKeys),this._callBackChangeState&&this._callBackChangeState(this.stateKeys)},back:function(){history.back()},setState:function(e){this.stateKeys=e;var t="";for(key in this.stateKeys)t.length>0&&(t+="&"),t+=key,this.stateKeys[key]!=null&&(t+="="+this.stateKeys[key]);this.updateState(),window.location.hash=t,typeof _gaq!="undefined"&&_gaq.push(["_trackEvent","State","set",t])},_onChanged:function(){var e={},t=window.location.hash,n=t.substring(1).split("&");for(var r=0;r<n.length;r++)if(n[r]){var i=n[r].split("=");e[i[0]]=i[1]}var s=!0;if(this.dstateKeys==null)s=!1;else{for(var o in e)if(!(o in this.stateKeys)||e[o]!=this.stateKeys[o])s=!1;for(var o in this.stateKeys)if(!(o in e)||this.stateKeys[o]!=e[o])s=!1}s||(this.stateKeys=e,this.updateState())},_reactSwitchTab:function(e,t){if(n.__ignoreSwitchTab)return;var r=null;for(var i=0;i<n.views.length;i++){var s=n.views[i];s.getFrame()!=null&&t==s.getFrame().myFrameID&&(r&&DQX.reportError("Duplicate matching view"),r=s)}if(!r)for(var i=0;i<n.views.length;i++){var s=n.views[i];s.getFrame()!=null&&s.getFrame().isVisible()&&(r&&DQX.reportError("Duplicate matching view"),r=s)}r&&(n.__preventSetFragment||n.setState(r.getStateKeys()))},end:!0};return window.onhashchange=e.proxy(n._onChanged,n),t.listen("",{type:"ChangeTab"},n._reactSwitchTab),n}),define("DQX/Framework",["jquery","handlebars","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/Controls","DQX/FramePanel","DQX/HistoryManager"],function(e,t,n,r,i,s,o,u){var a={};return a.dimX=0,a.dimY=1,a.isValidDim=function(e){e!==0&&e!==1&&n.reportError("Invalid dimension identifier")},a.frameCounter=0,a.sepSizeLarge=6,a.sepSizeSmall=3,a.FrameTypes={Final:0,GroupHor:1,GroupVert:2,Tab:3,Stack:4},a.FrameGroupHor=function(e,t){return a.Frame(e,"GroupHor",t)},a.FrameGroupVert=function(e,t){return a.Frame(e,"GroupVert",t)},a.FrameGroupTab=function(e,t){return a.Frame(e,"Tab",t).setFrameClassClient("DQXForm").setMarginsIndividual(0,2,0,0)},a.FrameGroupStack=function(e,t){return a.Frame(e,"Stack",t)},a.FrameFinal=function(e,t){return a.Frame(e,"Final",t).setFrameClassClient("DQXClient")},a.FrameGeneric=function(e,t){return a.Frame(e,"-",t)},a.FrameDynamic=function(t,n){var r=a.Frame(t,"-",n);return r.render=function(){var t=r._createElements(1).toString();e("#"+r.myID).html(t),e(window).resize(),r._postCreateHTML()},r.clearMemberFrames=function(){this.memberFrames=[]},r},a.SizeRange=function(){var e={};return e.minSize=120,e.maxSize=99999999,e.setMinSize=function(e){this.minSize=e},e.setFixedSize=function(e){return this.minSize=e,this.maxSize=e,this},e._isFixedSize=function(){return this.maxSize==this.minSize},e._getMinSize=function(){return this.minSize},e._getMaxSize=function(){return this.maxSize},e},a.Frame=function(t,s,o){n.checkIsString(t),s!="-"&&(s in a.FrameTypes||n.reportError("Invalid frame type"));var f={};return f._parentFrame=null,f.myFrameID=t,f.myDisplayTitle="",f._displayTitle2="",f.myType=s,f.mySizeWeight=o,f.activeTabNr=0,f.autoSizeY=!1,f.sizeRange=[a.SizeRange(),a.SizeRange()],f.marginLeft=0,f.marginRight=0,f.marginTop=0,f.marginBottom=0,f.memberFrames=[],f.myClientObject=null,f.myID="RootFrame"+a.frameCounter,a.frameCounter++,f._separatorSize=6,f.frameClass="",f.frameClassClient="",f._handleInitialise=null,f._frameContainer=null,f.allowYScrollbar=!0,f.allowYScrollbarSmooth=!1,f._showVertScrollFeedback=!0,f.allowXScrollbar=!1,f.frameTitleBarH=33,f.getFrameID=function(){return f.myFrameID},f.getFrameContainer=function(){return this._frameContainer},f.getVisibleTitleDivID=function(){return this.myID+"_DisplayTitle"},f.getClientContainerDivID=function(){return this.myID+"_clientcontainer"},f.getClientDivID=function(){return this.myID+"_client"},f.getSeparatorDivID=function(e){return this.myID+"_sep_"+e},f.isFinalPanel=function(){return this.myType=="Final"},f.isStacker=function(){return this.myType=="Tab"||this.myType=="Stack"},f.hasTabs=function(){return this.myType=="Tab"},f.isHorSplitter=function(){return this.myType=="GroupHor"},f.isVertSplitter=function(){return this.myType=="GroupVert"},f.isSplitter=function(){return this.isHorSplitter()||this.isVertSplitter()},f.isContainerPanel=function(){return this.isSplitter()||this.isStacker()},f.checkSplitter=function(){this.isSplitter()||n.reportError("Frame is not a splitter")},f.checkFinalPanel=function(){this.isFinalPanel()||n.reportError("Frame is not a final frame (i.e. containing a client panel). Type: "+this.myType)},f.splitterDim=function(){if(this.isHorSplitter())return 0;if(this.isVertSplitter())return 1;n.reportError("Frame is not a splitter")},f.getTitle=function(){return this.myDisplayTitle.length>0?this.myDisplayTitle:""},f.hasTitleBar=function(){return this.myDisplayTitle&&(!this._parentFrame||!this._parentFrame.hasTabs())},f.getTitleBarHeight=function(){return this.hasTitleBar()?f.frameTitleBarH:0},f.isStackMember=function(){return this._parentFrame?this._parentFrame.isStacker():!1},f.settingsStreamOut=function(){var t=[];e.each(this.memberFrames,function(e,n){t.push(n.settingsStreamOut())});var n={sizeWeight:this.mySizeWeight,activeTabNr:this.activeTabNr,memberFrames:t};return n},f.settingsStreamIn=function(t){this.mySizeWeight=t.sizeWeight,this.activeTabNr=t.activeTabNr,e.each(this.memberFrames,function(e,n){e<t.memberFrames.length&&n.settingsStreamIn(t.memberFrames[e])})},f.setInitialiseFunction=function(e){return e&&n.checkIsFunction(e),this._handleInitialise=e,this},f.makeGroupVert=function(){return this.myType!="-"&&n.reportError("Frame is not generic"),this.myType="GroupVert",this},f.makeGroupHor=function(){return this.myType!="-"&&n.reportError("Frame is not generic"),this.myType="GroupHor",this},f.makeGroupTab=function(){return this.myType!="-"&&n.reportError("Frame is not generic"),this.myType="Tab",this.setFrameClassClient("DQXForm").setMarginsIndividual(0,5,0,0),this},f.MakeControlsFrame=function(e,t,n,r){f.isControlsFrame=!0,f._controlsCollapsed=r,f._controlsSize=n,e.setFixedSize(a.dimX,f._controlsCollapsed?2:n),f.makeGroupHor(),f.addMemberFrame(e),f.addMemberFrame(t)},f.makeFinal=function(){return this.myType!="-"&&n.reportError("Frame is not generic"),this.myType="Final",this},f.setMinSize=function(e,t){return a.isValidDim(e),n.checkIsNumber(t),this.sizeRange[e].setMinSize(t),this},f.setFixedSize=function(e,t){return a.isValidDim(e),n.checkIsNumber(t),e==a.dimX&&(this._fixedSizeX=t),this.sizeRange[e].setFixedSize(t),this},f.setAutoSize=function(){return this.setMinSize(a.dimY,0),this.autoSizeY=!0,this},f.setAnimateTransition=function(){return this._animateTransition=!0,this},f.setMargins=function(e){return n.checkIsNumber(e),this.marginLeft=e,this.marginRight=e,this.marginTop=e,this.marginBottom=e,this},f.setMarginsIndividual=function(e,t,r,i){return n.checkIsNumber(e),n.checkIsNumber(t),n.checkIsNumber(r),n.checkIsNumber(i),this.marginLeft=e,this.marginRight=r,this.marginTop=t,this.marginBottom=i,this},f.setDisplayTitle=function(e){return n.checkIsString(e),this.myDisplayTitle=n.interpolate(e),this},f.setDisplayTitle2=function(e){return n.checkIsString(e),this._displayTitle2=n.interpolate(e),this},f.setAllowScrollBars=function(e,t){return this.checkFinalPanel(),n.checkIsBoolean(e),n.checkIsBoolean(t),this.allowXScrollbar=e,this.allowYScrollbar=t,this},f.setAllowSmoothScrollY=function(){return this.checkFinalPanel(),this.allowXScrollbar=!1,this.allowYScrollbar=!0,this.allowYScrollbarSmooth=!0,this},f.setFrameClass=function(e){return n.checkIsString(e),this.frameClass=e,this},f.setFrameClassClient=function(e){return n.checkIsString(e),this.frameClassClient=e,this},f.setSeparatorSize=function(e){return n.checkIsNumber(e),this.checkSplitter(),this._separatorSize=e,this},f.addMemberFrame=function(e){return n.requireMemberFunction(e,"setInitialiseFunction"),this.isContainerPanel()||n.reportError("Can't add member frames to a frame that is not a container"),this._frameContainer||n.reportError("Can't add frames to an unitialised panel"),e._frameContainer=this._frameContainer,e.myID="Frame"+a.frameCounter,a.frameCounter++,this.memberFrames.push(e),e._setParentFrame(this),e},f.InsertFrameTop=function(e){var t=this._parentFrame;t||n.reportError("Unable to insert at root frame");var r=a.FrameGroupVert("",.5);r._frameContainer=t._frameContainer,r._setParentFrame(t),r.myID=this.myID,r.mySizeWeight=this.mySizeWeight,this.myID="Frame"+a.frameCounter,a.frameCounter++;for(var i=0;i<t.memberFrames.length;i++)t.memberFrames[i]==this&&(t.memberFrames[i]=r);return e._setParentFrame(r),r.addMemberFrame(e),r.addMemberFrame(this),e},f.InsertStaticHeader=function(e,t,r){var i=t;i||(i="DQXClientInfo");var s=this.InsertFrameTop(a.FrameFinal("",.01));s.setFrameClassClient(i).setFrameClass(i).setMargins(5).setAllowScrollBars(!1,!1),s.setAutoSize(),s._parentFrame.setSeparatorSize(3),r?s._parentFrame.setSeparatorSize(6):(s._parentFrame.setDisplayTitle(this.myDisplayTitle),this.myDisplayTitle=""),s.setInitialiseFunction(function(){var t='<img src="'+n.BMP("info2.png")+'" alt="info" style="float:left;margin-right:5px"/>',r=a.Form(s);r.addHtml(t+e),r.render()})},f.InsertIntroBox=function(e,t,i){var s=this.InsertFrameTop(a.FrameFinal("",.01));return s.setFrameClassClient("DQXIntroInfo").setFrameClass("DQXIntroInfo").setMargins(8).setAllowScrollBars(!1,!1),s.setAutoSize(),s._parentFrame.setSeparatorSize(6),s.setMinSize(a.dimY,80),s.setInitialiseFunction(function(){var o="";e&&(o+='<img src="Bitmaps/'+e+'" alt="info" style="float:left;margin-left:0px;margin-top:5px;margin-right:8px;margin-bottom:5px"/>');if(i){var u=r.Span({id:i});u.setCssClass("DQXHelpLink DQXIntroBoxHelpLink"),u.addAttribute("href",i),u.addElem('<IMG SRC="'+n.BMP("info2.png")+'" border=0  ALT="Help">'),o+=u}o+=t;if(i){var u=r.Span({id:i});u.setCssClass("DQXHelpLink"),u.addAttribute("href",i),u.addElem(" More information..."),o+=u}var f=a.Form(s);f.addHtml(o),f.render()}),s},f.setClientObject=function(e){n.checkIsFunction(e.getID),this.myClientObject=e},f._setParentFrame=function(e){this._parentFrame=e},f._calcAutoSizeY=function(){var e=0;return this.myClientObject&&(e=this.myClientObject.getAutoSizeY()),this._parentFrame&&(e+=this._parentFrame._separatorSize/2),e+this.marginTop+this.marginBottom},f._getMinSize=function(e){a.isValidDim(e);if(e==a.dimY&&this.autoSizeY){var t=Math.max(this._calcAutoSizeY(),this.sizeRange[e]._getMinSize());return t}var n=0;if(this.isSplitter()&&this.splitterDim()==e)for(var r=0;r<this.memberFrames.length;r++)n+=this.memberFrames[r]._getMinSize(e);else for(var r=0;r<this.memberFrames.length;r++)n=Math.max(n,this.memberFrames[r]._getMinSize(e));var t=Math.max(n,this.sizeRange[e]._getMinSize());return e==a.dimY&&this.hasTitleBar()&&(t+=f.frameTitleBarH),t},f._getMaxSize=function(e){a.isValidDim(e);if(e==a.dimY&&this.autoSizeY)return f._getMinSize(e);var t=0;if(this.isSplitter()&&this.splitterDim()==e)for(var n=0;n<this.memberFrames.length;n++)t+=this.memberFrames[n]._getMaxSize(e);else for(var n=0;n<this.memberFrames.length;n++)t=Math.max(t,this.memberFrames[n]._getMaxSize(e));var r=Math.max(t,this.sizeRange[e]._getMaxSize());return e==a.dimY&&this.hasTitleBar()&&(r+=f.frameTitleBarH),r},f._getMarginTop=function(){return this.marginTop+(this.hasTitleBar()?f.frameTitleBarH:0)},f._isFixedSize=function(e){return a.isValidDim(e),e==a.dimY&&this.autoSizeY?!0:this.sizeRange[e]._isFixedSize()},f._reactClickTab=function(e,t){for(var n=0;n<this.memberFrames.length;n++){var r=this.getClientDivID()+"_tab_"+n;r==t&&(this.activeTabNr=n)}this._setSubFramesPosition(!1),this._onChangeTab(this.memberFrames[this.activeTabNr].myFrameID),this.getFrameContainer().notifyLayoutChanged()},f._createElements=function(e){f.isStackMember()?f.frameTitleBarH=33:f.frameTitleBarH=25,this.myID.length==0&&n.reportError("Frame without ID");var t=r.Div({id:this.myID}),s=r.Div({parent:t,id:this.getClientContainerDivID()}),o=r.Div({parent:s,id:this.getClientDivID()+"Scroller"}),u=r.Div({parent:o,id:this.getClientDivID()});t.setWidthPx(100),t.setHeightPx(100);var a=1-.1*e;this.frameClass.length>0&&t.setCssClass(this.frameClass),this.isFinalPanel()&&(this.allowYScrollbar?u.makeAutoVerticalScroller(this.allowYScrollbarSmooth):u.addStyle("overflow-y","hidden"),this.allowXScrollbar?u.makeAutoHorizontalScroller():u.addStyle("overflow-x","hidden"),u.setCssClass("DQXClient"));if(this.hasTitleBar()){var l=r.Div({parent:t,id:this.getVisibleTitleDivID()});l.setHeightPx(f.frameTitleBarH),this.isStackMember()?l.setCssClass("DQXTitleBar"):l.setCssClass("DQXTitleBarRounded");if(this._displayTitle2){var c=r.Span({parent:l});c.setCssClass("DQXTitleBarRightInfo"),c.addElem(this._displayTitle2+"&nbsp;&nbsp;&#8212;&nbsp;&nbsp;")}var h=r.Span({parent:l});h.setCssClass("DQXTitleLeftPart"),h.addElem(this.myDisplayTitle)}if(this.isSplitter()){for(var p=0;p<this.memberFrames.length-1;p++){var d=r.Div({parent:t,id:this.getSeparatorDivID(p)});this._canMoveSeparator(p)&&(this.isHorSplitter()?d.addStyle("cursor","col-resize"):d.addStyle("cursor","row-resize"));if(f.isControlsFrame){var v=r.Create("img",{parent:d,id:this.getSeparatorDivID(p)+"_mover"});v.setCssClass("DQXControlExpandCollapse"),v.addStyle("left",f._controlsCollapsed?"0px":"-10px"),v.addAttribute("src",f._controlsCollapsed?n.BMP("controlexpand.png"):n.BMP("controlcollapse.png")),v.addStyle("cursor",f._controlsCollapsed?"e-resize":"w-resize")}}for(var p=0;p<this.memberFrames.length;p++)u.addElem(this.memberFrames[p]._createElements(e+1))}if(this.isStacker()){u.setCssClass("DQXTabSet");var m=r.Div({parent:u,id:this.getClientDivID()+"_tabheader"});m.setCssClass("DQXTabs"),this.hasTabs()||m.addStyle("display","none");var g=r.Div({parent:u,id:this.getClientDivID()+"_tabbody"});this.hasTabs()?g.setCssClass("DQXTabBody DQXTabBodyStyled"):g.setCssClass("DQXTabBody DQXLightFrame");for(var p=0;p<this.memberFrames.length;p++){var y=this.getClientDivID()+"_tab_"+p,b=r.Div({parent:g,id:"C"+y});b.setCssClass("DQXTabContent"),b.addElem(this.memberFrames[p]._createElements(e+1))}i.listen("",{type:"ClickTab",id:this.getClientDivID()},f._reactClickTab,f)}return this.frameClassClient.length>0&&(u.setCssClass(this.frameClassClient),s.setCssClass(this.frameClassClient)),t},f._performSwitchTab=function(t){var s=e("#"+f.getClientDivID());e(s).children(".DQXTabs").children(".DQXTab").removeClass("DQXTabActive"),e(s).children(".DQXTabs").children(".DQXTab").addClass("DQXTabInactive"),e("#"+t).addClass("DQXTabActive"),e("#"+t).removeClass("DQXTabInactive");var o="C"+t,u=null;e.each(e(s).children(".DQXTabBody").children(".DQXTabContent"),function(t,n){e(n).css("display")!="none"&&(u=e(n).attr("id"))}),u||n.reportError("Unable to determine active tab");var a=e(s).find("#"+u),l=e(s).find("#"+o);a.length!=1&&n.reportError("Invalid tab "+u),l.length!=1&&n.reportError("Invalid tab "+o);if(this._animateTransition){var c=.8,h=e("#"+f.getClientDivID()+"_tabbody"),p=h.offset().left,d=h.offset().top,v=h.outerWidth(),m=h.outerHeight(),g=r.Div({id:"DQXTabTransientBlocker"});g.addStyle("position","absolute"),g.addStyle("left",p+"px"),g.addStyle("top",d+"px"),g.addStyle("width",v+"px"),g.addStyle("height",m+"px"),g.addStyle("background-color","rgb(255,255,255)"),g.addStyle("opacity",c),g.addStyle("z-index","2000"),e("#DQXUtilContainer").append(g.toString())}a.hide(),l.show(),i.broadcast({type:"ClickTab",id:f.getClientDivID()},t);if(this._animateTransition){var y=function(){c>0?(e("#DQXTabTransientBlocker").css("opacity",c),c-=.3,setTimeout(y,50)):e("#DQXTabTransientBlocker").remove()};setTimeout(y,125)}},f._createTabItems=function(){var t=e("#"+this.getClientDivID()+"_tabbody").width()-20;if(t>0){var n=0;for(var i=0;i<this.memberFrames.length;i++)n=Math.max(n,this.memberFrames[i].getTitle().length);var s=n;do{var o="";for(var i=0;i<this.memberFrames.length;i++){var u=this.getClientDivID()+"_tab_"+i,a=r.Div({id:u});this.memberFrames[i].isHiddenPanel&&a.addStyle("display","none"),a.setCssClass(i==this.activeTabNr?"DQXTab DQXTabActive":"DQXTab DQXTabInactive");var l=this.memberFrames[i].getTitle();s<l.length&&(l=l.substring(0,s)+"..."),a.addElem(l),o+=a}e("#"+this.getClientDivID()+"_tabheader").html(o);var c=0;for(var i=0;i<this.memberFrames.length;i++)c+=e("#"+this.getClientDivID()+"_tab_"+i).outerWidth();s--}while(c>t&&s>0);var h=e("#"+this.getClientDivID());e(h).children(".DQXTabBody").children(".DQXTabContent").css("display","none");var p="C"+e(h).find(".DQXTabActive").attr("id");e(h).find("#"+p).css("display","inline"),e(h).children(".DQXTabs").children(".DQXTab").click(function(){f._performSwitchTab(e(this).attr("id"))})}},f._postCreateHTML=function(){var t=e("#"+this.getClientDivID());t.mousedown(e.proxy(this._handleOnMouseDown,this)),t.mousemove(e.proxy(this._handleOnMouseMove,this)),this._showVertScrollFeedback&&this.isFinalPanel()&&this.allowYScrollbar&&(f.scrollHelper=n.scrollHelper(e("#"+this.getClientDivID())));for(var r=0;r<this.memberFrames.length;r++)r<this.memberFrames.length-1&&this.isSplitter()&&(e("#"+this.getSeparatorDivID(r)).mousedown(e.proxy(this._handleSplitterOnMouseDown,this)),e("#"+this.getSeparatorDivID(r)).mousemove(e.proxy(this._handleSplitterOnMouseMove,this)),f.isControlsFrame&&e("#"+this.getSeparatorDivID(r)+"_mover").mousedown(e.proxy(this._handleSplitterMover,this)),t.mousemove(e.proxy(this._handleSplitterOnMouseMove,this))),this.memberFrames[r]._postCreateHTML()},f._canMoveSeparator=function(e){var t=!1;for(var n=0;n<=e;n++)this.memberFrames[n]._isFixedSize(this.splitterDim())||(t=!0);var r=!1;for(var n=e+1;n<this.memberFrames.length;n++)this.memberFrames[n]._isFixedSize(this.splitterDim())||(r=!0);return t&&r},f.isControlsCollapsed=function(){return!!f._controlsCollapsed},f._handleSplitterMover=function(t){var r=e("#"+this.myID),i=e("#"+this.getClientDivID()),s=e("#"+this.getSeparatorDivID(0)+"_mover");if(!f._controlsCollapsed){var o=2;f._controlsCollapsed=!0,s.attr("src",n.BMP("controlexpand.png")),s.css("left","0px"),s.css("cursor","e-resize")}else{var o=f._controlsSize;f._controlsCollapsed=!1,s.attr("src",n.BMP("controlcollapse.png")),s.css("left","-10px"),s.css("cursor","w-resize")}f.memberFrames[0].sizeRange[0].setFixedSize(o),this._setSubFramesPosition(!0)},f._handleSplitterOnMouseDown=function(t){var n=e("#"+this.myID),r=e("#"+this.getClientDivID()),i=t.pageX-r.offset().left,s=t.pageY-r.offset().top,o=this.isHorSplitter()?i:s,u=t.target.id.split("_"),a=parseInt(u[u.length-1]);if(this._canMoveSeparator(a))return this.dragSep=!0,this.dragSepNr=a,this.dragOffset=o-this.sepPosits[a],e(document).bind("mouseup",f._handleSplitterOnMouseUp),!1},f._handleSplitterOnMouseMove=function(t){var n=e("#"+this.getClientDivID()),r=t.pageX-n.offset().left,i=t.pageY-n.offset().top;if(this.dragSep){var s=this.isHorSplitter()?n.width():n.height(),o=this.isHorSplitter()?r:i;return this._calculateNewFrameSizeFractions(this.dragSepNr,o-this.dragOffset,s),this._setSubFramesPosition(!0),!1}},f._handleOnMouseDown=function(e){},f._handleOnMouseMove=function(e){},f._handleSplitterOnMouseUp=function(t){e(document).unbind("mouseup",f._handleSplitterOnMouseUp),f.dragSep&&(f._setSubFramesPosition(!1),f.getFrameContainer().notifyLayoutChanged()),f.dragSep=!1},f._calculateFramePositions=function(e){var t=0;this.sepPosits=[];var n=[];for(var r=0;r<this.memberFrames.length;r++){r>0&&this.sepPosits.push(t);var i=t+e*this.memberFrames[r].mySizeWeight,s=Math.round(t+(r>0?this._separatorSize/2:0)),o=Math.round(i-(r<this.memberFrames.length-1?this._separatorSize/2:0));n.push({pos1:s,pos2:o}),t=i}return n},f._calculateNewFrameSizeFractions=function(e,t,n){var r=[],i=0;for(var s=0;s<this.memberFrames.length;s++)i+=this.memberFrames[s].mySizeWeight*n,r.push(i);r[e]=t;var o=0;for(var s=0;s<this.memberFrames.length;s++)this.memberFrames[s].mySizeWeight=Math.max(1e-9,(r[s]-o)/n),o=r[s];this._adjustFrameSizeFractions(n)},f._adjustFrameSizeFractions=function(e){var t=[],n=[],r=[];for(var i=0;i<this.memberFrames.length;i++)t.push(this.memberFrames[i].mySizeWeight*e),n.push(this.memberFrames[i]._getMinSize(this.splitterDim())),r.push(this.memberFrames[i]._getMaxSize(this.splitterDim()));var s=!0;for(var o=0;o<5&&s;o++){s=!1;for(var u=0;u<this.memberFrames.length;u++){if(t[u]<n[u]-1){var a=n[u]-t[u];t[u]+=a;for(var i=0;i<this.memberFrames.length;i++)i!=u&&(t[i]-=a/(this.memberFrames.length-1));s=!0}if(t[u]>r[u]+1){var a=r[u]-t[u];t[u]+=a;for(var i=0;i<this.memberFrames.length;i++)i!=u&&(t[i]-=a/(this.memberFrames.length-1));s=!0}}}for(var u=0;u<this.memberFrames.length;u++)this.memberFrames[u].mySizeWeight=Math.max(1e-9,t[u]/e)},f._setSubFramesPosition=function(t){this._executeInitialisers();var n=e("#"+this.myID);this._setPosition(n.position().left,n.position().top,n.width(),n.height(),!0,!1,t),this._executePostInitialisers()},f._executeInitialisers=function(){for(var e=0;e<this.memberFrames.length;e++){var t=!1;this.isStacker()&&e!=this.activeTabNr&&(t=!0),t||this.memberFrames[e]._executeInitialisers()}this._initialised||(this._initialised=!0,this._handleInitialise&&this._handleInitialise())},f._executePostInitialisers=function(){for(var e=0;e<this.memberFrames.length;e++){var t=!1;this.isStacker()&&e!=this.activeTabNr&&(t=!0),t||this.memberFrames[e]._executePostInitialisers()}this._postInitialised||(this._postInitialised=!0,this.myClientObject&&this.myClientObject.execPostInitialise())},f._setPosition=function(t,n,r,i,s,o,u){var a=e("#"+this.myID);s||(a.css("position","absolute"),a.css("left",t+"px"),a.css("top",n+"px"),a.css("width",r+"px"),a.css("height",i+"px"));var l=r-this.marginRight-this.marginLeft,c=i-this.getTitleBarHeight()-this.marginBottom-this.marginTop;if(!s){var h=e("#"+this.getClientContainerDivID());h.css("position","absolute"),h.css("left","0px"),h.css("top",this.getTitleBarHeight()+"px"),h.css("width",r+"px"),h.css("height",i-this.getTitleBarHeight()+"px");var p=e("#"+this.getClientDivID());p.css("position","absolute"),p.css("left",this.marginLeft+"px"),p.css("top",this.marginTop+"px"),p.css("width",l+"px"),p.css("height",c+"px")}!this._initialised&&!o&&(this._initialised=!0,this._handleInitialise&&this._handleInitialise());var d=0;for(var v=0;v<this.memberFrames.length;v++)d+=this.memberFrames[v].mySizeWeight;for(var v=0;v<this.memberFrames.length;v++)this.memberFrames[v].mySizeWeight/=d;if(this.isHorSplitter()){this._adjustFrameSizeFractions(l),this.sepPosits=[];var m=f._calculateFramePositions(l);for(var v=0;v<this.memberFrames.length;v++){this.memberFrames[v]._setPosition(m[v].pos1,0,m[v].pos2-m[v].pos1+1,c,!1,o,u);if(v<this.memberFrames.length-1){var g=e("#"+this.getSeparatorDivID(v));g.css("position","absolute"),g.css("left",m[v].pos2+this.marginLeft+"px"),g.css("top",this._getMarginTop()+"px"),g.css("width",this._separatorSize+"px"),g.css("height",c+"px")}}}if(this.isVertSplitter()){this._adjustFrameSizeFractions(c),this.sepPosits=[];var m=f._calculateFramePositions(c);for(var v=0;v<this.memberFrames.length;v++){this.memberFrames[v]._setPosition(0,m[v].pos1,l,m[v].pos2-m[v].pos1+1,!1,o,u);if(v<this.memberFrames.length-1){var g=e("#"+this.getSeparatorDivID(v));g.css("position","absolute"),g.css("top",m[v].pos2+this._getMarginTop()+"px"),g.css("left",this.marginLeft+"px"),g.css("height",this._separatorSize+"px"),g.css("width",l+"px")}}}if(this.isStacker()){var y=0;this.hasTabs()&&(y=30),e("#"+this.getClientDivID()+"_tabbody").css("height",c-y-17);for(var v=0;v<this.memberFrames.length;v++)this.memberFrames[v]._setPosition(0,y,l,c-y,!1,o||v!=this.activeTabNr,u)}s||this.isStacker()&&this._createTabItems(),this.isFinalPanel()&&(this.scrollHelper&&this.scrollHelper.update(),this.myClientObject!=null?this.myClientObject.handleResize(u):this._needUpdateSize=!0)},f._updateSize=function(){for(var e=0;e<this.memberFrames.length;e++)this.memberFrames[e]._updateSize();this.isFinalPanel()&&this._needUpdateSize&&(this._needUpdateSize=!1,this.myClientObject!=null&&this.myClientObject.handleResize())},f.applyOnPanels=function(e){for(var t=0;t<this.memberFrames.length;t++)this.memberFrames[t].applyOnPanels(e);this.isFinalPanel()&&this.myClientObject!=null&&e(this.myClientObject)},f.switchTab=function(e){this.isStacker()||n.reportError("Container is not a tab");if(this.getActiveTabFrameID()==e)return!1;var t=null;for(var r=0;r<this.memberFrames.length;r++)e==this.memberFrames[r].myFrameID&&(t=this.getClientDivID()+"_tab_"+r);return t||n.reportError("Tab switch: invalid end tag"),f._performSwitchTab(t),!0},f.getActiveTabFrameID=function(){return this.isStacker()||n.reportError("Container is not a tab"),this.memberFrames[this.activeTabNr].myFrameID},f.modifyDisplayTitle=function(t){e("#"+this.getVisibleTitleDivID()).find(".DQXTitleLeftPart").text(t)},f.isVisible=function(){var e=this;while(e._parentFrame!=null){if(e._parentFrame.isStacker()&&e._parentFrame.getActiveTabFrameID()!=e.myFrameID)return!1;e=e._parentFrame}return!0},f.makeVisible=function(){if(this.isVisible())return;var e=this,t=[];while(e._parentFrame!=null)e._parentFrame.isStacker()&&t.unshift(e),e=e._parentFrame;u.__ignoreSwitchTab=!0;for(var n=0;n<t.length;n++)t[n]._parentFrame.switchTab(t[n].myFrameID);u.__ignoreSwitchTab=!1;if(t.length>0){var e=t[t.length-1];i.broadcast({type:"ChangeTab",id:e._parentFrame},e.myFrameID)}return this.myClientObject!=null&&this.myClientObject.handleResize(),!0},f.setContentHtml=function(t){this.checkFinalPanel(),e("#"+this.getClientDivID()).html(t),n.ExecPostCreateHtml()},f.setContentStaticDiv=function(t){this.checkFinalPanel();var r=e("#"+t).html();e("#"+this.getClientDivID()).html(n.interpolate(r))},f._onChangeTab=function(e){i.broadcast({type:"ChangeTab",id:this.myFrameID},this.getActiveTabFrameID())},f.notifyContentChanged=function(){f.scrollHelper&&f.scrollHelper.update()},f},a.FrameFullWindow=function(t){var r={};return r.frameRoot=t,r.frameRoot._frameContainer=r,r.getFrameRoot=function(){return this.frameRoot},r._handleResize=function(){var t=e("#"+r.frameRoot.myID).parent(),n=t.attr("id"),i=t.get(0).tagName,s=t.innerWidth(),o=t.innerHeight();r.frameRoot._executeInitialisers(),r.frameRoot._setPosition(0,0,s,o,!1,!1,!1),r.frameRoot._executePostInitialisers()},r.notifyLayoutChanged=function(){},r._updateSize=function(){r.frameRoot&&r.frameRoot._updateSize(),setTimeout(r._updateSize,100)},r._updateSize(),r.render=function(t){var i=r.frameRoot._createElements(1).toString();e("#"+t).length==0&&n.reportError("Invalid element "+t),e("#"+t).html(i),r.frameRoot._postCreateHTML(),e(window).resize(r._handleResize),r._handleResize()},r},a.ViewSet=function(e,t){var r={};return e||n.reportError("Invalid frame"),r._myFrame=e,r._myStateID=t,r.registerView=function(){u.addView(this)},r.getStateID=function(){return this._myStateID},r.getFrame=function(){return this._myFrame},r.getStateKeys=function(){var e={};return e[this._myStateID]=null,e},r.activateState=function(){n.reportError("View does not implement activateState")},r._initialisePanels=function(){r.createPanels||n.reportError("View set does not have createPanels function"),r.createPanels()},r._myFrame.setInitialiseFunction(r._initialisePanels),r},a.Form=function(t,r){var i=o(t,r);return i._content=s.CompoundHor([]),i._padding=0,i._panelfirstRendered=!1,i.clear=function(){i._content.clear()},i.setPadding=function(e){return this._padding=e,i},i.addControl=function(e){return n.requireMemberFunction(e,"getID"),i._content.addControl(e),e},i.addHtml=function(e){i._content.addControl(s.Label(e))},i._getInnerDivID=function(){return this.getDivID()+"Inner"},i.render=function(){i._panelfirstRendered=!0;var t=i._content.renderHtml();t='<div id="'+this._getInnerDivID()+'" style="padding:'+this._padding+'px">'+t+"</div>",e("#"+this.getDivID()).html(t),this.content=t,i._content.postCreateHtml(),n.ExecPostCreateHtml(),this.myParentFrame.notifyContentChanged(),this.myParentFrame.autoSizeY&&setTimeout(i.myParentFrame.getFrameContainer()._handleResize,100)},i.getAutoSizeY=function(){var e=document.getElementById(this._getInnerDivID());return e?e.offsetHeight:0},i.handleResize=function(){},i.tearDown=function(){i._content.tearDown()},i},t.registerHelper("control",function(e,n){return new t.SafeString(e(n).renderHtml())}),t.registerHelper("pluralise",function(e,t){return n.pluralise(e,t)}),a.TemplateFrame=function(r,i,s){var u=o(r);return u.compiled_template=null,u.need_render=!1,s?e.ajax({url:"scripts/Views/Templates/"+i+".handlebars",dataType:"text",success:function(e){u.compiled_template=t.compile(e),u.need_render&&u.render(u.need_render)}}).fail(function(){n.reportError("Error fetching template resource "+i)}):u.compiled_template=t.compile(i),u.render=function(t){if(u.compiled_template){var r=n.interpolate(u.compiled_template(t||{}));e("#"+u.getDivID()).html(r),n.ExecPostCreateHtml(),u.myParentFrame.notifyContentChanged(),u.myParentFrame.autoSizeY&&setTimeout(u.myParentFrame.getFrameContainer()._handleResize,500)}else u.need_render=t},u.handleResize=function(){},u},a}),define("DQX/PopupFrame",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/Framework","DQX/Popup"],function(e,t,n,r,i,s){var o={};return o._settingsHistory={},o.hasThumbNails=!1,o.activeList=[],o.setHasThumbNails=function(){o.hasThumbNails=!0},o.setFrameSettingsHistory=function(e,t){o._settingsHistory[e]||(o._settingsHistory[e]={}),o._settingsHistory[e].frameSettings=t},o.minimiseAll=function(t){e.each(o.activeList,function(e,n){n.minimise(t)})},o.PopupFrame=function(r,u){t.checkIsString(r),t.requireMember(u,"title");var a={};a.typeID=r,a.frameRoot=i.FrameGeneric(""),a.frameRoot._frameContainer=a,a.getFrameRoot=function(){return this.frameRoot},a.maximised=!1,a.minimised=!1,a.frameRoot.setFrameClass("DQXLightFrame"),a._title="Frame",u.title&&(a._title=u.title),a._icon=null,u.icon&&(a._icon=u.icon),a._sizeX=800,u.sizeX&&(a._sizeX=u.sizeX),a._sizeY=600,u.sizeY&&(a._sizeY=u.sizeY),a.blocking=!1,u.blocking&&(a.blocking=u.blocking);if(a.typeID in o._settingsHistory){var f=o._settingsHistory[a.typeID];a._sizeX=f.sizeX,a._sizeY=f.sizeY}else{var f={};o._settingsHistory[a.typeID]=f}return a._sizeX=Math.min(a._sizeX,t.getWindowClientW()-50),a._sizeY=Math.min(a._sizeY,t.getWindowClientH()-70),a._minSizeX=180,u.minSizeX&&(a._minSizeX=u.minSizeX),a._minSizeY=180,u.minSizeY&&(a._minSizeY=u.minSizeY),f.sizeX=a._sizeX,f.sizeY=a._sizeY,t._popupIndex++,a.ID="DXPopup"+t._popupIndex,a.posX=70,a.posY=88,"posX"in f&&(a.posX=f.posX),"posY"in f&&(a.posY=f.posY),e(".DQXPopupFrame").each(function(t,n){a.posX==e(this).position().left&&a.posY==e(this).position().top&&(a.posX+=25,a.posY+=25)}),a.posX=Math.min(a.posX,t.getWindowClientW()-a._sizeX-10),a.posY=Math.min(a.posY,t.getWindowClientH()-40),a._tools=[],a.addTool=function(e,t){a._tools.push({icon:e,handler:t})},a.onClose=function(){},a.createFrames=function(){t.reportError("Please override createFrames")},a.createPanels=function(){t.reportError("Please override createPanels")},a.create=function(){a.createFrames(a.frameRoot),a.render(),a.createPanels(),a.getFrameRoot().applyOnPanels(function(e){e._panelfirstRendered==0&&e.render()})},a.render=function(){if(a.blocking){var r=n.Div({id:"BlockingBackGround"});r.addStyle("position","absolute"),r.addStyle("left","0px"),r.addStyle("top","0px"),r.addStyle("width","100%"),r.addStyle("height","100%");var i="rgba(100,100,100,0.4)";r.addStyle("background-color",i),r.addStyle("z-index","2000"),e("#DQXUtilContainer").append(r.toString()),e("#BlockingBackGround").mousedown(function(t){t.target.id=="BlockingBackGround"&&(e("#BlockingBackGround").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#BlockingBackGround").css("background-color",i),setTimeout(function(){e("#BlockingBackGround").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#BlockingBackGround").css("background-color",i)},150)},150)},150))})}"frameSettings"in f&&a.frameRoot.settingsStreamIn(f.frameSettings);var u=n.Div({id:a.ID});u.setCssClass("DQXPopupFrame"),u.addStyle("position","absolute"),u.addStyle("left",this.posX+"px"),u.addStyle("top",this.posY+"px");var l=n.Div({id:a.ID+"Handler",parent:u});l.setCssClass("DQXPopupFrameHeader DQXDragHeader"),a._icon&&l.addElem('<span class="fa {icon}" style="font-size:24px;position:relative;left:-5px;top:-4px;vertical-align: text-top"></span>'.DQXformat({icon:a._icon})),l.addElem(t.interpolate(this._title));var c=n.Div({id:a.ID+"Body",parent:u});c.setCssClass("DQXPopupFrameContent"),c.addStyle("width",a._sizeX+"px"),c.addStyle("height",a._sizeY+"px"),c.addStyle("position","relative"),s._floatBoxMaxIndex++,u.addStyle("z-index",s._floatBoxMaxIndex);var h=a.frameRoot._createElements(1).toString();c.addElem(h);var p=n.JavaScriptBitmaplink(t.BMP("close2.png"),"Close","");p.addAttribute("id",a.ID+"closeButton"),u.addElem(p),p.addStyle("position","absolute"),p.addStyle("right","-13px"),p.addStyle("top","-13px");var d=20,v=n.JavaScriptBitmaplinkTransparent(t.BMP("maximize.png"),"Maximise","");v.addAttribute("id",a.ID+"maximiseButton"),u.addElem(v),v.addStyle("position","absolute"),v.addStyle("right",d+"px"),v.addStyle("top","2px"),d+=30;if(o.hasThumbNails&&!a.blocking){var m=n.JavaScriptBitmaplinkTransparent(t.BMP("minimize.png"),"Minimise","");m.addAttribute("id",a.ID+"minimiseButton"),u.addElem(m),m.addStyle("position","absolute"),m.addStyle("right",d+"px"),m.addStyle("top","2px"),d+=30}e.each(a._tools,function(e,r){r.id="DQXPopupFrameTool"+t.getNextUniqueID();var i=n.Span({id:r.id,parent:u});i.addElem('<span style="font-size: 18px" class="fa {icon} DQXPopupFrameTool"></span>'.DQXformat({icon:r.icon})),i.addStyle("position","absolute"),i.addStyle("right",d+"px"),i.addStyle("top","6px"),d+=30});var g=n.Div({parent:u});g.setCssClass("DQXPopupFrameResizer DQXPopupFrameResizer1");var g=n.Div({parent:u});g.setCssClass("DQXPopupFrameResizer DQXPopupFrameResizer2");var y=u.toString();a.blocking?e("#BlockingBackGround").append(y):e("#DQXUtilContainer").append(y),e("#"+a.ID+"closeButton").click(e.proxy(a.close,a)),e("#"+a.ID+"maximiseButton").click(a.maximise),e("#"+a.ID+"minimiseButton").click(a.minimise),e.each(a._tools,function(t,n){e("#"+n.id).click(n.handler)}),e("#"+a.ID).find(".DQXPopupFrameResizer").mousedown(e.proxy(a._onResizeMouseDown,a)),a.frameRoot._postCreateHTML(),a._handleResize(!1),t.ExecPostCreateHtml(),s.makeDraggable(a.ID);if(o.hasThumbNails&&!a.blocking){a.thumbNailId=a.ID+"_minimisedThumbNail";var b='<div class="DQXThumbNail" style="position:relative" id="{id}">{title}<img id="{closeboxid}" SRC="{closebmp}" style="position:absolute;right:0px;top:0px;"/></div>'.DQXformat({id:a.thumbNailId,title:a._title,closebmp:t.BMP("closeSmall.png"),closeboxid:a.thumbNailId+"_closebox"});e(".DQXThumbNailBox").append(b),e("#"+a.thumbNailId+"_closebox").mousedown(function(e){return a.close(),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),0}),e("#"+a.thumbNailId).click(function(t){return a.minimised?a.restore():o.getTopLevelPopup()==a?a.minimise():(s._floatBoxMaxIndex++,e("#"+a.ID).css("z-index",s._floatBoxMaxIndex)),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),0}),a.animateTransition(e("#"+a.thumbNailId),e("#"+a.ID))}},a.notifyLayoutChanged=function(){o._settingsHistory[a.typeID].frameSettings=this.frameRoot.settingsStreamOut()},a.maximise=function(){a.maximised=!a.maximised,a.maximised?a.animateTransition(e("#"+a.ID),e("body"),function(){a.unMaximisedPosX=e("#"+a.ID).position().left,a.unMaximisedPosY=e("#"+a.ID).position().top,a.unMaximisedSizeX=a._sizeX,a.unMaximisedSizeY=a._sizeY,newSizeX=t.getWindowClientW()-10,newSizeY=t.getWindowClientH()-50,a._sizeX=e("#"+this.ID+"Body").width(),a._sizeY=e("#"+this.ID+"Body").height(),e("#"+a.ID).offset({top:5,left:0}),e("#"+a.ID+"Body").width(newSizeX),e("#"+a.ID+"Body").height(newSizeY),a._handleResize(!1)}):(e("#"+a.ID).offset({left:a.unMaximisedPosX,top:a.unMaximisedPosY}),e("#"+a.ID+"Body").width(a.unMaximisedSizeX),e("#"+a.ID+"Body").height(a.unMaximisedSizeY),a._sizeX=a.unMaximisedSizeX,a._sizeY=a.unMaximisedSizeY,a.animateTransition(e("body"),e("#"+a.ID)),a._handleResize(!1))},a.animateTransition=function(r,i,o,u){var a="_transientAnim_"+t.getNextUniqueID(),f=r.position().left,l=r.position().top,c=r.width(),h=r.height(),p=i.position().left,d=i.position().top,v=i.width(),m=i.height(),g=n.Div({id:a});g.addStyle("position","absolute"),g.addStyle("left",f+"px"),g.addStyle("top",l+"px"),g.addStyle("width",c+"px"),g.addStyle("height",h+"px"),g.addStyle("border","4px solid black"),g.addStyle("z-index",s._floatBoxMaxIndex+1),e("#DQXUtilContainer").append(g.toString());var y=250;u&&u.slow&&(y=500),e("#"+a).animate({left:p+"px",top:d+"px",width:v+"px",height:m+"px"},y,function(){e("#"+a).remove(),o&&o()})},a.minimise=function(t){if(a.minimised)return;a.minimised=!0,a.animateTransition(e("#"+a.ID),e("#"+a.thumbNailId),function(){e("#"+a.thumbNailId).addClass("DQXThumbNailMinimised")},t),e("#"+a.ID).hide()},a.restore=function(){a.minimised&&(a.minimised=!1,e("#"+a.ID).css("opacity",0),e("#"+a.ID).show(),s._floatBoxMaxIndex++,e("#"+a.ID).css("z-index",s._floatBoxMaxIndex),e("#"+a.thumbNailId).removeClass("DQXThumbNailMinimised"),a.animateTransition(e("#"+a.thumbNailId),e("#"+a.ID),function(){e("#"+a.ID).css("opacity",1)}))},a.close=function(){var t=o._settingsHistory[a.typeID];!a.maximised&&!a.minimised&&(t.posX=e("#"+a.ID).position().left,t.posY=e("#"+a.ID).position().top),t.frameSettings=this.frameRoot.settingsStreamOut(),e("#"+a.ID).remove(),e("#BlockingBackGround").remove(),a.onClose(),a.frameRoot.applyOnPanels(function(e){e.tearDown&&e.tearDown()}),o.hasThumbNails&&e("#"+a.thumbNailId).remove();var n=-1;e.each(o.activeList,function(e,t){t.ID==a.ID&&(n=e)}),n>=0&&o.activeList.splice(n,1)},a._onResizeMouseDown=function(t){return e(document).bind("mouseup.PopupFrameResize",e.proxy(a._onResizeMouseUp,a)),e(document).bind("mousemove.PopupFrameResize",e.proxy(a._onResizeMouseMove,a)),this._resizeX0=t.pageX,this._resizeY0=t.pageY,this._resizeW0=e("#"+this.ID+"Body").width(),this._resizeH0=e("#"+this.ID+"Body").height(),this._oldBoxShadow=e("#"+this.ID).css("box-shadow"),e("#"+this.ID).css("box-shadow","none"),!1},a._onResizeMouseUp=function(t){return e(document).unbind("mouseup.PopupFrameResize"),e(document).unbind("mousemove.PopupFrameResize"),e("#"+this.ID).css("box-shadow",this._oldBoxShadow),this._handleResize(!1),!1},a._onResizeMouseMove=function(n){if(!a.maximised){var r=this._resizeW0+n.pageX-this._resizeX0,i=this._resizeH0+n.pageY-this._resizeY0;r=Math.max(r,this._minSizeX),i=Math.max(i,this._minSizeY),r=Math.min(r,t.getWindowClientW()-50),i=Math.min(i,t.getWindowClientH()-50),e("#"+this.ID+"Body").width(r),e("#"+this.ID+"Body").height(i),this._sizeX=r,this._sizeY=i;var s=o._settingsHistory[this.typeID];s.sizeX=this._sizeX,s.sizeY=this._sizeY,this._handleResize(!0)}return!1},a._handleResize=function(t){var n=e("#"+a.ID+"Body"),r=n.attr("id"),i=n.get(0).tagName,s=n.innerWidth(),o=n.innerHeight();a.frameRoot._executeInitialisers(),a.frameRoot._setPosition(0,0,s,o,!1,!1,t),a.frameRoot._executePostInitialisers()},o.activeList.push(a),a},o.getTopLevelPopup=function(){var t=0,n=null;return e.each(o.activeList,function(r,i){if(!i.minimised){var s=parseInt(e("#"+i.ID).css("z-index"));s>t&&(t=s,n=i)}}),n},o}),define("DQX/Application",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/Framework","DQX/HistoryManager","DQX/Controls","DQX/PopupFrame"],function(e,t,n,r,i,s,o,u){var a={};return a._initialised=!1,a._customNavigationButtons=[],a._views=[],a._viewMap={},a._showViewsAsTabs=!1,a._headerHeight=60,a._addView=function(e){e.getStateID()in a._viewMap&&t.reportError("Duplicate view id: "+e.getStateID()),a._views.push(e),a._viewMap[e.getStateID()]=e},a.setHeaderHeight=function(e){a._headerHeight=e},a.setHeader=function(e){a._checkNotInitialised(),a._headerHtml=e},a.addNavigationButton=function(e,t,n,r){a._customNavigationButtons.push({name:e,bitmap:t,width:n,handler:r})},a.showViewsAsTabs=function(){a._showViewsAsTabs=!0},a.customInitFunction=function(e){e()},a.init=function(n){a.title=n;if(!Modernizr.canvas||!Modernizr.canvastext||!Modernizr.svg){var r=e("#OldBrowser").html();r||(r="<b>Fatal error:</b> This browser is outdated and does not support the features necessary to run this application"),e("#Div1").html(r);return}a.startupParams={};var i=window.location.search.substring(1).split("&");for(var s=0;s<i.length;s++)if(i[s]){var o=i[s].split("=");a.startupParams[o[0]]=o[1]}t.Init(),setTimeout(function(){a._createFrameWork1(),a._initialised=!0})},a.getViewList=function(){return a._views},a.getView=function(e){return a._viewMap[e]||t.reportError("Invalid view "+e),a._viewMap[e]},a.activateView=function(e){e in a._viewMap||t.reportError("Invalid view id: "+e),a._viewMap[e].activateState()},a._createFrameWork1=function(){a.frameWindow=i.FrameFullWindow(i.FrameGroupVert("")),a.frameRoot=a.frameWindow.getFrameRoot(),a.frameRoot.setMargins(0).setSeparatorSize(0),a.frameHeaderIntro=a.frameRoot.addMemberFrame(i.FrameFinal("HeaderIntro",1)).setFixedSize(i.dimY,a._headerHeight).setFrameClassClient("DQXPage").setMargins(0).setAllowScrollBars(!1,!1),a._showViewsAsTabs?a.frameBody=a.frameRoot.addMemberFrame(i.FrameGroupTab("info",1)):a.frameBody=a.frameRoot.addMemberFrame(i.FrameGroupStack("info",1)).setAnimateTransition(),e.each(a._views,function(e,t){t._myFrame=a.frameBody.addMemberFrame(i.FrameGeneric(t.getStateID(),1)).setFrameClass("DQXClient").setDisplayTitle(t._myTitle).setDisplayTitle2(a.title).setMargins(0).setFrameClass("DQXFrame"),t.createFrames(t._myFrame),t._doEarlyInitialisation||t._myFrame.setInitialiseFunction(t._initialisePanels)}),r.listen("",{type:"ChangeTab",id:a.frameBody.getFrameID()},function(e,t){a.getView(t).onBecomeVisible()}),a.customInitFunction(a._createFramework2)},a._createFramework2=function(){a.frameWindow.render("Div1"),a.frameHeaderIntro.setContentHtml(a._headerHtml),a._createNavigationSection(),t.initPostCreate(),s.init(),e.each(a._views,function(e,t){t._doEarlyInitialisation&&t._initialisePanels()})},a._checkNotInitialised=function(){a._initialised&&t.reportError("Application is already initialised")},a._createNavigationButton=function(e,t,n,r,i,s,u){if(n.indexOf("fa-")===0)var a=o.Button(e,{icon:n,content:r,buttonClass:i,width:s,height:30});else var a=o.Button(e,{bitmap:n,content:r,buttonClass:i,width:s,height:30});a.setOnChanged(u),t.addElem(a.renderHtml())},a._createNavigationSection=function(){var i=n.Div();i.addStyle("position","absolute"),i.addStyle("right","0px"),i.addStyle("top","0px"),i.addStyle("padding-top","0px"),i.addStyle("padding-right","0px"),this._createNavigationButton("HeaderHome",i,"fa-home","Start","DQXToolButton3",70,function(){r.send({type:"Home"})}),e.each(a._customNavigationButtons,function(e,t){a._createNavigationButton("",i,t.bitmap,t.name,"DQXToolButton3",t.width,t.handler)}),e("#Div1").append(i.toString()),t.ExecPostCreateHtml(),r.listen("",{type:"Home"},function(){u.minimiseAll(),s.setState(a._views[0].getStateKeys())}),r.listen("",{type:"Back"},function(){s.back()})},a.View=function(e,n){var r={};return r._myID=e,r._myTitle=n,r._myFrame=null,r._doEarlyInitialisation=!1,r.setEarlyInitialisation=function(){r._doEarlyInitialisation=!0},r.getStateID=function(){return this._myID},r.getFrame=function(){return r._myFrame},r._initialisePanels=function(){r.createPanels(),r._myFrame.applyOnPanels(function(e){e._panelfirstRendered==0&&e.render()})},r.getStateKeys=function(){var e={};return e[this._myID]=null,e},r.activateState=function(){r._myFrame.makeVisible(),setTimeout(function(){r._myFrame.applyOnPanels(function(e){e.handleResize&&e.handleResize()})},50)},r.isActive=function(){return r._myFrame.isVisible()},r.createActivationButton=function(e){var t=100;e.width&&(t=e.width);var n=o.Button(null,{buttonClass:"DQXToolButton2",content:e.content,bitmap:e.bitmap,icon:e.icon,width:t,height:35});return n.setOnChanged(function(){a.activateView(r._myID)}),n},r.createFrames=function(){t.reportError("Please override createFrames")},r.createPanels=function(){t.reportError("Please override createPanels")},r.onBecomeVisible=function(){},a._addView(r),s.addView(r),r},a}),define("DQX/base64",[],function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",encode:function(t){var n="",r,i,s,o,u,a,f,l=0;t=e._utf8_encode(t);while(l<t.length)r=t.charCodeAt(l++),i=t.charCodeAt(l++),s=t.charCodeAt(l++),o=r>>2,u=(r&3)<<4|i>>4,a=(i&15)<<2|s>>6,f=s&63,isNaN(i)?a=f=64:isNaN(s)&&(f=64),n=n+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)+this._keyStr.charAt(f);return n},decode:function(t){var n="",r,i,s,o,u,a,f,l=0;while(l<t.length)o=this._keyStr.indexOf(t.charAt(l++)),u=this._keyStr.indexOf(t.charAt(l++)),a=this._keyStr.indexOf(t.charAt(l++)),f=this._keyStr.indexOf(t.charAt(l++)),r=o<<2|u>>4,i=(u&15)<<4|a>>2,s=(a&3)<<6|f,n+=String.fromCharCode(r),a!=64&&(n+=String.fromCharCode(i)),f!=64&&(n+=String.fromCharCode(s));return n=e._utf8_decode(n),n},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode:function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}};return e}),define("DQX/SQL",["jquery","DQX/DocEl","DQX/base64"],function(e,t,n){var r={};return r.DataTypes=["String","Float","Integer","MultiChoiceInt"],r.TableColInfo=function(e,t,n,r){var i={};return i.ID=e,i.name=t,i.datatype=n,i.choicelist=r,i.content2Display=function(e){return e.toString()},i.display2Content=function(e){return e},i.isNumerical=function(){return this.datatype=="Float"||this.datatype=="Integer"},i.isMultipleCoice=function(){return this.datatype=="MultiChoiceInt"||this.choicelist&&this.choicelist.length>0},i},r.WhereClause={},r.WhereClause.whcClassGenerator={},r.WhereClause._fieldComparisonOperators=[{ID:"=",name:"Equals",String:!0,Float:!0,Integer:!0,MultiChoiceInt:!0,Create:function(){return r.WhereClause.CompareFixed("","=","")}},{ID:"<>",name:"Differs from",String:!0,Float:!0,Integer:!0,MultiChoiceInt:!0,Create:function(){return r.WhereClause.CompareFixed("","<>","")}},{ID:"<",name:"<",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareFixed("","<","")}},{ID:">",name:">",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareFixed("",">","")}},{ID:"<=",name:"<=",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareFixed("","<=","")}},{ID:">=",name:">=",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareFixed("",">=","")}},{ID:"between",name:"Between",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareBetween("","","")}},{ID:"CONTAINS",name:"Contains",String:!0,Create:function(){return r.WhereClause.CompareFixed("","CONTAINS","")}},{ID:"NOTCONTAINS",name:"Does not contain",String:!0,Create:function(){return r.WhereClause.CompareFixed("","NOTCONTAINS","")}},{ID:"STARTSWITH",name:"Starts with",String:!0,Create:function(){return r.WhereClause.CompareFixed("","STARTSWITH","")}},{ID:"LIKE",name:"Like",String:!0,Create:function(){return r.WhereClause.CompareFixed("","LIKE","")}},{ID:"ISPRESENT",name:"Is present",MultiChoiceInt:!0,Float:!0,Integer:!0,Create:function(){return r.WhereClause.IsPresent()}},{ID:"ISABSENT",name:"Is absent",MultiChoiceInt:!0,Float:!0,Integer:!0,Create:function(){return r.WhereClause.IsAbsent()}},{ID:"ISNOTEMPTYSTR",name:"Is present",String:!0,Create:function(){return r.WhereClause.IsNotEmptyStr()}},{ID:"ISEMPTYSTR",name:"Is absent",String:!0,Create:function(){return r.WhereClause.IsEmptyStr()}},{ID:"=FIELD",name:"Equals field",MultiChoiceInt:!0,String:!0,Float:!0,Integer:!0,Create:function(){return r.WhereClause.EqualsField()}},{ID:"<>FIELD",name:"Differs from field",MultiChoiceInt:!0,String:!0,Float:!0,Integer:!0,Create:function(){return r.WhereClause.DiffersField()}},{ID:"<FIELD",name:"< Field",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareField("<FIELD")}},{ID:">FIELD",name:"> Field",Float:!0,Integer:!0,Create:function(){return r.WhereClause.CompareField(">FIELD")}},{ID:"_subset_",name:"in subset",Create:function(){return r.WhereClause.InSubset()}},{ID:"_note_",name:"has note containing",Create:function(){return r.WhereClause.NoteContains()}}],r.WhereClause.getFieldComparisonOperatorInfo=function(e){for(var t in r.WhereClause._fieldComparisonOperators){var n=r.WhereClause._fieldComparisonOperators[t];if(n.ID==e)return n}DQX.reportError("Invalid field comparison operator id "+e)},r.WhereClause.getCompatibleFieldComparisonOperators=function(e){var t=[];for(var n in r.WhereClause._fieldComparisonOperators){var i=r.WhereClause._fieldComparisonOperators[n];i[e]&&t.push(i)}return t},r.WhereClause.whcClassGenerator.comparefixed=function(e){return r.WhereClause.CompareFixed(e.ColName,e.Tpe,e.CompValue)},r.WhereClause.CompareFixed=function(n,i,s){var o={},u=!1;for(var a=0;a<r.WhereClause._fieldComparisonOperators.length;a++)r.WhereClause._fieldComparisonOperators[a].ID==i&&(u=!0);return u||DQX.reportError("Invalid comparison where clause statement: "+icompoundtype),o.whcClass="comparefixed",o.isCompound=!1,o.ColName=n,o.Tpe=i,o.CompValue=s,o._buildStatement=function(e,n,r){if(!r.hasColumn(this.ColName))return;var i=r.getColumn(this.ColName);if(i.isMultipleCoice()){var s=t.Div();s.addStyle("display","inline-block"),s.setCssClass("DQXSelectWrapper");var o=t.Select(i.choicelist,this.CompValue,{parent:s});o.setID(r.getControlID(e,"Content")),o.setWidthPx(150),o.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(o,e),n.addElem(s);return}var u=t.Edit(i.content2Display(this.CompValue));u.setID(r.getControlID(e,"Content")),u.setWidthPx(140),u.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(u,e),n.addElem(u)},o._fetchStatementContent=function(t,n){if(this.ColName=="_subset_"||this.ColName=="_note_")DQX.reportError("Invalid query component content");else{var r=n.getColumn(this.ColName);e("#"+n.getControlID(t,"Content")).length>0&&(this.CompValue=r.display2Content(e("#"+n.getControlID(t,"Content")).val()))}},o.toQueryDisplayString=function(e,t){return e.fieldInfoMap[o.ColName].name+" "+o.Tpe+" "+e.fieldInfoMap[o.ColName].toDisplayString(o.CompValue)},o},r.WhereClause.whcClassGenerator.between=function(e){return r.WhereClause.CompareBetween(e.ColName,e.CompValueMin,e.CompValueMax)},r.WhereClause.CompareBetween=function(n,r,i){var s={};return s.whcClass="between",s.isCompound=!1,s.ColName=n,s.CompValueMin=r,s.CompValueMax=i,s.Tpe="between",s._buildStatement=function(e,n,r){if(!r.hasColumn(this.ColName))return;var i=r.getColumn(this.ColName),s=t.Edit(i.content2Display(this.CompValueMin));s.setID(r.getControlID(e,"ContentMin")),s.setWidthPx(140),s.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(s,e),n.addElem(s),n.addElem(" and ");var s=t.Edit(i.content2Display(this.CompValueMax));s.setID(r.getControlID(e,"ContentMax")),s.setWidthPx(140),s.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(s,e),n.addElem(s)},s._fetchStatementContent=function(t,n){var r=n.getColumn(this.ColName);e("#"+n.getControlID(t,"ContentMin")).length>0&&(this.CompValueMin=r.display2Content(e("#"+n.getControlID(t,"ContentMin")).val())),e("#"+n.getControlID(t,"ContentMax")).length>0&&(this.CompValueMax=r.display2Content(e("#"+n.getControlID(t,"ContentMax")).val()))},s.toQueryDisplayString=function(e,t){return e.fieldInfoMap[s.ColName].name+" between "+e.fieldInfoMap[s.ColName].toDisplayString(s.CompValueMin)+" and "+e.fieldInfoMap[s.ColName].toDisplayString(s.CompValueMax)},s},r.WhereClause.whcClassGenerator.equalsfield=function(e){var t=r.WhereClause.EqualsField();return t.ColName=e.ColName,t.ColName2=e.ColName2,t},r.WhereClause.EqualsField=function(){var n={};return n.whcClass="equalsfield",n.isCompound=!1,n.ColName="",n.ColName2="",n.Tpe="=FIELD",n._buildStatement=function(e,n,r){var i=[];for(var s=0;s<r.myColumns.length;s++)r.myColumns[s].ID!=this.ColName&&i.push({id:r.myColumns[s].ID,name:r.myColumns[s].name});var o=t.Div();o.addStyle("display","inline-block"),o.setCssClass("DQXSelectWrapper");var u=t.Select(i,this.ColName2,{parent:o});u.setID(r.getControlID(e,"OtherField")),u.setWidthPx(150),u.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(u,e),n.addElem(o)},n._fetchStatementContent=function(t,n){e("#"+n.getControlID(t,"OtherField")).length>0&&(this.ColName2=e("#"+n.getControlID(t,"OtherField")).val())},n.toQueryDisplayString=function(e,t){return e.fieldInfoMap[n.ColName].name+" = "+e.fieldInfoMap[n.ColName2].name},n},r.WhereClause.whcClassGenerator.differsfield=function(e){var t=r.WhereClause.DiffersField();return t.ColName=e.ColName,t.ColName2=e.ColName2,t},r.WhereClause.DiffersField=function(){var n={};return n.whcClass="differsfield",n.isCompound=!1,n.ColName="",n.ColName2="",n.Tpe="<>FIELD",n._buildStatement=function(e,n,r){var i=[];for(var s=0;s<r.myColumns.length;s++)r.myColumns[s].ID!=this.ColName&&i.push({id:r.myColumns[s].ID,name:r.myColumns[s].name});var o=t.Div();o.addStyle("display","inline-block"),o.setCssClass("DQXSelectWrapper");var u=t.Select(i,this.ColName2,{parent:o});u.setID(r.getControlID(e,"OtherField")),u.setWidthPx(150),u.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(u,e),n.addElem(o)},n._fetchStatementContent=function(t,n){e("#"+n.getControlID(t,"OtherField")).length>0&&(this.ColName2=e("#"+n.getControlID(t,"OtherField")).val())},n.toQueryDisplayString=function(e,t){return e.fieldInfoMap[n.ColName].name+" <> "+e.fieldInfoMap[n.ColName2].name},n},r.WhereClause.whcClassGenerator.comparefield=function(e){var t=r.WhereClause.CompareField(e.Tpe);return t.ColName=e.ColName,t.ColName2=e.ColName2,t.Factor=e.Factor,t.Offset=e.Offset,t},r.WhereClause.CompareField=function(n){var r={};return r.whcClass="comparefield",r.isCompound=!1,r.ColName="",r.ColName2="",r.Tpe=n,r.Factor=1,r.Offset=0,r._buildStatement=function(e,n,r){var i=t.Edit(this.Factor);i.setID(r.getControlID(e,"Factor")),i.setWidthPx(50),i.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(i,e),n.addElem(i),n.addElem(" x ");var s=[];for(var o=0;o<r.myColumns.length;o++)r.myColumns[o].isNumerical()&&r.myColumns[o].ID!=this.ColName&&s.push({id:r.myColumns[o].ID,name:r.myColumns[o].name});var u=t.Div();u.addStyle("display","inline-block"),u.setCssClass("DQXSelectWrapper");var a=t.Select(s,this.ColName2,{parent:u});a.setID(r.getControlID(e,"OtherField")),a.setWidthPx(150),a.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(a,e),n.addElem(u),n.addElem(" + ");var f=t.Edit(this.Offset);f.setID(r.getControlID(e,"Offset")),f.setWidthPx(50),f.setCssClass("DQXQBQueryboxControl"),r.decorateQueryStatementControl(f,e),n.addElem(f)},r._fetchStatementContent=function(t,n){e("#"+n.getControlID(t,"Factor")).length>0&&(this.Factor=e("#"+n.getControlID(t,"Factor")).val(),this.Offset=e("#"+n.getControlID(t,"Offset")).val(),this.ColName2=e("#"+n.getControlID(t,"OtherField")).val())},r.toQueryDisplayString=function(e,t){var n=e.fieldInfoMap[r.ColName].name+" "+r.Tpe[0]+" ";if(Math.abs(r.Factor-1)>1e-9){if(r.Factor==0)var i="0";else var s=parseFloat(r.Factor),o=Math.max(0,Math.round(4-Math.log(Math.abs(s))/Math.LN10)),i=s.toFixed(o);n+=i+"x"}n+=e.fieldInfoMap[r.ColName2].name;var u=e.fieldInfoMap[r.ColName].toDisplayString(Math.abs(r.Offset));return r.Offset>0&&(n+="+"+u),r.Offset<0&&(n+="-"+u),n},r},r.WhereClause.whcClassGenerator.ispresent=function(e){var t=r.WhereClause.IsPresent();return t.ColName=e.ColName,t},r.WhereClause.IsPresent=function(){var e={};return e.whcClass="ispresent",e.isCompound=!1,e.Tpe="ISPRESENT",e._buildStatement=function(e,t,n){},e._fetchStatementContent=function(e,t){},e.toQueryDisplayString=function(t,n){return t.fieldInfoMap[e.ColName].name+" is present"},e},r.WhereClause.whcClassGenerator.isabsent=function(e){var t=r.WhereClause.IsAbsent();return t.ColName=e.ColName,t},r.WhereClause.IsAbsent=function(){var e={};return e.whcClass="isabsent",e.isCompound=!1,e.Tpe="ISABSENT",e._buildStatement=function(e,t,n){},e._fetchStatementContent=function(e,t){},e.toQueryDisplayString=function(t,n){return t.fieldInfoMap[e.ColName].name+" is absent"},e},r.WhereClause.whcClassGenerator.isstringnonempty=function(e){var t=r.WhereClause.IsNotEmptyStr();return t.ColName=e.ColName,t},r.WhereClause.IsNotEmptyStr=function(){var e={};return e.whcClass="isstringnonempty",e.isCompound=!1,e.Tpe="ISNOTEMPTYSTR",e._buildStatement=function(e,t,n){},e._fetchStatementContent=function(e,t){},e.toQueryDisplayString=function(t,n){return t.fieldInfoMap[e.ColName].name+" is present"},e},r.WhereClause.whcClassGenerator.isstringempty=function(e){var t=r.WhereClause.IsEmptyStr();return t.ColName=e.ColName,t},r.WhereClause.IsEmptyStr=function(){var e={};return e.whcClass="isstringempty",e.isCompound=!1,e.Tpe="ISEMPTYSTR",e._buildStatement=function(e,t,n){},e._fetchStatementContent=function(e,t){},e.toQueryDisplayString=function(t,n){return t.fieldInfoMap[e.ColName].name+" is absent"},e},r.WhereClause.whcClassGenerator._subset_=function(e){var t=r.WhereClause.InSubset();return t.Subset=e.Subset,t.SubsetTable=e.SubsetTable,t.PrimKey=e.PrimKey,t},r.WhereClause.InSubset=function(){var n={};return n.whcClass="_subset_",n.isCompound=!1,n.Tpe="_subset_",n.ColName="_subset_",n._buildStatement=function(r,i,s){n.SubsetTable=s.subsetTableName,n.PrimKey=s.primKey;var o=[];s.subsetList&&e.each(s.subsetList,function(e,t){o.push({id:t.id,name:t.name})});var u=t.Div();u.addStyle("display","inline-block"),u.setCssClass("DQXSelectWrapper");var a=t.Select(o,this.Subset,{parent:u});a.setID(s.getControlID(r,"Subset")),a.setWidthPx(150),a.setCssClass("DQXQBQueryboxControl"),s.decorateQueryStatementControl(a,r),i.addElem(u);var f=t.Span();f.setID(s.getControlID(r,"STable")),f.addElem(n.SubsetTable),f.addStyle("display","none"),i.addElem(f);var f=t.Span();f.setID(s.getControlID(r,"PrimKey")),f.addElem(n.PrimKey),f.addStyle("display","none"),i.addElem(f)},n._fetchStatementContent=function(t,n){this.Subset=e("#"+n.getControlID(t,"Subset")).val(),this.SubsetTable=e("#"+n.getControlID(t,"STable")).text(),this.PrimKey=e("#"+n.getControlID(t,"PrimKey")).text()},n.toQueryDisplayString=function(e,t){var n="[Unknown]";return e.subsetMap[this.Subset]&&(n=e.subsetMap[this.Subset].name),'in subset "'+n+'"'},n},r.WhereClause.whcClassGenerator._note_=function(e){var t=r.WhereClause.NoteContains();return t.NoteText=e.NoteText,t.PrimKey=e.PrimKey,t.NoteItemTable=e.NoteItemTable,t},r.WhereClause.NoteContains=function(){var n={};return n.whcClass="_note_",n.isCompound=!1,n.Tpe="_note_",n.ColName="_note_",n.NoteText="",n._buildStatement=function(e,r,i){n.PrimKey=i.primKey,n.NoteItemTable=i.tableName;var s=t.Edit(n.NoteText);s.setID(i.getControlID(e,"NoteText")),s.setWidthPx(150),s.setCssClass("DQXQBQueryboxControl"),i.decorateQueryStatementControl(s,e),r.addElem(s);var o=t.Span();o.setID(i.getControlID(e,"PrimKey")),o.addElem(n.PrimKey),o.addStyle("display","none"),r.addElem(o);var o=t.Span();o.setID(i.getControlID(e,"NoteItemTable")),o.addElem(n.NoteItemTable),o.addStyle("display","none"),r.addElem(o)},n._fetchStatementContent=function(t,n){this.NoteText=e("#"+n.getControlID(t,"NoteText")).val(),this.NoteText||(this.NoteText=""),this.PrimKey=e("#"+n.getControlID(t,"PrimKey")).text(),this.NoteItemTable=e("#"+n.getControlID(t,"NoteItemTable")).text()},n.toQueryDisplayString=function(e,t){return'has note containing "'+this.NoteText+'"'},n},r.WhereClause.whcClassGenerator.trivial=function(e){var t=r.WhereClause.Trivial();return t},r.WhereClause.Trivial=function(){var e={};return e.whcClass="trivial",e.isCompound=!1,e.Tpe="",e.isTrivial=!0,e.toQueryDisplayString=function(e,t){return"All"},e},r.WhereClause.whcClassGenerator.none=function(e){var t=r.WhereClause.None();return t},r.WhereClause.None=function(){var e={};return e.whcClass="none",e.isCompound=!1,e.Tpe="None",e.isNone=!0,e.toQueryDisplayString=function(e,t){return"None"},e},r.WhereClause.whcClassGenerator.compound=function(t){var n=r.WhereClause.Compound(t.Tpe,[]);return e.each(t.Components,function(e,t){n.addComponent(r.WhereClause.whcClassGenerator[t.whcClass](t))}),n},r.WhereClause.Compound=function(t,n){t!="AND"&&t!="OR"&&DQX.reportError("Invalid compound where clause statement: "+t);var r={};return r.whcClass="compound",r.isCompound=!0,r.Tpe=t,r.Components=n,r.Components==null&&(r.Components=[]),r.addComponent=function(e){this.Components.push(e)},r.getComponentCount=function(){return this.Components.length},r.toQueryDisplayString=function(t,n){n||(n=0);var i=[];e.each(r.Components,function(e,r){i.push(r.toQueryDisplayString(t,n+1))});var s=" "+r.Tpe+" ";n==0&&(s=" <b>"+r.Tpe+"</b> ");var o=i.join(s);return n==1&&(o="["+o+"]"),n>1&&(o="("+o+")"),o},r},r.WhereClause.AND=function(e){return r.WhereClause.Compound("AND",e)},r.WhereClause.OR=function(e){return r.WhereClause.Compound("OR",e)},r.WhereClause.encode=function(e){var t=JSON.stringify(e),r=n.encode(t);r=r.replace(/\+/g,"-"),r=r.replace(/\//g,"_");if(n.decode(r)!=t){var i=n.decode(r);DQX.reportError("Invalid encoding")}return r},r.WhereClause.decode=function(e){e=n.decode(e);var t=JSON.parse(e);return r.WhereClause.whcClassGenerator[t.whcClass](t)},r.WhereClause.clone=function(e){return r.WhereClause.decode(r.WhereClause.encode(e))},r.WhereClause.createRestriction=function(e,t){var n=r.WhereClause.clone(e);return n.isTrivial?t:n.isCompound&&n.Tpe=="AND"?(n.addComponent(t),n):r.WhereClause.AND([n,t])},r.WhereClause.createValueRestriction=function(t,n,i,s){s||(s="=");var o=r.WhereClause.clone(t),u=r.WhereClause.CompareFixed(n,s,i.toString());if(o.isTrivial)return u;var a=null;o.Tpe==s&&o.ColName==n&&(a=o),o.isCompound&&o.Tpe=="AND"&&e.each(o.Components,function(e,t){t.Tpe==s&&t.ColName==n&&(a=t)});if(a){var f=!0;return(s=="<"||s=="<=")&&i<a.CompValue&&(f=!1),(s==">"||s==">=")&&i>a.CompValue&&(f=!1),a.CompValue=i,o}return o.isCompound&&o.Tpe=="AND"?(o.addComponent(u),o):r.WhereClause.AND([o,u])},r.WhereClause.createRangeRestriction=function(t,n,i,s,o){var u=r.WhereClause.clone(t),a=r.WhereClause.CompareBetween(n,i.toString(),s.toString());if(u.isTrivial)return a;var f=null;return u.Tpe=="between"&&u.ColName==n&&(f=u),u.isCompound&&u.Tpe=="AND"&&e.each(u.Components,function(e,t){t.Tpe=="between"&&t.ColName==n&&(f=t)}),f?(o?(f.CompValueMin=i.toString(),f.CompValueMax=s.toString()):(f.CompValueMin=Math.max(parseFloat(f.CompValueMin),parseFloat(i)).toString(),f.CompValueMax=Math.min(parseFloat(f.CompValueMax),parseFloat(s)).toString()),u):u.isCompound&&u.Tpe=="AND"?(u.addComponent(a),u):r.WhereClause.AND([u,a])},r.TableSort=function(e){var t={};return t.columnList=e,t.getPrimaryColumnID=function(){return this.columnList[this.columnList.length-1]},t.toString=function(){return this.columnList.join("~")},t},r});var LZString={_f:String.fromCharCode,_keyStrBase64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_keyStrUriSafe:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789~-$",_getBaseValue:function(e,t){LZString._baseReverseDic||(LZString._baseReverseDic={});if(!LZString._baseReverseDic[e]){LZString._baseReverseDic[e]={};for(var n=0;n<e.length;n++)LZString._baseReverseDic[e][e[n]]=n}return LZString._baseReverseDic[e][t]},compressToBase64:function(e){if(e==null)return"";var t=LZString._compress(e,6,function(e){return LZString._keyStrBase64.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(e){return e==null?"":e==""?null:LZString._decompress(e.length,32,function(t){return LZString._getBaseValue(LZString._keyStrBase64,e.charAt(t))})},compressToUTF16:function(e){return e==null?"":LZString._compress(e,15,function(e){return String.fromCharCode(e+32)})+" "},decompressFromUTF16:function(e){return e==null?"":e==""?null:LZString._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){var t=LZString.compress(e),n=new Uint8Array(t.length*2);for(var r=0,i=t.length;r<i;r++){var s=t.charCodeAt(r);n[r*2]=s>>>8,n[r*2+1]=s%256}return n},decompressFromUint8Array:function(e){if(e===null||e===undefined)return LZString.decompress(e);var t=new Array(e.length/2);for(var n=0,r=t.length;n<r;n++)t[n]=e[n*2]*256+e[n*2+1];var i="";return t.forEach(function(e){i+=String.fromCharCode(e)}),LZString.decompress(i)},compressToEncodedURIComponent:function(e){return e==null?"":LZString._compress(e,6,function(e){return LZString._keyStrUriSafe.charAt(e)})},decompressFromEncodedURIComponent:function(e){return e==null?"":e==""?null:LZString._decompress(e.length,32,function(t){return LZString._getBaseValue(LZString._keyStrUriSafe,e.charAt(t))})},compress:function(e){return LZString._compress(e,16,function(e){return String.fromCharCode(e)})},_compress:function(e,t,n){if(e==null)return"";var r,i,s={},o={},u="",a="",f="",l=2,c=3,h=2,p="",d=0,v=0,m,g=LZString._f;for(m=0;m<e.length;m+=1){u=e[m],Object.prototype.hasOwnProperty.call(s,u)||(s[u]=c++,o[u]=!0),a=f+u;if(Object.prototype.hasOwnProperty.call(s,a))f=a;else{if(Object.prototype.hasOwnProperty.call(o,f)){if(f.charCodeAt(0)<256){for(r=0;r<h;r++)d<<=1,v==t-1?(v=0,p+=n(d),d=0):v++;i=f.charCodeAt(0);for(r=0;r<8;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1}else{i=1;for(r=0;r<h;r++)d=d<<1|i,v==t-1?(v=0,p+=n(d),d=0):v++,i=0;i=f.charCodeAt(0);for(r=0;r<16;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1}l--,l==0&&(l=Math.pow(2,h),h++),delete o[f]}else{i=s[f];for(r=0;r<h;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1}l--,l==0&&(l=Math.pow(2,h),h++),s[a]=c++,f=String(u)}}if(f!==""){if(Object.prototype.hasOwnProperty.call(o,f)){if(f.charCodeAt(0)<256){for(r=0;r<h;r++)d<<=1,v==t-1?(v=0,p+=n(d),d=0):v++;i=f.charCodeAt(0);for(r=0;r<8;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1}else{i=1;for(r=0;r<h;r++)d=d<<1|i,v==t-1?(v=0,p+=n(d),d=0):v++,i=0;i=f.charCodeAt(0);for(r=0;r<16;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1}l--,l==0&&(l=Math.pow(2,h),h++),delete o[f]}else{i=s[f];for(r=0;r<h;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1}l--,l==0&&(l=Math.pow(2,h),h++)}i=2;for(r=0;r<h;r++)d=d<<1|i&1,v==t-1?(v=0,p+=n(d),d=0):v++,i>>=1;for(;;){d<<=1;if(v==t-1){p+=n(d);break}v++}return p},decompress:function(e){return e==null?"":e==""?null:LZString._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(e,t,n){var r=[],i,s=4,o=4,u=3,a="",f="",l,c,h,p,d,v,m,g=LZString._f,y={val:n(0),position:t,index:1};for(l=0;l<3;l+=1)r[l]=l;h=0,d=Math.pow(2,2),v=1;while(v!=d)p=y.val&y.position,y.position>>=1,y.position==0&&(y.position=t,y.val=n(y.index++)),h|=(p>0?1:0)*v,v<<=1;switch(i=h){case 0:h=0,d=Math.pow(2,8),v=1;while(v!=d)p=y.val&y.position,y.position>>=1,y.position==0&&(y.position=t,y.val=n(y.index++)),h|=(p>0?1:0)*v,v<<=1;m=g(h);break;case 1:h=0,d=Math.pow(2,16),v=1;while(v!=d)p=y.val&y.position,y.position>>=1,y.position==0&&(y.position=t,y.val=n(y.index++)),h|=(p>0?1:0)*v,v<<=1;m=g(h);break;case 2:return""}r[3]=m,c=f=m;for(;;){if(y.index>e)return"";h=0,d=Math.pow(2,u),v=1;while(v!=d)p=y.val&y.position,y.position>>=1,y.position==0&&(y.position=t,y.val=n(y.index++)),h|=(p>0?1:0)*v,v<<=1;switch(m=h){case 0:h=0,d=Math.pow(2,8),v=1;while(v!=d)p=y.val&y.position,y.position>>=1,y.position==0&&(y.position=t,y.val=n(y.index++)),h|=(p>0?1:0)*v,v<<=1;r[o++]=g(h),m=o-1,s--;break;case 1:h=0,d=Math.pow(2,16),v=1;while(v!=d)p=y.val&y.position,y.position>>=1,y.position==0&&(y.position=t,y.val=n(y.index++)),h|=(p>0?1:0)*v,v<<=1;r[o++]=g(h),m=o-1,s--;break;case 2:return f}s==0&&(s=Math.pow(2,u),u++);if(r[m])a=r[m];else{if(m!==o)return null;a=c+c[0]}f+=a,r[o++]=c+a[0],s--,c=a,s==0&&(s=Math.pow(2,u),u++)}}};typeof module!="undefined"&&module!=null&&(module.exports=LZString),define("lzstring",function(e){return function(){var t,n;return t||e.LZString}}(this)),define("DQX/DataDecoders",["jquery","DQX/Utils"],function(e,t){var n={};return n.B64=function(){var e={};e.encodestr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-",e.invencode=[];for(var t=0;t<255;t++)e.invencode.push(0);for(var t=0;t<e.encodestr.length;t++)e.invencode[e.encodestr[t].charCodeAt(0)]=t;return e.B642Int=function(e){rs=0;for(var t=0;t<e.length;t++)rs=(rs<<6)+this.invencode[e.charCodeAt(t)];return rs},e.B642IntFixed=function(e,t,n){if(e[t]=="~")return null;rs=0;for(var r=0;r<n;r++)rs=(rs<<6)+this.invencode[e.charCodeAt(t+r)];return rs},e.arrayB642Float=function(e,t,n,r){var i=[],s=e.length/t,o=0;for(var u=0;u<s;u++)if(e[o]=="~"||e[o]=="#")i.push(null),o+=t;else{var a=0;for(var f=0;f<t;f++)a=(a<<6)+this.invencode[e.charCodeAt(o)],o++;i.push(a*n+r)}return i},e},n.ValueListDecoder=function(){var e={};return e.b64codec=n.B64(),e.doDecode=function(e){if(e["Encoding"]=="IntegerDiffB64"){if(e["Data"].length==0)return[];var n=[],r=e.Offset,i=e.Data.split(",");for(var s=0;s<i.length;s++)r+=this.b64codec.B642Int(i[s]),n.push(r);return n}if(e["Encoding"]=="IntegerB64"){if(e["Data"].length==0)return[];var n=[],i=e.Data.split(",");for(var s=0;s<i.length;s++)n.push(this.b64codec.B642Int(i[s]));return n}if(e["Encoding"]=="FloatAsIntB64"){if(e["Data"].length==0)return[];var r=e.Offset,o=e.Slope,u=e.ByteCount,a=e.Data,n=this.b64codec.arrayB642Float(a,u,o,r);return n}if(e["Encoding"]=="FloatAsH"){if(e["Data"].length==0)return[];var n=[],i=e.Data.split(",");for(var s=0;s<i.length;s++)i[s]!="~"?n.push(parseFloat(i[s])):n.push(null);return n}if(e["Encoding"]=="Integer"){if(e["Data"].length==0)return[];var n=[],i=e.Data.split(",");for(var s=0;s<i.length;s++)n.push(parseInt(i[s]));return n}if(e["Encoding"]=="String"){if(e["Data"].length==0)return[];var n=e.Data.split("~");return n}t.reportError("Unknown value list encoding: "+e.Encoding)},e},n.Encoder={},n.Encoder.FixedString=function(e){var n={};return t.checkIsNumber(e.Len),n.length=parseFloat(e.Len),n.decodeArray=function(e){var t=[],n=e.length/this.length;for(var r=0;r<n;r++)t.push(e[r*this.length,(r+1)*this.length]);return t},n.decodeSingle=function(e,t){return e.substring(t,t+this.length)},n.getRecordLength=function(){return this.length},n},n.Encoder.Boolean=function(e){var t={};return t.decodeArray=function(e){var t=[],n=e.length;for(var r=0;r<n;r++)t.push(e[r]=="1");return t},t.decodeSingle=function(e,t){return e[t]=="1"},t.getRecordLength=function(){return 1},t},n.Encoder.Int2B64=function(e){var r={};t.checkIsNumber(e.Len),r.length=parseFloat(e.Len);var i=n.B64();return r.decodeSingle=function(e,t){return i.B642IntFixed(e,t,this.length)},r.getRecordLength=function(){return this.length},r},n.Encoder.Float2B64=function(e){var r={};t.checkIsNumber(e.Len),t.checkIsNumber(e.Offset),t.checkIsNumber(e.Slope),r.offset=parseFloat(e.Offset),r.slope=parseFloat(e.Slope),r.length=parseFloat(e.Len);var i=n.B64();return r.decodeArray=function(e){return i.arrayB642Float(e,this.length,this.slope,this.offset)},r.decodeSingle=function(e,t){return i.B642IntFixed(e,t,this.length)*this.slope+this.offset},r.getRecordLength=function(){return this.length},r},n.Encoder.FloatList2B64=function(e){var r={};t.checkIsNumber(e.Count),t.checkIsNumber(e.RangeOffset),t.checkIsNumber(e.RangeSlope),r.rangeOffset=parseFloat(e.RangeOffset),r.rangeSlope=parseFloat(e.RangeSlope),r.count=parseInt(e.Count);var i=n.B64();return r.decodeArray=function(e){var t=e.length,n=r.count+4,s=[];for(var o=0;o<t;o+=n){var u=i.B642IntFixed(e,o+0,2)*r.rangeSlope+r.rangeOffset,a=i.B642IntFixed(e,o+2,2)*r.rangeSlope+r.rangeOffset,f=[];for(var l=0;l<this.count;l++)f.push(u+i.B642IntFixed(e,o+4+l,1)/63*(a-u));s.push(f)}return s},r.getRecordLength=function(){t.reportError("Undefined record length")},r},n.Encoder.BooleanListB64=function(e){var r={};t.checkIsNumber(e.Count),r.rangeSlope=parseFloat(e.RangeSlope),r.valueCount=parseInt(e.Count),r.byteCount=Math.floor((r.valueCount+5)/6);var i=n.B64();return r.decodeArray=function(e){return"-"},r.decodeSingle=function(e,t){var n=i.B642IntFixed(e,t,this.byteCount),r=[];for(var s=0;s<this.valueCount;s++)r.unshift(n&1),n>>=1;return r},r.getRecordLength=function(){return this.byteCount},r},n.Encoder.MultiCatCount=function(e){var r={};t.checkIsNumber(e.CatCount),t.checkIsNumber(e.EncoderLen),r.catCount=parseInt(e.CatCount),r.encoderlen=parseInt(e.EncoderLen);var i=n.B64();return r.decodeArray=function(e){var t=e.length,n=r.catCount*r.encoderlen,s=[];for(var o=0;o<t;){var u=[];for(var a=0;a<r.catCount;a++)u.push(i.B642IntFixed(e,o,r.encoderlen)),o+=r.encoderlen;s.push(u)}return s},r.decodeSingle=function(e,t){throw"Not implemented"},r.getRecordLength=function(){return this.byteCount},r},n.Encoder.Create=function(e){if(e["ID"]=="Int2B64")return n.Encoder.Int2B64(e);if(e["ID"]=="Float2B64")return n.Encoder.Float2B64(e);if(e["ID"]=="FloatList2B64")return n.Encoder.FloatList2B64(e);if(e["ID"]=="FixedString")return n.Encoder.FixedString(e);if(e["ID"]=="Boolean")return n.Encoder.Boolean(e);if(e["ID"]=="BooleanListB64")return n.Encoder.BooleanListB64(e);if(e["ID"]=="MultiCatCount")return n.Encoder.MultiCatCount(e);t.reportError("Invalid encoder id "+e.ID)},n}),define("DQX/DataFetcher/DataFetchers",["jquery","lzstring","DQX/SQL","DQX/Utils","DQX/DataDecoders"],function(e,t,n,r,i){var s={};return s.RecordCountFetchType={IMMEDIATE:0,DELAYED:1,NONE:2},s.Table=function(e,t,n){r.checkIsString(e),r.checkIsString(t),r.checkIsString(n);var i=new s.Curve(e,t,n,"LIMIT");return i.positionField="",i.setSortOption=function(e,t){r.requireMemberFunction(e,"getPrimaryColumnID"),this.positionField=e.toString(),this.sortReverse=t},i},s.Curve=function(o,u,a,f){this instanceof arguments.callee||r.reportError("Should be called as constructor!"),r.checkIsString(o),r.checkIsString(u),r.checkIsString(a),this.serverurl=o,this.database=u,this.tablename=a,this.rangeExtension=1.5,this._maxViewportSizeX=1e99,this._maxrecordcount=1e6,this._reportIfError=!1,this._requestNr=0,a||r.reportError("Invalid table name"),f||(f="pos"),this.positionField=f,this.sortReverse=!1,this.useLimit=f=="LIMIT",this._userQuery1=null,this._userQuery2=null,this.setReportIfError=function(e){this._reportIfError=e},this.setUserQuery1=function(e){this._userQuery1=e,this.clearData()},this.setUserQuery2=function(e){e.isTrivial?this._userQuery2=null:this._userQuery2=e,this.clearData()},this.setTableName=function(e){this.tablename=e,this.clearData()},this.setMaxRecordCount=function(e){this._maxrecordcount=e},this.setMaxViewportSizeX=function(e){this._maxViewportSizeX=e},this.resetAll=function(){this._currentRangeMin=1e3,this._currentRangeMax=-1e3,this.myDownloadPointsX=[],this.myColumns={},this.totalRecordCount=-1,this._isFetching=!1,this.hasFetchFailed=!1},this.resetAll(),this.clearData=function(){this._requestNr++,this._currentRangeMin=1e3,this._currentRangeMax=-1e3,this.myDownloadPointsX=[];for(var e in this.myColumns)this.myColumns[e].clearData();this.totalRecordCount=-1,this._isFetching=!1},this.addFetchColumn=function(e,t){return this.myColumns[e]||(this.myColumns[e]=s.CurveColumn(t)),this.clearData(),this.myColumns[e]},this.addFetchColumnActive=function(e,t){var n=this.addFetchColumn(e,t);return this.activateFetchColumn(e),n},this.addFetchColumnInt=function(e,t){var n=this.addFetchColumn(e,"IntB64");return t&&this.activateFetchColumn(e),n},this.addFetchColumnValue=function(e,t){var n=this.addFetchColumn(e,"Float2");return t&&this.activateFetchColumn(e),n},this.addFetchColumnHighPrecisionValue=function(e,t){var n=this.addFetchColumn(e,"FloatH");return t&&this.activateFetchColumn(e),n},this.hasFetchColumn=function(e){return e in this.myColumns},this.getFetchColumn=function(e){var t=this.myColumns[e];return t==null&&r.reportError("Invalid fetcher column id "+e),t},this.delFetchColumn=function(e){delete this.myColumns[e]},this.activateFetchColumn=function(e){e in this.myColumns||r.reportError("Unable to activate column {cid}: it is not present in the datafetcher".DQXformat({cid:e})),this.myColumns[e].myActiveCount==0&&this.clearData(),this.myColumns[e].myActiveCount++},this.deactivateFetchColumn=function(e){e in this.myColumns&&this.myColumns[e].myActiveCount--},this._ajaxResponse_FetchRange=function(t){this.showDownload&&r.stopProcessing();if(!this._isFetching)return;this.hasFetchFailed=!1,this._isFetching=!1;var n=r.parseResponse(t);if("Error"in n){this.hasFetchFailed=!0,this._reportIfError?alert("Error:\n"+n.Error):setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),r.timeoutRetry);return}if(n.requestnr!=this._requestNr){this.myDataConsumer.notifyDataReady();return}for(var s in this.myColumns)if(this.myColumns[s].isActive()&&!(s in n)){this.myDataConsumer.notifyDataReady();return}this._currentRangeMin=parseFloat(n._start),this._currentRangeMax=parseFloat(n._stop),"TotalRecordCount"in n&&(this.totalRecordCount=n.TotalRecordCount);var o=i.B64(),u=i.ValueListDecoder();if(n["DataType"]=="Points"){this.myDownloadPointsX=u.doDecode(n.XValues);for(var s in this.myColumns)this.myColumns[s].isActive()&&(this.myColumns[s].myDownloadValues=u.doDecode(n[s]));if(this.useLimit){var a=Math.max(0,parseInt(n._start)),f=parseInt(n._stop)-a+1,l=this.myDownloadPointsX.length;l<f&&(this.totalRecordCount=a+l)}}this.myDataConsumer.notifyDataReady()},this._ajaxFailure_FetchRange=function(t){this.showDownload&&r.stopProcessing(),this.hasFetchFailed=!0,this._isFetching=!1;if(this._reportIfError){var n="Error:\n";t.statusText&&(n+=t.statusText),alert(n)}else setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),r.timeoutRetry)},this._ajaxResponse_FetchRecordCount=function(e){var t=r.parseResponse(e);if("Error"in t)return;if(t.requestid!=this._recordcountrequestid)return;"TotalRecordCount"in t&&(this.totalRecordCount=t.TotalRecordCount),this.isTruncatedRecordCount=!1,"Truncated"in t&&(this.isTruncatedRecordCount=t.Truncated),this.myDataConsumer.notifyDataReady()},this._createActiveColumnListString=function(){var e="";for(var t in this.myColumns)this.myColumns[t].isActive()&&(e.length>0&&(e+="~"),e+=this.myColumns[t].myEncodingID,e+=t);return e},this.isValid=function(){return this._userQuery1==null?!0:!this._userQuery1.isNone},this._fetchRange=function(i,o,u){u||(u=s.RecordCountFetchType.IMMEDIATE);if(o-i>this._maxViewportSizeX)return;if(this._userQuery1&&this._userQuery1.isNone){this.hasFetchFailed=!1,this._isFetching=!1,range=o-i,i=Math.round(i-this.rangeExtension*range),o=Math.round(o+this.rangeExtension*range),this._currentRangeMin=i,this._currentRangeMax=o,this.myDownloadPointsX=[];for(var a in this.myColumns)this.myColumns[a].myDownloadValues=[];this.totalRecordCount=0,setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),r.timeoutRetry);return}if(!this._isFetching){var f=this._createActiveColumnListString();range=o-i,i-=this.rangeExtension*range,o+=this.rangeExtension*range;var l=n.WhereClause.Trivial();this.useLimit?this._userQuery1!=null&&(l=this._userQuery1,this._userQuery2&&!this._userQuery2.isTrivial&&(l=n.WhereClause.AND([l,this._userQuery2]))):(l=n.WhereClause.AND(),l.addComponent(n.WhereClause.CompareFixed(this.positionField,">=",i)),l.addComponent(n.WhereClause.CompareFixed(this.positionField,"<=",o)),this._userQuery1!=null&&l.addComponent(this._userQuery1),this._userQuery2!=null&&l.addComponent(this._userQuery2));var c="qry";this.useLimit&&(c="pageqry");var h=r.Url(this.serverurl);h.addUrlQueryItem("datatype",c),h.addUrlQueryItem("database",this.database),h.addUrlQueryItem("requestnr",this._requestNr),h.addUrlQueryItem("qry",n.WhereClause.encode(l)),h.addUrlQueryItem("tbname",this.tablename),h.addUrlQueryItem("collist",t.compressToEncodedURIComponent(f)),h.addUrlQueryItem("posfield",this.positionField),this.positionField&&h.addUrlQueryItem("order",this.positionField),h.addUrlQueryItem("_start",i),h.addUrlQueryItem("_stop",o),h.addUrlQueryItem("sortreverse",this.sortReverse?1:0),h.addUrlQueryItem("needtotalcount",this.totalRecordCount<0&&u==s.RecordCountFetchType.IMMEDIATE?1:0),h.addUrlQueryItem("needsmartsort",0),this.useLimit&&h.addUrlQueryItem("limit",i+"~"+o);if(f.length>0){var p=h.toString();this._isFetching=!0;var d=this;this.showDownload&&r.setProcessing("Downloading..."),e.ajax({url:p,success:function(t){d._ajaxResponse_FetchRange(t);if(u==s.RecordCountFetchType.DELAYED){var i=r.Url(d.serverurl);d._recordcountrequestid=r.getNextUniqueID(),i.addUrlQueryItem("datatype","getrecordcount"),i.addUrlQueryItem("database",d.database),i.addUrlQueryItem("requestid",d._recordcountrequestid),i.addUrlQueryItem("qry",n.WhereClause.encode(l)),i.addUrlQueryItem("tbname",d.tablename),i.addUrlQueryItem("maxrecordcount",d._maxrecordcount),e.ajax({url:i.toString(),success:function(e){d._ajaxResponse_FetchRecordCount(e)},error:function(e){}})}},error:function(e){d._ajaxFailure_FetchRange(e)}})}}},this.createDownloadUrl=function(){var e=this._createActiveColumnListString(),i=n.WhereClause.Trivial();this._userQuery1!=null&&(i=this._userQuery1);var s=r.Url(this.serverurl);return s.addUrlQueryItem("datatype","downloadtable"),s.addUrlQueryItem("database",this.database),s.addUrlQueryItem("qry",n.WhereClause.encode(i)),s.addUrlQueryItem("tbname",this.tablename),s.addUrlQueryItem("collist",t.compressToEncodedURIComponent(e)),s.addUrlQueryItem("posfield",this.positionField),s.addUrlQueryItem("order",this.positionField),s.addUrlQueryItem("sortreverse",this.sortReverse?1:0),s.toString()},this.IsDataReady=function(e,t,n){if(t-e>this._maxViewportSizeX)return!0;if(e>=this._currentRangeMin&&t<=this._currentRangeMax){var r=(t-e)/2;return(e-r<this._currentRangeMin||t+r>this._currentRangeMax)&&this._fetchRange(e,t,n),!0}return this._fetchRange(e,t,n),!1},this.findIndexByXVal=function(e){if("myDownloadPointsX"in this)for(var t in this.myDownloadPointsX)if(e==this.myDownloadPointsX[t])return t;return-1},this.getColumnPoints=function(e,t,n){var r={};for(var i=0;i<this.myDownloadPointsX.length-1&&this.myDownloadPointsX[i]<e;i++);for(var s=this.myDownloadPointsX.length-1;s>0&&this.myDownloadPointsX[s]>t;s--);i>0&&i--,s<this.myDownloadPointsX.length-1&&s++,r.startIndex=i,r.xVals=[];for(var o=i;o<=s;o++)r.xVals.push(this.myDownloadPointsX[o]);r.YVals=[];var u=this.myColumns[n];for(var o=i;o<=s;o++)r.YVals.push(u.myDownloadValues[o]);return r},this.getPosition=function(e){return e<0||e>=this.myDownloadPointsX.length?null:this.myDownloadPointsX[e]},this.getColumnPoint=function(e,t){if(e<0||e>=this.myDownloadPointsX.length)return null;var n=this.myColumns[t];return n||r.reportError('Invalid column ID "{id}"'.DQXformat({id:t})),n.myDownloadValues[e]},this._ajaxFailure_FetchPoint=function(e){this._isFetching=!1},this.fetchFullRecordInfo=function(t,i,s){var o=r.Url(this.serverurl);o.addUrlQueryItem("datatype","recordinfo"),o.addUrlQueryItem("database",this.database),o.addUrlQueryItem("qry",n.WhereClause.encode(t)),o.addUrlQueryItem("tbname",this.tablename);var u=function(e){var t=r.parseResponse(e);if("Error"in t){s(t.Error);return}i(t.Data)};e.ajax({url:o.toString(),success:u,error:s})}},s.CurveColumn=function(t){var n={};n.myEncodingList={Generic:{id:"GN",type:"String"},String:{id:"ST",type:"String"},Float2:{id:"F2",type:"Float"},Float3:{id:"F3",type:"Float"},Float4:{id:"F4",type:"Float"},FloatH:{id:"FH",type:"Float"},Int:{id:"IN",type:"Integer"},IntB64:{id:"IB",type:"Integer"},IntDiff:{id:"ID",type:"Integer"}};if(!(t in n.myEncodingList)){var i=[];e.each(n.myEncodingList,function(e,t){i.push(e)}),r.reportError("Invalid column encoding "+t+". Should be one of: "+i.join(", "))}return n.myEncodingID=n.myEncodingList[t].id,n.myEncodingType=n.myEncodingList[t].type,n.myActiveCount=0,n.myDownloadValues=[],n.clearData=function(){this.myDownloadValues=[]},n.isActive=function(){return this.myActiveCount>0},n},s.fetchSingleRecord=function(e,t,i,o,u,a,f){var l=new s.Curve(e,t,i);l.fetchFullRecordInfo(n.WhereClause.CompareFixed(o,"=",u),function(e){r.stopProcessing(),a(e)},function(e){r.stopProcessing(),f&&f()}),r.setProcessing("Downloading...")},s.RecordsetFetcher=function(i,s,o){var u={};return r.checkIsString(i),r.checkIsString(s),r.checkIsString(o),u.serverUrl=i,u.database=s,u.tableName=o,u.columns=[],u._maxResultCount=1e5,u._sortReverse=!1,u._distinct=!1,o||r.reportError("Invalid table name"),u.addColumn=function(e,t){this.columns.push({id:e,encoding:t})},u.getColumnIDs=function(){var t=[];return e.each(this.columns,function(e,n){t.push(n.id)}),t},u.setMaxResultCount=function(e){this._maxResultCount=e},u.makeDistinct=function(e){return u._distinct=e,u},u._ajaxResponse_FetchRange=function(e,t,n){this.showDownload&&r.stopProcessing();var i=r.parseResponse(e);if(i.Error){n(i.Error);return}var s={},o=require("DQX/DataDecoders"),u=o.B64(),a=o.ValueListDecoder();for(var f=0;f<this.columns.length;f++)s[this.columns[f].id]=a.doDecode(i[this.columns[f].id]);t(s)},u._ajaxFailure_FetchRange=function(e,t){this.showDownload&&r.stopProcessing(),t&&t("Server error "+JSON.stringify(e))},u._createActiveColumnListString=function(){var e="";for(var t=0;t<this.columns.length;t++)e.length>0&&(e+="~"),e+=this.columns[t].encoding,e+=this.columns[t].id;return e},u.getData=function(i,s,o,a){var f=r.Url(this.serverUrl);f.addUrlQueryItem("datatype","pageqry"),f.addUrlQueryItem("database",this.database),f.addUrlQueryItem("qry",n.WhereClause.encode(i)),f.addUrlQueryItem("tbname",this.tableName),f.addUrlQueryItem("collist",t.compressToEncodedURIComponent(this._createActiveColumnListString())),f.addUrlQueryItem("order",s),f.addUrlQueryItem("sortreverse",u._sortReverse?1:0),f.addUrlQueryItem("needtotalcount",0),f.addUrlQueryItem("limit","0~"+this._maxResultCount),f.addUrlQueryItem("distinct",u._distinct?1:0);var l=f.toString();this._isFetching=!0;var c=this;e.ajax({url:l,success:function(e){c._ajaxResponse_FetchRange(e,o,a)},error:function(e){c._ajaxFailure_FetchRange(e,a)}})},u},s.ServerDataGetter=function(){var t={};return t._tables=[],t._tablesMap={},t.addTable=function(i,s,o,u,a){var f=[];e.each(s,function(e,t){typeof t!="object"?f.push({id:t,tpe:"string"}):(["string","float","int"].indexOf(t.tpe)<0&&r.reportError("Invalid table column type: property tpe should be string,float or int"),f.push(t))});var l={name:i,columns:f,sortcolumn:o};a&&a.distinct&&(l.distinct=!0),l.query=n.WhereClause.Trivial(),u&&(l.query=u),t._tables.push(l),t._tablesMap[i]=l},t.getTableRecords=function(e){var n=t._tablesMap[e];return n||r.reportError("Invalid table name "+e),n.records},t.tryFinalise=function(){var n=!0;e.each(t._tables,function(e,t){t.data||(n=!1)}),n&&(e.each(t._tables,function(t,n){var r=n.data[n.columns[0].id].length;n.records=[];for(var i=0;i<r;i++){var s={};e.each(n.columns,function(e,t){s[t.id]=n.data[t.id][i],t.tpe=="float"&&(s[t.id]=parseFloat(s[t.id])),t.tpe=="int"&&(s[t.id]=parseInt(s[t.id]))}),n.records.push(s)}}),t._proceedFunction())},t.execute=function(n,i,o){t._proceedFunction=o;if(t._tables.length==0){o();return}e.each(t._tables,function(o,u){var a=s.RecordsetFetcher(n,i,u.name);a.makeDistinct(u.distinct),e.each(u.columns,function(e,t){a.addColumn(t.id,"GN")}),a.getData(u.query,u.sortcolumn,function(e){u.data=e,t.tryFinalise()},function(e){r.reportError(e)})})},t},s}),define("MetaData",["DQX/Utils","DQX/Controls","DQX/Msg","DQX/Popup"],function(e,t,n,r){PnServerModule="panoptesserver";var i={};return i.quickLoad=!0,i.updateCalculationInfo=!1,i.serverUrl=serverUrl,i.urlDocumentation="http://panoptes.readthedocs.org/en/latest/",i.tableAnnotation="annotation",i.hasTable=function(t){return i.mapTableCatalog||e.reportError("Table info not yet available"),!!i.mapTableCatalog[t]},i.getTableInfo=function(t){return i.mapTableCatalog||e.reportError("Table info not yet available"),i.mapTableCatalog[t]||e.reportError("Could not find table "+t),i.mapTableCatalog[t]},i.customProperties=[],i.findProperty=function(t,n){var r=null;$.each(i.customProperties,function(e,i){i.tableid==t&&i.propid==n&&(r=i)});if(r!=null)return r;e.reportError("Property {prop} not found for table {table}".DQXformat({prop:n,table:t}))},i.hasProperty=function(e,t){var n=!1;return $.each(i.customProperties,function(r,i){i.tableid==e&&i.propid==t&&(n=!0)}),n},i.findSummaryValue=function(t,n){var r=null;$.each(i.summaryValues,function(e,i){i.tableid==t&&i.propid==n&&(r=i)});if(r!=null)return r;e.reportError("Summary value {prop} not found for table {table}".DQXformat({prop:n,table:t}))},i.hasSummaryValue=function(e,t){var n=!1;return $.each(i.summaryValues,function(r,i){i.tableid==e&&i.propid==t&&(n=!0)}),n},i}),define("DQX/MessageBox",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/Controls","DQX/Popup"],function(e,t,n,r,i,s){var o={};return o.confirmationBox=function(e,t){var n='<div style="padding:10px;min-width: 330px">';n+='<span class="fa fa-question-circle" style="font-size: 36px; color:rgb(150,150,150);float:left;padding-right:10px;padding-bottom:10px"></span>',n+=e,n+="<p>";var r=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-check",content:"OK",width:100,height:35}).setOnChanged(function(){s.closeIfNeeded(o),t&&t()});n+=r.renderHtml(),n+="&nbsp;&nbsp;";var r=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-close",content:"Cancel",width:100,height:35}).setOnChanged(function(){s.closeIfNeeded(o)});n+=r.renderHtml(),n+="</div>";var o=s.create("Confirmation",n,null,{canClose:!1})},o.errorBox=function(e,t){var n='<div style="padding:10px">';n+='<span class="fa fa-exclamation-triangle" style="font-size: 36px; color:rgb(150,0,0);float:left;padding-right:10px;padding-bottom:10px"></span>',n+=t,n+="<p>";var r=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-close",content:"Close",width:120,height:35}).setOnChanged(function(){s.closeIfNeeded(o)});n+=r.renderHtml(),n+="</div>";var o=s.create(e,n,null,{canClose:!1})},o}),define("DQX/Wizard",["jquery","DQX/DocEl","DQX/Msg","DQX/Utils","DQX/Framework","DQX/Controls","DQX/Popup","DQX/MessageBox"],function(e,t,n,r,i,s,o,u){var a={};return closeWizard=function(){dqxCurrentWizard&&dqxCurrentWizard._onCancel()},a.Create=function(i,a){var f={};return f.ID=i,f._title="Wizard",f._pages=[],f._pageIndex={},f._sizeX=600,f._sizeY=500,f._canCancel=!0,a&&(a.title&&(f._title=a.title),a.sizeX&&(f._sizeX=a.sizeX),a.sizeY&&(f._sizeY=a.sizeY),"canCancel"in a&&(f._canCancel=a.canCancel),a.noBackground&&(f._noBackground=a.noBackground)),f.setTitle=function(e){f._title=r.interpolate(e)},f.addPage=function(e){this._checkNotRunning(),r.requireMember(e,"id"),r.requireMember(e,"form"),r.requireMemberFunction(e.form,"getID"),e.form.setContextID(this.ID),e.id in this._pageIndex&&r.reportError("Page already present in wizard "+e.id),this._pageIndex[e.id]=this._pages.length,this._pages.push(e)},f.getResultValue=function(e){return f._resultValues[e]},f.getCurrentPage=function(){var e=this._pages[this.pageNr];return e||r.reportError("Invalid wizard page"),e},f.getPageNr=function(e){return e in this._pageIndex||r.reportError("Invalid wizard page "+e),this._pageIndex[e]},f.getPage=function(e){return this._pages[this.getPageNr(e)]},f._checkNotRunning=function(){this._isRunning&&r.reportError("Wizard is running")},f._checkRunning=function(){this._isRunning||r.reportError("Wizard is not running")},f._onKeyDown=function(e){e.isEscape&&this._onCancel()},f.run=function(n){dqxCurrentWizard=f,r.checkIsFunction(n),this._checkNotRunning(),f._resultValues={},this._onFinishFunction=n,this._isRunning=!0;var i=t.Div({id:"WizBackGround"});i.addStyle("position","absolute"),i.addStyle("left","0px"),i.addStyle("top","0px"),i.addStyle("width","100%"),i.addStyle("height","100%");var u="rgba(100,100,100,0.4)";f._noBackground||i.addStyle("background-color",u),i.addStyle("z-index","2000"),e("#DQXUtilContainer").append(i.toString()),e("#WizBackGround").mousedown(function(t){t.target.id=="WizBackGround"&&(e("#WizBackGround").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#WizBackGround").css("background-color",u),setTimeout(function(){e("#WizBackGround").css("background-color","rgba(50,50,50,0.6)"),setTimeout(function(){e("#WizBackGround").css("background-color",u)},150)},150)},150))});var a=r.getWindowClientW(),l=r.getWindowClientH(),c=f._sizeX,h=f._sizeY;this._pageTrace=[];var p=t.Div({id:"WizBox"});p.addStyle("position","absolute"),p.addStyle("left",(a-c)/2+"px"),p.addStyle("top",(l-h)/2+"px"),p.addStyle("width",c+"px"),p.addStyle("height",h+"px"),p.setCssClass("DQXWizardBox");var d=t.Div({id:"WizBoxHeader",parent:p});d.setCssClass("DQXWizardBoxHeader DQXDragHeader"),d.addElem(this._title);var v=t.Div({id:"WizBoxContent",parent:p});v.setCssClass("DQXWizardBoxBody"),v.setHeightPx(h-4-105);var m=t.Div({id:"WizBoxFooter",parent:p});m.setCssClass("DQXWizardBoxFooter");var g=t.Div({id:"WizBoxButtons",parent:m});g.addStyle("position","absolute"),g.addStyle("top","0px"),g.addStyle("right","0px");var y=t.JavaScriptBitmaplink(r.BMP("close2.png"),"Close","closeWizard();");p.addElem(y),y.addStyle("position","absolute"),y.addStyle("right","-13px"),y.addStyle("top","-13px");var b=[];f._canCancel&&b.push({id:"WizBoxButtonCancel",name:"Cancel",bitmap:r.BMP("cancel.png"),floatPos:"left",handler:f._onCancel}),b.push({id:"WizBoxButtonPrevious",name:"Previous",bitmap:r.BMP("arrow5left.png"),floatPos:"left",handler:f._onPrevious}),b.push({id:"WizBoxButtonNext",name:"Next",bitmap:r.BMP("arrow5right.png"),floatPos:"right",handler:f._onNext}),b.push({id:"WizBoxButtonFinish",name:"Finish",bitmap:r.BMP("ok.png"),floatPos:"left",handler:f._onFinish});for(var w=0;w<b.length;w++){var E=b[w],S='<IMG SRC="'+E.bitmap+'" border=0 ALT="" style="float:'+E.floatPos+';margin-right:3px;margin-left:3px"></IMG>'+E.name;E.control=s.Button(E.id,{content:S,buttonClass:"DQXWizardButton",fastTouch:!0}),g.addElem(E.control.renderHtml()),E.control.setOnChanged(e.proxy(E.handler,f))}var x=t.Div({id:"WizBoxButtonHelp",parent:m});x.addStyle("padding-left","8px");var T='<IMG SRC="'+r.BMP("info4.png")+'" border=0 ALT=""style="float:left;margin-right:5px;margin-left:3px;"></IMG>Help';helpButtonControl=s.Button("WizBoxButtonHelp",{content:T,buttonClass:"DQXWizardButton",fastTouch:!0}),helpButtonControl.setOnChanged(e.proxy(f._onHelp,f)),x.addElem(helpButtonControl.renderHtml()),e("#WizBackGround").append(p.toString()),o.makeDraggable(p.myID),e("#WizBoxButtonPrevious").hide(),e("#WizBoxButtonFinish").hide(),s.ExecPostCreateHtml(),this._keyDownReceiverID=r.registerGlobalKeyDownReceiver(e.proxy(f._onKeyDown,f)),this.pageNr=null,this._setPage(0)},f._getPageResultSet=function(){this.pageNr!=null&&f._pages[this.pageNr].form.applyOnControls(function(e){"getValue"in e&&(f._resultValues[e.getID()]=e.getValue())})},f._setPage=function(t){this._checkRunning(),this.pageNr=t,e("#WizBoxContent").html(this._pages[this.pageNr].form.renderHtml()),this._pages[this.pageNr].form.postCreateHtml(),this._pages[this.pageNr].helpUrl?e("#WizBoxButtonHelp").show():e("#WizBoxButtonHelp").hide(),this._isFinalPage()?(e("#WizBoxButtonFinish").show(),e("#WizBoxButtonNext").hide()):(e("#WizBoxButtonFinish").hide(),this._pages[this.pageNr].hideNext?e("#WizBoxButtonNext").hide():e("#WizBoxButtonNext").show()),this.pageNr==0?e("#WizBoxButtonPrevious").hide():e("#WizBoxButtonPrevious").show(),this.getCurrentPage().onStart&&this.getCurrentPage().onStart()},f._isFinalPage=function(){return this.pageNr==this._pages.length-1?!0:this.getCurrentPage().onFinish},f._stopRunning=function(){dqxCurrentWizard=null,r.unRegisterGlobalKeyDownReceiver(this._keyDownReceiverID),e("#WizBackGround").remove(),this._isRunning=!1},f._onCancel=function(){f._canCancel?this._stopRunning():alert("This wizard can not be aborted")},f._onHelp=function(){n.send({type:"ShowHelp"},this.getCurrentPage().helpUrl)},f._onFinish=function(){if(this.getCurrentPage().reportValidationError){var e=this.getCurrentPage().reportValidationError();if(e){u.errorBox("",e);return}}return this.getCurrentPage().onFinish&&this.getCurrentPage().onFinish(),this.performFinish(),!1},f.performFinish=function(){this._checkRunning(),f._getPageResultSet(),this._stopRunning(),this._onFinishFunction()},f.jumpToPage=function(e){this._checkRunning(),this._pageTrace.push(this.pageNr),this._setPage(this.getPageNr(e))},f._onNext=function(){if(this.getCurrentPage().reportValidationError){var e=this.getCurrentPage().reportValidationError();if(e){u.errorBox("",e);return}}f._getPageResultSet();if(this._isFinalPage()){this._onFinish();return}this._pageTrace.push(this.pageNr);var t=this.pageNr+1;return this.getCurrentPage().getNextPage&&(t=this.getPageNr(this.getCurrentPage().getNextPage())),this._setPage(t),!1},f._onPrevious=function(){if(this._pageTrace.length>0){var e=this._pageTrace[this._pageTrace.length-1];this._pageTrace.pop(),this._setPage(e)}return!1},f},a}),define("DQX/FrameCanvas",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/FramePanel"],function(e,t,n,r,i){return function(r){var s=i(r);s._panelfirstRendered=!1,s._toolTipInfo={ID:null},s._directRedraw=!0,s._fixedWidth=null,s._fixedHeight=null,s._dragActionPan=!1,s.selectionHorOnly=!1,s._canvasLayerIds=["main","selection"],s._canvasLayerMap={},e.each(s._canvasLayerIds,function(e,t){s._canvasLayerMap[t]={}}),s.canvasBaseId="CNV_"+s.getDivID()+"_",s.setDirectDedraw=function(e){s._directRedraw=e},s.setFixedWidth=function(e){s._fixedWidth=e,s.handleResize()},s.setFixedHeight=function(e){s._fixedHeight=e,s.handleResize()},s.getCanvasID=function(e){return e in s._canvasLayerMap||t.reportError("Invalid canvas id: "+e),s.canvasBaseId+"_"+e},s.getMyCanvasElement=function(t){return e("#"+s.getCanvasID(t))[0]},s.render_exec=function(){var e=s.getMyCanvasElement("main").getContext("2d");e.fillStyle="#FFFFFF",e.fillRect(0,0,s._cnvWidth,s._cnvHeight);var t={ctx:e,sizeX:s._cnvWidth,sizeY:s._cnvHeight};s.draw(t)},s.render=function(){s._directRedraw?s.render_exec():t.executeProcessing(function(){s.render_exec()})},s.invalidate=t.debounce(s.render,150),s.draw=function(e){e.ctx.beginPath(),e.ctx.moveTo(0,0),e.ctx.lineTo(e.sizeX,e.sizeY),e.ctx.stroke()},s.getToolTipInfo=function(e,t){return null},s.onMouseClick=function(e,t){},s.onSelected=function(e,t,n,r,i,s,o){},s.getEventPosX=function(t){var n=t;return t.originalEvent&&(n=t.originalEvent),n.pageX-e(s.getMyCanvasElement("main")).offset().left},s.getEventPosY=function(t){var n=t;return t.originalEvent&&(n=t.originalEvent),n.pageY-e(s.getMyCanvasElement("main")).offset().top},s.posXCanvas2Screen=function(t){return t+e(s.getMyCanvasElement("main")).offset().left},s.posYCanvas2Screen=function(t){return t+e(s.getMyCanvasElement("main")).offset().top},s._onMouseClick=function(e){!s._hasMouseMoved&&!s.isSelecting()&&s.onMouseClick(e,{x:s.getEventPosX(e),y:s.getEventPosY(e),pageY:e.pageY})},s._onMouseDown=function(t){return s.lassoSelecting||(e(document).bind("mouseup.FrameCanvas",s._onMouseDragUp),e(document).bind("mousemove.FrameCanvas",s._onMouseDragMove),s.hideToolTip(),s.dragging=!0,s._hasMouseMoved=!1,s.dragX0=s.getEventPosX(t),s.dragY0=s.getEventPosY(t),s.dragX1=s.dragX0,s.dragY1=s.dragY0,s._dragActionPan&&!t.shiftKey&&(s.isPanning=!0,s.panningStart(s.dragX0,s.dragY0))),t.returnValue=!1,!1},s._onMouseDragUp=function(t){e(document).unbind("mouseup.FrameCanvas"),e(document).unbind("mousemove.FrameCanvas"),s.dragging=!1;if(s.isPanning)s.isPanning=!1,s.panningStop();else if(s._hasMouseMoved){var n=s.getMyCanvasElement("selection"),r=n.getContext("2d");r.clearRect(0,0,n.width,n.height),s.onSelected(Math.min(s.dragX0,s.dragX1),Math.min(s.dragY0,s.dragY1),Math.max(s.dragX0,s.dragX1),Math.max(s.dragY0,s.dragY1),t.shiftKey,t.ctrlKey,t.altKey)}return t.returnValue=!1,!1},s._drawSelRect=function(){var e=s.getMyCanvasElement("selection"),t=e.getContext("2d");t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),t.fillStyle="rgba(255,0,0,0.1)",t.strokeStyle="rgba(255,0,0,0.5)";var n=s.dragY0,r=s.dragY1;s.selectionHorOnly&&(n=0,r=s.getMyCanvasElement("selection").height),t.beginPath(),t.moveTo(s.dragX0,n),t.lineTo(s.dragX0,r),t.lineTo(s.dragX1,r),t.lineTo(s.dragX1,n),t.closePath(),t.fill(),t.stroke()},s._onMouseDragMove=function(e){return s.dragX1=s.getEventPosX(e),s.dragY1=s.getEventPosY(e),Math.abs(s.dragX1-s.dragX0)+Math.abs(s.dragY1-s.dragY0)>5&&(s._hasMouseMoved=!0),s.isPanning?s.panningDo(s.dragX1,s.dragY1):s._hasMouseMoved&&s._drawSelRect(),e.returnValue=!1,!1},s.isSelecting=function(){return s.dragging||s.lassoSelecting||s.halfPlaneSelecting||s.rectangleSelecting},s._onMouseMove=function(t){var r=s.getEventPosX(t),i=s.getEventPosY(t);if(!s.isSelecting()){var o=s.getToolTipInfo(r,i),u=!1;if(o){o.showPointer&&(u=!0);if(s._toolTipInfo.ID!=o.ID){s.hideToolTip(),s._toolTipInfo=o;var a=n.Div();a.setCssClass("DQXChannelToolTip"),a.addStyle("position","absolute");var f=s.posXCanvas2Screen(s._toolTipInfo.px),l=s.posYCanvas2Screen(s._toolTipInfo.py);a.addStyle("left",f+10+"px"),a.addStyle("top",l+10+"px"),a.addStyle("z-index","9999999"),a.addElem(s._toolTipInfo.content),e("#DQXUtilContainer").append(a.toString());if(s._toolTipInfo.highlightPoint){var a=n.Div();a.setCssClass("DQXChannelToolTipHighlightPoint"),a.addStyle("position","absolute"),a.addStyle("left",f-5+"px"),a.addStyle("top",l-5+"px"),e("#DQXUtilContainer").append(a.toString())}}}else s.hideToolTip();var c=u?"pointer":"auto";e("#"+s.canvasID).css("cursor",c),e("#"+s.getCanvasID("main")).css("cursor",c),e("#"+s.getCanvasID("selection")).css("cursor",c)}},s._onMouseEnter=function(e){},s._onMouseLeave=function(e){s.hideToolTip()},s.startLassoSelection=function(t){if(s.lassoSelecting)return;s.lassoSelecting=!0,s.lassoSelectingCallbackOnComplete=t;var n=[],r=function(t){var r=s.getMyCanvasElement("selection"),i=r.getContext("2d");i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,r.width,r.height),i.fillStyle="rgba(255,0,0,0.1)",i.strokeStyle="rgba(255,0,0,0.5)",i.beginPath(),e.each(n,function(e,t){e==0?i.moveTo(t.x,t.y):i.lineTo(t.x,t.y)}),t&&n.length>0&&i.lineTo(t.x,t.y),i.closePath(),i.fill(),i.stroke()},i=function(e){var t=s.getEventPosX(e),i=s.getEventPosY(e);(n.length==0||t!=n[n.length-1].x||i!=n[n.length-1].y)&&n.push({x:t,y:i}),r()},o=function(){e("#"+s.clickLayerId).unbind("click.FrameCanvasLasso"),e("#"+s.clickLayerId).unbind("dblclick.FrameCanvasLasso"),e(document).unbind("mousemove.FrameCanvasLasso");var t=n;n=[],r(),e("#"+s.clickLayerId).css("cursor","auto"),s.lassoSelecting=!1,s.lassoSelectingCallbackOnComplete&&s.lassoSelectingCallbackOnComplete(t)},u=function(e){var t=s.getEventPosX(e),n=s.getEventPosY(e);r({x:t,y:n})};e("#"+s.clickLayerId).bind("click.FrameCanvasLasso",i),e("#"+s.clickLayerId).bind("dblclick.FrameCanvasLasso",o),e(document).bind("mousemove.FrameCanvasLasso",u),e("#"+s.clickLayerId).css("cursor","crosshair")},s.startHalfPlaneSelection=function(t){if(s.halfPlaneSelecting)return;s.halfPlaneSelecting=!0,s.halfPlaneSelectingCallbackOnComplete=t;var n=function(e){var t=s.getMyCanvasElement("selection"),n=t.getContext("2d");n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.fillStyle="rgba(255,0,0,0.1)",n.strokeStyle="rgba(255,0,0,0.5)";if(r&&e){var o=r;i={x:e.x-r.x,y:e.y-r.y};var u=Math.sqrt(i.x*i.x+i.y*i.y);if(u>10){i.x/=u,i.y/=u,Math.abs(i.y)<.05&&(i.y=0),Math.abs(i.x)<.05&&(i.x=0);var a=1e4;n.beginPath(),n.moveTo(o.x-a*i.x,o.y-a*i.y),n.lineTo(o.x+a*i.x,o.y+a*i.y),n.lineTo(o.x+a*i.x+a*i.y,o.y+a*i.y-a*i.x),n.lineTo(o.x-a*i.x+a*i.y,o.y-a*i.y-a*i.x),n.closePath(),n.fill(),n.stroke()}else i=null}},r=null,i=null,o=function(t){var o=s.getEventPosX(t),u=s.getEventPosY(t);r?(e("#"+s.clickLayerId).unbind("click.FrameCanvasHalfPlaneSelection"),e(document).unbind("mousemove.FrameCanvasHalfPlaneSelection"),n(null),e("#"+s.clickLayerId).css("cursor","auto"),s.halfPlaneSelecting=!1,s.halfPlaneSelectingCallbackOnComplete&&i&&s.halfPlaneSelectingCallbackOnComplete(r,i)):(r={x:o,y:u},n(null))},u=function(e){var t=s.getEventPosX(e),r=s.getEventPosY(e);n({x:t,y:r})};e("#"+s.clickLayerId).bind("click.FrameCanvasHalfPlaneSelection",o),e(document).bind("mousemove.FrameCanvasHalfPlaneSelection",u),e("#"+s.clickLayerId).css("cursor","crosshair")},s.startRectangleSelection=function(t){if(s.rectangleSelecting)return;s.rectangleSelecting=!0,s.rectangleSelectingCallbackOnComplete=t;var n=function(e){var t=s.getMyCanvasElement("selection"),n=t.getContext("2d");n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.fillStyle="rgba(255,0,0,0.1)",n.strokeStyle="rgba(255,0,0,0.5)",r&&e&&(i=e,n.beginPath(),n.moveTo(r.x,r.y),n.lineTo(r.x,i.y),n.lineTo(i.x,i.y),n.lineTo(i.x,r.y),n.closePath(),n.fill(),n.stroke())},r=null,i=null,o=function(t){var o=s.getEventPosX(t),u=s.getEventPosY(t);r?(e("#"+s.clickLayerId).unbind("click.FrameCanvasRectangleSelection"),e(document).unbind("mousemove.FrameCanvasRectangleSelection"),n(null),e("#"+s.clickLayerId).css("cursor","auto"),s.rectangleSelecting=!1,s.rectangleSelectingCallbackOnComplete&&i&&s.rectangleSelectingCallbackOnComplete(r,i)):(r={x:o,y:u},n(null))},u=function(e){var t=s.getEventPosX(e),r=s.getEventPosY(e);n({x:t,y:r})};e("#"+s.clickLayerId).bind("click.FrameCanvasRectangleSelection",o),e(document).bind("mousemove.FrameCanvasRectangleSelection",u),e("#"+s.clickLayerId).css("cursor","crosshair")},s.hideToolTip=function(){s._toolTipInfo.ID=null,e("#DQXUtilContainer").find(".DQXChannelToolTip").remove(),e("#DQXUtilContainer").find(".DQXChannelToolTipHighlightPoint").remove()},s.handleResize=function(t){s._fixedWidth!=null?s._cnvWidth=s._fixedWidth:s._cnvWidth=e("#"+s.getDivID()).innerWidth(),s._fixedHeight!=null?s._cnvHeight=s._fixedHeight:s._cnvHeight=e("#"+s.getDivID()).innerHeight(),e.each(s._canvasLayerIds,function(t,n){e("#"+s.getCanvasID(n)).width(s._cnvWidth),e("#"+s.getCanvasID(n)).height(s._cnvHeight)});if(!t||s._directRedraw)e.each(s._canvasLayerIds,function(e,t){s.getMyCanvasElement(t).width=s._cnvWidth,s.getMyCanvasElement(t).height=s._cnvHeight}),s.render()},s._cnvWidth=e("#"+s.getDivID()).innerWidth(),s._cnvHeight=e("#"+s.getDivID()).innerHeight();var o="";return e.each(s._canvasLayerIds,function(e,t){var r=n.Create("canvas",{id:s.getCanvasID(t)});r.addAttribute("width",s._cnvWidth),r.addAttribute("height",s._cnvHeight),r.setWidthPx(s._cnvWidth).setHeightPx(s._cnvHeight),r.addStyle("position","absolute"),r.addStyle("left","0"),r.addStyle("top","0"),o+=r.toString()}),e("#"+s.getDivID()).html(o),s.clickLayerId=s.getCanvasID("selection"),e("#"+s.clickLayerId).click(e.proxy(s._onMouseClick,s)),e("#"+s.clickLayerId).mousedown(e.proxy(s._onMouseDown,s)),e("#"+s.clickLayerId).mousemove(e.proxy(s._onMouseMove,s)),e("#"+s.clickLayerId).mouseenter(e.proxy(s._onMouseEnter,s)),e("#"+s.clickLayerId).mouseleave(e.proxy(s._onMouseLeave,s)),t.ExecPostCreateHtml(),s.myParentFrame.notifyContentChanged(),s}}),define("Wizards/EditQuery",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p={};return p.CreateDialogBox=function(e,t,n){var s=c.PopupFrame("editquery",{title:"Edit query",blocking:!0,sizeX:700,sizeY:500});return s.tableInfo=h.getTableInfo(e),s.query=t,s.createFrames=function(){s.frameRoot.makeGroupVert(),s.frameBody=s.frameRoot.addMemberFrame(r.FrameFinal("",.7)).setAllowScrollBars(!0,!0),s.frameButtons=s.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,70).setFrameClassClient("DQXGrayClient")},s.createPanels=function(){s.panelButtons=r.Form(s.frameButtons);var e=s.tableInfo.storedSubsets;s.builder=h.getTableInfo(s.tableInfo.id).tableViewer.panelTable.createPanelAdvancedQuery(s.frameBody,function(){},!0,{tableName:s.tableInfo.id,subsetTableName:s.tableInfo.id+"_subsets",primKey:s.tableInfo.primkey,subsetList:e}),s.builder.setQuery(s.query);var t=i.Button(null,{buttonClass:"DQXWizardButton",content:"Cancel",bitmap:a.BMP("cancel.png"),width:80,height:25}).setOnChanged(function(){s.close()}),o=i.Button(null,{buttonClass:"DQXWizardButton",content:"Apply",bitmap:a.BMP("apply.png"),width:80,height:25}).setOnChanged(function(){var e=s.builder.getQuery();n(e)}),u=i.Button(null,{buttonClass:"DQXWizardButton",content:"OK",bitmap:a.BMP("ok.png"),width:80,height:25}).setOnChanged(s.onOK);s.panelButtons.addControl(i.AlignRight(i.CompoundHor([t,i.HorizontalSeparator(10),o,u,i.HorizontalSeparator(7)])))},s.onOK=function(){var e=s.builder.getQuery();s.close(),n(e)},s.create(),s},p}),define("DQX/FrameTree",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/FramePanel"],function(e,t,n,r,i){var s={};return s._objectBranch=function(e,n){this.myID=e,e||(this.myID=t.getNextUniqueID()),this.content=n,this.items=[],this._canSelect=!0,this.myParent=null,this.myTree=null,this._collapsed=!1,this.showBracket=!0,this.canCollapse=!0},s._objectBranch.prototype.setID=function(e){this.myID=e},s._objectBranch.prototype.getID=function(e){return this.myID},s._objectBranch.prototype.setCanSelect=function(e){return this._canSelect=e,this},s._objectBranch.prototype.setCollapsed=function(e){return this._collapsed=e,this},s._objectBranch.prototype.isCollapsed=function(e){return this._collapsed},s._objectBranch.prototype.setCssClass=function(e){return this._cssClass=e,this},s._objectBranch.prototype.renderHtml=function(){return t.interpolate(this.content.toString())},s._objectBranch.prototype.postCreateHtml=function(){},s._objectBranch.prototype.getItems=function(){return this.items},s._objectBranch.prototype.clear=function(){this.tearDown(),this.items=[]},s._objectBranch.prototype.tearDown=function(){e.each(this.items,function(e,t){"tearDown"in t&&t.tearDown()})},s._objectBranch.prototype.addItem=function(e){return e instanceof s._objectBranch||t.reportError("Invalid type for branch member"),this.items.push(e),e.myParent=this,this.myTree&&this.myTree._addItemSub(this),e},s._objectBranch.prototype.setTree=function(e){this.myTree!=null&&this.myTree!==e&&t.reportError("Item is already attached to a tree"),this.myTree=e,this._setTreeSub(e)},s._objectBranch.prototype._setTreeSub=function(e){},s.Branch=function(e,t){return new s._objectBranch(e,t)},s.Control=function(e){var t=s.Branch(e.getID(),"");return t.control=e,t._canSelect=!1,t._setTreeSub=function(e){this.control.setContextID(e.myID)},t.renderHtml=function(e){return this.control.renderHtml()},t.postCreateHtml=function(){return this.control.postCreateHtml()},t.tearDown=function(){t.control&&"tearDown"in t.control&&t.control.tearDown()},t},s.Tree=function(o,u){var a=i(o,u);return a.root=s.Branch(),a.root.myTree=a,a._itemList=[],a._itemMap={},a._activeItem="",a.canCollapse=!0,a.getActiveItem=function(){return a._activeItem},a.clear=function(){a.root=s.Branch(),a.root.myTree=a,a._itemList=[],a._itemMap={},a._activeItem=""},a.findItem=function(e){return this._itemMap[e]},a._addItemSub=function(e){e.setTree(this),e.myID in this._itemMap?this._itemMap[e.myID]!==e&&t.reportError('Tree item ID "{id}" is already used'.DQXformat({id:e.myID})):(this._itemList.push(e),this._itemMap[e.myID]=e);var n=e.getItems();for(var r=0;r<n.length;r++)this._addItemSub(n[r])},a.scrollToBranch=function(t){var n=e("#"+a.getDivID()),r=a._getDivIDItem(t),i=n.find("#"+r),s=i.position().top;n.animate({scrollTop:s},1e3)},a._getDivIDButton=function(e){return this.myID+"_DQXBt_"+e},a._getDivIDItem=function(e){return this.myID+"_DQXIt_"+e},a._createButtonHtml=function(e){return a.canCollapse?'<IMG SRC="'+t.BMP(e?"morelines.png":"lesslines.png")+'" border=0 ALT="" TITLE="" class="DQXTreeButtonImage" style="float:left;padding-right:6px">':""},a._renderSub=function(e,t,r){var i=t.getItems(),s=i.length>0,o=n.Div({parent:e,id:this._getDivIDItem(t.myID)});t._canSelect?o.setCssClass("DQXTreeItem"):o.setCssClass("DQXTreeItemNoSelect"),t._cssClass&&o.setCssClass(t._cssClass);if(s){var u=n.Div({parent:o,id:this._getDivIDButton(t.myID)});u.setCssClass("DQXTreeButton"),t.canCollapse&&u.addElem(this._createButtonHtml(t._collapsed))}contentstr=t.renderHtml(this.myID),o.addElem(contentstr);if(s){var a=n.Div({parent:e,id:this.myID+"_DQXSub_"+t.myID});t._collapsed&&a.addStyle("display","none"),a.addStyle("padding-left","12px"),a.addStyle("padding-bottom","4px");var f=n.Div({parent:a});f.addStyle("padding-left","17px"),t.showBracket&&(f.addStyle("border-width","0px"),f.addStyle("border-color","rgb(190,190,190)"),f.addStyle("border-left-width","1px"),f.addStyle("border-style","solid"),f.addStyle("border-bottom-left-radius","6px"));var l=.82-.07*r;for(var c=0;c<i.length;c++)this._renderSub(f,i[c],r+1)}},a.render=function(){var t=n.Div({id:"tree"});t.setCssClass("DQXTree"),t.addStyle("padding","6px");var r=this.root.getItems();for(var i=0;i<r.length;i++)this._renderSub(t,r[i],0);e("#"+this.getDivID()).html(t.toString());for(var i=0;i<this._itemList.length;i++)this._itemList[i].postCreateHtml();e("#"+this.getDivID()).find(".DQXTreeButton").click(e.proxy(a._clickTreeButton,a)),e("#"+this.getDivID()).find(".DQXTreeItem").click(a._clickTreeItem)},a.setActiveItem=function(t,n){this._activeItem&&e("#"+this.getDivID()).find("#"+this._getDivIDItem(this._activeItem)).removeClass("DQXTreeItemSelected"),e("#"+this.getDivID()).find("#"+this._getDivIDItem(t)).addClass("DQXTreeItemSelected"),this._activeItem=t,n||(a.notifyClickTreeItem&&a.notifyClickTreeItem(t),r.broadcast({type:"SelectItem",id:this.myID},this._activeItem))},a.scrollActiveInView=function(){var t=e("#"+this.getDivID()).children("#"+this._activeItem);e("#"+this.getDivID()).scrollTop(t)},a._clickTreeItem=function(t){var n=e(this).attr("id");n&&(n=n.split("_DQXIt_")[1],a.setActiveItem(n))},a._clickTreeButton=function(t){var n=t.target.id;n==""&&(n=e(t.target).parent().attr("id")),n=n.split("_DQXBt_")[1];var r=this.findItem(n);r._collapsed=!r._collapsed,e("#"+this._getDivIDButton(n)).html(this._createButtonHtml(r._collapsed));var i=e("#"+this.myID+"_DQXSub_"+n);r._collapsed?i.slideUp(250):i.slideDown(250)},a.handleResize=function(){},e("#"+a.getDivID()).addClass("DQXTree"),a},s}),define("DQX/FrameList",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/FramePanel"],function(e,t,n,r,i){return function(s,o){var u=i(s,o);return u.myFilterDivID=u.getDivID()+"_filter",u.myListDivID=u.getDivID()+"_lst",u.items=[],u._activeItem="",u._filterText=null,u._isCreated=!1,u._hasFilter=!1,u._template=null,u._filterTemplateComponentList=[],u.setTemplate=function(e){return u._template=e,u},u.setOnItemHighlighted=function(e){u._onItemHighlighted=e},u.setOnOpen=function(e){u._onOpen=e},u.setHasFilter=function(e){return u._hasFilter=!0,e&&(u._filterTemplateComponentList=e),u},u.setItems=function(e,t){this.items=[];var n=!1;for(var r=0;r<e.length;r++)this.items.push({id:e[r].id,content:e[r].content,icon:e[r].icon}),e[r].id==this._activeItem&&(n=!0);n||(e.length>0?this._activeItem=e[0].id:this._activeItem=""),typeof t!="undefined"&&(this._activeItem=t)},u.render=function(){if(!this._isCreated){var r="",i=0;if(this._hasFilter){i=30;var s=n.Div({});s.addStyle("padding-left","30px"),s.addStyle("padding-right","12px"),s.addStyle("padding-top","3px"),s.addStyle("padding-bottom","5px"),s.addStyle("background-color","rgb(210,210,210)"),s.addElem('<IMG SRC="'+t.BMP("magnif2.png")+'" border=0 ALT="" TITLE="" style="position:absolute;left:3px;top:2px">');var o=n.Edit("",{id:this.myFilterDivID,parent:s,placeHolder:"Enter search text to filter items"});o.addStyle("width","100%"),o.addStyle("height","18px"),o.addStyle("border","1px solid rgb(170,170,170)"),r+=s.toString()}var a=n.Div({id:this.myListDivID});a.setCssClass("DQXLargeList"),a.makeAutoVerticalScroller(!0),a.addStyle("position","absolute"),this._hasFilter?a.addStyle("top",i+"px"):a.addStyle("top","0px"),a.addStyle("bottom","0px"),a.addStyle("left","0px"),a.addStyle("right","0px"),r+=a.toString(),e("#"+this.getDivID()).html(r),this._hasFilter&&e("#"+this.myFilterDivID).bind("propertychange keyup input paste",e.proxy(u._onChangeFilter,u)),this._isCreated=!0,this.scrollHelper=t.scrollHelper(e("#"+this.myListDivID))}var f="",l="";for(var c=0;c<this.items.length;c++){var h=n.Div();h.setID(this.items[c].id),this._activeItem==this.items[c].id?h.setCssClass("DQXLargeListItemSelected"):h.setCssClass("DQXLargeListItem"),this.items[c].icon&&h.addElem('<IMG SRC="'+this.items[c].icon+'" border=0 ALT="" TITLE="" style="float:left;padding-right:6px">');var p=!this._filterText;if(!this._template){this._filterText&&(p=this.items[c].content.toUpperCase().indexOf(this._filterText)>=0);var d=this.items[c].content;this._filterText&&(d=t.highlightText(d,this._filterText)),h.addElem(d)}else{var v=e.extend(!0,{},u.items[c].content);this._filterText&&e.each(this._filterTemplateComponentList,function(e,n){u.items[c].content[n].toUpperCase().indexOf(u._filterText)>=0&&(p=!0),v[n]=t.highlightText(v[n],u._filterText)});var d=this._template.DQXformat(v);h.addElem(d)}p?f+=h.toString():(h.addStyle("color","rgb(130,130,130)"),l+=h.toString())}e("#"+this.myListDivID).html(f+l),e("#"+this.myListDivID).children().click(u._clickItem),e("#"+this.myListDivID).children().dblclick(u._dblclickItem),e("#"+this.myListDivID).children().mousedown(function(e){e.preventDefault()}),u.scrollHelper.update()},u._onChangeFilter=function(){this._filterText=e("#"+this.myFilterDivID).val().toUpperCase(),this.render(),e("#"+this.myListDivID).scrollTop(0)},u.setActiveItem=function(t,n){this._activeItem&&e("#"+this.myListDivID).children("#"+this._activeItem).addClass("DQXLargeListItem").removeClass("DQXLargeListItemSelected"),e("#"+this.myListDivID).children("#"+t).removeClass("DQXLargeListItem").addClass("DQXLargeListItemSelected"),this._activeItem=t,n||(r.broadcast({type:"SelectItem",id:this.myID},this._activeItem),u._onItemHighlighted&&u._onItemHighlighted(u._activeItem))},u.scrollActiveInView=function(){if(this._activeItem){var t=e("#"+this.myListDivID).children("#"+this._activeItem).position().top;e("#"+this.myListDivID).scrollTop(t)}},u._clickItem=function(t){var n=e(this),r=n.attr("id");return u.setActiveItem(r),t.preventDefault(),t.stopPropagation(),!1},u._dblclickItem=function(e){return e.preventDefault(),e.stopPropagation(),u._onOpen&&u._onOpen(),!1},u.handleResize=function(){u.scrollHelper&&u.scrollHelper.update()},u.getActiveItem=function(){return this._activeItem},u}}),define("Wizards/ManageStoredEntities",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/FrameList","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.manage=function(e,t,n,a,l){var c=h.PopupFrame("ManageEntity_"+e,{title:"Manage "+a,blocking:!0,sizeX:400,sizeY:350});return c.tablename=e,c.tableid=t,c.createFrames=function(){c.frameRoot.makeGroupVert();var e=c.frameRoot.addMemberFrame(r.FrameGroupVert("",.7)).setSeparatorSize(2);c.frameInfo=e.addMemberFrame(r.FrameFinal("",.01)).setFrameClassClient("InfoBox").setMargins(8).setAutoSize().setAllowScrollBars(!1,!1),c.frameList=e.addMemberFrame(r.FrameFinal("",.7)).setAllowScrollBars(!0,!0),c.frameButtons=c.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,47).setFrameClassClient("DQXGrayClient")},c.createPanels=function(){var e=r.Form(this.frameInfo);e.addHtml("Stored queries are permanently maintained on the server, and can be recalled during later sessions or shared with other users."),e.render(),c.panelList=i(c.frameList),c.reload();var t=s.Button(null,{buttonClass:"PnButtonGrid",content:"Add current",bitmap:"Bitmaps/actionbuttons/new.png",width:100,height:35}).setOnChanged(c.onAdd),n=s.Button(null,{buttonClass:"PnButtonGrid",content:"Delete selected",bitmap:"Bitmaps/actionbuttons/delete.png",width:100,height:35}).setOnChanged(c.onDel),o=s.Button(null,{buttonClass:"PnButtonGrid",content:"Set selected as default",bitmap:"Bitmaps/actionbuttons/import.png",width:120,height:35}).setOnChanged(c.onDefault);c.panelButtons=r.Form(c.frameButtons),c.panelButtons.addControl(s.CompoundHor([t,n,o]))},c.reload=function(){var t=d.ServerDataGetter();t.addTable(e,["id","name","content"],"name",u.WhereClause.AND([u.WhereClause.CompareFixed("workspaceid","=",m.workspaceid),u.WhereClause.CompareFixed("tableid","=",c.tableid)])),t.execute(m.serverUrl,m.database,function(){var n=t.getTableRecords(e);c.itemsByID={};var r=[];$.each(n,function(e,t){r.push({id:t.id,content:t.name,query:t.content}),c.itemsByID[t.id]={id:t.id,content:t.name,query:t.content}}),c.panelList.setItems(r),c.panelList.render()})},c.onDel=function(){var t=c.panelList.getActiveItem();t&&window.confirm("Remove "+n+"?")&&f.customRequest(m.serverUrl,PnServerModule,"delstoredentity",{database:m.database,tablename:e,id:t},function(){c.reload(),o.broadcast({type:"StoredQueriesModified"},{tableid:c.tableid})})},c.onAdd=function(){var t=prompt("Please enter a name for the "+n,"");t!=null&&f.customRequest(m.serverUrl,PnServerModule,"addstoredentity",{database:m.database,tablename:e,tableid:c.tableid,workspaceid:m.workspaceid,name:t,content:l},function(e){c.reload(),o.broadcast({type:"StoredQueriesModified"},{tableid:c.tableid})})},c.onDefault=function(){var e=c.panelList.getActiveItem();if(e){var t=c.itemsByID[e].query;f.customRequest(m.serverUrl,PnServerModule,"update_default_query",{database:m.database,id:c.tableid,defaultQuery:t},function(){alert("Default set")})}},c.create(),c},g}),define("Utils/QueryTool",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameTree","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","Wizards/ManageStoredEntities","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.getSubSamplingOptions_All=function(){var e={};return e.frac=1,e.sliceidx=0,e},g.Create=function(e,t){var n={};return n.tableInfo=m.getTableInfo(e),n.query=o.WhereClause.decode(o.WhereClause.encode(n.tableInfo.defaultQuery)),n.hasSubSampler=!1,n.tableInfo.currentQuery&&(n.query=o.WhereClause.decode(o.WhereClause.encode(n.tableInfo.currentQuery))),n.prevQueries=[],t&&(n.includeCurrentQuery=t.includeCurrentQuery,n.hasSubSampler=t.hasSubSampler),n.setStartQuery=function(e){n.query=o.WhereClause.decode(o.WhereClause.encode(e))},n.get=function(){return n.query},n.getForFetching=function(){if(!n.hasSubSampler)return n.get();var e=n.subSamplerMapper(n.ctrlSubSampler.getValue());if(e<0)return n.query;var t=n.reSampleSliceIndex,r=t*e,i=(t+1)*e;return o.WhereClause.createRestriction(n.query,o.WhereClause.CompareBetween("RandPrimKey",r,i))},n.isSubSampling=function(){if(!n.hasSubSampler)return!1;var e=n.subSamplerMapper(n.ctrlSubSampler.getValue());return e>0},n.getSubSamplingOptions=function(){var e={};return n.hasSubSampler&&(e.frac=n.ctrlSubSampler.getValue(),e.sliceidx=n.reSampleSliceIndex),e},n.setSubSamplingOptions=function(e){n.hasSubSampler&&(n.ctrlSubSampler.modifyValue(e.frac),e.sliceidx!=null&&(n.reSampleSliceIndex=e.sliceidx))},n.store=function(){var e={query:o.WhereClause.encode(n.query)};return n.hasSubSampler&&(e.frac=n.ctrlSubSampler.getValue(),e.sliceidx=n.reSampleSliceIndex),e},n.recall=function(e,t){n.query=o.WhereClause.decode(e.query),n.ctrlQueryString&&n.ctrlQueryString.modifyValue(n.tableInfo.tableViewer.getQueryDescription(n.query)),n.clearQueryShowHide&&n.clearQueryShowHide.setVisible(!n.query.isTrivial),n.hasSubSampler&&(n.ctrlSubSampler.modifyValue(e.frac),e.sliceidx!=null&&(n.reSampleSliceIndex=e.sliceidx)),t&&n.notifyQueryUpdated&&n.notifyQueryUpdated()},n.modify=function(e){n.prevQueries.push(o.WhereClause.encode(n.query)),n.query=e,n.ctrlQueryString&&n.ctrlQueryString.modifyValue(n.tableInfo.tableViewer.getQueryDescription(e)),n.clearQueryShowHide&&n.clearQueryShowHide.setVisible(!n.query.isTrivial),n.notifyQueryUpdated&&n.notifyQueryUpdated()},n.createQueryControl=function(e,r){var u=!1;e&&e.defaultHidden&&(u=!0);var f=!0;e&&e.noDefine&&(f=!1);var l=!1;e&&e.hasSection&&(l=!0);var c=!1;e&&e.hasQueryString&&(c=!0),n.controlsWidth=185,e&&e.controlsWidth&&(n.controlsWidth=e.controlsWidth);var h=i.BaseCustom(!0).setMargin(0),p=i.CompoundVert().setMargin(6);if(n.hasSubSampler){n.reSampleSliceIndex=0;var v=.65;t.subSamplingOptions&&(n.reSampleSliceIndex=t.subSamplingOptions.sliceidx,v=t.subSamplingOptions.frac),n.ctrlSubSampler=i.ValueSlider(null,{label:"Subsampling:",width:n.controlsWidth,height:18,minval:0,maxval:1,value:v,digits:10,drawIndicators:!1}).setNotifyOnFinished().setOnChanged(function(){n.reSampleSliceIndex=0,n.notifyQueryUpdated()});var m=[20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6];n.subSamplerMapper=function(e){if(e>.95)return-1;var t=Math.pow(1e6,(e+.3)/1.3),n=1e9,r=1;return $.each(m,function(e,i){n>Math.abs(i-t)&&(r=i,n=Math.abs(i-t))}),r},n.ctrlSubSampler.customValueMapper=function(e){var t=n.subSamplerMapper(e),r="";if(t<0)r="All";else{r=t.toFixed(0);if(t>1e4)var r=(t/1e3).toFixed(0)+"K"}return r},p.addControl(i.CompoundHor([n.ctrlSubSampler]))}if(f){var y=i.Button(null,{content:"Define query",buttonClass:"PnButtonGrid",width:130,height:30,icon:"fa-filter"});y.setOnChanged(function(){d.CreateDialogBox(n.tableInfo.id,n.query,function(e){n.modify(e)})}),n.buttonOpen=i.Button(null,{content:" ",hint:"Open existing query",buttonClass:"PnButtonGrid",bitmap:"Bitmaps/ellipsis.png",width:30,height:30}).setOnChanged(function(){g.createOpenQueryPopup(n)})}return c&&(n.clearQuery=i.Button(null,{hint:"Clear Query",buttonClass:"PnClearQuery",bitmap:a.BMP("closeSmall.png")}),n.clearQuery.setOnChanged(function(){n.modify(o.WhereClause.Trivial())}),n.clearQueryShowHide=i.ShowHide(n.clearQuery),n.clearQueryShowHide.setVisible(!n.query.isTrivial),n.ctrlQueryString=i.Html(null,n.tableInfo.tableViewer.getQueryDescription(n.query),"PnQueryString"),p.addControl(i.CompoundFloat([n.clearQueryShowHide,n.ctrlQueryString]))),f&&p.addControl(i.CompoundHor([y,n.buttonOpen])),r&&$.each(r,function(e,t){p.addControl(t)}),n.updateStoredQueries(),s.listen("",{type:"StoredQueriesModified"},function(e,t){t.tableid==n.tableInfo.id&&n.updateStoredQueries()}),l?h.addControl(i.Section(p,{title:n.tableInfo.tableCapNamePlural+" query",bodyStyleClass:"ControlsSectionBody",defaultCollapsed:u})):h.addControl(p),h},n.updateStoredQueries=function(){},n.createQueryDisplayStringHtml=function(){var e="";e=n.tableInfo.createQueryDisplayString(n.get());if(n.isSubSampling()){var t=n.subSamplerMapper(n.ctrlSubSampler.getValue());e+='<br><span style="color:rgb(150,100,100)">(from a <span style="color:rgb(192,0,0);"><b>{count}</b></span> {names} random subsampling set)</span>'.DQXformat({count:t,names:n.tableInfo.tableNamePlural})}return e},n},g.CreateStoredQueryPicker=function(e,t){return that=i.BaseCustom(),that.tableInfo=m.getTableInfo(e),that.pickedHandler=t,that.handlePickQuery=function(){var e=that.ctrlPick.getValue();that.ctrlPick.modifyValue("");if(e=="_all_"){that.pickedHandler(o.WhereClause.Trivial());return}e&&p.fetchSingleRecord(m.serverUrl,m.database,"storedqueries","id",e,function(e){that.pickedHandler(o.WhereClause.decode(e.content))})},that.ctrlPick=i.Combo(null,{label:"",states:[],width:130}).setOnChanged(that.handlePickQuery),that.addControl(that.ctrlPick),that.updateStoredQueries=function(){var e=p.ServerDataGetter();e.addTable("storedqueries",["id","name"],"name",o.WhereClause.AND([o.WhereClause.CompareFixed("workspaceid","=",m.workspaceid),o.WhereClause.CompareFixed("tableid","=",that.tableInfo.id)])),e.execute(m.serverUrl,m.database,function(){var t=e.getTableRecords("storedqueries"),n=[];n.push({id:"",name:"[ Queries ]"}),n.push({id:"_all_",name:"All "+that.tableInfo.name}),$.each(t,function(e,t){n.push({id:t.id,name:t.name})}),that.ctrlPick.setItems(n,"")})},that.updateStoredQueries(),s.listen("",{type:"StoredQueriesModified"},function(e,t){t.tableid==that.tableInfo.id&&that.updateStoredQueries()}),that},g.createOpenQueryPopup=function(e){var t=c.PopupFrame("OpenStoredQuery_"+e.tableInfo.id,{title:"Open "+e.tableInfo.tableNamePlural+" query",blocking:!0,sizeX:500,sizeY:450});return t.queryTool=e,t.tableInfo=e.tableInfo,t.createFrames=function(){t.frameRoot.makeGroupVert();var e=t.frameRoot.addMemberFrame(r.FrameGroupVert("",.7)).setSeparatorSize(2);t.frameTree=e.addMemberFrame(r.FrameFinal("",.99)).setAllowScrollBars(!1,!0),t.frameButtons=t.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,47).setFrameClassClient("DQXGrayClient").setAllowScrollBars(!1,!1)},t.createPanels=function(){t.panelTree=h.Tree(t.frameTree),t.panelButtons=r.Form(t.frameButtons),t.getStoredQueries()},t.getStoredQueries=function(){var e=p.ServerDataGetter();e.addTable("storedqueries",["id","name"],"name",o.WhereClause.AND([o.WhereClause.CompareFixed("workspaceid","=",m.workspaceid),o.WhereClause.CompareFixed("tableid","=",t.tableInfo.id)])),e.execute(m.serverUrl,m.database,function(){var n=e.getTableRecords("storedqueries");t.storedQueries=[],$.each(n,function(e,n){t.storedQueries.push({id:n.id,name:n.name})}),t.renderItems()})},t.renderItems=function(){t.panelTree.clear();var e=[];if(t.queryTool.prevQueries.length>0){var n=o.WhereClause.decode(t.queryTool.prevQueries[t.queryTool.prevQueries.length-1]);n.isTrivial||e.push({id:"_previous_",name:'Previous query <span style="color:rgb(150,150,150)">('+t.tableInfo.createQueryDisplayString(n)+")</span>"})}t.queryTool.query.isTrivial||e.push({id:"_all_",name:"All "+t.tableInfo.tableNamePlural}),e.length>0&&$.each(e,function(e,n){var r='<div style="padding-bottom:5px;padding-top:5px"><img style="position:relative;top:2px" src="Bitmaps/actionbuttons/open.png"/>&nbsp;'+n.name+"</div>",i=h.Branch(n.id,r);t.panelTree.root.addItem(i)});var r=i.ImageButton(null,{bitmap:"Bitmaps/actionbuttons/edit.png",hint:"Edit stored queries",vertShift:-3});r.setOnChanged(function(){newValue=null,t.queryTool.query&&(newValue=t.queryTool.store().query),t.close(),v.manage("storedqueries",t.tableInfo.id,"stored query","stored queries",newValue)});var s=h.Control(i.CompoundHor([i.Static('<div style="font-size: 120%;font-weight: bold">Stored queries&nbsp;&nbsp;</div>'),r]));s.canCollapse=!1,t.panelTree.root.addItem(s),$.each(t.storedQueries,function(e,t){var n='<img style="position:relative;top:2px" src="Bitmaps/actionbuttons/open.png"/>&nbsp;'+t.name,r=h.Branch("storedquery_l_"+t.id,n);s.addItem(r)});if(t.storedQueries.length==0){var u=h.Branch(null,'<span class="SupportingText"><i>There are currently no stored queries present for {names}. You can store the current query by clicking on the edit button.</i></span>'.DQXformat({names:t.tableInfo.tableNamePlural}));u.setCanSelect(!1),s.addItem(u)}t.panelTree.notifyClickTreeItem=function(e){if(e=="_all_"){t.queryTool.modify(o.WhereClause.Trivial()),t.close();return}if(e=="_previous_"){t.queryTool.modify(o.WhereClause.decode(t.queryTool.prevQueries.pop())),t.queryTool.prevQueries.pop(),t.close();return}if(e.split("_l_")[0]=="storedquery"){queryid=e.split("_l_")[1],p.fetchSingleRecord(m.serverUrl,m.database,"storedqueries","id",queryid,function(e){t.queryTool.modify(o.WhereClause.decode(e.content))}),t.close();return}},t.panelTree.render()},t.create(),t},g}),define("Plots/GenericPlot",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Utils/QueryTool"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y._registeredPlotTypes={},y.registerPlotType=function(e){e.typeID||f.reportError("Invalid plot type"),y._registeredPlotTypes[e.typeID]=e},y.getCompatiblePlotTypes=function(e){var t=[];return $.each(y._registeredPlotTypes,function(n,r){r.isCompatible(e)&&t.push(r)}),t},y.activePlotList=[],y.Create=function(n,r,i,u,a){i.blocking=!1,i.sizeX=700,i.sizeY=550;var l=h.PopupFrame(n+"_"+r,i);y.activePlotList.push(l),m.isManager&&l.addTool("fa-link",function(){l.handleCreateLink()}),l.plotTypeID=r,l.tableInfo=m.getTableInfo(n),l.eventids=[];var c=f.getNextUniqueID();l.eventids.push(c),o.listen(c,{type:"PropertyContentChanged"},function(e,t){l.tableInfo.id==t.tableid&&l.notifyPropertyContentChanged&&l.notifyPropertyContentChanged(t.propid)});var p=null;return a&&a.subSamplingOptions&&(p=a.subSamplingOptions),l.hasProvidedAspects=function(){return a?!!a.aspects:!1},l.providedAspect2Property=function(e){return a?a.aspects?a.aspects[e]?a.aspects[e]:"":"":""},l.theQuery=g.Create(n,{includeCurrentQuery:!0,hasSubSampler:l.tableInfo.settings.AllowSubSampling,subSamplingOptions:p}),u&&l.theQuery.setStartQuery(u),l.onClose=function(){$.each(l.eventids,function(e,t){o.delListener(t)});var e=-1;$.each(y.activePlotList,function(t,n){n===l&&(e=t)}),e>=0?y.activePlotList.splice(e,1):f.reportError("Plot not found!"),l.onCloseCustom&&l.onCloseCustom()},l.plotSettingsControls={},l.addPlotSettingsControl=function(e,t){l.plotSettingsControls[e]=t},l.store=function(){var e={};return e.tableid=l.tableInfo.id,e.plotTypeID=l.plotTypeID,e.query=l.theQuery.store(),e.settings={},$.each(l.plotSettingsControls,function(t,n){e.settings[t]=s.storeSettings(n)}),l.storeCustomSettings&&(e.settingsCustom=l.storeCustomSettings()),e.controlsCollapsed=l.frameRoot.isControlsCollapsed(),e},l.recall=function(e){e.query&&l.theQuery.recall(e.query),e.settings&&(l.staging=!0,$.each(l.plotSettingsControls,function(t,n){e.settings[t]&&s.recallSettings(n,e.settings[t],!1)}),l.staging=!1),e.settingsCustom&&l.recallCustomSettings&&l.recallCustomSettings(e.settingsCustom),l.reloadAll()},l.createIntroControls=function(e){l.introText=s.Html(null,"","_dummyclass_"),l.ctrl_PointCount=s.Html(null,"");var t=[l.ctrl_PointCount];e&&$.each(e,function(e,n){t.push(n)});var n=l.theQuery.createQueryControl({},t);return l.setIntroText(),s.Wrapper(s.CompoundVert([l.introText,s.AlignCenter(s.CompoundVert([s.VerticalSeparator(10),n]))]),"ControlsSectionBody")},l.onQueryModified=function(){l.setIntroText(),l.updateQuery&&l.updateQuery()},l.setIntroText=function(){var e="";e+=l.tableInfo.createIcon({floatLeft:!0}),e+="<b>{Names}</b><br>".DQXformat({Names:l.tableInfo.tableCapNamePlural}),e+=l.theQuery.createQueryDisplayStringHtml(),l.introText.modifyValue(e)},l.handleCreateLink=function(){var n=t.encode(JSON.stringify(l.store()));f.serverDataStore(m.serverUrl,n,function(t){f.customRequest(m.serverUrl,PnServerModule,"view_store",{database:m.database,workspaceid:m.workspaceid,id:t},function(n){e("Utils/IntroViews").createIntroView("plot",t,"-","Add plot to start page")})})},l.theQuery.notifyQueryUpdated=l.onQueryModified,l},y.loadStoredPlot=function(e,n){f.serverDataFetch(m.serverUrl,n,function(e){var n=JSON.parse(t.decode(e));y.recall([n])})},y.store=function(){var e=[];return $.each(y.activePlotList,function(t,n){e.push(n.store())}),e},y.recall=function(e){$.each(e,function(e,t){var n=y._registeredPlotTypes[t.plotTypeID];n||f.reportError("Unknown plot type: "+t.plotTypeID);var r=n.Create(t.tableid,null,null,t);r.recall(t)})},o.listen("",{type:"LoadStoredPlot"},y.loadStoredPlot),y}),define("Utils/TableRecordSelectionManager",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Plots/GenericPlot"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.Create=function(e,t,n){var r={};return r.id=e,r.tableInfo=t,r.onChangedHandler=n,r.mem={},r.fieldCache=t.fieldCache,r.isItemSelected=function(e){return r.mem[e]},r.selectItem=function(e,t,n){r.mem[e]!=t&&(r.mem[e]=t,t&&r.fieldCache.add(e),r.onChangedHandler&&!n&&r.onChangedHandler(e))},r.notifyChanged=function(){r.onChangedHandler&&r.onChangedHandler(e)},r.clearAll=function(){r.mem={},r.notifyChanged()},r.getSelectedList=function(){var e=[];return $.each(r.mem,function(t,n){n&&e.push(t)}),e},r.getSelectedCount=function(){var e=0;return $.each(r.mem,function(t,n){n&&(e+=1)}),e},r.storeSettings=function(){return JSON.stringify(r.getSelectedList())},r.recallSettings=function(e){var t=JSON.parse(e);r.mem={},$.each(t,function(e,t){r.mem[t]=!0,r.fieldCache.add(t)})},r},g}),define("Utils/TableFieldCache",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Plots/GenericPlot"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.throttledBroadCast=a.debounce(s.broadcast,250),g.Create=function(e){var t={};return t.tableInfo=e,t.cache={},t._fieldStatus={},t.add=function(e){t.cache[e]||p.fetchSingleRecord(v.serverUrl,v.database,t.tableInfo.id,t.tableInfo.primkey,e,function(n){t.cache[e]=n,g.throttledBroadCast({type:"TableFieldCacheModified",tableid:t.tableInfo.id})},function(e,t){})},t.requestAll=function(n,r){var i=!!v.findProperty(e.id,e.primkey).isFloat;if(!!t._fieldStatus[n])return t._fieldStatus[n].fetched?!0:!1;t._fieldStatus[n]={fetched:!1,notifyList:[r]};var s=p.RecordsetFetcher(v.serverUrl,v.database,t.tableInfo.getQueryTableName(!1));s.addColumn(t.tableInfo.primkey,i?"IN":"ST"),s.addColumn(n,"ST"),s.getData(o.WhereClause.Trivial(),t.tableInfo.primkey,function(e){var r=e[t.tableInfo.primkey],i=e[n];$.each(r,function(e,r){t.cache[r]||(t.cache[r]={}),t.cache[r][n]=i[e]}),t._fieldStatus[n].fetched=!0,$.each(t._fieldStatus[n].notifyList,function(e,t){t()})},function(e){t._fieldStatus[n]=null})},t.getField=function(e,n){return t.cache[e]?t.cache[e][n]?t.cache[e][n]:"":""},t},g}),define("Utils/TableFullDataItemInfo",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Plots/GenericPlot"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.throttledBroadCast=a.debounce(s.broadcast,250),g.create=function(e){var t={};return t.tableInfo=e,t._items=null,t._fetching=!1,t._callBackList=[],t._fetch=function(){t._fetching=!0;var n=p.ServerDataGetter();t._properties=[];var r=[];$.each(v.customProperties,function(n,i){i.tableid==e.id&&(t._properties.push(i),r.push(i.propid))});var i=e.getQueryTableName(!1);n.addTable(i,r,e.primkey,o.WhereClause.Trivial(),{}),n.execute(v.serverUrl,v.database,function(){t._items=n.getTableRecords(i),t._fetching=!1,$.each(t._items,function(e,n){$.each(t._properties,function(e,t){t.isFloat&&n[t.propid]!=null&&(n[t.propid]===""?n[t.propid]=0:n[t.propid]=parseFloat(n[t.propid]))})}),$.each(t._callBackList,function(e,n){n(t._items)}),t._callBackList=[]})},t.get=function(e){t._items?e(t._items):(t._callBackList.push(e),t._fetching||t._fetch())},t},g}),define("Utils/Initialise",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","Utils/TableRecordSelectionManager","Utils/TableFieldCache","Utils/TableFullDataItemInfo","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b={};b.colorFalse=a.Color(.85,.25,0),b.colorTrue=a.Color(0,.5,1);var w=function(e){return function(t){return t==null||t=="None"?"":(t=parseFloat(t),isNaN(t)?"":t.toFixed(e))}};return b._waitcount=0,b.incrWait=function(){b._waitcount+=1},b.decrWait=function(){b._waitcount-=1},b.waitForCompletion=function(e){function t(){b._waitcount<=0?e():setTimeout(t,50)}t()},b.parseTableSettings=function(e){var t={GenomeMaxViewportSizeX:5e4};e.settings&&(e.settings=e.settings.replace(/`/g,'\\"'),e.settings=e.settings.replace(/\n/g,"\\n"),t=$.extend(t,JSON.parse(e.settings))),e.settings=t},b.augmentTableInfo=function(e){e.hasGenomePositions=e.IsPositionOnGenome=="1",e.defaultQuery!=""?e.defaultQuery=o.WhereClause.decode(e.defaultQuery):e.defaultQuery=o.WhereClause.Trivial(),e.currentQuery=e.defaultQuery,e.currentSelection={},e.tableNameSingle=e.name,e.tableNamePlural=e.name,e.settings.NameSingle&&(e.tableNameSingle=e.settings.NameSingle),e.settings.NamePlural&&(e.tableNamePlural=e.settings.NamePlural),e.tableCapNameSingle=e.tableNameSingle.charAt(0).toUpperCase()+e.tableNameSingle.slice(1),e.tableCapNamePlural=e.tableNamePlural.charAt(0).toUpperCase()+e.tableNamePlural.slice(1),e.fieldCache=m.Create(e),e._fullDataItemInfo=g.create(e),e.loadFullDataItemInfo=function(t){e._fullDataItemInfo.get(t)},e.hasGenomeRegions=!!e.settings.IsRegionOnGenome,e.hasGenomePositions&&(e.ChromosomeField=e.settings.Chromosome||"chrom",e.PositionField=e.settings.Position||"pos");if(e.hasGenomeRegions||e.hasGenomePositions)e.genomeBrowserInfo={};e.quickFindFields=[e.primkey],"QuickFindFields"in e.settings&&(e.quickFindFields=e.settings.QuickFindFields.split(",")),e.isItemSelected=function(t){return e.currentSelection[t]},e.selectItem=function(t,n){n?e.currentSelection[t]=!0:delete e.currentSelection[t]},e.clearSelection=function(t,n){e.currentSelection={}},e.getSelectedCount=function(){var t=0;return $.each(e.currentSelection,function(e,n){n&&(t+=1)}),t},e.getSelectedList=function(){var t=[];return $.each(e.currentSelection,function(e,n){n&&t.push(e)}),t},e.colIsHidden={},e.isPropertyColumnVisible=function(t){return!e.colIsHidden[t]},e.setPropertyColumnVisible=function(t,n){e.colIsHidden[t]=!n},e.storeSettings=function(){var t={};return t.tableBasedSummaryValues={},t.tableBasedSummaryValues.selection=e.genomeTrackSelectionManager.storeSettings(),t},e.recallSettings=function(t){t.tableBasedSummaryValues&&t.tableBasedSummaryValues.selection&&e.genomeTrackSelectionManager.recallSettings(t.tableBasedSummaryValues.selection)},e.getQueryTableName=function(t){return t?e.id+"CMBSORTRAND_"+y.workspaceid:e.id+"CMB_"+y.workspaceid},e.createSubsetWhereclause=function(t){var n=o.WhereClause.InSubset();return n.SubsetTable=e.id+"_subsets",n.PrimKey=e.primkey,n.Subset=t,n},e.createNoteWhereclause=function(t){var n=o.WhereClause.NoteContains();return n.NoteItemTable=e.id,n.PrimKey=e.primkey,n.NoteText=t,n},e.createQueryDisplayString=function(t){if(!t||t.isTrivial)return"All";var n={};$.each(y.customProperties,function(t,r){r.tableid==e.id&&(n[r.propid]={name:r.name,toDisplayString:r.toDisplayString})});var r={};$.each(e.storedSubsets,function(e,t){r[t.id]={name:t.name}});var i={fieldInfoMap:n,subsetMap:r};return t.toQueryDisplayString(i,0)},e.createIcon=function(t){var n=u.Div();return n.setCssClass("DatasetIcon"),n.addStyle("position","relative"),e.settings.Icon?n.addElem('<span class="fa {icon}" style="line-height: inherit;font-size: 30px;/*text-shadow:-1px -1px 0px rgb(110,110,110);*/"></span>'.DQXformat({icon:e.settings.Icon})):n.addElem(e.settings.LetterCode),t&&t.floatLeft&&(n.addStyle("float","left"),n.addStyle("margin-right","10px"),n.addStyle("margin-bottom","5px")),n.toString()},e.propertyGroups=[],e.propertyGroupMap={},e.settings.PropertyGroups&&$.each(e.settings.PropertyGroups,function(t,n){n.properties=[],e.propertyGroups.push(n),e.propertyGroupMap[n.Id]=n})},b.augment2DTableInfo=function(e){e.tableNameSingle=e.name,e.tableNamePlural=e.name,e.settings.NameSingle&&(e.tableNameSingle=e.settings.NameSingle),e.settings.NamePlural&&(e.tableNamePlural=e.settings.NamePlural),e.tableCapNameSingle=e.tableNameSingle.charAt(0).toUpperCase()+e.tableNameSingle.slice(1),e.tableCapNamePlural=e.tableNamePlural.charAt(0).toUpperCase()+e.tableNamePlural.slice(1),e.col_table=y.mapTableCatalog[e.col_table],e.row_table=y.mapTableCatalog[e.row_table],e.hasGenomePositions=e.col_table.hasGenomePositions,e.hasGenomePositions&&(e.genomeBrowserInfo={});var t={};e.settings&&(t=$.extend(t,JSON.parse(e.settings))),t.GenomeMaxViewportSizeX=parseInt(t.GenomeMaxViewportSizeX),e.settings=t},b.createLetterCodes=function(){var e=[];$.each(y.tableCatalog,function(t,n){n.settings.LetterCode&&e.push(n.settings.LetterCode)}),$.each(y.tableCatalog,function(t,n){if(!n.settings.LetterCode){n.settings.LetterCode="Xx";if(n.tableCapNamePlural&&n.tableCapNamePlural.length>1){n.settings.LetterCode="";var r=[],i=n.tableCapNamePlural.split(" ");i.length>1&&r.push(i[1][0]);for(var s=1;s<n.tableCapNamePlural.length;s++)r.push(n.tableCapNamePlural[s]);$.each(r,function(t,r){if(!n.settings.LetterCode){var i=n.tableCapNamePlural[0]+r;e.indexOf(i,0)<0&&(n.settings.LetterCode=i)}})}}})},b.parseSummaryValues=function(){$.each(y.summaryValues,function(e,t){t.minval?t.minval=parseFloat(t.minval):t.minval=0,t.maxval?t.maxval=parseFloat(t.maxval):t.maxval=0,t.minblocksize=parseFloat(t.minblocksize),t.isCustom=!0;var n={channelColor:"rgb(0,0,180)"};t.settings&&(n=$.extend(n,JSON.parse(t.settings))),t.settings=n})},b.parseCustomProperties=function(){$.each(y.customProperties,function(e,t){var n=y.mapTableCatalog[t.tableid];t.isCustom=t.source=="custom",t.datatype=="Text"&&(t.isText=!0);if(t.datatype=="Value"||t.datatype=="LowPrecisionValue"||t.datatype=="HighPrecisionValue"||t.datatype=="GeoLongitude"||t.datatype=="GeoLattitude"||t.datatype=="Date")t.isFloat=!0;t.datatype=="Boolean"&&(t.isBoolean=!0),t.datatype=="Date"&&(t.isDate=!0),t.name||(t.name=t.propid);var r={showInTable:!0,showInBrowser:!1,channelName:"",channelColor:"rgb(0,0,0)",connectLines:!1};t.isFloat&&(r.minval=0,r.maxval=1,r.decimDigits=2),t.datatype=="GeoLongitude"&&(r.minval=0,r.maxval=360,r.decimDigits=5,n.propIdGeoCoordLongit=t.propid),t.datatype=="GeoLattitude"&&(r.minval=-90,r.maxval=90,r.decimDigits=5,n.propIdGeoCoordLattit=t.propid),t.propid==y.getTableInfo(t.tableid).primkey&&(t.isPrimKey=!0);if(t.settings){try{var i=JSON.parse(t.settings);"MaxVal"in i&&(i.hasValueRange=!0)}catch(s){alert("Invalid settings string for {table}.{propid}: {sett}\n{msg}".DQXformat({table:t.tableid,propid:t.propid,sett:t.settings,msg:s}))}r=$.extend(r,i)}t.settings=r,t.toDisplayString=function(e){return e},t.dispDataType="Text",t.settings.isCategorical&&(t.dispDataType="Categorical"),t.isFloat&&(t.dispDataType="Value"),t.isBoolean&&(t.dispDataType="Boolean"),t.isDate&&(t.dispDataType="Date"),t.datatype=="GeoLongitude"&&(t.dispDataType="Longitude"),t.datatype=="GeoLattitude"&&(t.dispDataType="Latitude"),t.group=null,t.settings.GroupId&&n.propertyGroupMap[t.settings.GroupId]&&(t.group=n.propertyGroupMap[t.settings.GroupId],n.propertyGroupMap[t.settings.GroupId].properties.push(t));if(!t.group){if(!n.propertyGroupMap[""]){var u={Id:"",Name:"Properties",properties:[]};n.propertyGroupMap[""]=u,n.propertyGroups.push(u)}t.group=n.propertyGroupMap[""],n.propertyGroupMap[""].properties.push(t)}t.source=="fixed"?t.originalTableName=t.tableid:t.originalTableName=t.tableid+"INFO_"+y.workspaceid,t.isFloat&&(t.toDisplayString=w(t.settings.decimDigits),t.settings.decimDigits==0&&(t.isInt=!0)),t.isBoolean&&(t.toDisplayString=function(e){return e=="Yes"?e:parseInt(e)?"Yes":"No"}),t.isDate&&(n.hasDate=!0,t.toDisplayString=function(e){if(e==null||e=="None")return"";var t=a.JD2DateTime(parseFloat(e));if(isNaN(t.getTime()))return"2000-01-01";var n=function(e){return e<10?"0"+e:e};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())},t.fromDisplayString=function(e){var t=parseInt(e.substring(0,4)),n=parseInt(e.substring(5,7)),r=parseInt(e.substring(8,10));return isNaN(t)&&(t=2e3),isNaN(n)&&(n=1),isNaN(r)&&(r=1),a.DateTime2JD(new Date(t,n-1,r,6,0,0))}),t.category2Color=a.PersistentAssociator(a.standardColors.length),t.mapSingleColor=function(e){if(t.settings.categoryColors){var n=t.settings.categoryColors[e];return n?a.colourFromString(n):a.Color(.5,.5,.5)}if(t.isBoolean)return!e||e=="No"||e=="0"||e=="-None-"?b.colorFalse:b.colorTrue;var r=t.category2Color,i=r.get(e);return i>=0?a.standardColors[i]:a.Color(.5,.5,.5)},t.mapColors=function(e){if(t.isFloat&&t.settings.maxval!=t.settings.minval){clCount=100;var n=[];for(var r=0;r<clCount;r++)u=r*1/(clCount-1),n.push(a.HSL2Color(.5-u*.75,.6,.5));n.push(a.Color(.5,.5,.5));var i=n.length-1,s=[],o=t.settings.maxval-t.settings.minval;for(var r=0;r<e.length;r++){if(e[r]!=null){var u=(e[r]-t.settings.minval)/o,f=Math.round(u*(clCount-1));f<0&&(f=0),f>=clCount&&(f=clCount-1)}else var f=i;s.push(f)}var l=[],c=a.DrawUtil.getScaleJump(o/20);for(var r=Math.ceil(t.settings.minval/c.Jump1);r<=Math.floor(t.settings.maxval/c.Jump1);r++)if(r%c.JumpReduc==0){var h=r*c.Jump1,u=(h-t.settings.minval)/o;l.push({state:c.value2String(h),color:a.HSL2Color(.5-u*.75,.6,.5)})}return{indices:s,colors:n,legend:l}}if(t.settings.categoryColors){var n=[],p={},d=a.Color(.5,.5,.5);t.settings.categoryColors._other_&&(d=a.parseColorString(t.settings.categoryColors._other_,a.Color(0,.5,.5))),$.each(t.settings.categoryColors,function(e,t){e!="_other_"&&(n.push(a.parseColorString(t,a.Color(.5,.5,.5))),p[e]=n.length)}),n.push(d);var v=n.length,s=[];for(var r=0;r<e.length;r++){var f=p[t.toDisplayString(e[r])];f||(f=v),s.push(f-1)}var l=[];return $.each(t.settings.categoryColors,function(e,t){e!="_other_"&&l.push({state:e,color:t})}),{indices:s,colors:n,legend:l}}if(t.isBoolean){var s=[];for(var r=0;r<e.length;r++)!e[r]||e[r]=="No"?s.push(0):s.push(1);return{indices:s,colors:[b.colorFalse,b.colorTrue],legend:[{state:"No",color:b.colorFalse},{state:"Yes",color:b.colorTrue}]}}var m={},g=[];for(var r=0;r<e.length;r++)m[e[r]]||(m[e[r]]=!0,g.push(e[r]));var y=t.category2Color;y.map(g);var s=[];for(var r=0;r<e.length;r++){var w=y.get(e[r]);w<0&&(w=y.itemCount-1),s.push(w)}var l=[];return $.each(y.getAssociations(),function(e,n){l.push({state:t.toDisplayString(e),color:a.standardColors[n]})}),{indices:s,colors:a.standardColors,legend:l}};if(t.settings.isCategorical){var f=p.ServerDataGetter();f.addTable(t.originalTableName,[t.propid],t.propid,o.WhereClause.Trivial(),{distinct:!0}),t.propCategories=[],b.incrWait(),f.execute(y.serverUrl,y.database,function(){var e=f.getTableRecords(t.originalTableName);$.each(e,function(e,n){t.propCategories.push(n[t.propid])}),b.decrWait()})}n.properties=n.properties||[],n.properties.push(t)}),$.each(y.tableCatalog,function(e,t){t.propIdGeoCoordLongit&&t.propIdGeoCoordLattit&&(t.hasGeoCoord=!0)})},b.parse2DProperties=function(){$.each(y.twoDProperties,function(e,t){var n={showInTable:!0,showInBrowser:!1};if(t.settings){try{var r=JSON.parse(t.settings)}catch(i){alert("Invalid settings string for {table}.{propid}: {sett}\n{msg}".DQXformat({table:t.tableid,propid:t.propid,sett:t.settings,msg:i}))}n=$.extend(n,r)}t.settings=n,t.toDisplayString=function(e){return e};var s=y.map2DTableCatalog[t.tableid];s.properties=s.properties||{},s.properties[t.id]=t})},b.parseRelations=function(e){$.each(y.tableCatalog,function(e,t){t.relationsChildOf=[],t.relationsParentOf=[]}),y.relations=e,$.each(e,function(e,t){var n=y.mapTableCatalog[t.childtableid];n||a.reportError("Invalid child table in relation: "+t.childtableid);var r=y.mapTableCatalog[t.parenttableid];r||a.reportError("Invalid parent table in relation: "+t.parenttableid),n.relationsChildOf.push(t),r.relationsParentOf.push(t),y.findProperty(n.id,t.childpropid).relationParentTableId=r.id})},b.parseStoredSubsets=function(e){$.each(y.tableCatalog,function(e,t){t.storedSubsets=[]}),$.each(e,function(e,t){var n=y.mapTableCatalog[t.tableid];n&&n.storedSubsets.push({id:t.subsetid,name:t.name,membercount:null})}),a.customRequest(y.serverUrl,PnServerModule,"subset_fetchallmembercounts",{database:y.database,workspaceid:y.workspaceid},function(e){y.subset_membercount_maxcount=e.maxcount,$.each(e.info,function(e,t){var n=y.mapTableCatalog[e];$.each(n.storedSubsets,function(e,n){t[n.id]?n.membercount=t[n.id]:n.membercount=0})})})},b.parseTableBasedSummaryValues=function(){$.each(y.tableCatalog,function(e,t){t.tableBasedSummaryValues=[],t.mapTableBasedSummaryValues={},t.genomeTrackSelectionManager=v.Create(t.id+"_genometracks",t,function(e){s.broadcast({type:"TableBasedSummaryValueSelectionChanged"},{tableid:t.id,recordid:e})})}),$.each(y.tableBasedSummaryValues,function(e,t){t.minval?t.minval=parseFloat(t.minval):t.minval=0,t.maxval?t.maxval=parseFloat(t.maxval):t.maxval=1,t.minblocksize=parseFloat(t.minblocksize);var n={channelColor:"rgb(0,0,180)"};if(t.settings)try{var r=JSON.parse(t.settings);n=$.extend(n,r)}catch(i){a.reportError('Invalid settings string "{str}" for tablebasedsummaryvalues {tableid},{trackid}:\n{error}'.DQXformat({str:t.settings,tableid:t.tableid,trackid:t.trackid,error:i}))}t.settings=n,t.isVisible=t.settings.defaultVisible;var s=y.getTableInfo(t.tableid);s.tableBasedSummaryValues.push(t),s.mapTableBasedSummaryValues[t.trackid]=t})},b}),define("DQX/QueryBuilder",["jquery","DQX/SQL","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/FramePanel"],function(e,t,n,r,i,s){var o={};return o.Panel=function(e,t){var n=o.Builder(e,t);return n.handleResize=function(){n.getRootElem().width()>5&&n.getRootElem().height()>5&&this._reRender()},n},o.Builder=function(u,a){var f=s(u);return a||(a={}),n.ObjectMapper.Add(f),f.myColumns=[],f.bSepX=20,f.spacerH1=20,f.spacerH2=15,f.borderSize=0,f._globalcontentnr=10,f._compid=0,f.subsetList=a.subsetList,f.primKey=a.primKey,f.subsetTableName=a.subsetTableName,f.tableName=a.tableName,f.notifyModified=function(){i.broadcast({type:"QueryModified",id:this.getDivID()})},f._createNewStatement=function(e){this._globalcontentnr++;var n={};n.isCompound=!1,n.myOperator=t.WhereClause.CompareFixed(this.myColumns[0].ID,"=",""),e.myComponents.push(n)},f._createCompOR=function(){var e={};return e.isCompound=!0,e.Tpe="OR",e.myComponents=[],e},f._createCompAND=function(){var e={};return e.isCompound=!0,e.Tpe="AND",e.myComponents=[],e},f.root=f._createCompAND(),f.addTableColumn=function(e){this.myColumns.push(e)},f.hasColumn=function(e){for(var t in this.myColumns)if(this.myColumns[t].ID==e)return!0;return!1},f.getColumn=function(e){for(var t in this.myColumns)if(this.myColumns[t].ID==e)return this.myColumns[t];n.reportError("Invalid column id "+e)},f._cleanUp=function(e){var t=!1;if(e.isCompound){for(var n in e.myComponents)this._cleanUp(e.myComponents[n])&&(t=!0);var n=0;while(n<e.myComponents.length){var r=e.myComponents[n],i=!1;if(r.isCompound){if(r.Tpe==e.Tpe){for(var s in r.myComponents)e.myComponents.splice(n+1+s,0,r.myComponents[s]);r.myComponents=[],t=!0}r.myComponents.length==0&&(i=!0,t=!0),r.myComponents.length==1&&(e.myComponents[n]=r.myComponents[0],t=!0)}i?e.myComponents.splice(n,1):n++}}return t},f._ReactChangeField=function(e){this._reRender(),this.notifyModified()},f._ReactChangeCompType=function(e){this._reRender(),this.notifyModified()},f._ReactStatementModified=function(e){this.notifyModified()},f._ReactDel=function(e){compmap[e].myParent==null&&n.reportError("no parent");var t=compmap[e].myParent,r=-1;for(var i in t.myComponents)t.myComponents[i].ID==e&&(r=i);r<0&&n.reportError("???"),t.myComponents.splice(r,1),this._reRender(),this.notifyModified()},f._ReactAddAnd=function(e){this._createNewStatement(compmap[e]),this._reRender(),this.notifyModified()},f._ReactAddOr=function(e){this._createNewStatement(compmap[e]),this._reRender(),this.notifyModified()},f._ReactCreateOr=function(e){var t=compmap[e].myParent,r=-1;for(var i in t.myComponents)t.myComponents[i].ID==e&&(r=i);r<0&&n.reportError("???");var s=this._createCompOR();t.myComponents[r]=s,s.myComponents.push(compmap[e]),this._createNewStatement(s),this._reRender(),this.notifyModified()},f._ReactCreateRootOr=function(){var e=this.root;this.root=this._createCompAND();var t=this._createCompOR();this.root.myComponents.push(t),t.myComponents.push(e),this._createNewStatement(t),this._reRender(),this.notifyModified()},f._ReactCreateAnd=function(e){var t=compmap[e].myParent,r=-1;for(var i in t.myComponents)t.myComponents[i].ID==e&&(r=i);r<0&&n.reportError("???");var s=this._createCompAND();t.myComponents[r]=s,s.myComponents.push(compmap[e]),this._createNewStatement(s),this._reRender(),this.notifyModified()},f._ReactUpdateQuery=function(e){i.broadcast({type:"RequestUpdateQuery",id:this.getDivID()})},f._calcMinSizeX=function(e){if(e.isCompound){if(e.Tpe=="AND"){var t=0;for(var n in e.myComponents)this._calcMinSizeX(e.myComponents[n]),t=Math.max(t,e.myComponents[n].MinSizeX);e.MinSizeX=t}if(e.Tpe=="OR"){var t=0;for(var n in e.myComponents)this._calcMinSizeX(e.myComponents[n]),t+=e.myComponents[n].MinSizeX;e.MinSizeX=t+(e.myComponents.length-1)*this.bSepX}}else e.MinSizeX=200},f._calcSizeX=function(e,t){if(e.isCompound){if(e.Tpe=="AND"){for(var n in e.myComponents)this._calcSizeX(e.myComponents[n],t);e.sizeX=t}if(e.Tpe=="OR"){var r=t-(e.myComponents.length-1)*this.bSepX;for(var n in e.myComponents)r-=e.myComponents[n].MinSizeX;r=Math.floor(r/e.myComponents.length);for(var n in e.myComponents)this._calcSizeX(e.myComponents[n],e.myComponents[n].MinSizeX+r);e.sizeX=t}}else e.sizeX=t},f._createReactFunctionString=function(e,t){return n.ObjectMapper.CreateCallBackFunctionString(this,e,t)},f._createBlockColor=function(t){return n.parseColorString(e("#"+this.getDivID()).css("background-color"),n.Color(.9,.9,.9)).lighten(.1*t)},f.getControlID=function(e,t){return"DQXQbldStmnt"+this.getDivID()+e+t},f.decorateQueryStatementControl=function(e,t){e.setOnChange(this._createReactFunctionString("_ReactStatementModified",t)),e.setOnKeyUp(this._createReactFunctionString("_ReactStatementModified",t))},f._buildStatement=function(e,i){var s=e.myOperator,o=e.sizeX,u=e.myParent.Tpe!="OR",a=e.myParent.Tpe!="AND";i.setCssClass("DQXQBQuerybox"),i.addStyle("float","left"),i.setWidthPx(o-2*this.borderSize),i.addStyle("position","relative");var l=r.Div({parent:i});l.addStyle("text-align","center").addStyle("padding-top","10px").addStyle("padding-bottom","10px").addStyle("padding-left","8px").addStyle("padding-right","8px");var c=r.Span({parent:l});c.addElem(" ");var h=[];for(var p in this.myColumns)h.push({id:this.myColumns[p].ID,name:this.myColumns[p].name,group:this.myColumns[p].GroupName});h.push({id:"_note_",name:"has note containing",group:"Other"}),f.subsetList&&f.subsetList.length>0&&h.push({id:"_subset_",name:"in subset",group:"Other"});var d=r.Div();d.addStyle("display","inline-block"),d.setCssClass("DQXSelectWrapper");var v=r.Select(h,s.ColName,{parent:d});v.setID(this.getControlID(e.ID,"Field")),v.setWidthPx(150),v.setCssClass("DQXQBQueryboxControl"),v.SetChangeEvent(this._createReactFunctionString("_ReactChangeField",e.ID)),c.addElem(d),c.addElem(" ");if(s.Tpe!="_subset_"&&s.Tpe!="_note_"){var m=t.WhereClause.getCompatibleFieldComparisonOperators(this.getColumn(s.ColName).datatype),g=[],y=!1;for(var b in m){var w=m[b];g.push({id:w.ID,name:w.name}),s.Tpe==w.ID&&(y=!0)}y||(s.Tpe=g[0].id,this._needRebuild=!0);var d=r.Div();d.addStyle("display","inline-block"),d.setCssClass("DQXSelectWrapper");var E=r.Select(g,s.Tpe,{parent:d});E.setID(this.getControlID(e.ID,"Type")),E.setWidthPx(150),E.setCssClass("DQXQBQueryboxControl"),E.SetChangeEvent(this._createReactFunctionString("_ReactChangeCompType",e.ID)),c.addElem(d)}c.addElem(" "),s._buildStatement(e.ID,c,this);var S=r.JavaScriptBitmaplinkTransparent(n.BMP("close.png"),"Delete this condition",this._createReactFunctionString("_ReactDel",e.ID));S.addStyle("position","absolute"),S.addStyle("left","-8px"),S.addStyle("top","-12px"),l.addElem(S);if(u){var S=r.JavaScriptBitmaplinkTransparent(n.BMP("addright.png"),"Create an alternative condition (OR)",this._createReactFunctionString("_ReactCreateOr",e.ID));S.addStyle("position","absolute"),S.addStyle("right","-10px"),S.addStyle("top","-14px"),l.addElem(S)}if(a){var S=r.JavaScriptBitmaplinkTransparent(n.BMP("adddown.png"),"Create an extra condition (AND)",this._createReactFunctionString("_ReactCreateAnd",e.ID));S.addStyle("position","absolute"),S.addStyle("left",o/2+8+"px"),S.addStyle("bottom","-16px"),l.addElem(S)}},f._buildElement=function(e,t,i){var s=e.sizeX;e.myParent=t,this._compid++;var u=this._compid,a=r.Div();e.ID=this._compid,compmap[this._compid]=e,a.addAttribute("id",this.getControlID(e.ID,"")),a.addStyle("float","left"),a.setWidthPx(s),a.setBackgroundColor(this._createBlockColor(i));if(e.isCompound){if(e.Tpe=="AND"){a.addStyle("background-image","url("+n.BMP("arrowdown.png")+")"),a.addStyle("background-position","center"),a.addStyle("background-repeat","repeat-y"),a.addStyle("position","relative");for(var f in e.myComponents){var l=f>0;if(l){var c=r.Div();c.addStyle("float","left"),c.setWidthPx(s),c.setHeightPx(this.spacerH1),a.addElem(c)}var h=this._buildElement(e.myComponents[f],e,i);a.addElem(h)}var p=r.JavaScriptBitmaplinkTransparent(n.BMP("adddown.png"),"Create an extra condition (AND)",this._createReactFunctionString("_ReactAddAnd",u));p.addStyle("position","absolute"),p.addStyle("left",s/2+10+"px"),p.addStyle("bottom","-16px"),a.addElem(p)}if(e.Tpe=="OR"){i++;var d=(s-(e.myComponents.length-1)*o.bSepX)/e.myComponents.length-2,v=[];for(var f in e.myComponents){var h=this._buildElement(e.myComponents[f],e,i);v.push(h)}var c=r.Div();c.addStyle("float","left"),c.setWidthPx(s),c.setHeightPx(15),c.setBackgroundColor("rgb(140,140,140)"),c.addStyle("text-align","center"),c.addStyle("position","relative"),c.addStyle("border-top-left-radius","15px"),c.addStyle("border-top-right-radius","15px"),c.addElem("Alternative paths (OR)");var p=r.JavaScriptBitmaplinkTransparent(n.BMP("addright.png"),"Add another alternative condition (OR)",this._createReactFunctionString("_ReactAddOr",u));p.addStyle("position","absolute"),p.addStyle("right","15px"),p.addStyle("top","-8px"),c.addElem(p),a.addElem(c);var m=r.Div();m.setBackgroundColor(this._createBlockColor(i)),m.addStyle("float","left"),m.setCssClass("DQXOrContainer");for(f in v){if(f>0){var c=r.Div();c.addStyle("float","left"),c.setHeightPx(3),c.setWidthPx(this.bSepX),m.addElem(c)}var g=r.Div();g.addStyle("float","left"),g.addStyle("height","100%"),g.addStyle("background-image","url("+n.BMP("arrowdown.png")+")"),g.addStyle("background-position","center"),g.addStyle("background-repeat","repeat-y"),g.addStyle("padding-top",this.spacerH2+"px"),g.addStyle("padding-bottom",this.spacerH2+"px"),g.addElem(v[f]),m.addElem(g)}a.addElem(m);var c=r.Div();c.addStyle("float","left"),c.setWidthPx(s),c.setHeightPx(15),c.setBackgroundColor("rgb(140,140,140)"),c.addStyle("border-bottom-left-radius","15px"),c.addStyle("border-bottom-right-radius","15px"),a.addElem(c)}}else this._buildStatement(e,a);return a},f.render=function(){this._compid=0,compmap={};while(this._cleanUp(this.root));var t=e("#"+this.getDivID()).width()-30;t<=1&&(t=600),this._calcMinSizeX(this.root),this.root.MinSizeX<t&&(this.root.MinSizeX=t),t=this.root.MinSizeX,this._calcSizeX(this.root,this.root.MinSizeX);var i=r.Div();i.addStyle("float","left"),i.addStyle("margin-left","9px"),i.addStyle("margin-top","8px"),i.setWidthPx(t);var s=function(e){var i=r.Div();return i.addStyle("position","relative"),i.addStyle("float","left"),i.addStyle("text-align","center"),i.setWidthPx(t),spacerel=r.Span({parent:i}),spacerel.setBackgroundColor(n.Color(.5,.5,.5)),spacerel.setColor(n.Color(.9,.9,.9)),spacerel.addStyle("border-radius","18px"),spacerel.addStyle("text-align","center"),spacerel.addStyle("padding-top","10px"),spacerel.addStyle("padding-bottom","10px"),spacerel.addStyle("display","block"),spacerel.addStyle("font-weight","bold"),spacerel.addStyle("font-size","9pt"),spacerel.addElem(e),spacerel.addStyle("margin-left","auto"),spacerel.addStyle("margin-right","auto"),spacerel.addStyle("position","relative"),spacerel.addStyle("color","rgb(200,230,255)"),spacerel.setHeightPx(16),spacerel.setWidthPx(230),i},o=s("Full data set"),u=this.root.myComponents.length>1;if(u){var f=r.JavaScriptBitmaplinkTransparent(n.BMP("addright.png"),"Create an alternative condition (OR)",this._createReactFunctionString("_ReactCreateRootOr",-1));f.addStyle("position","absolute"),f.addStyle("right","-12px"),f.addStyle("top","5px"),o.getElem(0).addElem(f)}i.addElem(o);var o=r.Div();o.addStyle("background-image","url("+n.BMP("arrowdown.png")+")"),o.addStyle("background-position","center"),o.addStyle("background-repeat","repeat-y"),o.addStyle("float","left"),o.setWidthPx(t),o.setHeightPx(this.spacerH1),i.addElem(o),i.addElem(this._buildElement(this.root,null,0));var o=r.Div();o.addStyle("background-image","url("+n.BMP("arrowdown.png")+")"),o.addStyle("background-position","center"),o.addStyle("background-repeat","repeat-y"),o.addStyle("float","left"),o.setWidthPx(t),o.setHeightPx(this.spacerH1),i.addElem(o);var o=s("Filtered data set");if(!a.noUpdate){var l=r.Div();l.setCssClass("DQXGlowButton"),l.addAttribute("onclick",this._createReactFunctionString("_ReactUpdateQuery",-1)),l.setWidthPx(150),l.addElem("Update query results"),l.addStyle("position","absolute"),l.addStyle("left","30px"),l.addStyle("bottom","-40px"),spacerel.addElem(l)}i.addElem(o);var c=i.toString();e("#"+this.getDivID()).html(c),e(".DQXOrContainer").each(function(t,n){var r=1;e(n).children().each(function(t,n){r=Math.max(r,e(n).height())}),e(n).children().each(function(t,n){e(n).height(r)})})},f._fetchStatementContent=function(n){if(n.isCompound)for(var r in n.myComponents)this._fetchStatementContent(n.myComponents[r]);else if("ID"in n){var i=e("#"+this.getControlID(n.ID,"Field")).val();n.myOperator=null,i=="_subset_"&&(n.myOperator=t.WhereClause.getFieldComparisonOperatorInfo("_subset_").Create(),n.myOperator.ColName="_subset_",n.myOperator._fetchStatementContent(n.ID,this)),i=="_note_"&&(n.myOperator=t.WhereClause.getFieldComparisonOperatorInfo("_note_").Create(),n.myOperator.ColName="_note_",n.myOperator._fetchStatementContent(n.ID,this));if(!n.myOperator){var s=e("#"+this.getControlID(n.ID,"Type")).val();s||(s="="),n.myOperator=t.WhereClause.getFieldComparisonOperatorInfo(s).Create(),n.myOperator.ColName=i,n.myOperator._fetchStatementContent(n.ID,this)}}},f._reRender=function(){this._needRebuild=!1,this._fetchStatementContent(this.root),this.render(),this._needRebuild&&(this._fetchStatementContent(this.root),this.render())},f._extractQueryContent=function(e){if(e.isCompound){var n=t.WhereClause.Compound(e.Tpe);for(var r in e.myComponents)n.addComponent(this._extractQueryContent(e.myComponents[r]));return n}return e.myOperator},f.getQuery=function(){return this._fetchStatementContent(this.root),this.root.myComponents.length==0?t.WhereClause.Trivial():this._extractQueryContent(this.root)},f._importQuery=function(e){if(e.isCompound){if(e.Tpe=="OR")var t=this._createCompOR();else var t=this._createCompAND();for(var n=0;n<e.Components.length;n++){var r=this._importQuery(e.Components[n]);t.myComponents.push(r)}return t}var t={};return t.isCompound=!1,t.myOperator=e,t},f.setQuery=function(e){this.root=this._createCompAND(),e.Tpe!=""&&this.root.myComponents.push(this._importQuery(e)),this.render()},f},o}),define("DQX/QueryTable",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/FramePanel","DQX/Controls","DQX/SQL","DQX/QueryBuilder","DQX/DataFetcher/DataFetchers"],function(e,t,n,r,i,s,o,u,a){var f={};return f.Panel=function(s,a,l){var c=i(s);t.requireMemberFunction(a,"setSortOption");var h="",p=n.Div();p.setCssClass("DQXButtonBar"),p.addStyle("padding-bottom","5px");var d=n.Span({parent:p,id:c.getSubId("Pager")});h+=p;var v=n.Div({id:c.getSubId("BodyHolder")}),m=n.Div({parent:v});m.makeFloatLeft().addStyle("overflow","auto"),m.addStyle("max-width",(l.leftfraction||50).toString()+"%");var g=n.Div({parent:m,id:c.getSubId("Body1")});g.makeVisibleHorizontalScroller(!1).addStyle("overflow-y","hidden"),g.addStyle("border-width","0px"),g.addStyle("border-right-width","2px"),g.addStyle("border-style","solid"),g.addStyle("border-color","rgb(220,220,220)");var y=n.Div({parent:v,id:c.getSubId("BodyContainer")});y.addStyle("overflow","auto");var b=n.Div({parent:y,id:c.getSubId("Body2")});b.makeVisibleHorizontalScroller(!0).addStyle("overflow-y","hidden"),b.setBackgroundColor(t.Color(.98,.98,.98)),h+=v;var w=n.Div(),E=n.Span({parent:w,id:c.getSubId("Footer")});return w.addStyle("clear","both"),w.addStyle("padding-top","3px"),h+=w,c.getRootElem().html(h),c.myTable=f.Table(c.getDivID(),a),c.myTable.autoSizeHeight=!0,c.getTable=function(){return this.myTable},t.setOnHoverKeyDownReceiver(c.getID(),e.proxy(c.myTable.onKeyDown,c.myTable)),c._getVerticalUserSize=function(){return e("#"+c.getSubId("BodyHolder")).outerHeight()+e("#"+c.getSubId("Pager")).outerHeight()+e("#"+c.getSubId("Footer")).outerHeight()},c.onResize=function(){var e=this.getRootElem().innerHeight()-t.scrollBarWidth-25,n=21;if(e!=this.lastAvailabeH){this.myTable.myPageSize=Math.max(1,Math.floor((e-70)/n)),this.myTable.render();var r=0;do{var i=this._getVerticalUserSize();i+n<e&&this.myTable._onMoreLines(),r++}while(i+n<e&&r<5&&i>0);var r=0;do{var i=this._getVerticalUserSize();i>e&&this.myTable._onLessLines(),r++}while(i>e&&r<5&&i>0)}this.lastAvailabeH=e},c.invalidateQuery=function(){c.myTable.invalidate()},c.createPanelAdvancedQuery=function(t,n,i,s){var a={};a.noUpdate=i,s&&(a=e.extend(a,s));var f=u.Panel(t,a),l=f,h=this.myTable.myDataFetcher,p=function(){var e=l.getQuery();c.myTable.setQuery(e),c.myTable.reLoadTable()};return i||(r.listen("",{type:"RequestUpdateQuery",id:l.myDivID},function(){p(),n&&n()}),r.listen("",{type:"QueryModified",id:l.myDivID},function(){c.invalidateQuery()})),e.each(c.myTable.myColumns,function(e,t){if(!t.colIsClientGenerated){var n=h.getFetchColumn(t.myCompID),r=n.myEncodingType,i=null;t._datatype_MultipleChoiceInt&&(r="MultiChoiceInt",i=t._datatype_MultipleChoiceInt),t._datatype_MultipleChoiceString&&(r="String",i=t._datatype_MultipleChoiceString),queryColInfo=o.TableColInfo(t.myCompID,t.myName,r,i),t.CellToText&&(queryColInfo.content2Display=t.CellToText),t.CellToTextInv&&(queryColInfo.display2Content=t.CellToTextInv),t.GroupName&&(queryColInfo.GroupName=t.GroupName),l.addTableColumn(queryColInfo)}}),l.render(),l},c},f.Column=function(e,n,r){var i={};return i.myName=t.interpolate(e),i.myCompID=n,i.minWidth=10,i.TablePart=r,i._visible=!0,i._hyperlinkCellMessageScope=null,i._hyperlinkCellHint="",i._hyperlinkHeaderMessageScope=null,i._headerClickHandler=null,i._cellClickHandler=null,i._toolTip="",i.CellToText=function(e){return e},i.CellToColor=function(e){return"white"},i.makeHyperlinkCell=function(e,t){this._hyperlinkCellMessageScope=e,t&&(this._hyperlinkCellHint=t)},i.makeHyperlinkHeader=function(e,t){this._hyperlinkHeaderMessageScope=e,t&&this.setToolTip(t)},i.setToolTip=function(e){this._toolTip=e},i.setHeaderClickHandler=function(e){this._headerClickHandler=e},i.setCellClickHandler=function(e,t){this._cellClickHandler=e,this._cellClickHandlerIsExternal=t},i.isVisible=function(){return this._visible},i.setVisible=function(e){this._visible=e},i.setMinWidth=function(e){this.minWidth=e},i.setDataType_MultipleChoiceInt=function(e){this._datatype_MultipleChoiceInt=e},i.setDataType_MultipleChoiceString=function(e){this._datatype_MultipleChoiceString=e},i},f.Table=function(i,u){var l={};return l.myBaseID=i,l.myDataFetcher=u,l.myColumns=[],l.mySortOptions=[],l.myPageSize=20,l.hasHighlight=!0,l._highlightRowNr=-1,l.myDataFetcher.myDataConsumer=l,l._dataValid=!1,l.myTableOffset=0,l.totalRecordCount=-1,l._lastSelClickedRowNr=null,l.fetchBuffer=200,l.recordCountFetchType=a.RecordCountFetchType.IMMEDIATE,l.getElementID=function(e){return this.myBaseID+e},l.isPresentInDOMTree=function(){var t="#"+this.myBaseID,n=e(t);return n.length>0},l.getElement=function(n){var r="#"+this.myBaseID+n,i=e(r);return i.length==0&&t.reportError("Missing query table element "+r),i},l.addTableColumn=function(e){return t.requireMemberFunction(e,"CellToText"),this.myDataFetcher.activateFetchColumn(e.myCompID),this.myColumns.push(e),e},l.createTableColumn=function(e,t,n,r){this.myDataFetcher.addFetchColumn(e.myCompID,t);var i=this.addTableColumn(e);return n&&this.addSortOption(e.myName,o.TableSort([e.myCompID]),!!r),i},l.clearTableColumns=function(){e.each(this.myColumns,function(e,t){l.myDataFetcher.deactivateFetchColumn(t.myCompID)}),this.myColumns=[],this.mySortOptions=[]},l.createSelectionColumn=function(e,t,n,r,i,s,o){var u=f.Column(t,e,0);u.isSelection=!0,u.setCellClickHandler(function(e,t,n){var s=e.findIndexByXVal(t);if(s<0)return null;var u=e.getColumnPoint(s,r),a=i.isItemSelected(u);if(!n.shiftPressed||l._lastSelClickedRowNr==null)i.selectItem(u,!a);else for(var f=Math.min(s,l._lastSelClickedRowNr);f<=Math.max(s,l._lastSelClickedRowNr);f++){var u=e.getColumnPoint(f,r);i.selectItem(u,!a)}l._lastSelClickedRowNr=s,o&&o()}),u.colIsClientGenerated=!0,u.colorString=s.toString(),u.customTextCreator=function(e,t){var n=e.getColumnPoint(t,r),s=i.isItemSelected(n);return'<div style="width:20px;font-size: 14px;color:{cl}">&nbsp;<span class="fa {ic}"></span></div>'.DQXformat({cl:s?u.colorString:"rgb(170,170,170)",ic:s?"fa-check-circle":"fa-circle-thin"})},this.myColumns.push(u)},l.findColumn=function(e){for(var t in this.myColumns)if(this.myColumns[t].myCompID==e)return this.myColumns[t];return null},l.findColumnRequired=function(e){var n=this.findColumn(e);return n||t.reportError('Column id "{id}" not found in query table'.DQXformat({id:e})),n},l.addSortOption=function(e,n,r){t.requireMemberFunction(n,"getPrimaryColumnID"),this.mySortOptions.push({name:e,Option:n});var i=this.findColumn(n.getPrimaryColumnID());i&&(i.sortOption=n);if(!this.startSortOptionSet||r)this.startSortOptionSet=!0,this.myDataFetcher.setSortOption(n,!1)},l.getRecordCount=function(){return l.totalRecordCount<0?null:l.totalRecordCount},l.getIsTruncatedRecordCount=function(){return l.isTruncatedRecordCount},l.getSortColumn=function(){return this.myDataFetcher.positionField},l.notifyDataReady=function(){this.myDataFetcher.isValid()&&(this._dataValid=!0),this.render()},l._onForward=function(){if(this.myTableOffset+this.myPageSize<this.totalRecordCount||this.totalRecordCount<0)this.myTableOffset+=this.myPageSize,l._lastSelClickedRowNr=null,this.render();return!1},l._onFirst=function(){return this.myTableOffset=0,this.render(),l._lastSelClickedRowNr=null,!1},l._onBack=function(){return this.myTableOffset-=this.myPageSize,this.myTableOffset<0&&(this.myTableOffset=0),this.render(),l._lastSelClickedRowNr=null,!1},l._onLast=function(){return this.myTableOffset=Math.floor(this.totalRecordCount/this.myPageSize)*this.myPageSize,this.render(),l._lastSelClickedRowNr=null,!1},l._onMoreLines=function(){return l.myPageSize+=1,this.render(),!1},l._onLessLines=function(){return l.myPageSize=Math.max(1,l.myPageSize-1),this.render(),!1},l._onLineUp=function(e){return this.myTableOffset=Math.max(0,this.myTableOffset-e),l._lastSelClickedRowNr=null,this.render(),!1},l._onLineDown=function(e){return this.myTableOffset=Math.max(0,Math.min(this.totalRecordCount-this.myPageSize+4,this.myTableOffset+e)),l._lastSelClickedRowNr=null,this.render(),!1},l.scrollHighlightRowInView=function(){if(this._highlightRowNr<0)return;this._highlightRowNr<this.myTableOffset&&(this.myTableOffset=Math.max(0,this._highlightRowNr-3),this.render());if(this._highlightRowNr>=this.myTableOffset+this.myPageSize){var e=this._highlightRowNr-this.myPageSize+4;if(this.totalRecordCount>=0)var e=Math.min(this.totalRecordCount-this.myPageSize+4,e);this.myTableOffset=Math.max(0,e),this.render()}},l.queryAll=function(){this.setQuery(o.WhereClause.Trivial()),this.reLoadTable()},l.reLoadTable=function(){this.totalRecordCount=-1,this.myDataFetcher.clearData(),this.myTableOffset=0,this._highlightRowNr=-1,l._lastSelClickedRowNr=null,this.render()},l.clearData=function(){this.totalRecordCount=-1,this.myDataFetcher.clearData(),this._highlightRowNr=-1,l._lastSelClickedRowNr=null},l.invalidate=function(){this._dataValid&&(this._highlightRowNr=-1,this._dataValid=!1,this.render(),e("#"+this.myBaseID+"_status").html('<span class="DQXImportantMessage">Query results are not up-to-date</span>'))},l.setQuery=function(e){this._highlightRowNr=-1,this.myDataFetcher.setUserQuery1(e),this._dataValid=!0},l.setTable=function(e){this.myDataFetcher.setTableName(e)},l.render=function(){if(!l.isPresentInDOMTree())return;t.pushActivity("Creating table");if(!this._pagerCreated){var r="";r+='<span style="position:relative;bottom:-2px;">';var i=[];i.push(s.Button(l.myBaseID+"_goFirst",{height:22,icon:"fa-step-backward",description:"First page",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(l._onFirst,l))),i.push(s.Button(l.myBaseID+"_goPrevious",{height:22,icon:"fa-play",description:"Previous page",buttonClass:"DQXButtonBarButton fa-flip-horizontal",fastTouch:!0}).setOnChanged(e.proxy(l._onBack,l))),i.push(s.Button(l.myBaseID+"_goNext",{height:22,icon:"fa-play",description:"Next page",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(l._onForward,l))),i.push(s.Button(l.myBaseID+"_goLast",{height:22,icon:"fa-step-forward",description:"Last page",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(l._onLast,l))),this.navButtonControls=i,e.each(i,function(e,t){r+=t.renderHtml()}),r+="</span>",r+='<span id="{id}" style="display:inline-block; padding-top:7px"></span>'.DQXformat({id:l.myBaseID+"_status"});var o=n.Span({id:l.myBaseID+"_right"});o.addStyle("float","right"),o.addStyle("vertical-align","bottom"),o.addStyle("position","relative"),o.addStyle("top","5px"),o.addStyle("right","5px"),r+=o.toString(),this.getElement("Pager").html(r),s.ExecPostCreateHtml(),this._pagerCreated=!0}var u=Math.max(0,this.myTableOffset-this.fetchBuffer),a=this.myTableOffset+this.myPageSize+this.fetchBuffer,f=!1;this._dataValid&&(this.preventFetch||(f=this.myDataFetcher.IsDataReady(u,a,l.recordCountFetchType))),this.totalRecordCount=-1,"totalRecordCount"in this.myDataFetcher&&(this.totalRecordCount=this.myDataFetcher.totalRecordCount),this.isTruncatedRecordCount=!1,"isTruncatedRecordCount"in this.myDataFetcher&&(this.isTruncatedRecordCount=this.myDataFetcher.isTruncatedRecordCount);if(this.totalRecordCount==0)c='<span class="DQXImportantMessage">This result set does not contain any data<span>';else{var c="&nbsp;&nbsp;&nbsp;Current: "+(this.myTableOffset+1)+"-"+(this.myTableOffset+this.myPageSize);str_recordCount=" <i>[fetching...]</i>",this.totalRecordCount>0&&(this.isTruncatedRecordCount?str_recordCount=">"+this.totalRecordCount:str_recordCount=""+this.totalRecordCount),c+="; Total: "+str_recordCount}e("#"+l.myBaseID+"_status").html(c);if(f&&this._dataValid&&!this.preventDownloadData){var h=this.myDataFetcher.createDownloadUrl();l.dl_button?(l.dl_button.setOnChanged(function(){window.location.href=h}),l.dl_button_showhide.setVisible(!0)):(l.dl_button=s.Button(l.myBaseID+"_dl",{height:22,icon:"fa-download",description:"Download data",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(function(){window.location.href=h}),l.dl_button_showhide=s.ShowHide(l.dl_button),e("#"+l.myBaseID+"_right").html(l.dl_button_showhide.renderHtml()),s.ExecPostCreateHtml())}else l.dl_button_showhide&&l.dl_button_showhide.setVisible(!1);var p=[];for(var d=0;d<=1;d++)this._dataValid?p[d]='<table class="DQXQueryTable">':p[d]='<table class="DQXQueryTable DQXQueryTableInvalid">';var v=0;for(var m in this.myColumns){var g=this.myColumns[m];if(g.isVisible()){var d=g.TablePart;d==1&&v++,p[d]+='<th TITLE="{comment}"><div id="{theid}" class="DQXQueryTableHeaderText" style="position:relative;padding-right:15px;height:100%;min-width:{minw}px">'.DQXformat({comment:g._toolTip,theid:g.myCompID+"~headertext~"+this.myBaseID,minw:g.minWidth}),p[d]+=g.myName,g.myName.indexOf("<br>")<0&&(p[d]+="<br>&nbsp;");if(g.sortOption){var y=t.BMP("arrow6up.png");this.myDataFetcher.positionField==g.sortOption.toString()&&(this.myDataFetcher.sortReverse?y=t.BMP("arrow7down.png"):y=t.BMP("arrow7up.png"));var c='<IMG class="DQXQueryTableSortHeader" id="{id}" SRC={bmp} border=0 class="DQXBitmapLink" title="Sort by this column" ALT="Link" style="position:absolute;right:-4px;bottom:-3px">'.DQXformat({id:g.myCompID+"~sort~"+this.myBaseID,bmp:y});p[d]+=" "+c}if(g._hyperlinkHeaderMessageScope||g._headerClickHandler){var c='<IMG class="DQXQueryTableLinkHeader" id="{theid}" SRC='+t.BMP("linkinfo2.png")+' border=0 class="DQXBitmapLink" ALT="Link" title="{hint}" style="position:absolute;right:-3px;top:-3px">';c=c.DQXformat({theid:g.myCompID+"~headerlink~"+this.myBaseID,hint:g._toolTip}),p[d]+=" "+c}p[d]+="</div>",p[d]+="</th>"}}this._dataValid&&!f&&e("#"+l.myBaseID+"_status").html('<span class="DQXImportantMessage">FETCHING...</span>'),this.hasFetchFailed&&e("#"+l.myBaseID+"_status").html('<span class="DQXImportantMessage">FETCH FAILED !!!</span>');for(var b=0;b<this.myPageSize;b++){var w=this.myTableOffset+b,E=this.myDataFetcher.findIndexByXVal(w);for(var d=0;d<=1;d++)p[d]+='<tr class="DQXTableRow" id="{id}">'.DQXformat({id:w+"_row_"+this.myBaseID+"_"+d});for(var m in this.myColumns){var g=this.myColumns[m];if(g.isVisible()){var d=g.TablePart,S=!1,x="white",T="&nbsp;",N="";if(this.totalRecordCount<0||w<this.totalRecordCount)T="?";if(E>=0){S=!0,g.colIsClientGenerated||(T=this.myDataFetcher.getColumnPoint(E,g.myCompID));var C=T;g.customTextCreator&&(T=g.customTextCreator(this.myDataFetcher,E)),x=g.CellToColor(T),T=g.CellToText(T),N=T,g.barGraphWidth&&(T='<div style="display:inline-block;width:{width}px"><div class="QueryTableValueBar" style="width:{widthfr}px"></div></div><div style="position:relative;left:{mwidth}px;top:-2px;display:inline-block">{content}</div>'.DQXformat({width:g.barGraphWidth,mwidth:-g.barGraphWidth,widthfr:Math.round((C-g.minval)/(g.maxval-g.minval)*g.barGraphWidth),content:T}))}p[d]+="<td style='max-width:"+(g.maxColumnWidth?g.maxColumnWidth+"px":"none")+";background-color:"+x+"'>";var k=!1;if((g._hyperlinkCellMessageScope||g._cellClickHandler)&&S&&T){k=!0;var L=g.myCompID+"~"+w+"~link~"+this.myBaseID;p[d]+='<span class="DQXQueryTableLinkCell" id="{id}">'.DQXformat({id:L}),g.isSelection||(p[d]+='<span class="fa {icon} DQXQueryTableLinkIcon"></span>'.DQXformat({icon:g._cellClickHandlerIsExternal?"fa-external-link":"fa-external-link-square"}))}p[d]+=T,k&&(p[d]+="</span>"),p[d]+="</td>"}}for(var d=0;d<=1;d++)p[d]+="</tr>"}for(var d=0;d<=1;d++)p[d]+="</table>";this.getElement("Footer").html(""),this.getElement("Body1").html(p[0]),this.getElement("Body2").html(p[1]);if(this._highlightRowNr>=0)for(var d=0;d<=1;d++)e("#"+l.myBaseID).find("#"+this._highlightRowNr+"_row_"+l.myBaseID+"_"+d).addClass("DQXTableRowSelected");e("#"+this.myBaseID).find(".DQXQueryTableLinkCell").mousedown(function(){return!1}),e("#"+this.myBaseID).find(".DQXQueryTableLinkCell").click(e.proxy(l._onClickLinkCell,l)),e("#"+this.myBaseID).find(".DQXQueryTableHeaderText").click(e.proxy(l._onClickLinkHeader,l)),e("#"+this.myBaseID).find(".DQXQueryTableSortHeader").click(e.proxy(l._onClickSortHeader,l)),e("#"+this.myBaseID).find(".DQXTableRow").mouseenter(l._onRowMouseEnter),e("#"+this.myBaseID).find(".DQXTableRow").mouseleave(l._onRowMouseLeave),e("#"+this.myBaseID).find(".DQXTableRow").mousedown(l._onRowMouseDown),this.navButtonControls[0].enable(this.myTableOffset>0),this.navButtonControls[1].enable(this.myTableOffset>0);var A=this.myTableOffset+this.myPageSize>=this.totalRecordCount;this.navButtonControls[2].enable(!A||this.totalRecordCount<0),this.navButtonControls[3].enable(!A),t.popActivity()},l.modifyHightlightRow=function(t){if(this.hasHighlight){if(t>=0){if(!this._dataValid)return;t=Math.max(0,t),this.totalRecordCount>=0&&(t=Math.min(this.totalRecordCount-1,t))}else t=-1;if(l._highlightRowNr!=t){l._highlightRowNr=t,e("#"+l.myBaseID).find(".DQXTableRow").removeClass("DQXTableRowSelected");for(var n=0;n<=1;n++)e("#"+l.myBaseID).find("#"+t+"_row_"+l.myBaseID+"_"+n).addClass("DQXTableRowSelected");r.broadcast({type:"HighlightRowModified",id:this.myBaseID},this)}}},l.hasHighlightRow=function(){return l._highlightRowNr>=0},l.getHighlightRowNr=function(){return l._highlightRowNr},l.getCellValue=function(e,t){var n=this.myDataFetcher.findIndexByXVal(e);return n<0?null:l.myDataFetcher.getColumnPoint(n,t)},l._onRowMouseDown=function(t){var n=e(this).attr("id"),r=n.split("_")[0];r>=0&&l.modifyHightlightRow(r)},l._onRowMouseEnter=function(t){var n=e(this).attr("id"),r=n.split("_")[0];if(r>=0)for(var i=0;i<=1;i++)e("#"+l.myBaseID).find("#"+r+"_row_"+l.myBaseID+"_"+i).addClass("DQXTableRowHover")},l._onRowMouseLeave=function(t){var n=e(this).attr("id"),r=n.split("_")[0];if(r>=0)for(var i=0;i<=1;i++)e("#"+l.myBaseID).find("#"+r+"_row_"+l.myBaseID+"_"+i).removeClass("DQXTableRowHover")},l._onClickLinkCell=function(e){if(e.target.id)var t=e.target.id.split("~");else var t=e.currentTarget.id.split("~");var n=this.findColumn(t[0]);return n._cellClickHandler&&n._cellClickHandler(l.myDataFetcher,t[1],{shiftPressed:e.shiftKey,controlPressed:e.ctrlKey}),n._hyperlinkCellMessageScope&&r.broadcast(n._hyperlinkCellMessageScope,parseInt(t[1])),!1},l._onClickLinkHeader=function(e){var t=e.target.id.split("~"),n=this.findColumn(t[0]);return n._headerClickHandler&&n._headerClickHandler(t[0]),n._hyperlinkHeaderMessageScope&&r.broadcast(n._hyperlinkHeaderMessageScope,t[0]),!1},l._onClickSortHeader=function(e){var t=e.target.id.split("~"),n=this.findColumn(t[0]);if(n.checkCanSort&&!n.checkCanSort())return!1;var r=n.sortOption.toString();return this.myDataFetcher.positionField!=r?this.myDataFetcher.sortReverse=!1:this.myDataFetcher.sortReverse=!this.myDataFetcher.sortReverse,this.myDataFetcher.positionField=r,this.myDataFetcher.clearData(),this.myTableOffset=0,this._highlightRowNr=-1,this.render(),!1},l.sortByColumn=function(e,t){var n=this.findColumn(e);if(n.checkCanSort&&!n.checkCanSort())return;var r=n.sortOption.toString();this.myDataFetcher.sortReverse=t,this.myDataFetcher.positionField=r,this.myDataFetcher.clearData(),this.myTableOffset=0,this._highlightRowNr=-1,this.render()},l.storeSettings=function(){var e={};return e.positionField=l.myDataFetcher.positionField,e.sortReverse=l.myDataFetcher.sortReverse,e},l.recallSettings=function(e){e.positionField&&(l.myDataFetcher.positionField=e.positionField),e.sortReverse&&(l.myDataFetcher.sortReverse=e.sortReverse)},l.onKeyDown=function(e){return e.keyCode==40?(this.hasHighlight?(this.modifyHightlightRow(this._highlightRowNr+1),this.scrollHighlightRowInView()):this._onLineDown(1),!0):e.keyCode==38?(this.hasHighlight?(this.modifyHightlightRow(Math.max(0,this._highlightRowNr-1)),this.scrollHighlightRowInView()):this._onLineUp(1),!0):e.keyCode==33?(this.hasHighlight?(this.modifyHightlightRow(Math.max(0,this._highlightRowNr-this.myPageSize)),this.scrollHighlightRowInView()):l._onBack(),!0):e.keyCode==34?(this.hasHighlight?(this.modifyHightlightRow(Math.max(0,this._highlightRowNr+this.myPageSize)),this.scrollHighlightRowInView()):l._onForward(),!0):!1},l.OnMouseWheel=function(e){var n=t.getMouseWheelDelta(e);if(n<0)return this._onLineDown(3),!1;if(n>0)return this._onLineUp(3),!1},l.onResize=function(){},l.getElement("Body1").bind("DOMMouseScroll mousewheel",e.proxy(l.OnMouseWheel,l)),l.getElement("Body2").bind("DOMMouseScroll mousewheel",e.proxy(l.OnMouseWheel,l)),l},f}),define("DQX/data/countries",[],function(){var e={};e.raw_geo_json={type:"FeatureCollection",features:[{type:"Feature",id:"AFG",properties:{name:"Afghanistan"},geometry:{type:"Polygon",coordinates:[[[61.210817,35.650072],[62.230651,35.270664],[62.984662,35.404041],[63.193538,35.857166],[63.982896,36.007957],[64.546479,36.312073],[64.746105,37.111818],[65.588948,37.305217],[65.745631,37.661164],[66.217385,37.39379],[66.518607,37.362784],[67.075782,37.356144],[67.83,37.144994],[68.135562,37.023115],[68.859446,37.344336],[69.196273,37.151144],[69.518785,37.608997],[70.116578,37.588223],[70.270574,37.735165],[70.376304,38.138396],[70.806821,38.486282],[71.348131,38.258905],[71.239404,37.953265],[71.541918,37.905774],[71.448693,37.065645],[71.844638,36.738171],[72.193041,36.948288],[72.63689,37.047558],[73.260056,37.495257],[73.948696,37.421566],[74.980002,37.41999],[75.158028,37.133031],[74.575893,37.020841],[74.067552,36.836176],[72.920025,36.720007],[71.846292,36.509942],[71.262348,36.074388],[71.498768,35.650563],[71.613076,35.153203],[71.115019,34.733126],[71.156773,34.348911],[70.881803,33.988856],[69.930543,34.02012],[70.323594,33.358533],[69.687147,33.105499],[69.262522,32.501944],[69.317764,31.901412],[68.926677,31.620189],[68.556932,31.71331],[67.792689,31.58293],[67.683394,31.303154],[66.938891,31.304911],[66.381458,30.738899],[66.346473,29.887943],[65.046862,29.472181],[64.350419,29.560031],[64.148002,29.340819],[63.550261,29.468331],[62.549857,29.318572],[60.874248,29.829239],[61.781222,30.73585],[61.699314,31.379506],[60.941945,31.548075],[60.863655,32.18292],[60.536078,32.981269],[60.9637,33.528832],[60.52843,33.676446],[60.803193,34.404102],[61.210817,35.650072]]]}},{type:"Feature",id:"AGO",properties:{name:"Angola"},geometry:{type:"MultiPolygon",coordinates:[[[[16.326528,-5.87747],[16.57318,-6.622645],[16.860191,-7.222298],[17.089996,-7.545689],[17.47297,-8.068551],[18.134222,-7.987678],[18.464176,-7.847014],[19.016752,-7.988246],[19.166613,-7.738184],[19.417502,-7.155429],[20.037723,-7.116361],[20.091622,-6.94309],[20.601823,-6.939318],[20.514748,-7.299606],[21.728111,-7.290872],[21.746456,-7.920085],[21.949131,-8.305901],[21.801801,-8.908707],[21.875182,-9.523708],[22.208753,-9.894796],[22.155268,-11.084801],[22.402798,-10.993075],[22.837345,-11.017622],[23.456791,-10.867863],[23.912215,-10.926826],[24.017894,-11.237298],[23.904154,-11.722282],[24.079905,-12.191297],[23.930922,-12.565848],[24.016137,-12.911046],[21.933886,-12.898437],[21.887843,-16.08031],[22.562478,-16.898451],[23.215048,-17.523116],[21.377176,-17.930636],[18.956187,-17.789095],[18.263309,-17.309951],[14.209707,-17.353101],[14.058501,-17.423381],[13.462362,-16.971212],[12.814081,-16.941343],[12.215461,-17.111668],[11.734199,-17.301889],[11.640096,-16.673142],[11.778537,-15.793816],[12.123581,-14.878316],[12.175619,-14.449144],[12.500095,-13.5477],[12.738479,-13.137906],[13.312914,-12.48363],[13.633721,-12.038645],[13.738728,-11.297863],[13.686379,-10.731076],[13.387328,-10.373578],[13.120988,-9.766897],[12.87537,-9.166934],[12.929061,-8.959091],[13.236433,-8.562629],[12.93304,-7.596539],[12.728298,-6.927122],[12.227347,-6.294448],[12.322432,-6.100092],[12.735171,-5.965682],[13.024869,-5.984389],[13.375597,-5.864241],[16.326528,-5.87747]]],[[[12.436688,-5.684304],[12.182337,-5.789931],[11.914963,-5.037987],[12.318608,-4.60623],[12.62076,-4.438023],[12.995517,-4.781103],[12.631612,-4.991271],[12.468004,-5.248362],[12.436688,-5.684304]]]]}},{type:"Feature",id:"ALB",properties:{name:"Albania"},geometry:{type:"Polygon",coordinates:[[[20.590247,41.855404],[20.463175,41.515089],[20.605182,41.086226],[21.02004,40.842727],[20.99999,40.580004],[20.674997,40.435],[20.615,40.110007],[20.150016,39.624998],[19.98,39.694993],[19.960002,39.915006],[19.406082,40.250773],[19.319059,40.72723],[19.40355,41.409566],[19.540027,41.719986],[19.371769,41.877548],[19.304486,42.195745],[19.738051,42.688247],[19.801613,42.500093],[20.0707,42.58863],[20.283755,42.32026],[20.52295,42.21787],[20.590247,41.855404]]]}},{type:"Feature",id:"ARE",properties:{name:"United Arab Emirates"},geometry:{type:"Polygon",coordinates:[[[51.579519,24.245497],[51.757441,24.294073],[51.794389,24.019826],[52.577081,24.177439],[53.404007,24.151317],[54.008001,24.121758],[54.693024,24.797892],[55.439025,25.439145],[56.070821,26.055464],[56.261042,25.714606],[56.396847,24.924732],[55.886233,24.920831],[55.804119,24.269604],[55.981214,24.130543],[55.528632,23.933604],[55.525841,23.524869],[55.234489,23.110993],[55.208341,22.70833],[55.006803,22.496948],[52.000733,23.001154],[51.617708,24.014219],[51.579519,24.245497]]]}},{type:"Feature",id:"ARG",properties:{name:"Argentina"},geometry:{type:"MultiPolygon",coordinates:[[[[-65.5,-55.2],[-66.45,-55.25],[-66.95992,-54.89681],[-67.56244,-54.87001],[-68.63335,-54.8695],[-68.63401,-52.63637],[-68.25,-53.1],[-67.75,-53.85],[-66.45,-54.45],[-65.05,-54.7],[-65.5,-55.2]]],[[[-64.964892,-22.075862],[-64.377021,-22.798091],[-63.986838,-21.993644],[-62.846468,-22.034985],[-62.685057,-22.249029],[-60.846565,-23.880713],[-60.028966,-24.032796],[-58.807128,-24.771459],[-57.777217,-25.16234],[-57.63366,-25.603657],[-58.618174,-27.123719],[-57.60976,-27.395899],[-56.486702,-27.548499],[-55.695846,-27.387837],[-54.788795,-26.621786],[-54.625291,-25.739255],[-54.13005,-25.547639],[-53.628349,-26.124865],[-53.648735,-26.923473],[-54.490725,-27.474757],[-55.162286,-27.881915],[-56.2909,-28.852761],[-57.625133,-30.216295],[-57.874937,-31.016556],[-58.14244,-32.044504],[-58.132648,-33.040567],[-58.349611,-33.263189],[-58.427074,-33.909454],[-58.495442,-34.43149],[-57.22583,-35.288027],[-57.362359,-35.97739],[-56.737487,-36.413126],[-56.788285,-36.901572],[-57.749157,-38.183871],[-59.231857,-38.72022],[-61.237445,-38.928425],[-62.335957,-38.827707],[-62.125763,-39.424105],[-62.330531,-40.172586],[-62.145994,-40.676897],[-62.745803,-41.028761],[-63.770495,-41.166789],[-64.73209,-40.802677],[-65.118035,-41.064315],[-64.978561,-42.058001],[-64.303408,-42.359016],[-63.755948,-42.043687],[-63.458059,-42.563138],[-64.378804,-42.873558],[-65.181804,-43.495381],[-65.328823,-44.501366],[-65.565269,-45.036786],[-66.509966,-45.039628],[-67.293794,-45.551896],[-67.580546,-46.301773],[-66.597066,-47.033925],[-65.641027,-47.236135],[-65.985088,-48.133289],[-67.166179,-48.697337],[-67.816088,-49.869669],[-68.728745,-50.264218],[-69.138539,-50.73251],[-68.815561,-51.771104],[-68.149995,-52.349983],[-68.571545,-52.299444],[-69.498362,-52.142761],[-71.914804,-52.009022],[-72.329404,-51.425956],[-72.309974,-50.67701],[-72.975747,-50.74145],[-73.328051,-50.378785],[-73.415436,-49.318436],[-72.648247,-48.878618],[-72.331161,-48.244238],[-72.447355,-47.738533],[-71.917258,-46.884838],[-71.552009,-45.560733],[-71.659316,-44.973689],[-71.222779,-44.784243],[-71.329801,-44.407522],[-71.793623,-44.207172],[-71.464056,-43.787611],[-71.915424,-43.408565],[-72.148898,-42.254888],[-71.746804,-42.051386],[-71.915734,-40.832339],[-71.680761,-39.808164],[-71.413517,-38.916022],[-70.814664,-38.552995],[-71.118625,-37.576827],[-71.121881,-36.658124],[-70.364769,-36.005089],[-70.388049,-35.169688],[-69.817309,-34.193571],[-69.814777,-33.273886],[-70.074399,-33.09121],[-70.535069,-31.36501],[-69.919008,-30.336339],[-70.01355,-29.367923],[-69.65613,-28.459141],[-69.001235,-27.521214],[-68.295542,-26.89934],[-68.5948,-26.506909],[-68.386001,-26.185016],[-68.417653,-24.518555],[-67.328443,-24.025303],[-66.985234,-22.986349],[-67.106674,-22.735925],[-66.273339,-21.83231],[-64.964892,-22.075862]]]]}},{type:"Feature",id:"ARM",properties:{name:"Armenia"},geometry:{type:"Polygon",coordinates:[[[43.582746,41.092143],[44.97248,41.248129],[45.179496,40.985354],[45.560351,40.81229],[45.359175,40.561504],[45.891907,40.218476],[45.610012,39.899994],[46.034534,39.628021],[46.483499,39.464155],[46.50572,38.770605],[46.143623,38.741201],[45.735379,39.319719],[45.739978,39.473999],[45.298145,39.471751],[45.001987,39.740004],[44.79399,39.713003],[44.400009,40.005],[43.656436,40.253564],[43.752658,40.740201],[43.582746,41.092143]]]}},{type:"Feature",id:"ATA",properties:{name:"Antarctica"},geometry:{type:"MultiPolygon",coordinates:[[[[-59.572095,-80.040179],[-59.865849,-80.549657],[-60.159656,-81.000327],[-62.255393,-80.863178],[-64.488125,-80.921934],[-65.741666,-80.588827],[-65.741666,-80.549657],[-66.290031,-80.255773],[-64.037688,-80.294944],[-61.883246,-80.39287],[-61.138976,-79.981371],[-60.610119,-79.628679],[-59.572095,-80.040179]]],[[[-159.208184,-79.497059],[-161.127601,-79.634209],[-162.439847,-79.281465],[-163.027408,-78.928774],[-163.066604,-78.869966],[-163.712896,-78.595667],[-163.712896,-78.595667],[-163.105801,-78.223338],[-161.245113,-78.380176],[-160.246208,-78.693645],[-159.482405,-79.046338],[-159.208184,-79.497059]]],[[[-45.154758,-78.04707],[-43.920828,-78.478103],[-43.48995,-79.08556],[-43.372438,-79.516645],[-43.333267,-80.026123],[-44.880537,-80.339644],[-46.506174,-80.594357],[-48.386421,-80.829485],[-50.482107,-81.025442],[-52.851988,-80.966685],[-54.164259,-80.633528],[-53.987991,-80.222028],[-51.853134,-79.94773],[-50.991326,-79.614623],[-50.364595,-79.183487],[-49.914131,-78.811209],[-49.306959,-78.458569],[-48.660616,-78.047018],[-48.660616,-78.047019],[-48.151396,-78.04707],[-46.662857,-77.831476],[-45.154758,-78.04707]]],[[[-121.211511,-73.50099],[-119.918851,-73.657725],[-118.724143,-73.481353],[-119.292119,-73.834097],[-120.232217,-74.08881],[-121.62283,-74.010468],[-122.621735,-73.657778],[-122.621735,-73.657777],[-122.406245,-73.324619],[-121.211511,-73.50099]]],[[[-125.559566,-73.481353],[-124.031882,-73.873268],[-124.619469,-73.834097],[-125.912181,-73.736118],[-127.28313,-73.461769],[-127.28313,-73.461768],[-126.558472,-73.246226],[-125.559566,-73.481353]]],[[[-98.98155,-71.933334],[-97.884743,-72.070535],[-96.787937,-71.952971],[-96.20035,-72.521205],[-96.983765,-72.442864],[-98.198083,-72.482035],[-99.432013,-72.442864],[-100.783455,-72.50162],[-101.801868,-72.305663],[-102.330725,-71.894164],[-102.330725,-71.894164],[-101.703967,-71.717792],[-100.430919,-71.854993],[-98.98155,-71.933334]]],[[[-68.451346,-70.955823],[-68.333834,-71.406493],[-68.510128,-71.798407],[-68.784297,-72.170736],[-69.959471,-72.307885],[-71.075889,-72.503842],[-72.388134,-72.484257],[-71.8985,-72.092343],[-73.073622,-72.229492],[-74.19004,-72.366693],[-74.953895,-72.072757],[-75.012625,-71.661258],[-73.915819,-71.269345],[-73.915819,-71.269344],[-73.230331,-71.15178],[-72.074717,-71.190951],[-71.780962,-70.681473],[-71.72218,-70.309196],[-71.741791,-69.505782],[-71.173815,-69.035475],[-70.253252,-68.87874],[-69.724447,-69.251017],[-69.489422,-69.623346],[-69.058518,-70.074016],[-68.725541,-70.505153],[-68.451346,-70.955823]]],[[[-58.614143,-64.152467],[-59.045073,-64.36801],[-59.789342,-64.211223],[-60.611928,-64.309202],[-61.297416,-64.54433],[-62.0221,-64.799094],[-62.51176,-65.09303],[-62.648858,-65.484942],[-62.590128,-65.857219],[-62.120079,-66.190326],[-62.805567,-66.425505],[-63.74569,-66.503847],[-64.294106,-66.837004],[-64.881693,-67.150474],[-65.508425,-67.58161],[-65.665082,-67.953887],[-65.312545,-68.365335],[-64.783715,-68.678908],[-63.961103,-68.913984],[-63.1973,-69.227556],[-62.785955,-69.619419],[-62.570516,-69.991747],[-62.276736,-70.383661],[-61.806661,-70.716768],[-61.512906,-71.089045],[-61.375809,-72.010074],[-61.081977,-72.382351],[-61.003661,-72.774265],[-60.690269,-73.166179],[-60.827367,-73.695242],[-61.375809,-74.106742],[-61.96337,-74.439848],[-63.295201,-74.576997],[-63.74569,-74.92974],[-64.352836,-75.262847],[-65.860987,-75.635124],[-67.192818,-75.79191],[-68.446282,-76.007452],[-69.797724,-76.222995],[-70.600724,-76.634494],[-72.206776,-76.673665],[-73.969536,-76.634494],[-75.555977,-76.712887],[-77.24037,-76.712887],[-76.926979,-77.104802],[-75.399294,-77.28107],[-74.282876,-77.55542],[-73.656119,-77.908112],[-74.772536,-78.221633],[-76.4961,-78.123654],[-77.925858,-78.378419],[-77.984666,-78.789918],[-78.023785,-79.181833],[-76.848637,-79.514939],[-76.633224,-79.887216],[-75.360097,-80.259545],[-73.244852,-80.416331],[-71.442946,-80.69063],[-70.013163,-81.004151],[-68.191646,-81.317672],[-65.704279,-81.474458],[-63.25603,-81.748757],[-61.552026,-82.042692],[-59.691416,-82.37585],[-58.712121,-82.846106],[-58.222487,-83.218434],[-57.008117,-82.865691],[-55.362894,-82.571755],[-53.619771,-82.258235],[-51.543644,-82.003521],[-49.76135,-81.729171],[-47.273931,-81.709586],[-44.825708,-81.846735],[-42.808363,-82.081915],[-42.16202,-81.65083],[-40.771433,-81.356894],[-38.244818,-81.337309],[-36.26667,-81.121715],[-34.386397,-80.906172],[-32.310296,-80.769023],[-30.097098,-80.592651],[-28.549802,-80.337938],[-29.254901,-79.985195],[-29.685805,-79.632503],[-29.685805,-79.260226],[-31.624808,-79.299397],[-33.681324,-79.456132],[-35.639912,-79.456132],[-35.914107,-79.083855],[-35.77701,-78.339248],[-35.326546,-78.123654],[-33.896763,-77.888526],[-32.212369,-77.65345],[-30.998051,-77.359515],[-29.783732,-77.065579],[-28.882779,-76.673665],[-27.511752,-76.497345],[-26.160336,-76.360144],[-25.474822,-76.281803],[-23.927552,-76.24258],[-22.458598,-76.105431],[-21.224694,-75.909474],[-20.010375,-75.674346],[-18.913543,-75.439218],[-17.522982,-75.125698],[-16.641589,-74.79254],[-15.701491,-74.498604],[-15.40771,-74.106742],[-16.46532,-73.871614],[-16.112784,-73.460114],[-15.446855,-73.146542],[-14.408805,-72.950585],[-13.311973,-72.715457],[-12.293508,-72.401936],[-11.510067,-72.010074],[-11.020433,-71.539767],[-10.295774,-71.265416],[-9.101015,-71.324224],[-8.611381,-71.65733],[-7.416622,-71.696501],[-7.377451,-71.324224],[-6.868232,-70.93231],[-5.790985,-71.030289],[-5.536375,-71.402617],[-4.341667,-71.461373],[-3.048981,-71.285053],[-1.795492,-71.167438],[-0.659489,-71.226246],[-0.228637,-71.637745],[.868195,-71.304639],[1.886686,-71.128267],[3.022638,-70.991118],[4.139055,-70.853917],[5.157546,-70.618789],[6.273912,-70.462055],[7.13572,-70.246512],[7.742866,-69.893769],[8.48711,-70.148534],[9.525135,-70.011333],[10.249845,-70.48164],[10.817821,-70.834332],[11.953824,-70.638375],[12.404287,-70.246512],[13.422778,-69.972162],[14.734998,-70.030918],[15.126757,-70.403247],[15.949342,-70.030918],[17.026589,-69.913354],[18.201711,-69.874183],[19.259373,-69.893769],[20.375739,-70.011333],[21.452985,-70.07014],[21.923034,-70.403247],[22.569403,-70.697182],[23.666184,-70.520811],[24.841357,-70.48164],[25.977309,-70.48164],[27.093726,-70.462055],[28.09258,-70.324854],[29.150242,-70.20729],[30.031583,-69.93294],[30.971733,-69.75662],[31.990172,-69.658641],[32.754053,-69.384291],[33.302443,-68.835642],[33.870419,-68.502588],[34.908495,-68.659271],[35.300202,-69.012014],[36.16201,-69.247142],[37.200035,-69.168748],[37.905108,-69.52144],[38.649404,-69.776205],[39.667894,-69.541077],[40.020431,-69.109941],[40.921358,-68.933621],[41.959434,-68.600514],[42.938702,-68.463313],[44.113876,-68.267408],[44.897291,-68.051866],[45.719928,-67.816738],[46.503343,-67.601196],[47.44344,-67.718759],[48.344419,-67.366068],[48.990736,-67.091718],[49.930885,-67.111303],[50.753471,-66.876175],[50.949325,-66.523484],[51.791547,-66.249133],[52.614133,-66.053176],[53.613038,-65.89639],[54.53355,-65.818049],[55.414943,-65.876805],[56.355041,-65.974783],[57.158093,-66.249133],[57.255968,-66.680218],[58.137361,-67.013324],[58.744508,-67.287675],[59.939318,-67.405239],[60.605221,-67.679589],[61.427806,-67.953887],[62.387489,-68.012695],[63.19049,-67.816738],[64.052349,-67.405239],[64.992447,-67.620729],[65.971715,-67.738345],[66.911864,-67.855909],[67.891133,-67.934302],[68.890038,-67.934302],[69.712624,-68.972791],[69.673453,-69.227556],[69.555941,-69.678226],[68.596258,-69.93294],[67.81274,-70.305268],[67.949889,-70.697182],[69.066307,-70.677545],[68.929157,-71.069459],[68.419989,-71.441788],[67.949889,-71.853287],[68.71377,-72.166808],[69.869307,-72.264787],[71.024895,-72.088415],[71.573285,-71.696501],[71.906288,-71.324224],[72.454627,-71.010703],[73.08141,-70.716768],[73.33602,-70.364024],[73.864877,-69.874183],[74.491557,-69.776205],[75.62756,-69.737034],[76.626465,-69.619419],[77.644904,-69.462684],[78.134539,-69.07077],[78.428371,-68.698441],[79.113859,-68.326216],[80.093127,-68.071503],[80.93535,-67.875546],[81.483792,-67.542388],[82.051767,-67.366068],[82.776426,-67.209282],[83.775331,-67.30726],[84.676206,-67.209282],[85.655527,-67.091718],[86.752359,-67.150474],[87.477017,-66.876175],[87.986289,-66.209911],[88.358411,-66.484261],[88.828408,-66.954568],[89.67063,-67.150474],[90.630365,-67.228867],[91.5901,-67.111303],[92.608539,-67.189696],[93.548637,-67.209282],[94.17542,-67.111303],[95.017591,-67.170111],[95.781472,-67.385653],[96.682399,-67.248504],[97.759646,-67.248504],[98.68021,-67.111303],[99.718182,-67.248504],[100.384188,-66.915346],[100.893356,-66.58224],[101.578896,-66.30789],[102.832411,-65.563284],[103.478676,-65.700485],[104.242557,-65.974783],[104.90846,-66.327527],[106.181561,-66.934931],[107.160881,-66.954568],[108.081393,-66.954568],[109.15864,-66.837004],[110.235835,-66.699804],[111.058472,-66.425505],[111.74396,-66.13157],[112.860378,-66.092347],[113.604673,-65.876805],[114.388088,-66.072762],[114.897308,-66.386283],[115.602381,-66.699804],[116.699161,-66.660633],[117.384701,-66.915346],[118.57946,-67.170111],[119.832924,-67.268089],[120.871,-67.189696],[121.654415,-66.876175],[122.320369,-66.562654],[123.221296,-66.484261],[124.122274,-66.621462],[125.160247,-66.719389],[126.100396,-66.562654],[127.001427,-66.562654],[127.882768,-66.660633],[128.80328,-66.758611],[129.704259,-66.58224],[130.781454,-66.425505],[131.799945,-66.386283],[132.935896,-66.386283],[133.85646,-66.288304],[134.757387,-66.209963],[135.031582,-65.72007],[135.070753,-65.308571],[135.697485,-65.582869],[135.873805,-66.033591],[136.206705,-66.44509],[136.618049,-66.778197],[137.460271,-66.954568],[138.596223,-66.895761],[139.908442,-66.876175],[140.809421,-66.817367],[142.121692,-66.817367],[143.061842,-66.797782],[144.374061,-66.837004],[145.490427,-66.915346],[146.195552,-67.228867],[145.999699,-67.601196],[146.646067,-67.895131],[147.723263,-68.130259],[148.839629,-68.385024],[150.132314,-68.561292],[151.483705,-68.71813],[152.502247,-68.874813],[153.638199,-68.894502],[154.284567,-68.561292],[155.165857,-68.835642],[155.92979,-69.149215],[156.811132,-69.384291],[158.025528,-69.482269],[159.181013,-69.599833],[159.670699,-69.991747],[160.80665,-70.226875],[161.570479,-70.579618],[162.686897,-70.736353],[163.842434,-70.716768],[164.919681,-70.775524],[166.11444,-70.755938],[167.309095,-70.834332],[168.425616,-70.971481],[169.463589,-71.20666],[170.501665,-71.402617],[171.20679,-71.696501],[171.089227,-72.088415],[170.560422,-72.441159],[170.109958,-72.891829],[169.75737,-73.24452],[169.287321,-73.65602],[167.975101,-73.812806],[167.387489,-74.165498],[166.094803,-74.38104],[165.644391,-74.772954],[164.958851,-75.145283],[164.234193,-75.458804],[163.822797,-75.870303],[163.568239,-76.24258],[163.47026,-76.693302],[163.489897,-77.065579],[164.057873,-77.457442],[164.273363,-77.82977],[164.743464,-78.182514],[166.604126,-78.319611],[166.995781,-78.750748],[165.193876,-78.907483],[163.666217,-79.123025],[161.766385,-79.162248],[160.924162,-79.730482],[160.747894,-80.200737],[160.316964,-80.573066],[159.788211,-80.945395],[161.120016,-81.278501],[161.629287,-81.690001],[162.490992,-82.062278],[163.705336,-82.395435],[165.095949,-82.708956],[166.604126,-83.022477],[168.895665,-83.335998],[169.404782,-83.825891],[172.283934,-84.041433],[172.477049,-84.117914],[173.224083,-84.41371],[175.985672,-84.158997],[178.277212,-84.472518],[180,-84.71338],[-179.942499,-84.721443],[-179.058677,-84.139412],[-177.256772,-84.452933],[-177.140807,-84.417941],[-176.084673,-84.099259],[-175.947235,-84.110449],[-175.829882,-84.117914],[-174.382503,-84.534323],[-173.116559,-84.117914],[-172.889106,-84.061019],[-169.951223,-83.884647],[-168.999989,-84.117914],[-168.530199,-84.23739],[-167.022099,-84.570497],[-164.182144,-84.82521],[-161.929775,-85.138731],[-158.07138,-85.37391],[-155.192253,-85.09956],[-150.942099,-85.295517],[-148.533073,-85.609038],[-145.888918,-85.315102],[-143.107718,-85.040752],[-142.892279,-84.570497],[-146.829068,-84.531274],[-150.060732,-84.296146],[-150.902928,-83.904232],[-153.586201,-83.68869],[-153.409907,-83.23802],[-153.037759,-82.82652],[-152.665637,-82.454192],[-152.861517,-82.042692],[-154.526299,-81.768394],[-155.29018,-81.41565],[-156.83745,-81.102129],[-154.408787,-81.160937],[-152.097662,-81.004151],[-150.648293,-81.337309],[-148.865998,-81.043373],[-147.22075,-80.671045],[-146.417749,-80.337938],[-146.770286,-79.926439],[-148.062947,-79.652089],[-149.531901,-79.358205],[-151.588416,-79.299397],[-153.390322,-79.162248],[-155.329376,-79.064269],[-155.975668,-78.69194],[-157.268302,-78.378419],[-158.051768,-78.025676],[-158.365134,-76.889207],[-157.875474,-76.987238],[-156.974573,-77.300759],[-155.329376,-77.202728],[-153.742832,-77.065579],[-152.920247,-77.496664],[-151.33378,-77.398737],[-150.00195,-77.183143],[-148.748486,-76.908845],[-147.612483,-76.575738],[-146.104409,-76.47776],[-146.143528,-76.105431],[-146.496091,-75.733154],[-146.20231,-75.380411],[-144.909624,-75.204039],[-144.322037,-75.537197],[-142.794353,-75.34124],[-141.638764,-75.086475],[-140.209007,-75.06689],[-138.85759,-74.968911],[-137.5062,-74.733783],[-136.428901,-74.518241],[-135.214583,-74.302699],[-134.431194,-74.361455],[-133.745654,-74.439848],[-132.257168,-74.302699],[-130.925311,-74.479019],[-129.554284,-74.459433],[-128.242038,-74.322284],[-126.890622,-74.420263],[-125.402082,-74.518241],[-124.011496,-74.479019],[-122.562152,-74.498604],[-121.073613,-74.518241],[-119.70256,-74.479019],[-118.684145,-74.185083],[-117.469801,-74.028348],[-116.216312,-74.243891],[-115.021552,-74.067519],[-113.944331,-73.714828],[-113.297988,-74.028348],[-112.945452,-74.38104],[-112.299083,-74.714198],[-111.261059,-74.420263],[-110.066325,-74.79254],[-108.714909,-74.910103],[-107.559346,-75.184454],[-106.149148,-75.125698],[-104.876074,-74.949326],[-103.367949,-74.988497],[-102.016507,-75.125698],[-100.645531,-75.302018],[-100.1167,-74.870933],[-100.763043,-74.537826],[-101.252703,-74.185083],[-102.545337,-74.106742],[-103.113313,-73.734413],[-103.328752,-73.362084],[-103.681289,-72.61753],[-102.917485,-72.754679],[-101.60524,-72.813436],[-100.312528,-72.754679],[-99.13738,-72.911414],[-98.118889,-73.20535],[-97.688037,-73.558041],[-96.336595,-73.616849],[-95.043961,-73.4797],[-93.672907,-73.283743],[-92.439003,-73.166179],[-91.420564,-73.401307],[-90.088733,-73.322914],[-89.226951,-72.558722],[-88.423951,-73.009393],[-87.268337,-73.185764],[-86.014822,-73.087786],[-85.192236,-73.4797],[-83.879991,-73.518871],[-82.665646,-73.636434],[-81.470913,-73.851977],[-80.687447,-73.4797],[-80.295791,-73.126956],[-79.296886,-73.518871],[-77.925858,-73.420892],[-76.907367,-73.636434],[-76.221879,-73.969541],[-74.890049,-73.871614],[-73.852024,-73.65602],[-72.833533,-73.401307],[-71.619215,-73.264157],[-70.209042,-73.146542],[-68.935916,-73.009393],[-67.956622,-72.79385],[-67.369061,-72.480329],[-67.134036,-72.049244],[-67.251548,-71.637745],[-67.56494,-71.245831],[-67.917477,-70.853917],[-68.230843,-70.462055],[-68.485452,-70.109311],[-68.544209,-69.717397],[-68.446282,-69.325535],[-67.976233,-68.953206],[-67.5845,-68.541707],[-67.427843,-68.149844],[-67.62367,-67.718759],[-67.741183,-67.326845],[-67.251548,-66.876175],[-66.703184,-66.58224],[-66.056815,-66.209963],[-65.371327,-65.89639],[-64.568276,-65.602506],[-64.176542,-65.171423],[-63.628152,-64.897073],[-63.001394,-64.642308],[-62.041686,-64.583552],[-61.414928,-64.270031],[-60.709855,-64.074074],[-59.887269,-63.95651],[-59.162585,-63.701745],[-58.594557,-63.388224],[-57.811143,-63.27066],[-57.223582,-63.525425],[-57.59573,-63.858532],[-58.614143,-64.152467]]]]}},{type:"Feature",id:"ATF",properties:{name:"French Southern and Antarctic Lands"},geometry:{type:"Polygon",coordinates:[[[68.935,-48.625],[69.58,-48.94],[70.525,-49.065],[70.56,-49.255],[70.28,-49.71],[68.745,-49.775],[68.72,-49.2425],[68.8675,-48.83],[68.935,-48.625]]]}},{type:"Feature",id:"AUS",properties:{name:"Australia"},geometry:{type:"MultiPolygon",coordinates:[[[[145.397978,-40.792549],[146.364121,-41.137695],[146.908584,-41.000546],[147.689259,-40.808258],[148.289068,-40.875438],[148.359865,-42.062445],[148.017301,-42.407024],[147.914052,-43.211522],[147.564564,-42.937689],[146.870343,-43.634597],[146.663327,-43.580854],[146.048378,-43.549745],[145.43193,-42.693776],[145.29509,-42.03361],[144.718071,-41.162552],[144.743755,-40.703975],[145.397978,-40.792549]]],[[[143.561811,-13.763656],[143.922099,-14.548311],[144.563714,-14.171176],[144.894908,-14.594458],[145.374724,-14.984976],[145.271991,-15.428205],[145.48526,-16.285672],[145.637033,-16.784918],[145.888904,-16.906926],[146.160309,-17.761655],[146.063674,-18.280073],[146.387478,-18.958274],[147.471082,-19.480723],[148.177602,-19.955939],[148.848414,-20.39121],[148.717465,-20.633469],[149.28942,-21.260511],[149.678337,-22.342512],[150.077382,-22.122784],[150.482939,-22.556142],[150.727265,-22.402405],[150.899554,-23.462237],[151.609175,-24.076256],[152.07354,-24.457887],[152.855197,-25.267501],[153.136162,-26.071173],[153.161949,-26.641319],[153.092909,-27.2603],[153.569469,-28.110067],[153.512108,-28.995077],[153.339095,-29.458202],[153.069241,-30.35024],[153.089602,-30.923642],[152.891578,-31.640446],[152.450002,-32.550003],[151.709117,-33.041342],[151.343972,-33.816023],[151.010555,-34.31036],[150.714139,-35.17346],[150.32822,-35.671879],[150.075212,-36.420206],[149.946124,-37.109052],[149.997284,-37.425261],[149.423882,-37.772681],[148.304622,-37.809061],[147.381733,-38.219217],[146.922123,-38.606532],[146.317922,-39.035757],[145.489652,-38.593768],[144.876976,-38.417448],[145.032212,-37.896188],[144.485682,-38.085324],[143.609974,-38.809465],[142.745427,-38.538268],[142.17833,-38.380034],[141.606582,-38.308514],[140.638579,-38.019333],[139.992158,-37.402936],[139.806588,-36.643603],[139.574148,-36.138362],[139.082808,-35.732754],[138.120748,-35.612296],[138.449462,-35.127261],[138.207564,-34.384723],[137.71917,-35.076825],[136.829406,-35.260535],[137.352371,-34.707339],[137.503886,-34.130268],[137.890116,-33.640479],[137.810328,-32.900007],[136.996837,-33.752771],[136.372069,-34.094766],[135.989043,-34.890118],[135.208213,-34.47867],[135.239218,-33.947953],[134.613417,-33.222778],[134.085904,-32.848072],[134.273903,-32.617234],[132.990777,-32.011224],[132.288081,-31.982647],[131.326331,-31.495803],[129.535794,-31.590423],[128.240938,-31.948489],[127.102867,-32.282267],[126.148714,-32.215966],[125.088623,-32.728751],[124.221648,-32.959487],[124.028947,-33.483847],[123.659667,-33.890179],[122.811036,-33.914467],[122.183064,-34.003402],[121.299191,-33.821036],[120.580268,-33.930177],[119.893695,-33.976065],[119.298899,-34.509366],[119.007341,-34.464149],[118.505718,-34.746819],[118.024972,-35.064733],[117.295507,-35.025459],[116.625109,-35.025097],[115.564347,-34.386428],[115.026809,-34.196517],[115.048616,-33.623425],[115.545123,-33.487258],[115.714674,-33.259572],[115.679379,-32.900369],[115.801645,-32.205062],[115.689611,-31.612437],[115.160909,-30.601594],[114.997043,-30.030725],[115.040038,-29.461095],[114.641974,-28.810231],[114.616498,-28.516399],[114.173579,-28.118077],[114.048884,-27.334765],[113.477498,-26.543134],[113.338953,-26.116545],[113.778358,-26.549025],[113.440962,-25.621278],[113.936901,-25.911235],[114.232852,-26.298446],[114.216161,-25.786281],[113.721255,-24.998939],[113.625344,-24.683971],[113.393523,-24.384764],[113.502044,-23.80635],[113.706993,-23.560215],[113.843418,-23.059987],[113.736552,-22.475475],[114.149756,-21.755881],[114.225307,-22.517488],[114.647762,-21.82952],[115.460167,-21.495173],[115.947373,-21.068688],[116.711615,-20.701682],[117.166316,-20.623599],[117.441545,-20.746899],[118.229559,-20.374208],[118.836085,-20.263311],[118.987807,-20.044203],[119.252494,-19.952942],[119.805225,-19.976506],[120.85622,-19.683708],[121.399856,-19.239756],[121.655138,-18.705318],[122.241665,-18.197649],[122.286624,-17.798603],[122.312772,-17.254967],[123.012574,-16.4052],[123.433789,-17.268558],[123.859345,-17.069035],[123.503242,-16.596506],[123.817073,-16.111316],[124.258287,-16.327944],[124.379726,-15.56706],[124.926153,-15.0751],[125.167275,-14.680396],[125.670087,-14.51007],[125.685796,-14.230656],[126.125149,-14.347341],[126.142823,-14.095987],[126.582589,-13.952791],[127.065867,-13.817968],[127.804633,-14.276906],[128.35969,-14.86917],[128.985543,-14.875991],[129.621473,-14.969784],[129.4096,-14.42067],[129.888641,-13.618703],[130.339466,-13.357376],[130.183506,-13.10752],[130.617795,-12.536392],[131.223495,-12.183649],[131.735091,-12.302453],[132.575298,-12.114041],[132.557212,-11.603012],[131.824698,-11.273782],[132.357224,-11.128519],[133.019561,-11.376411],[133.550846,-11.786515],[134.393068,-12.042365],[134.678632,-11.941183],[135.298491,-12.248606],[135.882693,-11.962267],[136.258381,-12.049342],[136.492475,-11.857209],[136.95162,-12.351959],[136.685125,-12.887223],[136.305407,-13.29123],[135.961758,-13.324509],[136.077617,-13.724278],[135.783836,-14.223989],[135.428664,-14.715432],[135.500184,-14.997741],[136.295175,-15.550265],[137.06536,-15.870762],[137.580471,-16.215082],[138.303217,-16.807604],[138.585164,-16.806622],[139.108543,-17.062679],[139.260575,-17.371601],[140.215245,-17.710805],[140.875463,-17.369069],[141.07111,-16.832047],[141.274095,-16.38887],[141.398222,-15.840532],[141.702183,-15.044921],[141.56338,-14.561333],[141.63552,-14.270395],[141.519869,-13.698078],[141.65092,-12.944688],[141.842691,-12.741548],[141.68699,-12.407614],[141.928629,-11.877466],[142.118488,-11.328042],[142.143706,-11.042737],[142.51526,-10.668186],[142.79731,-11.157355],[142.866763,-11.784707],[143.115947,-11.90563],[143.158632,-12.325656],[143.522124,-12.834358],[143.597158,-13.400422],[143.561811,-13.763656]]]]}},{type:"Feature",id:"AUT",properties:{name:"Austria"},geometry:{type:"Polygon",coordinates:[[[16.979667,48.123497],[16.903754,47.714866],[16.340584,47.712902],[16.534268,47.496171],[16.202298,46.852386],[16.011664,46.683611],[15.137092,46.658703],[14.632472,46.431817],[13.806475,46.509306],[12.376485,46.767559],[12.153088,47.115393],[11.164828,46.941579],[11.048556,46.751359],[10.442701,46.893546],[9.932448,46.920728],[9.47997,47.10281],[9.632932,47.347601],[9.594226,47.525058],[9.896068,47.580197],[10.402084,47.302488],[10.544504,47.566399],[11.426414,47.523766],[12.141357,47.703083],[12.62076,47.672388],[12.932627,47.467646],[13.025851,47.637584],[12.884103,48.289146],[13.243357,48.416115],[13.595946,48.877172],[14.338898,48.555305],[14.901447,48.964402],[15.253416,49.039074],[16.029647,48.733899],[16.499283,48.785808],[16.960288,48.596982],[16.879983,48.470013],[16.979667,48.123497]]]}},{type:"Feature",id:"AZE",properties:{name:"Azerbaijan"},geometry:{type:"MultiPolygon",coordinates:[[[[45.001987,39.740004],[45.298145,39.471751],[45.739978,39.473999],[45.735379,39.319719],[46.143623,38.741201],[45.457722,38.874139],[44.952688,39.335765],[44.79399,39.713003],[45.001987,39.740004]]],[[[47.373315,41.219732],[47.815666,41.151416],[47.987283,41.405819],[48.584353,41.80887],[49.110264,41.282287],[49.618915,40.572924],[50.08483,40.526157],[50.392821,40.256561],[49.569202,40.176101],[49.395259,39.399482],[49.223228,39.049219],[48.856532,38.815486],[48.883249,38.320245],[48.634375,38.270378],[48.010744,38.794015],[48.355529,39.288765],[48.060095,39.582235],[47.685079,39.508364],[46.50572,38.770605],[46.483499,39.464155],[46.034534,39.628021],[45.610012,39.899994],[45.891907,40.218476],[45.359175,40.561504],[45.560351,40.81229],[45.179496,40.985354],[44.97248,41.248129],[45.217426,41.411452],[45.962601,41.123873],[46.501637,41.064445],[46.637908,41.181673],[46.145432,41.722802],[46.404951,41.860675],[46.686071,41.827137],[47.373315,41.219732]]]]}},{type:"Feature",id:"BDI",properties:{name:"Burundi"},geometry:{type:"Polygon",coordinates:[[[29.339998,-4.499983],[29.276384,-3.293907],[29.024926,-2.839258],[29.632176,-2.917858],[29.938359,-2.348487],[30.469696,-2.413858],[30.527677,-2.807632],[30.743013,-3.034285],[30.752263,-3.35933],[30.50556,-3.568567],[30.116333,-4.090138],[29.753512,-4.452389],[29.339998,-4.499983]]]}},{type:"Feature",id:"BEL",properties:{name:"Belgium"},geometry:{type:"Polygon",coordinates:[[[3.314971,51.345781],[4.047071,51.267259],[4.973991,51.475024],[5.606976,51.037298],[6.156658,50.803721],[6.043073,50.128052],[5.782417,50.090328],[5.674052,49.529484],[4.799222,49.985373],[4.286023,49.907497],[3.588184,50.378992],[3.123252,50.780363],[2.658422,50.796848],[2.513573,51.148506],[3.314971,51.345781]]]}},{type:"Feature",id:"BEN",properties:{name:"Benin"},geometry:{type:"Polygon",coordinates:[[[2.691702,6.258817],[1.865241,6.142158],[1.618951,6.832038],[1.664478,9.12859],[1.463043,9.334624],[1.425061,9.825395],[1.077795,10.175607],[.772336,10.470808],[.899563,10.997339],[1.24347,11.110511],[1.447178,11.547719],[1.935986,11.64115],[2.154474,11.94015],[2.490164,12.233052],[2.848643,12.235636],[3.61118,11.660167],[3.572216,11.327939],[3.797112,10.734746],[3.60007,10.332186],[3.705438,10.06321],[3.220352,9.444153],[2.912308,9.137608],[2.723793,8.506845],[2.749063,7.870734],[2.691702,6.258817]]]}},{type:"Feature",id:"BFA",properties:{name:"Burkina Faso"},geometry:{type:"Polygon",coordinates:[[[-2.827496,9.642461],[-3.511899,9.900326],[-3.980449,9.862344],[-4.330247,9.610835],[-4.779884,9.821985],[-4.954653,10.152714],[-5.404342,10.370737],[-5.470565,10.95127],[-5.197843,11.375146],[-5.220942,11.713859],[-4.427166,12.542646],[-4.280405,13.228444],[-4.006391,13.472485],[-3.522803,13.337662],[-3.103707,13.541267],[-2.967694,13.79815],[-2.191825,14.246418],[-2.001035,14.559008],[-1.066363,14.973815],[-0.515854,15.116158],[-0.266257,14.924309],[.374892,14.928908],[.295646,14.444235],[.429928,13.988733],[.993046,13.33575],[1.024103,12.851826],[2.177108,12.625018],[2.154474,11.94015],[1.935986,11.64115],[1.447178,11.547719],[1.24347,11.110511],[.899563,10.997339],[.023803,11.018682],[-0.438702,11.098341],[-0.761576,10.93693],[-1.203358,11.009819],[-2.940409,10.96269],[-2.963896,10.395335],[-2.827496,9.642461]]]}},{type:"Feature",id:"BGD",properties:{name:"Bangladesh"},geometry:{type:"Polygon",coordinates:[[[92.672721,22.041239],[92.652257,21.324048],[92.303234,21.475485],[92.368554,20.670883],[92.082886,21.192195],[92.025215,21.70157],[91.834891,22.182936],[91.417087,22.765019],[90.496006,22.805017],[90.586957,22.392794],[90.272971,21.836368],[89.847467,22.039146],[89.70205,21.857116],[89.418863,21.966179],[89.031961,22.055708],[88.876312,22.879146],[88.52977,23.631142],[88.69994,24.233715],[88.084422,24.501657],[88.306373,24.866079],[88.931554,25.238692],[88.209789,25.768066],[88.563049,26.446526],[89.355094,26.014407],[89.832481,25.965082],[89.920693,25.26975],[90.872211,25.132601],[91.799596,25.147432],[92.376202,24.976693],[91.915093,24.130414],[91.46773,24.072639],[91.158963,23.503527],[91.706475,22.985264],[91.869928,23.624346],[92.146035,23.627499],[92.672721,22.041239]]]}},{type:"Feature",id:"BGR",properties:{name:"Bulgaria"},geometry:{type:"Polygon",coordinates:[[[22.65715,44.234923],[22.944832,43.823785],[23.332302,43.897011],[24.100679,43.741051],[25.569272,43.688445],[26.065159,43.943494],[27.2424,44.175986],[27.970107,43.812468],[28.558081,43.707462],[28.039095,43.293172],[27.673898,42.577892],[27.99672,42.007359],[27.135739,42.141485],[26.117042,41.826905],[26.106138,41.328899],[25.197201,41.234486],[24.492645,41.583896],[23.692074,41.309081],[22.952377,41.337994],[22.881374,41.999297],[22.380526,42.32026],[22.545012,42.461362],[22.436595,42.580321],[22.604801,42.898519],[22.986019,43.211161],[22.500157,43.642814],[22.410446,44.008063],[22.65715,44.234923]]]}},{type:"Feature",id:"BHS",properties:{name:"The Bahamas"},geometry:{type:"MultiPolygon",coordinates:[[[[-77.53466,23.75975],[-77.78,23.71],[-78.03405,24.28615],[-78.40848,24.57564],[-78.19087,25.2103],[-77.89,25.17],[-77.54,24.34],[-77.53466,23.75975]]],[[[-77.82,26.58],[-78.91,26.42],[-78.98,26.79],[-78.51,26.87],[-77.85,26.84],[-77.82,26.58]]],[[[-77,26.59],[-77.17255,25.87918],[-77.35641,26.00735],[-77.34,26.53],[-77.78802,26.92516],[-77.79,27.04],[-77,26.59]]]]}},{type:"Feature",id:"BIH",properties:{name:"Bosnia and Herzegovina"},geometry:{type:"Polygon",coordinates:[[[19.005486,44.860234],[19.36803,44.863],[19.11761,44.42307],[19.59976,44.03847],[19.454,43.5681],[19.21852,43.52384],[19.03165,43.43253],[18.70648,43.20011],[18.56,42.65],[17.674922,43.028563],[17.297373,43.446341],[16.916156,43.667722],[16.456443,44.04124],[16.23966,44.351143],[15.750026,44.818712],[15.959367,45.233777],[16.318157,45.004127],[16.534939,45.211608],[17.002146,45.233777],[17.861783,45.06774],[18.553214,45.08159],[19.005486,44.860234]]]}},{type:"Feature",id:"BLR",properties:{name:"Belarus"},geometry:{type:"Polygon",coordinates:[[[23.484128,53.912498],[24.450684,53.905702],[25.536354,54.282423],[25.768433,54.846963],[26.588279,55.167176],[26.494331,55.615107],[27.10246,55.783314],[28.176709,56.16913],[29.229513,55.918344],[29.371572,55.670091],[29.896294,55.789463],[30.873909,55.550976],[30.971836,55.081548],[30.757534,54.811771],[31.384472,54.157056],[31.791424,53.974639],[31.731273,53.794029],[32.405599,53.618045],[32.693643,53.351421],[32.304519,53.132726],[31.497644,53.167427],[31.305201,53.073996],[31.540018,52.742052],[31.785998,52.101678],[30.927549,52.042353],[30.619454,51.822806],[30.555117,51.319503],[30.157364,51.416138],[29.254938,51.368234],[28.992835,51.602044],[28.617613,51.427714],[28.241615,51.572227],[27.454066,51.592303],[26.337959,51.832289],[25.327788,51.910656],[24.553106,51.888461],[24.005078,51.617444],[23.527071,51.578454],[23.508002,52.023647],[23.199494,52.486977],[23.799199,52.691099],[23.804935,53.089731],[23.527536,53.470122],[23.484128,53.912498]]]}},{type:"Feature",id:"BLZ",properties:{name:"Belize"},geometry:{type:"Polygon",coordinates:[[[-89.14308,17.808319],[-89.150909,17.955468],[-89.029857,18.001511],[-88.848344,17.883198],[-88.490123,18.486831],[-88.300031,18.499982],[-88.296336,18.353273],[-88.106813,18.348674],[-88.123479,18.076675],[-88.285355,17.644143],[-88.197867,17.489475],[-88.302641,17.131694],[-88.239518,17.036066],[-88.355428,16.530774],[-88.551825,16.265467],[-88.732434,16.233635],[-88.930613,15.887273],[-89.229122,15.886938],[-89.150806,17.015577],[-89.14308,17.808319]]]}},{type:"Feature",id:"BMU",properties:{name:"Bermuda"},geometry:{type:"Polygon",coordinates:[[[-64.7799734332998,32.3072000581802],[-64.7873319183061,32.3039237143428],[-64.7946942710173,32.3032682700388],[-64.8094297981283,32.3098175728414],[-64.8167896352437,32.3058845718466],[-64.8101968029642,32.3022833180511],[-64.7962291465484,32.2934409732427],[-64.7815086336978,32.2868973114514],[-64.7997025513437,32.2796896417328],[-64.8066707691087,32.2747767569465],[-64.8225587873683,32.2669111289395],[-64.8287548840306,32.2669075473817],[-64.8306732143498,32.2583944840235],[-64.8399924854972,32.254782282336],[-64.8566090462354,32.2547740387514],[-64.8682296789446,32.2616393614322],[-64.8628241459563,32.2724481933959],[-64.8748651338951,32.2757120264753],[-64.8717752856644,32.2819371582026],[-64.8671422127295,32.2930760547989],[-64.8559068764437,32.2960321186471],[-64.8597429072279,32.3015842021933],[-64.8439233486717,32.3140553852543],[-64.8350242329311,32.3242161760006],[-64.8338690593672,32.3294587561557],[-64.8520298651164,32.3110911879954],[-64.8635922932573,32.3048469433363],[-64.8686668994079,32.30910745083],[-64.8721354593415,32.3041908606301],[-64.8779667328485,32.3038632800462],[-64.8780046844321,32.2907757831692],[-64.8849776658292,32.2819261366004],[-64.8783230004629,32.2613001418681],[-64.863194968877,32.2465799485801],[-64.8519819555722,32.2485519134663],[-64.842311980074,32.2492123317296],[-64.8388242605209,32.2475773472534],[-64.8334002575532,32.2462714714698],[-64.8256389530584,32.2472637398594],[-64.8205697556026,32.2531698880328],[-64.8105087275579,32.2561208974156],[-64.7900177727338,32.2659446936992],[-64.7745415970416,32.2718413023427],[-64.7644742436426,32.2855931353214],[-64.7551803442276,32.2908326702531],[-64.7423982971436,32.2996734994024],[-64.7206991797682,32.3137542201258],[-64.7117851247134,32.3176823360806],[-64.6962778813133,32.3275029115532],[-64.6768921127452,32.3324095397555],[-64.6567136927777,32.3451776458469],[-64.6532168823499,32.3494356627941],[-64.6605720384429,32.3589423487763],[-64.65125819471,32.3615600906466],[-64.6462011670816,32.36975169749],[-64.6613227512832,32.3763135008721],[-64.6690666074397,32.388444543924],[-64.6834270548595,32.3854968316788],[-64.6954617672714,32.3763221285869],[-64.70438689565,32.3704254760469],[-64.7117569982798,32.368132600249],[-64.7061764744404,32.3600110593559],[-64.700531552697,32.3590601356818],[-64.6940348033967,32.3640708659835],[-64.6895164826082,32.3633598579866],[-64.6864150099255,32.3547797587266],[-64.6824635995504,32.3540628176846],[-64.6835876652835,32.3626447677968],[-64.6801998697415,32.3631199096979],[-64.6672170444687,32.3597751617473],[-64.6598811264978,32.3497625771755],[-64.6737331235384,32.3390281851635],[-64.6887090648183,32.3342439408053],[-64.706732854446,32.3429010723036],[-64.7149301576112,32.3552188753513],[-64.7185967666669,32.3552239212394],[-64.7214189847314,32.3518830231342],[-64.7270616067222,32.3466461715475],[-64.734962460882,32.3442819830499],[-64.7383521549094,32.3407216514918],[-64.7411729976333,32.3311790864627],[-64.7423019216485,32.323311561213],[-64.7462482354281,32.318538611581],[-64.7566773739613,32.3130509130175],[-64.768738200563,32.3088369816572],[-64.7799734332998,32.3072000581802]]]}},{type:"Feature",id:"BOL",properties:{name:"Bolivia"},geometry:{type:"Polygon",coordinates:[[[-62.846468,-22.034985],[-63.986838,-21.993644],[-64.377021,-22.798091],[-64.964892,-22.075862],[-66.273339,-21.83231],[-67.106674,-22.735925],[-67.82818,-22.872919],[-68.219913,-21.494347],[-68.757167,-20.372658],[-68.442225,-19.405068],[-68.966818,-18.981683],[-69.100247,-18.260125],[-69.590424,-17.580012],[-68.959635,-16.500698],[-69.389764,-15.660129],[-69.160347,-15.323974],[-69.339535,-14.953195],[-68.948887,-14.453639],[-68.929224,-13.602684],[-68.88008,-12.899729],[-68.66508,-12.5613],[-69.529678,-10.951734],[-68.786158,-11.03638],[-68.271254,-11.014521],[-68.048192,-10.712059],[-67.173801,-10.306812],[-66.646908,-9.931331],[-65.338435,-9.761988],[-65.444837,-10.511451],[-65.321899,-10.895872],[-65.402281,-11.56627],[-64.316353,-12.461978],[-63.196499,-12.627033],[-62.80306,-13.000653],[-62.127081,-13.198781],[-61.713204,-13.489202],[-61.084121,-13.479384],[-60.503304,-13.775955],[-60.459198,-14.354007],[-60.264326,-14.645979],[-60.251149,-15.077219],[-60.542966,-15.09391],[-60.15839,-16.258284],[-58.24122,-16.299573],[-58.388058,-16.877109],[-58.280804,-17.27171],[-57.734558,-17.552468],[-57.498371,-18.174188],[-57.676009,-18.96184],[-57.949997,-19.400004],[-57.853802,-19.969995],[-58.166392,-20.176701],[-58.183471,-19.868399],[-59.115042,-19.356906],[-60.043565,-19.342747],[-61.786326,-19.633737],[-62.265961,-20.513735],[-62.291179,-21.051635],[-62.685057,-22.249029],[-62.846468,-22.034985]]]}},{type:"Feature",id:"BRA",properties:{name:"Brazil"},geometry:{type:"Polygon",coordinates:[[[-57.625133,-30.216295],[-56.2909,-28.852761],[-55.162286,-27.881915],[-54.490725,-27.474757],[-53.648735,-26.923473],[-53.628349,-26.124865],[-54.13005,-25.547639],[-54.625291,-25.739255],[-54.428946,-25.162185],[-54.293476,-24.5708],[-54.29296,-24.021014],[-54.652834,-23.839578],[-55.027902,-24.001274],[-55.400747,-23.956935],[-55.517639,-23.571998],[-55.610683,-22.655619],[-55.797958,-22.35693],[-56.473317,-22.0863],[-56.88151,-22.282154],[-57.937156,-22.090176],[-57.870674,-20.732688],[-58.166392,-20.176701],[-57.853802,-19.969995],[-57.949997,-19.400004],[-57.676009,-18.96184],[-57.498371,-18.174188],[-57.734558,-17.552468],[-58.280804,-17.27171],[-58.388058,-16.877109],[-58.24122,-16.299573],[-60.15839,-16.258284],[-60.542966,-15.09391],[-60.251149,-15.077219],[-60.264326,-14.645979],[-60.459198,-14.354007],[-60.503304,-13.775955],[-61.084121,-13.479384],[-61.713204,-13.489202],[-62.127081,-13.198781],[-62.80306,-13.000653],[-63.196499,-12.627033],[-64.316353,-12.461978],[-65.402281,-11.56627],[-65.321899,-10.895872],[-65.444837,-10.511451],[-65.338435,-9.761988],[-66.646908,-9.931331],[-67.173801,-10.306812],[-68.048192,-10.712059],[-68.271254,-11.014521],[-68.786158,-11.03638],[-69.529678,-10.951734],[-70.093752,-11.123972],[-70.548686,-11.009147],[-70.481894,-9.490118],[-71.302412,-10.079436],[-72.184891,-10.053598],[-72.563033,-9.520194],[-73.226713,-9.462213],[-73.015383,-9.032833],[-73.571059,-8.424447],[-73.987235,-7.52383],[-73.723401,-7.340999],[-73.724487,-6.918595],[-73.120027,-6.629931],[-73.219711,-6.089189],[-72.964507,-5.741251],[-72.891928,-5.274561],[-71.748406,-4.593983],[-70.928843,-4.401591],[-70.794769,-4.251265],[-69.893635,-4.298187],[-69.444102,-1.556287],[-69.420486,-1.122619],[-69.577065,-0.549992],[-70.020656,-0.185156],[-70.015566,.541414],[-69.452396,.706159],[-69.252434,.602651],[-69.218638,.985677],[-69.804597,1.089081],[-69.816973,1.714805],[-67.868565,1.692455],[-67.53781,2.037163],[-67.259998,1.719999],[-67.065048,1.130112],[-66.876326,1.253361],[-66.325765,.724452],[-65.548267,.789254],[-65.354713,1.095282],[-64.611012,1.328731],[-64.199306,1.492855],[-64.083085,1.916369],[-63.368788,2.2009],[-63.422867,2.411068],[-64.269999,2.497006],[-64.408828,3.126786],[-64.368494,3.79721],[-64.816064,4.056445],[-64.628659,4.148481],[-63.888343,4.02053],[-63.093198,3.770571],[-62.804533,4.006965],[-62.08543,4.162124],[-60.966893,4.536468],[-60.601179,4.918098],[-60.733574,5.200277],[-60.213683,5.244486],[-59.980959,5.014061],[-60.111002,4.574967],[-59.767406,4.423503],[-59.53804,3.958803],[-59.815413,3.606499],[-59.974525,2.755233],[-59.718546,2.24963],[-59.646044,1.786894],[-59.030862,1.317698],[-58.540013,1.268088],[-58.429477,1.463942],[-58.11345,1.507195],[-57.660971,1.682585],[-57.335823,1.948538],[-56.782704,1.863711],[-56.539386,1.899523],[-55.995698,1.817667],[-55.9056,2.021996],[-56.073342,2.220795],[-55.973322,2.510364],[-55.569755,2.421506],[-55.097587,2.523748],[-54.524754,2.311849],[-54.088063,2.105557],[-53.778521,2.376703],[-53.554839,2.334897],[-53.418465,2.053389],[-52.939657,2.124858],[-52.556425,2.504705],[-52.249338,3.241094],[-51.657797,4.156232],[-51.317146,4.203491],[-51.069771,3.650398],[-50.508875,1.901564],[-49.974076,1.736483],[-49.947101,1.04619],[-50.699251,.222984],[-50.388211,-0.078445],[-48.620567,-0.235489],[-48.584497,-1.237805],[-47.824956,-0.581618],[-46.566584,-0.941028],[-44.905703,-1.55174],[-44.417619,-2.13775],[-44.581589,-2.691308],[-43.418791,-2.38311],[-41.472657,-2.912018],[-39.978665,-2.873054],[-38.500383,-3.700652],[-37.223252,-4.820946],[-36.452937,-5.109404],[-35.597796,-5.149504],[-35.235389,-5.464937],[-34.89603,-6.738193],[-34.729993,-7.343221],[-35.128212,-8.996401],[-35.636967,-9.649282],[-37.046519,-11.040721],[-37.683612,-12.171195],[-38.423877,-13.038119],[-38.673887,-13.057652],[-38.953276,-13.79337],[-38.882298,-15.667054],[-39.161092,-17.208407],[-39.267339,-17.867746],[-39.583521,-18.262296],[-39.760823,-19.599113],[-40.774741,-20.904512],[-40.944756,-21.937317],[-41.754164,-22.370676],[-41.988284,-22.97007],[-43.074704,-22.967693],[-44.647812,-23.351959],[-45.352136,-23.796842],[-46.472093,-24.088969],[-47.648972,-24.885199],[-48.495458,-25.877025],[-48.641005,-26.623698],[-48.474736,-27.175912],[-48.66152,-28.186135],[-48.888457,-28.674115],[-49.587329,-29.224469],[-50.696874,-30.984465],[-51.576226,-31.777698],[-52.256081,-32.24537],[-52.7121,-33.196578],[-53.373662,-33.768378],[-53.650544,-33.202004],[-53.209589,-32.727666],[-53.787952,-32.047243],[-54.572452,-31.494511],[-55.60151,-30.853879],[-55.973245,-30.883076],[-56.976026,-30.109686],[-57.625133,-30.216295]]]}},{type:"Feature",id:"BRN",properties:{name:"Brunei"},geometry:{type:"Polygon",coordinates:[[[114.204017,4.525874],[114.599961,4.900011],[115.45071,5.44773],[115.4057,4.955228],[115.347461,4.316636],[114.869557,4.348314],[114.659596,4.007637],[114.204017,4.525874]]]}},{type:"Feature",id:"BTN",properties:{name:"Bhutan"},geometry:{type:"Polygon",coordinates:[[[91.696657,27.771742],[92.103712,27.452614],[92.033484,26.83831],[91.217513,26.808648],[90.373275,26.875724],[89.744528,26.719403],[88.835643,27.098966],[88.814248,27.299316],[89.47581,28.042759],[90.015829,28.296439],[90.730514,28.064954],[91.258854,28.040614],[91.696657,27.771742]]]}},{type:"Feature",id:"BWA",properties:{name:"Botswana"},geometry:{type:"Polygon",coordinates:[[[25.649163,-18.536026],[25.850391,-18.714413],[26.164791,-19.293086],[27.296505,-20.39152],[27.724747,-20.499059],[27.727228,-20.851802],[28.02137,-21.485975],[28.794656,-21.639454],[29.432188,-22.091313],[28.017236,-22.827754],[27.11941,-23.574323],[26.786407,-24.240691],[26.485753,-24.616327],[25.941652,-24.696373],[25.765849,-25.174845],[25.664666,-25.486816],[25.025171,-25.71967],[24.211267,-25.670216],[23.73357,-25.390129],[23.312097,-25.26869],[22.824271,-25.500459],[22.579532,-25.979448],[22.105969,-26.280256],[21.605896,-26.726534],[20.889609,-26.828543],[20.66647,-26.477453],[20.758609,-25.868136],[20.165726,-24.917962],[19.895768,-24.76779],[19.895458,-21.849157],[20.881134,-21.814327],[20.910641,-18.252219],[21.65504,-18.219146],[23.196858,-17.869038],[23.579006,-18.281261],[24.217365,-17.889347],[24.520705,-17.887125],[25.084443,-17.661816],[25.264226,-17.73654],[25.649163,-18.536026]]]}},{type:"Feature",id:"CAF",properties:{name:"Central African Republic"},geometry:{type:"Polygon",coordinates:[[[15.27946,7.421925],[16.106232,7.497088],[16.290562,7.754307],[16.456185,7.734774],[16.705988,7.508328],[17.96493,7.890914],[18.389555,8.281304],[18.911022,8.630895],[18.81201,8.982915],[19.094008,9.074847],[20.059685,9.012706],[21.000868,9.475985],[21.723822,10.567056],[22.231129,10.971889],[22.864165,11.142395],[22.977544,10.714463],[23.554304,10.089255],[23.55725,9.681218],[23.394779,9.265068],[23.459013,8.954286],[23.805813,8.666319],[24.567369,8.229188],[25.114932,7.825104],[25.124131,7.500085],[25.796648,6.979316],[26.213418,6.546603],[26.465909,5.946717],[27.213409,5.550953],[27.374226,5.233944],[27.044065,5.127853],[26.402761,5.150875],[25.650455,5.256088],[25.278798,5.170408],[25.128833,4.927245],[24.805029,4.897247],[24.410531,5.108784],[23.297214,4.609693],[22.84148,4.710126],[22.704124,4.633051],[22.405124,4.02916],[21.659123,4.224342],[20.927591,4.322786],[20.290679,4.691678],[19.467784,5.031528],[18.932312,4.709506],[18.542982,4.201785],[18.453065,3.504386],[17.8099,3.560196],[17.133042,3.728197],[16.537058,3.198255],[16.012852,2.26764],[15.907381,2.557389],[15.862732,3.013537],[15.405396,3.335301],[15.03622,3.851367],[14.950953,4.210389],[14.478372,4.732605],[14.558936,5.030598],[14.459407,5.451761],[14.53656,6.226959],[14.776545,6.408498],[15.27946,7.421925]]]}},{type:"Feature",id:"CAN",properties:{name:"Canada"},geometry:{type:"MultiPolygon",coordinates:[[[[-63.6645,46.55001],[-62.9393,46.41587],[-62.01208,46.44314],[-62.50391,46.03339],[-62.87433,45.96818],[-64.1428,46.39265],[-64.39261,46.72747],[-64.01486,47.03601],[-63.6645,46.55001]]],[[[-61.806305,49.10506],[-62.29318,49.08717],[-63.58926,49.40069],[-64.51912,49.87304],[-64.17322,49.95718],[-62.85829,49.70641],[-61.835585,49.28855],[-61.806305,49.10506]]],[[[-123.510002,48.510011],[-124.012891,48.370846],[-125.655013,48.825005],[-125.954994,49.179996],[-126.850004,49.53],[-127.029993,49.814996],[-128.059336,49.994959],[-128.444584,50.539138],[-128.358414,50.770648],[-127.308581,50.552574],[-126.695001,50.400903],[-125.755007,50.295018],[-125.415002,49.950001],[-124.920768,49.475275],[-123.922509,49.062484],[-123.510002,48.510011]]],[[[-56.134036,50.68701],[-56.795882,49.812309],[-56.143105,50.150117],[-55.471492,49.935815],[-55.822401,49.587129],[-54.935143,49.313011],[-54.473775,49.556691],[-53.476549,49.249139],[-53.786014,48.516781],[-53.086134,48.687804],[-52.958648,48.157164],[-52.648099,47.535548],[-53.069158,46.655499],[-53.521456,46.618292],[-54.178936,46.807066],[-53.961869,47.625207],[-54.240482,47.752279],[-55.400773,46.884994],[-55.997481,46.91972],[-55.291219,47.389562],[-56.250799,47.632545],[-57.325229,47.572807],[-59.266015,47.603348],[-59.419494,47.899454],[-58.796586,48.251525],[-59.231625,48.523188],[-58.391805,49.125581],[-57.35869,50.718274],[-56.73865,51.287438],[-55.870977,51.632094],[-55.406974,51.588273],[-55.600218,51.317075],[-56.134036,50.68701]]],[[[-132.710008,54.040009],[-132.710009,54.040009],[-132.710008,54.040009],[-132.710008,54.040009],[-131.74999,54.120004],[-132.04948,52.984621],[-131.179043,52.180433],[-131.57783,52.182371],[-132.180428,52.639707],[-132.549992,53.100015],[-133.054611,53.411469],[-133.239664,53.85108],[-133.180004,54.169975],[-132.710008,54.040009]]],[[[-79.26582,62.158675],[-79.65752,61.63308],[-80.09956,61.7181],[-80.36215,62.01649],[-80.315395,62.085565],[-79.92939,62.3856],[-79.52002,62.36371],[-79.26582,62.158675]]],[[[-81.89825,62.7108],[-83.06857,62.15922],[-83.77462,62.18231],[-83.99367,62.4528],[-83.25048,62.91409],[-81.87699,62.90458],[-81.89825,62.7108]]],[[[-85.161308,65.657285],[-84.975764,65.217518],[-84.464012,65.371772],[-83.882626,65.109618],[-82.787577,64.766693],[-81.642014,64.455136],[-81.55344,63.979609],[-80.817361,64.057486],[-80.103451,63.725981],[-80.99102,63.411246],[-82.547178,63.651722],[-83.108798,64.101876],[-84.100417,63.569712],[-85.523405,63.052379],[-85.866769,63.637253],[-87.221983,63.541238],[-86.35276,64.035833],[-86.224886,64.822917],[-85.883848,65.738778],[-85.161308,65.657285]]],[[[-75.86588,67.14886],[-76.98687,67.09873],[-77.2364,67.58809],[-76.81166,68.14856],[-75.89521,68.28721],[-75.1145,68.01036],[-75.10333,67.58202],[-75.21597,67.44425],[-75.86588,67.14886]]],[[[-95.647681,69.10769],[-96.269521,68.75704],[-97.617401,69.06003],[-98.431801,68.9507],[-99.797401,69.40003],[-98.917401,69.71003],[-98.218261,70.14354],[-97.157401,69.86003],[-96.557401,69.68003],[-96.257401,69.49003],[-95.647681,69.10769]]],[[[-90.5471,69.49766],[-90.55151,68.47499],[-89.21515,69.25873],[-88.01966,68.61508],[-88.31749,67.87338],[-87.35017,67.19872],[-86.30607,67.92146],[-85.57664,68.78456],[-85.52197,69.88211],[-84.10081,69.80539],[-82.62258,69.65826],[-81.28043,69.16202],[-81.2202,68.66567],[-81.96436,68.13253],[-81.25928,67.59716],[-81.38653,67.11078],[-83.34456,66.41154],[-84.73542,66.2573],[-85.76943,66.55833],[-86.0676,66.05625],[-87.03143,65.21297],[-87.32324,64.77563],[-88.48296,64.09897],[-89.91444,64.03273],[-90.70398,63.61017],[-90.77004,62.96021],[-91.93342,62.83508],[-93.15698,62.02469],[-94.24153,60.89865],[-94.62931,60.11021],[-94.6846,58.94882],[-93.21502,58.78212],[-92.76462,57.84571],[-92.29703,57.08709],[-90.89769,57.28468],[-89.03953,56.85172],[-88.03978,56.47162],[-87.32421,55.99914],[-86.07121,55.72383],[-85.01181,55.3026],[-83.36055,55.24489],[-82.27285,55.14832],[-82.4362,54.28227],[-82.12502,53.27703],[-81.40075,52.15788],[-79.91289,51.20842],[-79.14301,51.53393],[-78.60191,52.56208],[-79.12421,54.14145],[-79.82958,54.66772],[-78.22874,55.13645],[-77.0956,55.83741],[-76.54137,56.53423],[-76.62319,57.20263],[-77.30226,58.05209],[-78.51688,58.80458],[-77.33676,59.85261],[-77.77272,60.75788],[-78.10687,62.31964],[-77.41067,62.55053],[-75.69621,62.2784],[-74.6682,62.18111],[-73.83988,62.4438],[-72.90853,62.10507],[-71.67708,61.52535],[-71.37369,61.13717],[-69.59042,61.06141],[-69.62033,60.22125],[-69.2879,58.95736],[-68.37455,58.80106],[-67.64976,58.21206],[-66.20178,58.76731],[-65.24517,59.87071],[-64.58352,60.33558],[-63.80475,59.4426],[-62.50236,58.16708],[-61.39655,56.96745],[-61.79866,56.33945],[-60.46853,55.77548],[-59.56962,55.20407],[-57.97508,54.94549],[-57.3332,54.6265],[-56.93689,53.78032],[-56.15811,53.64749],[-55.75632,53.27036],[-55.68338,52.14664],[-56.40916,51.7707],[-57.12691,51.41972],[-58.77482,51.0643],[-60.03309,50.24277],[-61.72366,50.08046],[-63.86251,50.29099],[-65.36331,50.2982],[-66.39905,50.22897],[-67.23631,49.51156],[-68.51114,49.06836],[-69.95362,47.74488],[-71.10458,46.82171],[-70.25522,46.98606],[-68.65,48.3],[-66.55243,49.1331],[-65.05626,49.23278],[-64.17099,48.74248],[-65.11545,48.07085],[-64.79854,46.99297],[-64.47219,46.23849],[-63.17329,45.73902],[-61.52072,45.88377],[-60.51815,47.00793],[-60.4486,46.28264],[-59.80287,45.9204],[-61.03988,45.26525],[-63.25471,44.67014],[-64.24656,44.26553],[-65.36406,43.54523],[-66.1234,43.61867],[-66.16173,44.46512],[-64.42549,45.29204],[-66.02605,45.25931],[-67.13741,45.13753],[-67.79134,45.70281],[-67.79046,47.06636],[-68.23444,47.35486],[-68.905,47.185],[-69.237216,47.447781],[-69.99997,46.69307],[-70.305,45.915],[-70.66,45.46],[-71.08482,45.30524],[-71.405,45.255],[-71.50506,45.0082],[-73.34783,45.00738],[-74.867,45.00048],[-75.31821,44.81645],[-76.375,44.09631],[-76.5,44.018459],[-76.820034,43.628784],[-77.737885,43.629056],[-78.72028,43.625089],[-79.171674,43.466339],[-79.01,43.27],[-78.92,42.965],[-78.939362,42.863611],[-80.247448,42.3662],[-81.277747,42.209026],[-82.439278,41.675105],[-82.690089,41.675105],[-83.02981,41.832796],[-83.142,41.975681],[-83.12,42.08],[-82.9,42.43],[-82.43,42.98],[-82.137642,43.571088],[-82.337763,44.44],[-82.550925,45.347517],[-83.592851,45.816894],[-83.469551,45.994686],[-83.616131,46.116927],[-83.890765,46.116927],[-84.091851,46.275419],[-84.14212,46.512226],[-84.3367,46.40877],[-84.6049,46.4396],[-84.543749,46.538684],[-84.779238,46.637102],[-84.87608,46.900083],[-85.652363,47.220219],[-86.461991,47.553338],[-87.439793,47.94],[-88.378114,48.302918],[-89.272917,48.019808],[-89.6,48.01],[-90.83,48.27],[-91.64,48.14],[-92.61,48.45],[-93.63087,48.60926],[-94.32914,48.67074],[-94.64,48.84],[-94.81758,49.38905],[-95.15609,49.38425],[-95.15907,49],[-97.22872,49.0007],[-100.65,49],[-104.04826,48.99986],[-107.05,49],[-110.05,49],[-113,49],[-116.04818,49],[-117.03121,49],[-120,49],[-122.84,49],[-122.97421,49.002538],[-124.91024,49.98456],[-125.62461,50.41656],[-127.43561,50.83061],[-127.99276,51.71583],[-127.85032,52.32961],[-129.12979,52.75538],[-129.30523,53.56159],[-130.51497,54.28757],[-130.53611,54.80278],[-129.98,55.285],[-130.00778,55.91583],[-131.70781,56.55212],[-132.73042,57.69289],[-133.35556,58.41028],[-134.27111,58.86111],[-134.945,59.27056],[-135.47583,59.78778],[-136.47972,59.46389],[-137.4525,58.905],[-138.34089,59.56211],[-139.039,60],[-140.013,60.27682],[-140.99778,60.30639],[-140.9925,66.00003],[-140.986,69.712],[-139.12052,69.47102],[-137.54636,68.99002],[-136.50358,68.89804],[-135.62576,69.31512],[-134.41464,69.62743],[-132.92925,69.50534],[-131.43136,69.94451],[-129.79471,70.19369],[-129.10773,69.77927],[-128.36156,70.01286],[-128.13817,70.48384],[-127.44712,70.37721],[-125.75632,69.48058],[-124.42483,70.1584],[-124.28968,69.39969],[-123.06108,69.56372],[-122.6835,69.85553],[-121.47226,69.79778],[-119.94288,69.37786],[-117.60268,69.01128],[-116.22643,68.84151],[-115.2469,68.90591],[-113.89794,68.3989],[-115.30489,67.90261],[-113.49727,67.68815],[-110.798,67.80612],[-109.94619,67.98104],[-108.8802,67.38144],[-107.79239,67.88736],[-108.81299,68.31164],[-108.16721,68.65392],[-106.95,68.7],[-106.15,68.8],[-105.34282,68.56122],[-104.33791,68.018],[-103.22115,68.09775],[-101.45433,67.64689],[-99.90195,67.80566],[-98.4432,67.78165],[-98.5586,68.40394],[-97.66948,68.57864],[-96.11991,68.23939],[-96.12588,67.29338],[-95.48943,68.0907],[-94.685,68.06383],[-94.23282,69.06903],[-95.30408,69.68571],[-96.47131,70.08976],[-96.39115,71.19482],[-95.2088,71.92053],[-93.88997,71.76015],[-92.87818,71.31869],[-91.51964,70.19129],[-92.40692,69.69997],[-90.5471,69.49766]]],[[[-114.16717,73.12145],[-114.66634,72.65277],[-112.44102,72.9554],[-111.05039,72.4504],[-109.92035,72.96113],[-109.00654,72.63335],[-108.18835,71.65089],[-107.68599,72.06548],[-108.39639,73.08953],[-107.51645,73.23598],[-106.52259,73.07601],[-105.40246,72.67259],[-104.77484,71.6984],[-104.46476,70.99297],[-102.78537,70.49776],[-100.98078,70.02432],[-101.08929,69.58447],[-102.73116,69.50402],[-102.09329,69.11962],[-102.43024,68.75282],[-104.24,68.91],[-105.96,69.18],[-107.12254,69.11922],[-109,68.78],[-111.534149,68.630059],[-113.3132,68.53554],[-113.85496,69.00744],[-115.22,69.28],[-116.10794,69.16821],[-117.34,69.96],[-116.67473,70.06655],[-115.13112,70.2373],[-113.72141,70.19237],[-112.4161,70.36638],[-114.35,70.6],[-116.48684,70.52045],[-117.9048,70.54056],[-118.43238,70.9092],[-116.11311,71.30918],[-117.65568,71.2952],[-119.40199,71.55859],[-118.56267,72.30785],[-117.86642,72.70594],[-115.18909,73.31459],[-114.16717,73.12145]]],[[[-104.5,73.42],[-105.38,72.76],[-106.94,73.46],[-106.6,73.6],[-105.26,73.64],[-104.5,73.42]]],[[[-76.34,73.102685],[-76.251404,72.826385],[-77.314438,72.855545],[-78.39167,72.876656],[-79.486252,72.742203],[-79.775833,72.802902],[-80.876099,73.333183],[-80.833885,73.693184],[-80.353058,73.75972],[-78.064438,73.651932],[-76.34,73.102685]]],[[[-86.562179,73.157447],[-85.774371,72.534126],[-84.850112,73.340278],[-82.31559,73.750951],[-80.600088,72.716544],[-80.748942,72.061907],[-78.770639,72.352173],[-77.824624,72.749617],[-75.605845,72.243678],[-74.228616,71.767144],[-74.099141,71.33084],[-72.242226,71.556925],[-71.200015,70.920013],[-68.786054,70.525024],[-67.91497,70.121948],[-66.969033,69.186087],[-68.805123,68.720198],[-66.449866,68.067163],[-64.862314,67.847539],[-63.424934,66.928473],[-61.851981,66.862121],[-62.163177,66.160251],[-63.918444,64.998669],[-65.14886,65.426033],[-66.721219,66.388041],[-68.015016,66.262726],[-68.141287,65.689789],[-67.089646,65.108455],[-65.73208,64.648406],[-65.320168,64.382737],[-64.669406,63.392927],[-65.013804,62.674185],[-66.275045,62.945099],[-68.783186,63.74567],[-67.369681,62.883966],[-66.328297,62.280075],[-66.165568,61.930897],[-68.877367,62.330149],[-71.023437,62.910708],[-72.235379,63.397836],[-71.886278,63.679989],[-73.378306,64.193963],[-74.834419,64.679076],[-74.818503,64.389093],[-77.70998,64.229542],[-78.555949,64.572906],[-77.897281,65.309192],[-76.018274,65.326969],[-73.959795,65.454765],[-74.293883,65.811771],[-73.944912,66.310578],[-72.651167,67.284576],[-72.92606,67.726926],[-73.311618,68.069437],[-74.843307,68.554627],[-76.869101,68.894736],[-76.228649,69.147769],[-77.28737,69.76954],[-78.168634,69.826488],[-78.957242,70.16688],[-79.492455,69.871808],[-81.305471,69.743185],[-84.944706,69.966634],[-87.060003,70.260001],[-88.681713,70.410741],[-89.51342,70.762038],[-88.467721,71.218186],[-89.888151,71.222552],[-90.20516,72.235074],[-89.436577,73.129464],[-88.408242,73.537889],[-85.826151,73.803816],[-86.562179,73.157447]]],[[[-100.35642,73.84389],[-99.16387,73.63339],[-97.38,73.76],[-97.12,73.47],[-98.05359,72.99052],[-96.54,72.56],[-96.72,71.66],[-98.35966,71.27285],[-99.32286,71.35639],[-100.01482,71.73827],[-102.5,72.51],[-102.48,72.83],[-100.43836,72.70588],[-101.54,73.36],[-100.35642,73.84389]]],[[[-93.196296,72.771992],[-94.269047,72.024596],[-95.409856,72.061881],[-96.033745,72.940277],[-96.018268,73.43743],[-95.495793,73.862417],[-94.503658,74.134907],[-92.420012,74.100025],[-90.509793,73.856732],[-92.003965,72.966244],[-93.196296,72.771992]]],[[[-120.46,71.383602],[-123.09219,70.90164],[-123.62,71.34],[-125.928949,71.868688],[-125.5,72.292261],[-124.80729,73.02256],[-123.94,73.68],[-124.91775,74.29275],[-121.53788,74.44893],[-120.10978,74.24135],[-117.55564,74.18577],[-116.58442,73.89607],[-115.51081,73.47519],[-116.76794,73.22292],[-119.22,72.52],[-120.46,71.82],[-120.46,71.383602]]],[[[-93.612756,74.979997],[-94.156909,74.592347],[-95.608681,74.666864],[-96.820932,74.927623],[-96.288587,75.377828],[-94.85082,75.647218],[-93.977747,75.29649],[-93.612756,74.979997]]],[[[-98.5,76.72],[-97.735585,76.25656],[-97.704415,75.74344],[-98.16,75],[-99.80874,74.89744],[-100.88366,75.05736],[-100.86292,75.64075],[-102.50209,75.5638],[-102.56552,76.3366],[-101.48973,76.30537],[-99.98349,76.64634],[-98.57699,76.58859],[-98.5,76.72]]],[[[-108.21141,76.20168],[-107.81943,75.84552],[-106.92893,76.01282],[-105.881,75.9694],[-105.70498,75.47951],[-106.31347,75.00527],[-109.7,74.85],[-112.22307,74.41696],[-113.74381,74.39427],[-113.87135,74.72029],[-111.79421,75.1625],[-116.31221,75.04343],[-117.7104,75.2222],[-116.34602,76.19903],[-115.40487,76.47887],[-112.59056,76.14134],[-110.81422,75.54919],[-109.0671,75.47321],[-110.49726,76.42982],[-109.5811,76.79417],[-108.54859,76.67832],[-108.21141,76.20168]]],[[[-94.684086,77.097878],[-93.573921,76.776296],[-91.605023,76.778518],[-90.741846,76.449597],[-90.969661,76.074013],[-89.822238,75.847774],[-89.187083,75.610166],[-87.838276,75.566189],[-86.379192,75.482421],[-84.789625,75.699204],[-82.753445,75.784315],[-81.128531,75.713983],[-80.057511,75.336849],[-79.833933,74.923127],[-80.457771,74.657304],[-81.948843,74.442459],[-83.228894,74.564028],[-86.097452,74.410032],[-88.15035,74.392307],[-89.764722,74.515555],[-92.422441,74.837758],[-92.768285,75.38682],[-92.889906,75.882655],[-93.893824,76.319244],[-95.962457,76.441381],[-97.121379,76.751078],[-96.745123,77.161389],[-94.684086,77.097878]]],[[[-116.198587,77.645287],[-116.335813,76.876962],[-117.106051,76.530032],[-118.040412,76.481172],[-119.899318,76.053213],[-121.499995,75.900019],[-122.854924,76.116543],[-122.854925,76.116543],[-121.157535,76.864508],[-119.103939,77.51222],[-117.570131,77.498319],[-116.198587,77.645287]]],[[[-93.840003,77.519997],[-94.295608,77.491343],[-96.169654,77.555111],[-96.436304,77.834629],[-94.422577,77.820005],[-93.720656,77.634331],[-93.840003,77.519997]]],[[[-110.186938,77.697015],[-112.051191,77.409229],[-113.534279,77.732207],[-112.724587,78.05105],[-111.264443,78.152956],[-109.854452,77.996325],[-110.186938,77.697015]]],[[[-109.663146,78.601973],[-110.881314,78.40692],[-112.542091,78.407902],[-112.525891,78.550555],[-111.50001,78.849994],[-110.963661,78.804441],[-109.663146,78.601973]]],[[[-95.830295,78.056941],[-97.309843,77.850597],[-98.124289,78.082857],[-98.552868,78.458105],[-98.631984,78.87193],[-97.337231,78.831984],[-96.754399,78.765813],[-95.559278,78.418315],[-95.830295,78.056941]]],[[[-100.060192,78.324754],[-99.670939,77.907545],[-101.30394,78.018985],[-102.949809,78.343229],[-105.176133,78.380332],[-104.210429,78.67742],[-105.41958,78.918336],[-105.492289,79.301594],[-103.529282,79.165349],[-100.825158,78.800462],[-100.060192,78.324754]]],[[[-87.02,79.66],[-85.81435,79.3369],[-87.18756,79.0393],[-89.03535,78.28723],[-90.80436,78.21533],[-92.87669,78.34333],[-93.95116,78.75099],[-93.93574,79.11373],[-93.14524,79.3801],[-94.974,79.37248],[-96.07614,79.70502],[-96.70972,80.15777],[-96.01644,80.60233],[-95.32345,80.90729],[-94.29843,80.97727],[-94.73542,81.20646],[-92.40984,81.25739],[-91.13289,80.72345],[-89.45,80.509322],[-87.81,80.32],[-87.02,79.66]]],[[[-68.5,83.106322],[-65.82735,83.02801],[-63.68,82.9],[-61.85,82.6286],[-61.89388,82.36165],[-64.334,81.92775],[-66.75342,81.72527],[-67.65755,81.50141],[-65.48031,81.50657],[-67.84,80.9],[-69.4697,80.61683],[-71.18,79.8],[-73.2428,79.63415],[-73.88,79.430162],[-76.90773,79.32309],[-75.52924,79.19766],[-76.22046,79.01907],[-75.39345,78.52581],[-76.34354,78.18296],[-77.88851,77.89991],[-78.36269,77.50859],[-79.75951,77.20968],[-79.61965,76.98336],[-77.91089,77.022045],[-77.88911,76.777955],[-80.56125,76.17812],[-83.17439,76.45403],[-86.11184,76.29901],[-87.6,76.42],[-89.49068,76.47239],[-89.6161,76.95213],[-87.76739,77.17833],[-88.26,77.9],[-87.65,77.970222],[-84.97634,77.53873],[-86.34,78.18],[-87.96192,78.37181],[-87.15198,78.75867],[-85.37868,78.9969],[-85.09495,79.34543],[-86.50734,79.73624],[-86.93179,80.25145],[-84.19844,80.20836],[-83.408696,80.1],[-81.84823,80.46442],[-84.1,80.58],[-87.59895,80.51627],[-89.36663,80.85569],[-90.2,81.26],[-91.36786,81.5531],[-91.58702,81.89429],[-90.1,82.085],[-88.93227,82.11751],[-86.97024,82.27961],[-85.5,82.652273],[-84.260005,82.6],[-83.18,82.32],[-82.42,82.86],[-81.1,83.02],[-79.30664,83.13056],[-76.25,83.172059],[-75.71878,83.06404],[-72.83153,83.23324],[-70.665765,83.169781],[-68.5,83.106322]]]]}},{type:"Feature",id:"CHE",properties:{name:"Switzerland"},geometry:{type:"Polygon",coordinates:[[[9.594226,47.525058],[9.632932,47.347601],[9.47997,47.10281],[9.932448,46.920728],[10.442701,46.893546],[10.363378,46.483571],[9.922837,46.314899],[9.182882,46.440215],[8.966306,46.036932],[8.489952,46.005151],[8.31663,46.163642],[7.755992,45.82449],[7.273851,45.776948],[6.843593,45.991147],[6.5001,46.429673],[6.022609,46.27299],[6.037389,46.725779],[6.768714,47.287708],[6.736571,47.541801],[7.192202,47.449766],[7.466759,47.620582],[8.317301,47.61358],[8.522612,47.830828],[9.594226,47.525058]]]}},{type:"Feature",id:"CHL",properties:{name:"Chile"},geometry:{type:"MultiPolygon",coordinates:[[[[-68.63401,-52.63637],[-68.63335,-54.8695],[-67.56244,-54.87001],[-66.95992,-54.89681],[-67.29103,-55.30124],[-68.14863,-55.61183],[-68.639991,-55.580018],[-69.2321,-55.49906],[-69.95809,-55.19843],[-71.00568,-55.05383],[-72.2639,-54.49514],[-73.2852,-53.95752],[-74.66253,-52.83749],[-73.8381,-53.04743],[-72.43418,-53.7154],[-71.10773,-54.07433],[-70.59178,-53.61583],[-70.26748,-52.93123],[-69.34565,-52.5183],[-68.63401,-52.63637]]],[[[-68.219913,-21.494347],[-67.82818,-22.872919],[-67.106674,-22.735925],[-66.985234,-22.986349],[-67.328443,-24.025303],[-68.417653,-24.518555],[-68.386001,-26.185016],[-68.5948,-26.506909],[-68.295542,-26.89934],[-69.001235,-27.521214],[-69.65613,-28.459141],[-70.01355,-29.367923],[-69.919008,-30.336339],[-70.535069,-31.36501],[-70.074399,-33.09121],[-69.814777,-33.273886],[-69.817309,-34.193571],[-70.388049,-35.169688],[-70.364769,-36.005089],[-71.121881,-36.658124],[-71.118625,-37.576827],[-70.814664,-38.552995],[-71.413517,-38.916022],[-71.680761,-39.808164],[-71.915734,-40.832339],[-71.746804,-42.051386],[-72.148898,-42.254888],[-71.915424,-43.408565],[-71.464056,-43.787611],[-71.793623,-44.207172],[-71.329801,-44.407522],[-71.222779,-44.784243],[-71.659316,-44.973689],[-71.552009,-45.560733],[-71.917258,-46.884838],[-72.447355,-47.738533],[-72.331161,-48.244238],[-72.648247,-48.878618],[-73.415436,-49.318436],[-73.328051,-50.378785],[-72.975747,-50.74145],[-72.309974,-50.67701],[-72.329404,-51.425956],[-71.914804,-52.009022],[-69.498362,-52.142761],[-68.571545,-52.299444],[-69.461284,-52.291951],[-69.94278,-52.537931],[-70.845102,-52.899201],[-71.006332,-53.833252],[-71.429795,-53.856455],[-72.557943,-53.53141],[-73.702757,-52.835069],[-73.702757,-52.83507],[-74.946763,-52.262754],[-75.260026,-51.629355],[-74.976632,-51.043396],[-75.479754,-50.378372],[-75.608015,-48.673773],[-75.18277,-47.711919],[-74.126581,-46.939253],[-75.644395,-46.647643],[-74.692154,-45.763976],[-74.351709,-44.103044],[-73.240356,-44.454961],[-72.717804,-42.383356],[-73.3889,-42.117532],[-73.701336,-43.365776],[-74.331943,-43.224958],[-74.017957,-41.794813],[-73.677099,-39.942213],[-73.217593,-39.258689],[-73.505559,-38.282883],[-73.588061,-37.156285],[-73.166717,-37.12378],[-72.553137,-35.50884],[-71.861732,-33.909093],[-71.43845,-32.418899],[-71.668721,-30.920645],[-71.370083,-30.095682],[-71.489894,-28.861442],[-70.905124,-27.64038],[-70.724954,-25.705924],[-70.403966,-23.628997],[-70.091246,-21.393319],[-70.16442,-19.756468],[-70.372572,-18.347975],[-69.858444,-18.092694],[-69.590424,-17.580012],[-69.100247,-18.260125],[-68.966818,-18.981683],[-68.442225,-19.405068],[-68.757167,-20.372658],[-68.219913,-21.494347]]]]}},{type:"Feature",id:"CHN",properties:{name:"China"},geometry:{type:"MultiPolygon",coordinates:[[[[110.339188,18.678395],[109.47521,18.197701],[108.655208,18.507682],[108.626217,19.367888],[109.119056,19.821039],[110.211599,20.101254],[110.786551,20.077534],[111.010051,19.69593],[110.570647,19.255879],[110.339188,18.678395]]],[[[127.657407,49.76027],[129.397818,49.4406],[130.582293,48.729687],[130.987282,47.790132],[132.506672,47.78897],[133.373596,48.183442],[135.026311,48.47823],[134.500814,47.57844],[134.112362,47.212467],[133.769644,46.116927],[133.097127,45.144066],[131.883454,45.321162],[131.025212,44.967953],[131.288555,44.11152],[131.144688,42.92999],[130.633866,42.903015],[130.640016,42.395009],[129.994267,42.985387],[129.596669,42.424982],[128.052215,41.994285],[128.208433,41.466772],[127.343783,41.503152],[126.869083,41.816569],[126.182045,41.107336],[125.079942,40.569824],[124.265625,39.928493],[122.86757,39.637788],[122.131388,39.170452],[121.054554,38.897471],[121.585995,39.360854],[121.376757,39.750261],[122.168595,40.422443],[121.640359,40.94639],[120.768629,40.593388],[119.639602,39.898056],[119.023464,39.252333],[118.042749,39.204274],[117.532702,38.737636],[118.059699,38.061476],[118.87815,37.897325],[118.911636,37.448464],[119.702802,37.156389],[120.823457,37.870428],[121.711259,37.481123],[122.357937,37.454484],[122.519995,36.930614],[121.104164,36.651329],[120.637009,36.11144],[119.664562,35.609791],[119.151208,34.909859],[120.227525,34.360332],[120.620369,33.376723],[121.229014,32.460319],[121.908146,31.692174],[121.891919,30.949352],[121.264257,30.676267],[121.503519,30.142915],[122.092114,29.83252],[121.938428,29.018022],[121.684439,28.225513],[121.125661,28.135673],[120.395473,27.053207],[119.585497,25.740781],[118.656871,24.547391],[117.281606,23.624501],[115.890735,22.782873],[114.763827,22.668074],[114.152547,22.22376],[113.80678,22.54834],[113.241078,22.051367],[111.843592,21.550494],[110.785466,21.397144],[110.444039,20.341033],[109.889861,20.282457],[109.627655,21.008227],[109.864488,21.395051],[108.522813,21.715212],[108.05018,21.55238],[107.04342,21.811899],[106.567273,22.218205],[106.725403,22.794268],[105.811247,22.976892],[105.329209,23.352063],[104.476858,22.81915],[103.504515,22.703757],[102.706992,22.708795],[102.170436,22.464753],[101.652018,22.318199],[101.80312,21.174367],[101.270026,21.201652],[101.180005,21.436573],[101.150033,21.849984],[100.416538,21.558839],[99.983489,21.742937],[99.240899,22.118314],[99.531992,22.949039],[98.898749,23.142722],[98.660262,24.063286],[97.60472,23.897405],[97.724609,25.083637],[98.671838,25.918703],[98.712094,26.743536],[98.68269,27.508812],[98.246231,27.747221],[97.911988,28.335945],[97.327114,28.261583],[96.248833,28.411031],[96.586591,28.83098],[96.117679,29.452802],[95.404802,29.031717],[94.56599,29.277438],[93.413348,28.640629],[92.503119,27.896876],[91.696657,27.771742],[91.258854,28.040614],[90.730514,28.064954],[90.015829,28.296439],[89.47581,28.042759],[88.814248,27.299316],[88.730326,28.086865],[88.120441,27.876542],[86.954517,27.974262],[85.82332,28.203576],[85.011638,28.642774],[84.23458,28.839894],[83.898993,29.320226],[83.337115,29.463732],[82.327513,30.115268],[81.525804,30.422717],[81.111256,30.183481],[79.721367,30.882715],[78.738894,31.515906],[78.458446,32.618164],[79.176129,32.48378],[79.208892,32.994395],[78.811086,33.506198],[78.912269,34.321936],[77.837451,35.49401],[76.192848,35.898403],[75.896897,36.666806],[75.158028,37.133031],[74.980002,37.41999],[74.829986,37.990007],[74.864816,38.378846],[74.257514,38.606507],[73.928852,38.505815],[73.675379,39.431237],[73.960013,39.660008],[73.822244,39.893973],[74.776862,40.366425],[75.467828,40.562072],[76.526368,40.427946],[76.904484,41.066486],[78.187197,41.185316],[78.543661,41.582243],[80.11943,42.123941],[80.25999,42.349999],[80.18015,42.920068],[80.866206,43.180362],[79.966106,44.917517],[81.947071,45.317027],[82.458926,45.53965],[83.180484,47.330031],[85.16429,47.000956],[85.720484,47.452969],[85.768233,48.455751],[86.598776,48.549182],[87.35997,49.214981],[87.751264,49.297198],[88.013832,48.599463],[88.854298,48.069082],[90.280826,47.693549],[90.970809,46.888146],[90.585768,45.719716],[90.94554,45.286073],[92.133891,45.115076],[93.480734,44.975472],[94.688929,44.352332],[95.306875,44.241331],[95.762455,43.319449],[96.349396,42.725635],[97.451757,42.74889],[99.515817,42.524691],[100.845866,42.663804],[101.83304,42.514873],[103.312278,41.907468],[104.522282,41.908347],[104.964994,41.59741],[106.129316,42.134328],[107.744773,42.481516],[109.243596,42.519446],[110.412103,42.871234],[111.129682,43.406834],[111.829588,43.743118],[111.667737,44.073176],[111.348377,44.457442],[111.873306,45.102079],[112.436062,45.011646],[113.463907,44.808893],[114.460332,45.339817],[115.985096,45.727235],[116.717868,46.388202],[117.421701,46.672733],[118.874326,46.805412],[119.66327,46.69268],[119.772824,47.048059],[118.866574,47.74706],[118.064143,48.06673],[117.295507,47.697709],[116.308953,47.85341],[115.742837,47.726545],[115.485282,48.135383],[116.191802,49.134598],[116.678801,49.888531],[117.879244,49.510983],[119.288461,50.142883],[119.279366,50.582908],[120.18205,51.643566],[120.738191,51.964115],[120.725789,52.516226],[120.177089,52.753886],[121.003085,53.251401],[122.245748,53.431726],[123.571507,53.458804],[125.068211,53.161045],[125.946349,52.792799],[126.564399,51.784255],[126.939157,51.353894],[127.287456,50.739797],[127.657407,49.76027]]]]}},{type:"Feature",id:"CIV",properties:{name:"Ivory Coast"},geometry:{type:"Polygon",coordinates:[[[-2.856125,4.994476],[-3.311084,4.984296],[-4.00882,5.179813],[-4.649917,5.168264],[-5.834496,4.993701],[-6.528769,4.705088],[-7.518941,4.338288],[-7.712159,4.364566],[-7.635368,5.188159],[-7.539715,5.313345],[-7.570153,5.707352],[-7.993693,6.12619],[-8.311348,6.193033],[-8.60288,6.467564],[-8.385452,6.911801],[-8.485446,7.395208],[-8.439298,7.686043],[-8.280703,7.68718],[-8.221792,8.123329],[-8.299049,8.316444],[-8.203499,8.455453],[-7.8321,8.575704],[-8.079114,9.376224],[-8.309616,9.789532],[-8.229337,10.12902],[-8.029944,10.206535],[-7.89959,10.297382],[-7.622759,10.147236],[-6.850507,10.138994],[-6.666461,10.430811],[-6.493965,10.411303],[-6.205223,10.524061],[-6.050452,10.096361],[-5.816926,10.222555],[-5.404342,10.370737],[-4.954653,10.152714],[-4.779884,9.821985],[-4.330247,9.610835],[-3.980449,9.862344],[-3.511899,9.900326],[-2.827496,9.642461],[-2.56219,8.219628],[-2.983585,7.379705],[-3.24437,6.250472],[-2.810701,5.389051],[-2.856125,4.994476]]]}},{type:"Feature",id:"CMR",properties:{name:"Cameroon"},geometry:{type:"Polygon",coordinates:[[[13.075822,2.267097],[12.951334,2.321616],[12.35938,2.192812],[11.751665,2.326758],[11.276449,2.261051],[9.649158,2.283866],[9.795196,3.073404],[9.404367,3.734527],[8.948116,3.904129],[8.744924,4.352215],[8.488816,4.495617],[8.500288,4.771983],[8.757533,5.479666],[9.233163,6.444491],[9.522706,6.453482],[10.118277,7.03877],[10.497375,7.055358],[11.058788,6.644427],[11.745774,6.981383],[11.839309,7.397042],[12.063946,7.799808],[12.218872,8.305824],[12.753672,8.717763],[12.955468,9.417772],[13.1676,9.640626],[13.308676,10.160362],[13.57295,10.798566],[14.415379,11.572369],[14.468192,11.904752],[14.577178,12.085361],[14.181336,12.483657],[14.213531,12.802035],[14.495787,12.859396],[14.893386,12.219048],[14.960152,11.555574],[14.923565,10.891325],[15.467873,9.982337],[14.909354,9.992129],[14.627201,9.920919],[14.171466,10.021378],[13.954218,9.549495],[14.544467,8.965861],[14.979996,8.796104],[15.120866,8.38215],[15.436092,7.692812],[15.27946,7.421925],[14.776545,6.408498],[14.53656,6.226959],[14.459407,5.451761],[14.558936,5.030598],[14.478372,4.732605],[14.950953,4.210389],[15.03622,3.851367],[15.405396,3.335301],[15.862732,3.013537],[15.907381,2.557389],[16.012852,2.26764],[15.940919,1.727673],[15.146342,1.964015],[14.337813,2.227875],[13.075822,2.267097]]]}},{type:"Feature",id:"COD",properties:{name:"Democratic Republic of the Congo"},geometry:{type:"Polygon",coordinates:[[[30.83386,3.509166],[30.773347,2.339883],[31.174149,2.204465],[30.85267,1.849396],[30.468508,1.583805],[30.086154,1.062313],[29.875779,.59738],[29.819503,-0.20531],[29.587838,-0.587406],[29.579466,-1.341313],[29.291887,-1.620056],[29.254835,-2.21511],[29.117479,-2.292211],[29.024926,-2.839258],[29.276384,-3.293907],[29.339998,-4.499983],[29.519987,-5.419979],[29.419993,-5.939999],[29.620032,-6.520015],[30.199997,-7.079981],[30.740015,-8.340007],[30.346086,-8.238257],[29.002912,-8.407032],[28.734867,-8.526559],[28.449871,-9.164918],[28.673682,-9.605925],[28.49607,-10.789884],[28.372253,-11.793647],[28.642417,-11.971569],[29.341548,-12.360744],[29.616001,-12.178895],[29.699614,-13.257227],[28.934286,-13.248958],[28.523562,-12.698604],[28.155109,-12.272481],[27.388799,-12.132747],[27.16442,-11.608748],[26.553088,-11.92444],[25.75231,-11.784965],[25.418118,-11.330936],[24.78317,-11.238694],[24.314516,-11.262826],[24.257155,-10.951993],[23.912215,-10.926826],[23.456791,-10.867863],[22.837345,-11.017622],[22.402798,-10.993075],[22.155268,-11.084801],[22.208753,-9.894796],[21.875182,-9.523708],[21.801801,-8.908707],[21.949131,-8.305901],[21.746456,-7.920085],[21.728111,-7.290872],[20.514748,-7.299606],[20.601823,-6.939318],[20.091622,-6.94309],[20.037723,-7.116361],[19.417502,-7.155429],[19.166613,-7.738184],[19.016752,-7.988246],[18.464176,-7.847014],[18.134222,-7.987678],[17.47297,-8.068551],[17.089996,-7.545689],[16.860191,-7.222298],[16.57318,-6.622645],[16.326528,-5.87747],[13.375597,-5.864241],[13.024869,-5.984389],[12.735171,-5.965682],[12.322432,-6.100092],[12.182337,-5.789931],[12.436688,-5.684304],[12.468004,-5.248362],[12.631612,-4.991271],[12.995517,-4.781103],[13.25824,-4.882957],[13.600235,-4.500138],[14.144956,-4.510009],[14.209035,-4.793092],[14.582604,-4.970239],[15.170992,-4.343507],[15.75354,-3.855165],[16.00629,-3.535133],[15.972803,-2.712392],[16.407092,-1.740927],[16.865307,-1.225816],[17.523716,-0.74383],[17.638645,-0.424832],[17.663553,-0.058084],[17.82654,.288923],[17.774192,.855659],[17.898835,1.741832],[18.094276,2.365722],[18.393792,2.900443],[18.453065,3.504386],[18.542982,4.201785],[18.932312,4.709506],[19.467784,5.031528],[20.290679,4.691678],[20.927591,4.322786],[21.659123,4.224342],[22.405124,4.02916],[22.704124,4.633051],[22.84148,4.710126],[23.297214,4.609693],[24.410531,5.108784],[24.805029,4.897247],[25.128833,4.927245],[25.278798,5.170408],[25.650455,5.256088],[26.402761,5.150875],[27.044065,5.127853],[27.374226,5.233944],[27.979977,4.408413],[28.428994,4.287155],[28.696678,4.455077],[29.159078,4.389267],[29.715995,4.600805],[29.9535,4.173699],[30.83386,3.509166]]]}},{type:"Feature",id:"COG",properties:{name:"Republic of the Congo"},geometry:{type:"Polygon",coordinates:[[[12.995517,-4.781103],[12.62076,-4.438023],[12.318608,-4.60623],[11.914963,-5.037987],[11.093773,-3.978827],[11.855122,-3.426871],[11.478039,-2.765619],[11.820964,-2.514161],[12.495703,-2.391688],[12.575284,-1.948511],[13.109619,-2.42874],[13.992407,-2.470805],[14.29921,-1.998276],[14.425456,-1.333407],[14.316418,-0.552627],[13.843321,.038758],[14.276266,1.19693],[14.026669,1.395677],[13.282631,1.314184],[13.003114,1.830896],[13.075822,2.267097],[14.337813,2.227875],[15.146342,1.964015],[15.940919,1.727673],[16.012852,2.26764],[16.537058,3.198255],[17.133042,3.728197],[17.8099,3.560196],[18.453065,3.504386],[18.393792,2.900443],[18.094276,2.365722],[17.898835,1.741832],[17.774192,.855659],[17.82654,.288923],[17.663553,-0.058084],[17.638645,-0.424832],[17.523716,-0.74383],[16.865307,-1.225816],[16.407092,-1.740927],[15.972803,-2.712392],[16.00629,-3.535133],[15.75354,-3.855165],[15.170992,-4.343507],[14.582604,-4.970239],[14.209035,-4.793092],[14.144956,-4.510009],[13.600235,-4.500138],[13.25824,-4.882957],[12.995517,-4.781103]]]}},{type:"Feature",id:"COL",properties:{name:"Colombia"},geometry:{type:"Polygon",coordinates:[[[-75.373223,-0.152032],[-75.801466,.084801],[-76.292314,.416047],[-76.57638,.256936],[-77.424984,.395687],[-77.668613,.825893],[-77.855061,.809925],[-78.855259,1.380924],[-78.990935,1.69137],[-78.617831,1.766404],[-78.662118,2.267355],[-78.42761,2.629556],[-77.931543,2.696606],[-77.510431,3.325017],[-77.12769,3.849636],[-77.496272,4.087606],[-77.307601,4.667984],[-77.533221,5.582812],[-77.318815,5.845354],[-77.476661,6.691116],[-77.881571,7.223771],[-77.753414,7.70984],[-77.431108,7.638061],[-77.242566,7.935278],[-77.474723,8.524286],[-77.353361,8.670505],[-76.836674,8.638749],[-76.086384,9.336821],[-75.6746,9.443248],[-75.664704,9.774003],[-75.480426,10.61899],[-74.906895,11.083045],[-74.276753,11.102036],[-74.197223,11.310473],[-73.414764,11.227015],[-72.627835,11.731972],[-72.238195,11.95555],[-71.75409,12.437303],[-71.399822,12.376041],[-71.137461,12.112982],[-71.331584,11.776284],[-71.973922,11.608672],[-72.227575,11.108702],[-72.614658,10.821975],[-72.905286,10.450344],[-73.027604,9.73677],[-73.304952,9.152],[-72.78873,9.085027],[-72.660495,8.625288],[-72.439862,8.405275],[-72.360901,8.002638],[-72.479679,7.632506],[-72.444487,7.423785],[-72.198352,7.340431],[-71.960176,6.991615],[-70.674234,7.087785],[-70.093313,6.960376],[-69.38948,6.099861],[-68.985319,6.206805],[-68.265052,6.153268],[-67.695087,6.267318],[-67.34144,6.095468],[-67.521532,5.55687],[-67.744697,5.221129],[-67.823012,4.503937],[-67.621836,3.839482],[-67.337564,3.542342],[-67.303173,3.318454],[-67.809938,2.820655],[-67.447092,2.600281],[-67.181294,2.250638],[-66.876326,1.253361],[-67.065048,1.130112],[-67.259998,1.719999],[-67.53781,2.037163],[-67.868565,1.692455],[-69.816973,1.714805],[-69.804597,1.089081],[-69.218638,.985677],[-69.252434,.602651],[-69.452396,.706159],[-70.015566,.541414],[-70.020656,-0.185156],[-69.577065,-0.549992],[-69.420486,-1.122619],[-69.444102,-1.556287],[-69.893635,-4.298187],[-70.394044,-3.766591],[-70.692682,-3.742872],[-70.047709,-2.725156],[-70.813476,-2.256865],[-71.413646,-2.342802],[-71.774761,-2.16979],[-72.325787,-2.434218],[-73.070392,-2.308954],[-73.659504,-1.260491],[-74.122395,-1.002833],[-74.441601,-0.53082],[-75.106625,-0.057205],[-75.373223,-0.152032]]]}},{type:"Feature",id:"CRI",properties:{name:"Costa Rica"},geometry:{type:"Polygon",coordinates:[[[-82.965783,8.225028],[-83.508437,8.446927],[-83.711474,8.656836],[-83.596313,8.830443],[-83.632642,9.051386],[-83.909886,9.290803],[-84.303402,9.487354],[-84.647644,9.615537],[-84.713351,9.908052],[-84.97566,10.086723],[-84.911375,9.795992],[-85.110923,9.55704],[-85.339488,9.834542],[-85.660787,9.933347],[-85.797445,10.134886],[-85.791709,10.439337],[-85.659314,10.754331],[-85.941725,10.895278],[-85.71254,11.088445],[-85.561852,11.217119],[-84.903003,10.952303],[-84.673069,11.082657],[-84.355931,10.999226],[-84.190179,10.79345],[-83.895054,10.726839],[-83.655612,10.938764],[-83.40232,10.395438],[-83.015677,9.992982],[-82.546196,9.566135],[-82.932891,9.476812],[-82.927155,9.07433],[-82.719183,8.925709],[-82.868657,8.807266],[-82.829771,8.626295],[-82.913176,8.423517],[-82.965783,8.225028]]]}},{type:"Feature",id:"CUB",properties:{name:"Cuba"},geometry:{type:"Polygon",coordinates:[[[-82.268151,23.188611],[-81.404457,23.117271],[-80.618769,23.10598],[-79.679524,22.765303],[-79.281486,22.399202],[-78.347434,22.512166],[-77.993296,22.277194],[-77.146422,21.657851],[-76.523825,21.20682],[-76.19462,21.220565],[-75.598222,21.016624],[-75.67106,20.735091],[-74.933896,20.693905],[-74.178025,20.284628],[-74.296648,20.050379],[-74.961595,19.923435],[-75.63468,19.873774],[-76.323656,19.952891],[-77.755481,19.855481],[-77.085108,20.413354],[-77.492655,20.673105],[-78.137292,20.739949],[-78.482827,21.028613],[-78.719867,21.598114],[-79.285,21.559175],[-80.217475,21.827324],[-80.517535,22.037079],[-81.820943,22.192057],[-82.169992,22.387109],[-81.795002,22.636965],[-82.775898,22.68815],[-83.494459,22.168518],[-83.9088,22.154565],[-84.052151,21.910575],[-84.54703,21.801228],[-84.974911,21.896028],[-84.447062,22.20495],[-84.230357,22.565755],[-83.77824,22.788118],[-83.267548,22.983042],[-82.510436,23.078747],[-82.268151,23.188611]]]}},{type:"Feature",id:"-99",properties:{name:"Northern Cyprus"},geometry:{type:"Polygon",coordinates:[[[32.73178,35.140026],[32.802474,35.145504],[32.946961,35.386703],[33.667227,35.373216],[34.576474,35.671596],[33.900804,35.245756],[33.973617,35.058506],[33.86644,35.093595],[33.675392,35.017863],[33.525685,35.038688],[33.475817,35.000345],[33.455922,35.101424],[33.383833,35.162712],[33.190977,35.173125],[32.919572,35.087833],[32.73178,35.140026]]]}},{type:"Feature",id:"CYP",properties:{name:"Cyprus"},geometry:{type:"Polygon",coordinates:[[[33.973617,35.058506],[34.004881,34.978098],[32.979827,34.571869],[32.490296,34.701655],[32.256667,35.103232],[32.73178,35.140026],[32.919572,35.087833],[33.190977,35.173125],[33.383833,35.162712],[33.455922,35.101424],[33.475817,35.000345],[33.525685,35.038688],[33.675392,35.017863],[33.86644,35.093595],[33.973617,35.058506]]]}},{type:"Feature",id:"CZE",properties:{name:"Czech Republic"},geometry:{type:"Polygon",coordinates:[[[16.960288,48.596982],[16.499283,48.785808],[16.029647,48.733899],[15.253416,49.039074],[14.901447,48.964402],[14.338898,48.555305],[13.595946,48.877172],[13.031329,49.307068],[12.521024,49.547415],[12.415191,49.969121],[12.240111,50.266338],[12.966837,50.484076],[13.338132,50.733234],[14.056228,50.926918],[14.307013,51.117268],[14.570718,51.002339],[15.016996,51.106674],[15.490972,50.78473],[16.238627,50.697733],[16.176253,50.422607],[16.719476,50.215747],[16.868769,50.473974],[17.554567,50.362146],[17.649445,50.049038],[18.392914,49.988629],[18.853144,49.49623],[18.554971,49.495015],[18.399994,49.315001],[18.170498,49.271515],[18.104973,49.043983],[17.913512,48.996493],[17.886485,48.903475],[17.545007,48.800019],[17.101985,48.816969],[16.960288,48.596982]]]}},{type:"Feature",id:"DEU",properties:{name:"Germany"},geometry:{type:"Polygon",coordinates:[[[9.921906,54.983104],[9.93958,54.596642],[10.950112,54.363607],[10.939467,54.008693],[11.956252,54.196486],[12.51844,54.470371],[13.647467,54.075511],[14.119686,53.757029],[14.353315,53.248171],[14.074521,52.981263],[14.4376,52.62485],[14.685026,52.089947],[14.607098,51.745188],[15.016996,51.106674],[14.570718,51.002339],[14.307013,51.117268],[14.056228,50.926918],[13.338132,50.733234],[12.966837,50.484076],[12.240111,50.266338],[12.415191,49.969121],[12.521024,49.547415],[13.031329,49.307068],[13.595946,48.877172],[13.243357,48.416115],[12.884103,48.289146],[13.025851,47.637584],[12.932627,47.467646],[12.62076,47.672388],[12.141357,47.703083],[11.426414,47.523766],[10.544504,47.566399],[10.402084,47.302488],[9.896068,47.580197],[9.594226,47.525058],[8.522612,47.830828],[8.317301,47.61358],[7.466759,47.620582],[7.593676,48.333019],[8.099279,49.017784],[6.65823,49.201958],[6.18632,49.463803],[6.242751,49.902226],[6.043073,50.128052],[6.156658,50.803721],[5.988658,51.851616],[6.589397,51.852029],[6.84287,52.22844],[7.092053,53.144043],[6.90514,53.482162],[7.100425,53.693932],[7.936239,53.748296],[8.121706,53.527792],[8.800734,54.020786],[8.572118,54.395646],[8.526229,54.962744],[9.282049,54.830865],[9.921906,54.983104]]]}},{type:"Feature",id:"DJI",properties:{name:"Djibouti"},geometry:{type:"Polygon",coordinates:[[[43.081226,12.699639],[43.317852,12.390148],[43.286381,11.974928],[42.715874,11.735641],[43.145305,11.46204],[42.776852,10.926879],[42.55493,11.10511],[42.31414,11.0342],[41.75557,11.05091],[41.73959,11.35511],[41.66176,11.6312],[42,12.1],[42.35156,12.54223],[42.779642,12.455416],[43.081226,12.699639]]]}},{type:"Feature",id:"DNK",properties:{name:"Denmark"},geometry:{type:"MultiPolygon",coordinates:[[[[12.690006,55.609991],[12.089991,54.800015],[11.043543,55.364864],[10.903914,55.779955],[12.370904,56.111407],[12.690006,55.609991]]],[[[10.912182,56.458621],[10.667804,56.081383],[10.369993,56.190007],[9.649985,55.469999],[9.921906,54.983104],[9.282049,54.830865],[8.526229,54.962744],[8.120311,55.517723],[8.089977,56.540012],[8.256582,56.809969],[8.543438,57.110003],[9.424469,57.172066],[9.775559,57.447941],[10.580006,57.730017],[10.546106,57.215733],[10.25,56.890016],[10.369993,56.609982],[10.912182,56.458621]]]]}},{type:"Feature",id:"DOM",properties:{name:"Dominican Republic"},geometry:{type:"Polygon",coordinates:[[[-71.712361,19.714456],[-71.587304,19.884911],[-70.806706,19.880286],[-70.214365,19.622885],[-69.950815,19.648],[-69.76925,19.293267],[-69.222126,19.313214],[-69.254346,19.015196],[-68.809412,18.979074],[-68.317943,18.612198],[-68.689316,18.205142],[-69.164946,18.422648],[-69.623988,18.380713],[-69.952934,18.428307],[-70.133233,18.245915],[-70.517137,18.184291],[-70.669298,18.426886],[-70.99995,18.283329],[-71.40021,17.598564],[-71.657662,17.757573],[-71.708305,18.044997],[-71.687738,18.31666],[-71.945112,18.6169],[-71.701303,18.785417],[-71.624873,19.169838],[-71.712361,19.714456]]]}},{type:"Feature",id:"DZA",properties:{name:"Algeria"},geometry:{type:"Polygon",coordinates:[[[11.999506,23.471668],[8.572893,21.565661],[5.677566,19.601207],[4.267419,19.155265],[3.158133,19.057364],[3.146661,19.693579],[2.683588,19.85623],[2.060991,20.142233],[1.823228,20.610809],[-1.550055,22.792666],[-4.923337,24.974574],[-8.6844,27.395744],[-8.665124,27.589479],[-8.66559,27.656426],[-8.674116,28.841289],[-7.059228,29.579228],[-6.060632,29.7317],[-5.242129,30.000443],[-4.859646,30.501188],[-3.690441,30.896952],[-3.647498,31.637294],[-3.06898,31.724498],[-2.616605,32.094346],[-1.307899,32.262889],[-1.124551,32.651522],[-1.388049,32.864015],[-1.733455,33.919713],[-1.792986,34.527919],[-2.169914,35.168396],[-1.208603,35.714849],[-0.127454,35.888662],[.503877,36.301273],[1.466919,36.605647],[3.161699,36.783905],[4.815758,36.865037],[5.32012,36.716519],[6.26182,37.110655],[7.330385,37.118381],[7.737078,36.885708],[8.420964,36.946427],[8.217824,36.433177],[8.376368,35.479876],[8.140981,34.655146],[7.524482,34.097376],[7.612642,33.344115],[8.430473,32.748337],[8.439103,32.506285],[9.055603,32.102692],[9.48214,30.307556],[9.805634,29.424638],[9.859998,28.95999],[9.683885,28.144174],[9.756128,27.688259],[9.629056,27.140953],[9.716286,26.512206],[9.319411,26.094325],[9.910693,25.365455],[9.948261,24.936954],[10.303847,24.379313],[10.771364,24.562532],[11.560669,24.097909],[11.999506,23.471668]]]}},{type:"Feature",id:"ECU",properties:{name:"Ecuador"},geometry:{type:"Polygon",coordinates:[[[-80.302561,-3.404856],[-79.770293,-2.657512],[-79.986559,-2.220794],[-80.368784,-2.685159],[-80.967765,-2.246943],[-80.764806,-1.965048],[-80.933659,-1.057455],[-80.58337,-0.906663],[-80.399325,-0.283703],[-80.020898,.36034],[-80.09061,.768429],[-79.542762,.982938],[-78.855259,1.380924],[-77.855061,.809925],[-77.668613,.825893],[-77.424984,.395687],[-76.57638,.256936],[-76.292314,.416047],[-75.801466,.084801],[-75.373223,-0.152032],[-75.233723,-0.911417],[-75.544996,-1.56161],[-76.635394,-2.608678],[-77.837905,-3.003021],[-78.450684,-3.873097],[-78.639897,-4.547784],[-79.205289,-4.959129],[-79.624979,-4.454198],[-80.028908,-4.346091],[-80.442242,-4.425724],[-80.469295,-4.059287],[-80.184015,-3.821162],[-80.302561,-3.404856]]]}},{type:"Feature",id:"EGY",properties:{name:"Egypt"},geometry:{type:"Polygon",coordinates:[[[34.9226,29.50133],[34.64174,29.09942],[34.42655,28.34399],[34.15451,27.8233],[33.92136,27.6487],[33.58811,27.97136],[33.13676,28.41765],[32.42323,29.85108],[32.32046,29.76043],[32.73482,28.70523],[33.34876,27.69989],[34.10455,26.14227],[34.47387,25.59856],[34.79507,25.03375],[35.69241,23.92671],[35.49372,23.75237],[35.52598,23.10244],[36.69069,22.20485],[36.86623,22],[32.9,22],[29.02,22],[25,22],[25,25.6825],[25,29.238655],[24.70007,30.04419],[24.95762,30.6616],[24.80287,31.08929],[25.16482,31.56915],[26.49533,31.58568],[27.45762,31.32126],[28.45048,31.02577],[28.91353,30.87005],[29.68342,31.18686],[30.09503,31.4734],[30.97693,31.55586],[31.68796,31.4296],[31.96041,30.9336],[32.19247,31.26034],[32.99392,31.02407],[33.7734,30.96746],[34.26544,31.21936],[34.9226,29.50133]]]}},{type:"Feature",id:"ERI",properties:{name:"Eritrea"},geometry:{type:"Polygon",coordinates:[[[42.35156,12.54223],[42.00975,12.86582],[41.59856,13.45209],[41.155194,13.77332],[40.8966,14.11864],[40.026219,14.519579],[39.34061,14.53155],[39.0994,14.74064],[38.51295,14.50547],[37.90607,14.95943],[37.59377,14.2131],[36.42951,14.42211],[36.323189,14.822481],[36.75386,16.291874],[36.85253,16.95655],[37.16747,17.26314],[37.904,17.42754],[38.41009,17.998307],[38.990623,16.840626],[39.26611,15.922723],[39.814294,15.435647],[41.179275,14.49108],[41.734952,13.921037],[42.276831,13.343992],[42.589576,13.000421],[43.081226,12.699639],[42.779642,12.455416],[42.35156,12.54223]]]}},{type:"Feature",id:"ESP",properties:{name:"Spain"},geometry:{type:"Polygon",coordinates:[[[-9.034818,41.880571],[-8.984433,42.592775],[-9.392884,43.026625],[-7.97819,43.748338],[-6.754492,43.567909],[-5.411886,43.57424],[-4.347843,43.403449],[-3.517532,43.455901],[-1.901351,43.422802],[-1.502771,43.034014],[.338047,42.579546],[.701591,42.795734],[1.826793,42.343385],[2.985999,42.473015],[3.039484,41.89212],[2.091842,41.226089],[.810525,41.014732],[.721331,40.678318],[.106692,40.123934],[-0.278711,39.309978],[.111291,38.738514],[-0.467124,38.292366],[-0.683389,37.642354],[-1.438382,37.443064],[-2.146453,36.674144],[-3.415781,36.6589],[-4.368901,36.677839],[-4.995219,36.324708],[-5.37716,35.94685],[-5.866432,36.029817],[-6.236694,36.367677],[-6.520191,36.942913],[-7.453726,37.097788],[-7.537105,37.428904],[-7.166508,37.803894],[-7.029281,38.075764],[-7.374092,38.373059],[-7.098037,39.030073],[-7.498632,39.629571],[-7.066592,39.711892],[-7.026413,40.184524],[-6.86402,40.330872],[-6.851127,41.111083],[-6.389088,41.381815],[-6.668606,41.883387],[-7.251309,41.918346],[-7.422513,41.792075],[-8.013175,41.790886],[-8.263857,42.280469],[-8.671946,42.134689],[-9.034818,41.880571]]]}},{type:"Feature",id:"EST",properties:{name:"Estonia"},geometry:{type:"Polygon",coordinates:[[[24.312863,57.793424],[24.428928,58.383413],[24.061198,58.257375],[23.42656,58.612753],[23.339795,59.18724],[24.604214,59.465854],[25.864189,59.61109],[26.949136,59.445803],[27.981114,59.475388],[28.131699,59.300825],[27.420166,58.724581],[27.716686,57.791899],[27.288185,57.474528],[26.463532,57.476389],[25.60281,57.847529],[25.164594,57.970157],[24.312863,57.793424]]]}},{type:"Feature",id:"ETH",properties:{name:"Ethiopia"},geometry:{type:"Polygon",coordinates:[[[37.90607,14.95943],[38.51295,14.50547],[39.0994,14.74064],[39.34061,14.53155],[40.02625,14.51959],[40.8966,14.11864],[41.1552,13.77333],[41.59856,13.45209],[42.00975,12.86582],[42.35156,12.54223],[42,12.1],[41.66176,11.6312],[41.73959,11.35511],[41.75557,11.05091],[42.31414,11.0342],[42.55493,11.10511],[42.776852,10.926879],[42.55876,10.57258],[42.92812,10.02194],[43.29699,9.54048],[43.67875,9.18358],[46.94834,7.99688],[47.78942,8.003],[44.9636,5.00162],[43.66087,4.95755],[42.76967,4.25259],[42.12861,4.23413],[41.855083,3.918912],[41.1718,3.91909],[40.76848,4.25702],[39.85494,3.83879],[39.559384,3.42206],[38.89251,3.50074],[38.67114,3.61607],[38.43697,3.58851],[38.120915,3.598605],[36.855093,4.447864],[36.159079,4.447864],[35.817448,4.776966],[35.817448,5.338232],[35.298007,5.506],[34.70702,6.59422],[34.25032,6.82607],[34.0751,7.22595],[33.56829,7.71334],[32.95418,7.78497],[33.2948,8.35458],[33.8255,8.37916],[33.97498,8.68456],[33.96162,9.58358],[34.25745,10.63009],[34.73115,10.91017],[34.83163,11.31896],[35.26049,12.08286],[35.86363,12.57828],[36.27022,13.56333],[36.42951,14.42211],[37.59377,14.2131],[37.90607,14.95943]]]}},{type:"Feature",id:"FIN",properties:{name:"Finland"},geometry:{type:"Polygon",coordinates:[[[28.59193,69.064777],[28.445944,68.364613],[29.977426,67.698297],[29.054589,66.944286],[30.21765,65.80598],[29.54443,64.948672],[30.444685,64.204453],[30.035872,63.552814],[31.516092,62.867687],[31.139991,62.357693],[30.211107,61.780028],[28.069998,60.503517],[26.255173,60.423961],[24.496624,60.057316],[22.869695,59.846373],[22.290764,60.391921],[21.322244,60.72017],[21.544866,61.705329],[21.059211,62.607393],[21.536029,63.189735],[22.442744,63.81781],[24.730512,64.902344],[25.398068,65.111427],[25.294043,65.534346],[23.903379,66.006927],[23.56588,66.396051],[23.539473,67.936009],[21.978535,68.616846],[20.645593,69.106247],[21.244936,69.370443],[22.356238,68.841741],[23.66205,68.891247],[24.735679,68.649557],[25.689213,69.092114],[26.179622,69.825299],[27.732292,70.164193],[29.015573,69.766491],[28.59193,69.064777]]]}},{type:"Feature",id:"FJI",properties:{name:"Fiji"},geometry:{type:"MultiPolygon",coordinates:[[[[178.3736,-17.33992],[178.71806,-17.62846],[178.55271,-18.15059],[177.93266,-18.28799],[177.38146,-18.16432],[177.28504,-17.72465],[177.67087,-17.38114],[178.12557,-17.50481],[178.3736,-17.33992]]],[[[179.364143,-16.801354],[178.725059,-17.012042],[178.596839,-16.63915],[179.096609,-16.433984],[179.413509,-16.379054],[180,-16.067133],[180,-16.555217],[179.364143,-16.801354]]],[[[-179.917369,-16.501783],[-180,-16.555217],[-180,-16.067133],[-179.79332,-16.020882],[-179.917369,-16.501783]]]]}},{type:"Feature",id:"FLK",properties:{name:"Falkland Islands"},geometry:{type:"Polygon",coordinates:[[[-61.2,-51.85],[-60,-51.25],[-59.15,-51.5],[-58.55,-51.1],[-57.75,-51.55],[-58.05,-51.9],[-59.4,-52.2],[-59.85,-51.85],[-60.7,-52.3],[-61.2,-51.85]]]}},{type:"Feature",id:"FRA",properties:{name:"France"},geometry:{type:"MultiPolygon",coordinates:[[[[9.560016,42.152492],[9.229752,41.380007],[8.775723,41.583612],[8.544213,42.256517],[8.746009,42.628122],[9.390001,43.009985],[9.560016,42.152492]]],[[[3.588184,50.378992],[4.286023,49.907497],[4.799222,49.985373],[5.674052,49.529484],[5.897759,49.442667],[6.18632,49.463803],[6.65823,49.201958],[8.099279,49.017784],[7.593676,48.333019],[7.466759,47.620582],[7.192202,47.449766],[6.736571,47.541801],[6.768714,47.287708],[6.037389,46.725779],[6.022609,46.27299],[6.5001,46.429673],[6.843593,45.991147],[6.802355,45.70858],[7.096652,45.333099],[6.749955,45.028518],[7.007562,44.254767],[7.549596,44.127901],[7.435185,43.693845],[6.529245,43.128892],[4.556963,43.399651],[3.100411,43.075201],[2.985999,42.473015],[1.826793,42.343385],[.701591,42.795734],[.338047,42.579546],[-1.502771,43.034014],[-1.901351,43.422802],[-1.384225,44.02261],[-1.193798,46.014918],[-2.225724,47.064363],[-2.963276,47.570327],[-4.491555,47.954954],[-4.59235,48.68416],[-3.295814,48.901692],[-1.616511,48.644421],[-1.933494,49.776342],[-0.989469,49.347376],[1.338761,50.127173],[1.639001,50.946606],[2.513573,51.148506],[2.658422,50.796848],[3.123252,50.780363],[3.588184,50.378992]]]]}},{type:"Feature",id:"GAB",properties:{name:"Gabon"},geometry:{type:"Polygon",coordinates:[[[11.093773,-3.978827],[10.066135,-2.969483],[9.405245,-2.144313],[8.797996,-1.111301],[8.830087,-0.779074],[9.04842,-0.459351],[9.291351,.268666],[9.492889,1.01012],[9.830284,1.067894],[11.285079,1.057662],[11.276449,2.261051],[11.751665,2.326758],[12.35938,2.192812],[12.951334,2.321616],[13.075822,2.267097],[13.003114,1.830896],[13.282631,1.314184],[14.026669,1.395677],[14.276266,1.19693],[13.843321,.038758],[14.316418,-0.552627],[14.425456,-1.333407],[14.29921,-1.998276],[13.992407,-2.470805],[13.109619,-2.42874],[12.575284,-1.948511],[12.495703,-2.391688],[11.820964,-2.514161],[11.478039,-2.765619],[11.855122,-3.426871],[11.093773,-3.978827]]]}},{type:"Feature",id:"GBR",properties:{name:"United Kingdom"},geometry:{type:"MultiPolygon",coordinates:[[[[-5.661949,54.554603],[-6.197885,53.867565],[-6.95373,54.073702],[-7.572168,54.059956],[-7.366031,54.595841],[-7.572168,55.131622],[-6.733847,55.17286],[-5.661949,54.554603]]],[[[-3.005005,58.635],[-4.073828,57.553025],[-3.055002,57.690019],[-1.959281,57.6848],[-2.219988,56.870017],[-3.119003,55.973793],[-2.085009,55.909998],[-2.005676,55.804903],[-1.114991,54.624986],[-0.430485,54.464376],[.184981,53.325014],[.469977,52.929999],[1.681531,52.73952],[1.559988,52.099998],[1.050562,51.806761],[1.449865,51.289428],[.550334,50.765739],[-0.787517,50.774989],[-2.489998,50.500019],[-2.956274,50.69688],[-3.617448,50.228356],[-4.542508,50.341837],[-5.245023,49.96],[-5.776567,50.159678],[-4.30999,51.210001],[-3.414851,51.426009],[-3.422719,51.426848],[-4.984367,51.593466],[-5.267296,51.9914],[-4.222347,52.301356],[-4.770013,52.840005],[-4.579999,53.495004],[-3.093831,53.404547],[-3.09208,53.404441],[-2.945009,53.985],[-3.614701,54.600937],[-3.630005,54.615013],[-4.844169,54.790971],[-5.082527,55.061601],[-4.719112,55.508473],[-5.047981,55.783986],[-5.586398,55.311146],[-5.644999,56.275015],[-6.149981,56.78501],[-5.786825,57.818848],[-5.009999,58.630013],[-4.211495,58.550845],[-3.005005,58.635]]]]}},{type:"Feature",id:"GEO",properties:{name:"Georgia"},geometry:{type:"Polygon",coordinates:[[[41.554084,41.535656],[41.703171,41.962943],[41.45347,42.645123],[40.875469,43.013628],[40.321394,43.128634],[39.955009,43.434998],[40.076965,43.553104],[40.922185,43.382159],[42.394395,43.220308],[43.756017,42.740828],[43.9312,42.554974],[44.537623,42.711993],[45.470279,42.502781],[45.77641,42.092444],[46.404951,41.860675],[46.145432,41.722802],[46.637908,41.181673],[46.501637,41.064445],[45.962601,41.123873],[45.217426,41.411452],[44.97248,41.248129],[43.582746,41.092143],[42.619549,41.583173],[41.554084,41.535656]]]}},{type:"Feature",id:"GHA",properties:{name:"Ghana"},geometry:{type:"Polygon",coordinates:[[[1.060122,5.928837],[-0.507638,5.343473],[-1.063625,5.000548],[-1.964707,4.710462],[-2.856125,4.994476],[-2.810701,5.389051],[-3.24437,6.250472],[-2.983585,7.379705],[-2.56219,8.219628],[-2.827496,9.642461],[-2.963896,10.395335],[-2.940409,10.96269],[-1.203358,11.009819],[-0.761576,10.93693],[-0.438702,11.098341],[.023803,11.018682],[-0.049785,10.706918],[.36758,10.191213],[.365901,9.465004],[.461192,8.677223],[.712029,8.312465],[.490957,7.411744],[.570384,6.914359],[.836931,6.279979],[1.060122,5.928837]]]}},{type:"Feature",id:"GIN",properties:{name:"Guinea"},geometry:{type:"Polygon",coordinates:[[[-8.439298,7.686043],[-8.722124,7.711674],[-8.926065,7.309037],[-9.208786,7.313921],[-9.403348,7.526905],[-9.33728,7.928534],[-9.755342,8.541055],[-10.016567,8.428504],[-10.230094,8.406206],[-10.505477,8.348896],[-10.494315,8.715541],[-10.65477,8.977178],[-10.622395,9.26791],[-10.839152,9.688246],[-11.117481,10.045873],[-11.917277,10.046984],[-12.150338,9.858572],[-12.425929,9.835834],[-12.596719,9.620188],[-12.711958,9.342712],[-13.24655,8.903049],[-13.685154,9.494744],[-14.074045,9.886167],[-14.330076,10.01572],[-14.579699,10.214467],[-14.693232,10.656301],[-14.839554,10.876572],[-15.130311,11.040412],[-14.685687,11.527824],[-14.382192,11.509272],[-14.121406,11.677117],[-13.9008,11.678719],[-13.743161,11.811269],[-13.828272,12.142644],[-13.718744,12.247186],[-13.700476,12.586183],[-13.217818,12.575874],[-12.499051,12.33209],[-12.278599,12.35444],[-12.203565,12.465648],[-11.658301,12.386583],[-11.513943,12.442988],[-11.456169,12.076834],[-11.297574,12.077971],[-11.036556,12.211245],[-10.87083,12.177887],[-10.593224,11.923975],[-10.165214,11.844084],[-9.890993,12.060479],[-9.567912,12.194243],[-9.327616,12.334286],[-9.127474,12.30806],[-8.905265,12.088358],[-8.786099,11.812561],[-8.376305,11.393646],[-8.581305,11.136246],[-8.620321,10.810891],[-8.407311,10.909257],[-8.282357,10.792597],[-8.335377,10.494812],[-8.029944,10.206535],[-8.229337,10.12902],[-8.309616,9.789532],[-8.079114,9.376224],[-7.8321,8.575704],[-8.203499,8.455453],[-8.299049,8.316444],[-8.221792,8.123329],[-8.280703,7.68718],[-8.439298,7.686043]]]}},{type:"Feature",id:"GMB",properties:{name:"The Gambia"},geometry:{type:"Polygon",coordinates:[[[-16.841525,13.151394],[-16.713729,13.594959],[-15.624596,13.623587],[-15.39877,13.860369],[-15.081735,13.876492],[-14.687031,13.630357],[-14.376714,13.62568],[-14.046992,13.794068],[-13.844963,13.505042],[-14.277702,13.280585],[-14.712197,13.298207],[-15.141163,13.509512],[-15.511813,13.27857],[-15.691001,13.270353],[-15.931296,13.130284],[-16.841525,13.151394]]]}},{type:"Feature",id:"GNB",properties:{name:"Guinea Bissau"},geometry:{type:"Polygon",coordinates:[[[-15.130311,11.040412],[-15.66418,11.458474],[-16.085214,11.524594],[-16.314787,11.806515],[-16.308947,11.958702],[-16.613838,12.170911],[-16.677452,12.384852],[-16.147717,12.547762],[-15.816574,12.515567],[-15.548477,12.62817],[-13.700476,12.586183],[-13.718744,12.247186],[-13.828272,12.142644],[-13.743161,11.811269],[-13.9008,11.678719],[-14.121406,11.677117],[-14.382192,11.509272],[-14.685687,11.527824],[-15.130311,11.040412]]]}},{type:"Feature",id:"GNQ",properties:{name:"Equatorial Guinea"},geometry:{type:"Polygon",coordinates:[[[9.492889,1.01012],[9.305613,1.160911],[9.649158,2.283866],[11.276449,2.261051],[11.285079,1.057662],[9.830284,1.067894],[9.492889,1.01012]]]}},{type:"Feature",id:"GRC",properties:{name:"Greece"},geometry:{type:"MultiPolygon",coordinates:[[[[23.69998,35.705004],[24.246665,35.368022],[25.025015,35.424996],[25.769208,35.354018],[25.745023,35.179998],[26.290003,35.29999],[26.164998,35.004995],[24.724982,34.919988],[24.735007,35.084991],[23.514978,35.279992],[23.69998,35.705004]]],[[[26.604196,41.562115],[26.294602,40.936261],[26.056942,40.824123],[25.447677,40.852545],[24.925848,40.947062],[23.714811,40.687129],[24.407999,40.124993],[23.899968,39.962006],[23.342999,39.960998],[22.813988,40.476005],[22.626299,40.256561],[22.849748,39.659311],[23.350027,39.190011],[22.973099,38.970903],[23.530016,38.510001],[24.025025,38.219993],[24.040011,37.655015],[23.115003,37.920011],[23.409972,37.409991],[22.774972,37.30501],[23.154225,36.422506],[22.490028,36.41],[21.670026,36.844986],[21.295011,37.644989],[21.120034,38.310323],[20.730032,38.769985],[20.217712,39.340235],[20.150016,39.624998],[20.615,40.110007],[20.674997,40.435],[20.99999,40.580004],[21.02004,40.842727],[21.674161,40.931275],[22.055378,41.149866],[22.597308,41.130487],[22.76177,41.3048],[22.952377,41.337994],[23.692074,41.309081],[24.492645,41.583896],[25.197201,41.234486],[26.106138,41.328899],[26.117042,41.826905],[26.604196,41.562115]]]]}},{type:"Feature",id:"GRL",properties:{name:"Greenland"},geometry:{type:"Polygon",coordinates:[[[-46.76379,82.62796],[-43.40644,83.22516],[-39.89753,83.18018],[-38.62214,83.54905],[-35.08787,83.64513],[-27.10046,83.51966],[-20.84539,82.72669],[-22.69182,82.34165],[-26.51753,82.29765],[-31.9,82.2],[-31.39646,82.02154],[-27.85666,82.13178],[-24.84448,81.78697],[-22.90328,82.09317],[-22.07175,81.73449],[-23.16961,81.15271],[-20.62363,81.52462],[-15.76818,81.91245],[-12.77018,81.71885],[-12.20855,81.29154],[-16.28533,80.58004],[-16.85,80.35],[-20.04624,80.17708],[-17.73035,80.12912],[-18.9,79.4],[-19.70499,78.75128],[-19.67353,77.63859],[-18.47285,76.98565],[-20.03503,76.94434],[-21.67944,76.62795],[-19.83407,76.09808],[-19.59896,75.24838],[-20.66818,75.15585],[-19.37281,74.29561],[-21.59422,74.22382],[-20.43454,73.81713],[-20.76234,73.46436],[-22.17221,73.30955],[-23.56593,73.30663],[-22.31311,72.62928],[-22.29954,72.18409],[-24.27834,72.59788],[-24.79296,72.3302],[-23.44296,72.08016],[-22.13281,71.46898],[-21.75356,70.66369],[-23.53603,70.471],[-24.30702,70.85649],[-25.54341,71.43094],[-25.20135,70.75226],[-26.36276,70.22646],[-23.72742,70.18401],[-22.34902,70.12946],[-25.02927,69.2588],[-27.74737,68.47046],[-30.67371,68.12503],[-31.77665,68.12078],[-32.81105,67.73547],[-34.20196,66.67974],[-36.35284,65.9789],[-37.04378,65.93768],[-38.37505,65.69213],[-39.81222,65.45848],[-40.66899,64.83997],[-40.68281,64.13902],[-41.1887,63.48246],[-42.81938,62.68233],[-42.41666,61.90093],[-42.86619,61.07404],[-43.3784,60.09772],[-44.7875,60.03676],[-46.26364,60.85328],[-48.26294,60.85843],[-49.23308,61.40681],[-49.90039,62.38336],[-51.63325,63.62691],[-52.14014,64.27842],[-52.27659,65.1767],[-53.66166,66.09957],[-53.30161,66.8365],[-53.96911,67.18899],[-52.9804,68.35759],[-51.47536,68.72958],[-51.08041,69.14781],[-50.87122,69.9291],[-52.013585,69.574925],[-52.55792,69.42616],[-53.45629,69.283625],[-54.68336,69.61003],[-54.75001,70.28932],[-54.35884,70.821315],[-53.431315,70.835755],[-51.39014,70.56978],[-53.10937,71.20485],[-54.00422,71.54719],[-55,71.406537],[-55.83468,71.65444],[-54.71819,72.58625],[-55.32634,72.95861],[-56.12003,73.64977],[-57.32363,74.71026],[-58.59679,75.09861],[-58.58516,75.51727],[-61.26861,76.10238],[-63.39165,76.1752],[-66.06427,76.13486],[-68.50438,76.06141],[-69.66485,76.37975],[-71.40257,77.00857],[-68.77671,77.32312],[-66.76397,77.37595],[-71.04293,77.63595],[-73.297,78.04419],[-73.15938,78.43271],[-69.37345,78.91388],[-65.7107,79.39436],[-65.3239,79.75814],[-68.02298,80.11721],[-67.15129,80.51582],[-63.68925,81.21396],[-62.23444,81.3211],[-62.65116,81.77042],[-60.28249,82.03363],[-57.20744,82.19074],[-54.13442,82.19962],[-53.04328,81.88833],[-50.39061,82.43883],[-48.00386,82.06481],[-46.59984,81.985945],[-44.523,81.6607],[-46.9007,82.19979],[-46.76379,82.62796]]]}},{type:"Feature",id:"GTM",properties:{name:"Guatemala"},geometry:{type:"Polygon",coordinates:[[[-90.095555,13.735338],[-90.608624,13.909771],[-91.23241,13.927832],[-91.689747,14.126218],[-92.22775,14.538829],[-92.20323,14.830103],[-92.087216,15.064585],[-92.229249,15.251447],[-91.74796,16.066565],[-90.464473,16.069562],[-90.438867,16.41011],[-90.600847,16.470778],[-90.711822,16.687483],[-91.08167,16.918477],[-91.453921,17.252177],[-91.002269,17.254658],[-91.00152,17.817595],[-90.067934,17.819326],[-89.14308,17.808319],[-89.150806,17.015577],[-89.229122,15.886938],[-88.930613,15.887273],[-88.604586,15.70638],[-88.518364,15.855389],[-88.225023,15.727722],[-88.68068,15.346247],[-89.154811,15.066419],[-89.22522,14.874286],[-89.145535,14.678019],[-89.353326,14.424133],[-89.587343,14.362586],[-89.534219,14.244816],[-89.721934,14.134228],[-90.064678,13.88197],[-90.095555,13.735338]]]}},{type:"Feature",id:"GUF",properties:{name:"French Guiana"},geometry:{type:"Polygon",coordinates:[[[-52.556425,2.504705],[-52.939657,2.124858],[-53.418465,2.053389],[-53.554839,2.334897],[-53.778521,2.376703],[-54.088063,2.105557],[-54.524754,2.311849],[-54.27123,2.738748],[-54.184284,3.194172],[-54.011504,3.62257],[-54.399542,4.212611],[-54.478633,4.896756],[-53.958045,5.756548],[-53.618453,5.646529],[-52.882141,5.409851],[-51.823343,4.565768],[-51.657797,4.156232],[-52.249338,3.241094],[-52.556425,2.504705]]]}},{type:"Feature",id:"GUY",properties:{name:"Guyana"},geometry:{type:"Polygon",coordinates:[[[-59.758285,8.367035],[-59.101684,7.999202],[-58.482962,7.347691],[-58.454876,6.832787],[-58.078103,6.809094],[-57.542219,6.321268],[-57.147436,5.97315],[-57.307246,5.073567],[-57.914289,4.812626],[-57.86021,4.576801],[-58.044694,4.060864],[-57.601569,3.334655],[-57.281433,3.333492],[-57.150098,2.768927],[-56.539386,1.899523],[-56.782704,1.863711],[-57.335823,1.948538],[-57.660971,1.682585],[-58.11345,1.507195],[-58.429477,1.463942],[-58.540013,1.268088],[-59.030862,1.317698],[-59.646044,1.786894],[-59.718546,2.24963],[-59.974525,2.755233],[-59.815413,3.606499],[-59.53804,3.958803],[-59.767406,4.423503],[-60.111002,4.574967],[-59.980959,5.014061],[-60.213683,5.244486],[-60.733574,5.200277],[-61.410303,5.959068],[-61.139415,6.234297],[-61.159336,6.696077],[-60.543999,6.856584],[-60.295668,7.043911],[-60.637973,7.415],[-60.550588,7.779603],[-59.758285,8.367035]]]}},{type:"Feature",id:"HND",properties:{name:"Honduras"},geometry:{type:"Polygon",coordinates:[[[-87.316654,12.984686],[-87.489409,13.297535],[-87.793111,13.38448],[-87.723503,13.78505],[-87.859515,13.893312],[-88.065343,13.964626],[-88.503998,13.845486],[-88.541231,13.980155],[-88.843073,14.140507],[-89.058512,14.340029],[-89.353326,14.424133],[-89.145535,14.678019],[-89.22522,14.874286],[-89.154811,15.066419],[-88.68068,15.346247],[-88.225023,15.727722],[-88.121153,15.688655],[-87.901813,15.864458],[-87.61568,15.878799],[-87.522921,15.797279],[-87.367762,15.84694],[-86.903191,15.756713],[-86.440946,15.782835],[-86.119234,15.893449],[-86.001954,16.005406],[-85.683317,15.953652],[-85.444004,15.885749],[-85.182444,15.909158],[-84.983722,15.995923],[-84.52698,15.857224],[-84.368256,15.835158],[-84.063055,15.648244],[-83.773977,15.424072],[-83.410381,15.270903],[-83.147219,14.995829],[-83.489989,15.016267],[-83.628585,14.880074],[-83.975721,14.749436],[-84.228342,14.748764],[-84.449336,14.621614],[-84.649582,14.666805],[-84.820037,14.819587],[-84.924501,14.790493],[-85.052787,14.551541],[-85.148751,14.560197],[-85.165365,14.35437],[-85.514413,14.079012],[-85.698665,13.960078],[-85.801295,13.836055],[-86.096264,14.038187],[-86.312142,13.771356],[-86.520708,13.778487],[-86.755087,13.754845],[-86.733822,13.263093],[-86.880557,13.254204],[-87.005769,13.025794],[-87.316654,12.984686]]]}},{type:"Feature",id:"HRV",properties:{name:"Croatia"},geometry:{type:"Polygon",coordinates:[[[18.829838,45.908878],[19.072769,45.521511],[19.390476,45.236516],[19.005486,44.860234],[18.553214,45.08159],[17.861783,45.06774],[17.002146,45.233777],[16.534939,45.211608],[16.318157,45.004127],[15.959367,45.233777],[15.750026,44.818712],[16.23966,44.351143],[16.456443,44.04124],[16.916156,43.667722],[17.297373,43.446341],[17.674922,43.028563],[18.56,42.65],[18.450016,42.479991],[17.50997,42.849995],[16.930006,43.209998],[16.015385,43.507215],[15.174454,44.243191],[15.37625,44.317915],[14.920309,44.738484],[14.901602,45.07606],[14.258748,45.233777],[13.952255,44.802124],[13.656976,45.136935],[13.679403,45.484149],[13.71506,45.500324],[14.411968,45.466166],[14.595109,45.634941],[14.935244,45.471695],[15.327675,45.452316],[15.323954,45.731783],[15.67153,45.834154],[15.768733,46.238108],[16.564808,46.503751],[16.882515,46.380632],[17.630066,45.951769],[18.456062,45.759481],[18.829838,45.908878]]]}},{type:"Feature",id:"HTI",properties:{name:"Haiti"},geometry:{type:"Polygon",coordinates:[[[-73.189791,19.915684],[-72.579673,19.871501],[-71.712361,19.714456],[-71.624873,19.169838],[-71.701303,18.785417],[-71.945112,18.6169],[-71.687738,18.31666],[-71.708305,18.044997],[-72.372476,18.214961],[-72.844411,18.145611],[-73.454555,18.217906],[-73.922433,18.030993],[-74.458034,18.34255],[-74.369925,18.664908],[-73.449542,18.526053],[-72.694937,18.445799],[-72.334882,18.668422],[-72.79165,19.101625],[-72.784105,19.483591],[-73.415022,19.639551],[-73.189791,19.915684]]]}},{type:"Feature",id:"HUN",properties:{name:"Hungary"},geometry:{type:"Polygon",coordinates:[[[16.202298,46.852386],[16.534268,47.496171],[16.340584,47.712902],[16.903754,47.714866],[16.979667,48.123497],[17.488473,47.867466],[17.857133,47.758429],[18.696513,47.880954],[18.777025,48.081768],[19.174365,48.111379],[19.661364,48.266615],[19.769471,48.202691],[20.239054,48.327567],[20.473562,48.56285],[20.801294,48.623854],[21.872236,48.319971],[22.085608,48.422264],[22.64082,48.15024],[22.710531,47.882194],[22.099768,47.672439],[21.626515,46.994238],[21.021952,46.316088],[20.220192,46.127469],[19.596045,46.17173],[18.829838,45.908878],[18.456062,45.759481],[17.630066,45.951769],[16.882515,46.380632],[16.564808,46.503751],[16.370505,46.841327],[16.202298,46.852386]]]}},{type:"Feature",id:"IDN",properties:{name:"Indonesia"},geometry:{type:"MultiPolygon",coordinates:[[[[120.715609,-10.239581],[120.295014,-10.25865],[118.967808,-9.557969],[119.90031,-9.36134],[120.425756,-9.665921],[120.775502,-9.969675],[120.715609,-10.239581]]],[[[124.43595,-10.140001],[123.579982,-10.359987],[123.459989,-10.239995],[123.550009,-9.900016],[123.980009,-9.290027],[124.968682,-8.89279],[125.07002,-9.089987],[125.08852,-9.393173],[124.43595,-10.140001]]],[[[117.900018,-8.095681],[118.260616,-8.362383],[118.87846,-8.280683],[119.126507,-8.705825],[117.970402,-8.906639],[117.277731,-9.040895],[116.740141,-9.032937],[117.083737,-8.457158],[117.632024,-8.449303],[117.900018,-8.095681]]],[[[122.903537,-8.094234],[122.756983,-8.649808],[121.254491,-8.933666],[119.924391,-8.810418],[119.920929,-8.444859],[120.715092,-8.236965],[121.341669,-8.53674],[122.007365,-8.46062],[122.903537,-8.094234]]],[[[108.623479,-6.777674],[110.539227,-6.877358],[110.759576,-6.465186],[112.614811,-6.946036],[112.978768,-7.594213],[114.478935,-7.776528],[115.705527,-8.370807],[114.564511,-8.751817],[113.464734,-8.348947],[112.559672,-8.376181],[111.522061,-8.302129],[110.58615,-8.122605],[109.427667,-7.740664],[108.693655,-7.6416],[108.277763,-7.766657],[106.454102,-7.3549],[106.280624,-6.9249],[105.365486,-6.851416],[106.051646,-5.895919],[107.265009,-5.954985],[108.072091,-6.345762],[108.486846,-6.421985],[108.623479,-6.777674]]],[[[134.724624,-6.214401],[134.210134,-6.895238],[134.112776,-6.142467],[134.290336,-5.783058],[134.499625,-5.445042],[134.727002,-5.737582],[134.724624,-6.214401]]],[[[127.249215,-3.459065],[126.874923,-3.790983],[126.183802,-3.607376],[125.989034,-3.177273],[127.000651,-3.129318],[127.249215,-3.459065]]],[[[130.471344,-3.093764],[130.834836,-3.858472],[129.990547,-3.446301],[129.155249,-3.362637],[128.590684,-3.428679],[127.898891,-3.393436],[128.135879,-2.84365],[129.370998,-2.802154],[130.471344,-3.093764]]],[[[134.143368,-1.151867],[134.422627,-2.769185],[135.457603,-3.367753],[136.293314,-2.307042],[137.440738,-1.703513],[138.329727,-1.702686],[139.184921,-2.051296],[139.926684,-2.409052],[141.00021,-2.600151],[141.017057,-5.859022],[141.033852,-9.117893],[140.143415,-8.297168],[139.127767,-8.096043],[138.881477,-8.380935],[137.614474,-8.411683],[138.039099,-7.597882],[138.668621,-7.320225],[138.407914,-6.232849],[137.92784,-5.393366],[135.98925,-4.546544],[135.164598,-4.462931],[133.66288,-3.538853],[133.367705,-4.024819],[132.983956,-4.112979],[132.756941,-3.746283],[132.753789,-3.311787],[131.989804,-2.820551],[133.066845,-2.460418],[133.780031,-2.479848],[133.696212,-2.214542],[132.232373,-2.212526],[131.836222,-1.617162],[130.94284,-1.432522],[130.519558,-0.93772],[131.867538,-0.695461],[132.380116,-0.369538],[133.985548,-0.78021],[134.143368,-1.151867]]],[[[125.240501,1.419836],[124.437035,.427881],[123.685505,.235593],[122.723083,.431137],[121.056725,.381217],[120.183083,.237247],[120.04087,-0.519658],[120.935905,-1.408906],[121.475821,-0.955962],[123.340565,-0.615673],[123.258399,-1.076213],[122.822715,-0.930951],[122.38853,-1.516858],[121.508274,-1.904483],[122.454572,-3.186058],[122.271896,-3.5295],[123.170963,-4.683693],[123.162333,-5.340604],[122.628515,-5.634591],[122.236394,-5.282933],[122.719569,-4.464172],[121.738234,-4.851331],[121.489463,-4.574553],[121.619171,-4.188478],[120.898182,-3.602105],[120.972389,-2.627643],[120.305453,-2.931604],[120.390047,-4.097579],[120.430717,-5.528241],[119.796543,-5.6734],[119.366906,-5.379878],[119.653606,-4.459417],[119.498835,-3.494412],[119.078344,-3.487022],[118.767769,-2.801999],[119.180974,-2.147104],[119.323394,-1.353147],[119.825999,.154254],[120.035702,.566477],[120.885779,1.309223],[121.666817,1.013944],[122.927567,.875192],[124.077522,.917102],[125.065989,1.643259],[125.240501,1.419836]]],[[[128.688249,1.132386],[128.635952,.258486],[128.12017,.356413],[127.968034,-0.252077],[128.379999,-0.780004],[128.100016,-0.899996],[127.696475,-0.266598],[127.39949,1.011722],[127.600512,1.810691],[127.932378,2.174596],[128.004156,1.628531],[128.594559,1.540811],[128.688249,1.132386]]],[[[117.875627,1.827641],[118.996747,.902219],[117.811858,.784242],[117.478339,.102475],[117.521644,-0.803723],[116.560048,-1.487661],[116.533797,-2.483517],[116.148084,-4.012726],[116.000858,-3.657037],[114.864803,-4.106984],[114.468652,-3.495704],[113.755672,-3.43917],[113.256994,-3.118776],[112.068126,-3.478392],[111.703291,-2.994442],[111.04824,-3.049426],[110.223846,-2.934032],[110.070936,-1.592874],[109.571948,-1.314907],[109.091874,-0.459507],[108.952658,.415375],[109.069136,1.341934],[109.66326,2.006467],[109.830227,1.338136],[110.514061,.773131],[111.159138,.976478],[111.797548,.904441],[112.380252,1.410121],[112.859809,1.49779],[113.80585,1.217549],[114.621355,1.430688],[115.134037,2.821482],[115.519078,3.169238],[115.865517,4.306559],[117.015214,4.306094],[117.882035,4.137551],[117.313232,3.234428],[118.04833,2.28769],[117.875627,1.827641]]],[[[105.817655,-5.852356],[104.710384,-5.873285],[103.868213,-5.037315],[102.584261,-4.220259],[102.156173,-3.614146],[101.399113,-2.799777],[100.902503,-2.050262],[100.141981,-0.650348],[99.26374,.183142],[98.970011,1.042882],[98.601351,1.823507],[97.699598,2.453184],[97.176942,3.308791],[96.424017,3.86886],[95.380876,4.970782],[95.293026,5.479821],[95.936863,5.439513],[97.484882,5.246321],[98.369169,4.26837],[99.142559,3.59035],[99.693998,3.174329],[100.641434,2.099381],[101.658012,2.083697],[102.498271,1.3987],[103.07684,.561361],[103.838396,.104542],[103.437645,-0.711946],[104.010789,-1.059212],[104.369991,-1.084843],[104.53949,-1.782372],[104.887893,-2.340425],[105.622111,-2.428844],[106.108593,-3.061777],[105.857446,-4.305525],[105.817655,-5.852356]]]]}},{type:"Feature",id:"IND",properties:{name:"India"},geometry:{type:"Polygon",coordinates:[[[77.837451,35.49401],[78.912269,34.321936],[78.811086,33.506198],[79.208892,32.994395],[79.176129,32.48378],[78.458446,32.618164],[78.738894,31.515906],[79.721367,30.882715],[81.111256,30.183481],[80.476721,29.729865],[80.088425,28.79447],[81.057203,28.416095],[81.999987,27.925479],[83.304249,27.364506],[84.675018,27.234901],[85.251779,26.726198],[86.024393,26.630985],[87.227472,26.397898],[88.060238,26.414615],[88.174804,26.810405],[88.043133,27.445819],[88.120441,27.876542],[88.730326,28.086865],[88.814248,27.299316],[88.835643,27.098966],[89.744528,26.719403],[90.373275,26.875724],[91.217513,26.808648],[92.033484,26.83831],[92.103712,27.452614],[91.696657,27.771742],[92.503119,27.896876],[93.413348,28.640629],[94.56599,29.277438],[95.404802,29.031717],[96.117679,29.452802],[96.586591,28.83098],[96.248833,28.411031],[97.327114,28.261583],[97.402561,27.882536],[97.051989,27.699059],[97.133999,27.083774],[96.419366,27.264589],[95.124768,26.573572],[95.155153,26.001307],[94.603249,25.162495],[94.552658,24.675238],[94.106742,23.850741],[93.325188,24.078556],[93.286327,23.043658],[93.060294,22.703111],[93.166128,22.27846],[92.672721,22.041239],[92.146035,23.627499],[91.869928,23.624346],[91.706475,22.985264],[91.158963,23.503527],[91.46773,24.072639],[91.915093,24.130414],[92.376202,24.976693],[91.799596,25.147432],[90.872211,25.132601],[89.920693,25.26975],[89.832481,25.965082],[89.355094,26.014407],[88.563049,26.446526],[88.209789,25.768066],[88.931554,25.238692],[88.306373,24.866079],[88.084422,24.501657],[88.69994,24.233715],[88.52977,23.631142],[88.876312,22.879146],[89.031961,22.055708],[88.888766,21.690588],[88.208497,21.703172],[86.975704,21.495562],[87.033169,20.743308],[86.499351,20.151638],[85.060266,19.478579],[83.941006,18.30201],[83.189217,17.671221],[82.192792,17.016636],[82.191242,16.556664],[81.692719,16.310219],[80.791999,15.951972],[80.324896,15.899185],[80.025069,15.136415],[80.233274,13.835771],[80.286294,13.006261],[79.862547,12.056215],[79.857999,10.357275],[79.340512,10.308854],[78.885345,9.546136],[79.18972,9.216544],[78.277941,8.933047],[77.941165,8.252959],[77.539898,7.965535],[76.592979,8.899276],[76.130061,10.29963],[75.746467,11.308251],[75.396101,11.781245],[74.864816,12.741936],[74.616717,13.992583],[74.443859,14.617222],[73.534199,15.990652],[73.119909,17.92857],[72.820909,19.208234],[72.824475,20.419503],[72.630533,21.356009],[71.175273,20.757441],[70.470459,20.877331],[69.16413,22.089298],[69.644928,22.450775],[69.349597,22.84318],[68.176645,23.691965],[68.842599,24.359134],[71.04324,24.356524],[70.844699,25.215102],[70.282873,25.722229],[70.168927,26.491872],[69.514393,26.940966],[70.616496,27.989196],[71.777666,27.91318],[72.823752,28.961592],[73.450638,29.976413],[74.42138,30.979815],[74.405929,31.692639],[75.258642,32.271105],[74.451559,32.7649],[74.104294,33.441473],[73.749948,34.317699],[74.240203,34.748887],[75.757061,34.504923],[76.871722,34.653544],[77.837451,35.49401]]]}},{type:"Feature",id:"IRL",properties:{name:"Ireland"},geometry:{type:"Polygon",coordinates:[[[-6.197885,53.867565],[-6.032985,53.153164],[-6.788857,52.260118],[-8.561617,51.669301],[-9.977086,51.820455],[-9.166283,52.864629],[-9.688525,53.881363],[-8.327987,54.664519],[-7.572168,55.131622],[-7.366031,54.595841],[-7.572168,54.059956],[-6.95373,54.073702],[-6.197885,53.867565]]]}},{type:"Feature",id:"IRN",properties:{name:"Iran"},geometry:{type:"Polygon",coordinates:[[[53.921598,37.198918],[54.800304,37.392421],[55.511578,37.964117],[56.180375,37.935127],[56.619366,38.121394],[57.330434,38.029229],[58.436154,37.522309],[59.234762,37.412988],[60.377638,36.527383],[61.123071,36.491597],[61.210817,35.650072],[60.803193,34.404102],[60.52843,33.676446],[60.9637,33.528832],[60.536078,32.981269],[60.863655,32.18292],[60.941945,31.548075],[61.699314,31.379506],[61.781222,30.73585],[60.874248,29.829239],[61.369309,29.303276],[61.771868,28.699334],[62.72783,28.259645],[62.755426,27.378923],[63.233898,27.217047],[63.316632,26.756532],[61.874187,26.239975],[61.497363,25.078237],[59.616134,25.380157],[58.525761,25.609962],[57.397251,25.739902],[56.970766,26.966106],[56.492139,27.143305],[55.72371,26.964633],[54.71509,26.480658],[53.493097,26.812369],[52.483598,27.580849],[51.520763,27.86569],[50.852948,28.814521],[50.115009,30.147773],[49.57685,29.985715],[48.941333,30.31709],[48.567971,29.926778],[48.014568,30.452457],[48.004698,30.985137],[47.685286,30.984853],[47.849204,31.709176],[47.334661,32.469155],[46.109362,33.017287],[45.416691,33.967798],[45.64846,34.748138],[46.151788,35.093259],[46.07634,35.677383],[45.420618,35.977546],[44.77267,37.17045],[44.225756,37.971584],[44.421403,38.281281],[44.109225,39.428136],[44.79399,39.713003],[44.952688,39.335765],[45.457722,38.874139],[46.143623,38.741201],[46.50572,38.770605],[47.685079,39.508364],[48.060095,39.582235],[48.355529,39.288765],[48.010744,38.794015],[48.634375,38.270378],[48.883249,38.320245],[49.199612,37.582874],[50.147771,37.374567],[50.842354,36.872814],[52.264025,36.700422],[53.82579,36.965031],[53.921598,37.198918]]]}},{type:"Feature",id:"IRQ",properties:{name:"Iraq"},geometry:{type:"Polygon",coordinates:[[[45.420618,35.977546],[46.07634,35.677383],[46.151788,35.093259],[45.64846,34.748138],[45.416691,33.967798],[46.109362,33.017287],[47.334661,32.469155],[47.849204,31.709176],[47.685286,30.984853],[48.004698,30.985137],[48.014568,30.452457],[48.567971,29.926778],[47.974519,29.975819],[47.302622,30.05907],[46.568713,29.099025],[44.709499,29.178891],[41.889981,31.190009],[40.399994,31.889992],[39.195468,32.161009],[38.792341,33.378686],[41.006159,34.419372],[41.383965,35.628317],[41.289707,36.358815],[41.837064,36.605854],[42.349591,37.229873],[42.779126,37.385264],[43.942259,37.256228],[44.293452,37.001514],[44.772699,37.170445],[45.420618,35.977546]]]}},{type:"Feature",id:"ISL",properties:{name:"Iceland"},geometry:{type:"Polygon",coordinates:[[[-14.508695,66.455892],[-14.739637,65.808748],[-13.609732,65.126671],[-14.909834,64.364082],[-17.794438,63.678749],[-18.656246,63.496383],[-19.972755,63.643635],[-22.762972,63.960179],[-21.778484,64.402116],[-23.955044,64.89113],[-22.184403,65.084968],[-22.227423,65.378594],[-24.326184,65.611189],[-23.650515,66.262519],[-22.134922,66.410469],[-20.576284,65.732112],[-19.056842,66.276601],[-17.798624,65.993853],[-16.167819,66.526792],[-14.508695,66.455892]]]}},{type:"Feature",id:"ISR",properties:{name:"Israel"},geometry:{type:"Polygon",coordinates:[[[35.719918,32.709192],[35.545665,32.393992],[35.18393,32.532511],[34.974641,31.866582],[35.225892,31.754341],[34.970507,31.616778],[34.927408,31.353435],[35.397561,31.489086],[35.420918,31.100066],[34.922603,29.501326],[34.265433,31.219361],[34.556372,31.548824],[34.488107,31.605539],[34.752587,32.072926],[34.955417,32.827376],[35.098457,33.080539],[35.126053,33.0909],[35.460709,33.08904],[35.552797,33.264275],[35.821101,33.277426],[35.836397,32.868123],[35.700798,32.716014],[35.719918,32.709192]]]}},{type:"Feature",id:"ITA",properties:{name:"Italy"},geometry:{type:"MultiPolygon",coordinates:[[[[15.520376,38.231155],[15.160243,37.444046],[15.309898,37.134219],[15.099988,36.619987],[14.335229,36.996631],[13.826733,37.104531],[12.431004,37.61295],[12.570944,38.126381],[13.741156,38.034966],[14.761249,38.143874],[15.520376,38.231155]]],[[[9.210012,41.209991],[9.809975,40.500009],[9.669519,39.177376],[9.214818,39.240473],[8.806936,38.906618],[8.428302,39.171847],[8.388253,40.378311],[8.159998,40.950007],[8.709991,40.899984],[9.210012,41.209991]]],[[[12.376485,46.767559],[13.806475,46.509306],[13.69811,46.016778],[13.93763,45.591016],[13.141606,45.736692],[12.328581,45.381778],[12.383875,44.885374],[12.261453,44.600482],[12.589237,44.091366],[13.526906,43.587727],[14.029821,42.761008],[15.14257,41.95514],[15.926191,41.961315],[16.169897,41.740295],[15.889346,41.541082],[16.785002,41.179606],[17.519169,40.877143],[18.376687,40.355625],[18.480247,40.168866],[18.293385,39.810774],[17.73838,40.277671],[16.869596,40.442235],[16.448743,39.795401],[17.17149,39.4247],[17.052841,38.902871],[16.635088,38.843572],[16.100961,37.985899],[15.684087,37.908849],[15.687963,38.214593],[15.891981,38.750942],[16.109332,38.964547],[15.718814,39.544072],[15.413613,40.048357],[14.998496,40.172949],[14.703268,40.60455],[14.060672,40.786348],[13.627985,41.188287],[12.888082,41.25309],[12.106683,41.704535],[11.191906,42.355425],[10.511948,42.931463],[10.200029,43.920007],[9.702488,44.036279],[8.888946,44.366336],[8.428561,44.231228],[7.850767,43.767148],[7.435185,43.693845],[7.549596,44.127901],[7.007562,44.254767],[6.749955,45.028518],[7.096652,45.333099],[6.802355,45.70858],[6.843593,45.991147],[7.273851,45.776948],[7.755992,45.82449],[8.31663,46.163642],[8.489952,46.005151],[8.966306,46.036932],[9.182882,46.440215],[9.922837,46.314899],[10.363378,46.483571],[10.442701,46.893546],[11.048556,46.751359],[11.164828,46.941579],[12.153088,47.115393],[12.376485,46.767559]]]]}},{type:"Feature",id:"JAM",properties:{name:"Jamaica"},geometry:{type:"Polygon",coordinates:[[[-77.569601,18.490525],[-76.896619,18.400867],[-76.365359,18.160701],[-76.199659,17.886867],[-76.902561,17.868238],[-77.206341,17.701116],[-77.766023,17.861597],[-78.337719,18.225968],[-78.217727,18.454533],[-77.797365,18.524218],[-77.569601,18.490525]]]}},{type:"Feature",id:"JOR",properties:{name:"Jordan"},geometry:{type:"Polygon",coordinates:[[[35.545665,32.393992],[35.719918,32.709192],[36.834062,32.312938],[38.792341,33.378686],[39.195468,32.161009],[39.004886,32.010217],[37.002166,31.508413],[37.998849,30.5085],[37.66812,30.338665],[37.503582,30.003776],[36.740528,29.865283],[36.501214,29.505254],[36.068941,29.197495],[34.956037,29.356555],[34.922603,29.501326],[35.420918,31.100066],[35.397561,31.489086],[35.545252,31.782505],[35.545665,32.393992]]]}},{type:"Feature",id:"JPN",properties:{name:"Japan"},geometry:{type:"MultiPolygon",coordinates:[[[[134.638428,34.149234],[134.766379,33.806335],[134.203416,33.201178],[133.79295,33.521985],[133.280268,33.28957],[133.014858,32.704567],[132.363115,32.989382],[132.371176,33.463642],[132.924373,34.060299],[133.492968,33.944621],[133.904106,34.364931],[134.638428,34.149234]]],[[[140.976388,37.142074],[140.59977,36.343983],[140.774074,35.842877],[140.253279,35.138114],[138.975528,34.6676],[137.217599,34.606286],[135.792983,33.464805],[135.120983,33.849071],[135.079435,34.596545],[133.340316,34.375938],[132.156771,33.904933],[130.986145,33.885761],[132.000036,33.149992],[131.33279,31.450355],[130.686318,31.029579],[130.20242,31.418238],[130.447676,32.319475],[129.814692,32.61031],[129.408463,33.296056],[130.353935,33.604151],[130.878451,34.232743],[131.884229,34.749714],[132.617673,35.433393],[134.608301,35.731618],[135.677538,35.527134],[136.723831,37.304984],[137.390612,36.827391],[138.857602,37.827485],[139.426405,38.215962],[140.05479,39.438807],[139.883379,40.563312],[140.305783,41.195005],[141.368973,41.37856],[141.914263,39.991616],[141.884601,39.180865],[140.959489,38.174001],[140.976388,37.142074]]],[[[143.910162,44.1741],[144.613427,43.960883],[145.320825,44.384733],[145.543137,43.262088],[144.059662,42.988358],[143.18385,41.995215],[141.611491,42.678791],[141.067286,41.584594],[139.955106,41.569556],[139.817544,42.563759],[140.312087,43.333273],[141.380549,43.388825],[141.671952,44.772125],[141.967645,45.551483],[143.14287,44.510358],[143.910162,44.1741]]]]}},{type:"Feature",id:"KAZ",properties:{name:"Kazakhstan"},geometry:{type:"Polygon",coordinates:[[[70.962315,42.266154],[70.388965,42.081308],[69.070027,41.384244],[68.632483,40.668681],[68.259896,40.662325],[67.985856,41.135991],[66.714047,41.168444],[66.510649,41.987644],[66.023392,41.994646],[66.098012,42.99766],[64.900824,43.728081],[63.185787,43.650075],[62.0133,43.504477],[61.05832,44.405817],[60.239972,44.784037],[58.689989,45.500014],[58.503127,45.586804],[55.928917,44.995858],[55.968191,41.308642],[55.455251,41.259859],[54.755345,42.043971],[54.079418,42.324109],[52.944293,42.116034],[52.50246,41.783316],[52.446339,42.027151],[52.692112,42.443895],[52.501426,42.792298],[51.342427,43.132975],[50.891292,44.031034],[50.339129,44.284016],[50.305643,44.609836],[51.278503,44.514854],[51.316899,45.245998],[52.16739,45.408391],[53.040876,45.259047],[53.220866,46.234646],[53.042737,46.853006],[52.042023,46.804637],[51.191945,47.048705],[50.034083,46.60899],[49.10116,46.39933],[48.593241,46.561034],[48.694734,47.075628],[48.057253,47.743753],[47.315231,47.715847],[46.466446,48.394152],[47.043672,49.152039],[46.751596,49.356006],[47.54948,50.454698],[48.577841,49.87476],[48.702382,50.605128],[50.766648,51.692762],[52.328724,51.718652],[54.532878,51.02624],[55.716941,50.621717],[56.777961,51.043551],[58.363291,51.063653],[59.642282,50.545442],[59.932807,50.842194],[61.337424,50.79907],[61.588003,51.272659],[59.967534,51.96042],[60.927269,52.447548],[60.739993,52.719986],[61.699986,52.979996],[60.978066,53.664993],[61.436591,54.006265],[65.178534,54.354228],[65.666876,54.601267],[68.1691,54.970392],[69.068167,55.38525],[70.865267,55.169734],[71.180131,54.133285],[72.22415,54.376655],[73.508516,54.035617],[73.425679,53.48981],[74.384845,53.546861],[76.8911,54.490524],[76.525179,54.177003],[77.800916,53.404415],[80.03556,50.864751],[80.568447,51.388336],[81.945986,50.812196],[83.383004,51.069183],[83.935115,50.889246],[84.416377,50.3114],[85.11556,50.117303],[85.54127,49.692859],[86.829357,49.826675],[87.35997,49.214981],[86.598776,48.549182],[85.768233,48.455751],[85.720484,47.452969],[85.16429,47.000956],[83.180484,47.330031],[82.458926,45.53965],[81.947071,45.317027],[79.966106,44.917517],[80.866206,43.180362],[80.18015,42.920068],[80.25999,42.349999],[79.643645,42.496683],[79.142177,42.856092],[77.658392,42.960686],[76.000354,42.988022],[75.636965,42.8779],[74.212866,43.298339],[73.645304,43.091272],[73.489758,42.500894],[71.844638,42.845395],[71.186281,42.704293],[70.962315,42.266154]]]}},{type:"Feature",id:"KEN",properties:{name:"Kenya"},geometry:{type:"Polygon",coordinates:[[[40.993,-0.85829],[41.58513,-1.68325],[40.88477,-2.08255],[40.63785,-2.49979],[40.26304,-2.57309],[40.12119,-3.27768],[39.80006,-3.68116],[39.60489,-4.34653],[39.20222,-4.67677],[37.7669,-3.67712],[37.69869,-3.09699],[34.07262,-1.05982],[33.903711,-0.95],[33.893569,.109814],[34.18,.515],[34.6721,1.17694],[35.03599,1.90584],[34.59607,3.05374],[34.47913,3.5556],[34.005,4.249885],[34.620196,4.847123],[35.298007,5.506],[35.817448,5.338232],[35.817448,4.776966],[36.159079,4.447864],[36.855093,4.447864],[38.120915,3.598605],[38.43697,3.58851],[38.67114,3.61607],[38.89251,3.50074],[39.559384,3.42206],[39.85494,3.83879],[40.76848,4.25702],[41.1718,3.91909],[41.855083,3.918912],[40.98105,2.78452],[40.993,-0.85829]]]}},{type:"Feature",id:"KGZ",properties:{name:"Kyrgyzstan"},geometry:{type:"Polygon",coordinates:[[[70.962315,42.266154],[71.186281,42.704293],[71.844638,42.845395],[73.489758,42.500894],[73.645304,43.091272],[74.212866,43.298339],[75.636965,42.8779],[76.000354,42.988022],[77.658392,42.960686],[79.142177,42.856092],[79.643645,42.496683],[80.25999,42.349999],[80.11943,42.123941],[78.543661,41.582243],[78.187197,41.185316],[76.904484,41.066486],[76.526368,40.427946],[75.467828,40.562072],[74.776862,40.366425],[73.822244,39.893973],[73.960013,39.660008],[73.675379,39.431237],[71.784694,39.279463],[70.549162,39.604198],[69.464887,39.526683],[69.55961,40.103211],[70.648019,39.935754],[71.014198,40.244366],[71.774875,40.145844],[73.055417,40.866033],[71.870115,41.3929],[71.157859,41.143587],[70.420022,41.519998],[71.259248,42.167711],[70.962315,42.266154]]]}},{type:"Feature",id:"KHM",properties:{name:"Cambodia"},geometry:{type:"Polygon",coordinates:[[[103.49728,10.632555],[103.09069,11.153661],[102.584932,12.186595],[102.348099,13.394247],[102.988422,14.225721],[104.281418,14.416743],[105.218777,14.273212],[106.043946,13.881091],[106.496373,14.570584],[107.382727,14.202441],[107.614548,13.535531],[107.491403,12.337206],[105.810524,11.567615],[106.24967,10.961812],[105.199915,10.88931],[104.334335,10.486544],[103.49728,10.632555]]]}},{type:"Feature",id:"KOR",properties:{name:"South Korea"},geometry:{type:"Polygon",coordinates:[[[128.349716,38.612243],[129.21292,37.432392],[129.46045,36.784189],[129.468304,35.632141],[129.091377,35.082484],[128.18585,34.890377],[127.386519,34.475674],[126.485748,34.390046],[126.37392,34.93456],[126.559231,35.684541],[126.117398,36.725485],[126.860143,36.893924],[126.174759,37.749686],[126.237339,37.840378],[126.68372,37.804773],[127.073309,38.256115],[127.780035,38.304536],[128.205746,38.370397],[128.349716,38.612243]]]}},{type:"Feature",id:"CS-KM",properties:{name:"Kosovo"},geometry:{type:"Polygon",coordinates:[[[20.76216,42.05186],[20.71731,41.84711],[20.59023,41.85541],[20.52295,42.21787],[20.28374,42.32025],[20.0707,42.58863],[20.25758,42.81275],[20.49679,42.88469],[20.63508,43.21671],[20.81448,43.27205],[20.95651,43.13094],[21.143395,43.068685],[21.27421,42.90959],[21.43866,42.86255],[21.63302,42.67717],[21.77505,42.6827],[21.66292,42.43922],[21.54332,42.32025],[21.576636,42.245224],[21.3527,42.2068],[20.76216,42.05186]]]}},{type:"Feature",id:"KWT",properties:{name:"Kuwait"},geometry:{type:"Polygon",coordinates:[[[47.974519,29.975819],[48.183189,29.534477],[48.093943,29.306299],[48.416094,28.552004],[47.708851,28.526063],[47.459822,29.002519],[46.568713,29.099025],[47.302622,30.05907],[47.974519,29.975819]]]}},{type:"Feature",id:"LAO",properties:{name:"Laos"},geometry:{type:"Polygon",coordinates:[[[105.218777,14.273212],[105.544338,14.723934],[105.589039,15.570316],[104.779321,16.441865],[104.716947,17.428859],[103.956477,18.240954],[103.200192,18.309632],[102.998706,17.961695],[102.413005,17.932782],[102.113592,18.109102],[101.059548,17.512497],[101.035931,18.408928],[101.282015,19.462585],[100.606294,19.508344],[100.548881,20.109238],[100.115988,20.41785],[100.329101,20.786122],[101.180005,21.436573],[101.270026,21.201652],[101.80312,21.174367],[101.652018,22.318199],[102.170436,22.464753],[102.754896,21.675137],[103.203861,20.766562],[104.435,20.758733],[104.822574,19.886642],[104.183388,19.624668],[103.896532,19.265181],[105.094598,18.666975],[105.925762,17.485315],[106.556008,16.604284],[107.312706,15.908538],[107.564525,15.202173],[107.382727,14.202441],[106.496373,14.570584],[106.043946,13.881091],[105.218777,14.273212]]]}},{type:"Feature",id:"LBN",properties:{name:"Lebanon"},geometry:{type:"Polygon",coordinates:[[[35.821101,33.277426],[35.552797,33.264275],[35.460709,33.08904],[35.126053,33.0909],[35.482207,33.90545],[35.979592,34.610058],[35.998403,34.644914],[36.448194,34.593935],[36.61175,34.201789],[36.06646,33.824912],[35.821101,33.277426]]]}},{type:"Feature",id:"LBR",properties:{name:"Liberia"},geometry:{type:"Polygon",coordinates:[[[-7.712159,4.364566],[-7.974107,4.355755],[-9.004794,4.832419],[-9.91342,5.593561],[-10.765384,6.140711],[-11.438779,6.785917],[-11.199802,7.105846],[-11.146704,7.396706],[-10.695595,7.939464],[-10.230094,8.406206],[-10.016567,8.428504],[-9.755342,8.541055],[-9.33728,7.928534],[-9.403348,7.526905],[-9.208786,7.313921],[-8.926065,7.309037],[-8.722124,7.711674],[-8.439298,7.686043],[-8.485446,7.395208],[-8.385452,6.911801],[-8.60288,6.467564],[-8.311348,6.193033],[-7.993693,6.12619],[-7.570153,5.707352],[-7.539715,5.313345],[-7.635368,5.188159],[-7.712159,4.364566]]]}},{type:"Feature",id:"LBY",properties:{name:"Libya"},geometry:{type:"Polygon",coordinates:[[[14.8513,22.86295],[14.143871,22.491289],[13.581425,23.040506],[11.999506,23.471668],[11.560669,24.097909],[10.771364,24.562532],[10.303847,24.379313],[9.948261,24.936954],[9.910693,25.365455],[9.319411,26.094325],[9.716286,26.512206],[9.629056,27.140953],[9.756128,27.688259],[9.683885,28.144174],[9.859998,28.95999],[9.805634,29.424638],[9.48214,30.307556],[9.970017,30.539325],[10.056575,30.961831],[9.950225,31.37607],[10.636901,31.761421],[10.94479,32.081815],[11.432253,32.368903],[11.488787,33.136996],[12.66331,32.79278],[13.08326,32.87882],[13.91868,32.71196],[15.24563,32.26508],[15.71394,31.37626],[16.61162,31.18218],[18.02109,30.76357],[19.08641,30.26639],[19.57404,30.52582],[20.05335,30.98576],[19.82033,31.75179],[20.13397,32.2382],[20.85452,32.7068],[21.54298,32.8432],[22.89576,32.63858],[23.2368,32.19149],[23.60913,32.18726],[23.9275,32.01667],[24.92114,31.89936],[25.16482,31.56915],[24.80287,31.08929],[24.95762,30.6616],[24.70007,30.04419],[25,29.238655],[25,25.6825],[25,22],[25,20.00304],[23.85,20],[23.83766,19.58047],[19.84926,21.49509],[15.86085,23.40972],[14.8513,22.86295]]]}},{type:"Feature",id:"LKA",properties:{name:"Sri Lanka"},geometry:{type:"Polygon",coordinates:[[[81.787959,7.523055],[81.637322,6.481775],[81.21802,6.197141],[80.348357,5.96837],[79.872469,6.763463],[79.695167,8.200843],[80.147801,9.824078],[80.838818,9.268427],[81.304319,8.564206],[81.787959,7.523055]]]}},{type:"Feature",id:"LSO",properties:{name:"Lesotho"},geometry:{type:"Polygon",coordinates:[[[28.978263,-28.955597],[29.325166,-29.257387],[29.018415,-29.743766],[28.8484,-30.070051],[28.291069,-30.226217],[28.107205,-30.545732],[27.749397,-30.645106],[26.999262,-29.875954],[27.532511,-29.242711],[28.074338,-28.851469],[28.5417,-28.647502],[28.978263,-28.955597]]]}},{type:"Feature",id:"LTU",properties:{name:"Lithuania"},geometry:{type:"Polygon",coordinates:[[[22.731099,54.327537],[22.651052,54.582741],[22.757764,54.856574],[22.315724,55.015299],[21.268449,55.190482],[21.0558,56.031076],[22.201157,56.337802],[23.878264,56.273671],[24.860684,56.372528],[25.000934,56.164531],[25.533047,56.100297],[26.494331,55.615107],[26.588279,55.167176],[25.768433,54.846963],[25.536354,54.282423],[24.450684,53.905702],[23.484128,53.912498],[23.243987,54.220567],[22.731099,54.327537]]]}},{type:"Feature",id:"LUX",properties:{name:"Luxembourg"},geometry:{type:"Polygon",coordinates:[[[6.043073,50.128052],[6.242751,49.902226],[6.18632,49.463803],[5.897759,49.442667],[5.674052,49.529484],[5.782417,50.090328],[6.043073,50.128052]]]}},{type:"Feature",id:"LVA",properties:{name:"Latvia"},geometry:{type:"Polygon",coordinates:[[[21.0558,56.031076],[21.090424,56.783873],[21.581866,57.411871],[22.524341,57.753374],[23.318453,57.006236],[24.12073,57.025693],[24.312863,57.793424],[25.164594,57.970157],[25.60281,57.847529],[26.463532,57.476389],[27.288185,57.474528],[27.770016,57.244258],[27.855282,56.759326],[28.176709,56.16913],[27.10246,55.783314],[26.494331,55.615107],[25.533047,56.100297],[25.000934,56.164531],[24.860684,56.372528],[23.878264,56.273671],[22.201157,56.337802],[21.0558,56.031076]]]}},{type:"Feature",id:"MAR",properties:{name:"Morocco"},geometry:{type:"Polygon",coordinates:[[[-5.193863,35.755182],[-4.591006,35.330712],[-3.640057,35.399855],[-2.604306,35.179093],[-2.169914,35.168396],[-1.792986,34.527919],[-1.733455,33.919713],[-1.388049,32.864015],[-1.124551,32.651522],[-1.307899,32.262889],[-2.616605,32.094346],[-3.06898,31.724498],[-3.647498,31.637294],[-3.690441,30.896952],[-4.859646,30.501188],[-5.242129,30.000443],[-6.060632,29.7317],[-7.059228,29.579228],[-8.674116,28.841289],[-8.66559,27.656426],[-8.817809,27.656426],[-8.817828,27.656426],[-8.794884,27.120696],[-9.413037,27.088476],[-9.735343,26.860945],[-10.189424,26.860945],[-10.551263,26.990808],[-11.392555,26.883424],[-11.71822,26.104092],[-12.030759,26.030866],[-12.500963,24.770116],[-13.89111,23.691009],[-14.221168,22.310163],[-14.630833,21.86094],[-14.750955,21.5006],[-17.002962,21.420734],[-17.020428,21.42231],[-16.973248,21.885745],[-16.589137,22.158234],[-16.261922,22.67934],[-16.326414,23.017768],[-15.982611,23.723358],[-15.426004,24.359134],[-15.089332,24.520261],[-14.824645,25.103533],[-14.800926,25.636265],[-14.43994,26.254418],[-13.773805,26.618892],[-13.139942,27.640148],[-13.121613,27.654148],[-12.618837,28.038186],[-11.688919,28.148644],[-10.900957,28.832142],[-10.399592,29.098586],[-9.564811,29.933574],[-9.814718,31.177736],[-9.434793,32.038096],[-9.300693,32.564679],[-8.657476,33.240245],[-7.654178,33.697065],[-6.912544,34.110476],[-6.244342,35.145865],[-5.929994,35.759988],[-5.193863,35.755182]]]}},{type:"Feature",id:"MDA",properties:{name:"Moldova"},geometry:{type:"Polygon",coordinates:[[[26.619337,48.220726],[26.857824,48.368211],[27.522537,48.467119],[28.259547,48.155562],[28.670891,48.118149],[29.122698,47.849095],[29.050868,47.510227],[29.415135,47.346645],[29.559674,46.928583],[29.908852,46.674361],[29.83821,46.525326],[30.024659,46.423937],[29.759972,46.349988],[29.170654,46.379262],[29.072107,46.517678],[28.862972,46.437889],[28.933717,46.25883],[28.659987,45.939987],[28.485269,45.596907],[28.233554,45.488283],[28.054443,45.944586],[28.160018,46.371563],[28.12803,46.810476],[27.551166,47.405117],[27.233873,47.826771],[26.924176,48.123264],[26.619337,48.220726]]]}},{type:"Feature",id:"MDG",properties:{name:"Madagascar"},geometry:{type:"Polygon",coordinates:[[[49.543519,-12.469833],[49.808981,-12.895285],[50.056511,-13.555761],[50.217431,-14.758789],[50.476537,-15.226512],[50.377111,-15.706069],[50.200275,-16.000263],[49.860606,-15.414253],[49.672607,-15.710204],[49.863344,-16.451037],[49.774564,-16.875042],[49.498612,-17.106036],[49.435619,-17.953064],[49.041792,-19.118781],[48.548541,-20.496888],[47.930749,-22.391501],[47.547723,-23.781959],[47.095761,-24.94163],[46.282478,-25.178463],[45.409508,-25.601434],[44.833574,-25.346101],[44.03972,-24.988345],[43.763768,-24.460677],[43.697778,-23.574116],[43.345654,-22.776904],[43.254187,-22.057413],[43.433298,-21.336475],[43.893683,-21.163307],[43.89637,-20.830459],[44.374325,-20.072366],[44.464397,-19.435454],[44.232422,-18.961995],[44.042976,-18.331387],[43.963084,-17.409945],[44.312469,-16.850496],[44.446517,-16.216219],[44.944937,-16.179374],[45.502732,-15.974373],[45.872994,-15.793454],[46.312243,-15.780018],[46.882183,-15.210182],[47.70513,-14.594303],[48.005215,-14.091233],[47.869047,-13.663869],[48.293828,-13.784068],[48.84506,-13.089175],[48.863509,-12.487868],[49.194651,-12.040557],[49.543519,-12.469833]]]}},{type:"Feature",id:"MEX",properties:{name:"Mexico"},geometry:{type:"Polygon",coordinates:[[[-97.140008,25.869997],[-97.528072,24.992144],[-97.702946,24.272343],[-97.776042,22.93258],[-97.872367,22.444212],[-97.699044,21.898689],[-97.38896,21.411019],[-97.189333,20.635433],[-96.525576,19.890931],[-96.292127,19.320371],[-95.900885,18.828024],[-94.839063,18.562717],[-94.42573,18.144371],[-93.548651,18.423837],[-92.786114,18.524839],[-92.037348,18.704569],[-91.407903,18.876083],[-90.77187,19.28412],[-90.53359,19.867418],[-90.451476,20.707522],[-90.278618,20.999855],[-89.601321,21.261726],[-88.543866,21.493675],[-87.658417,21.458846],[-87.05189,21.543543],[-86.811982,21.331515],[-86.845908,20.849865],[-87.383291,20.255405],[-87.621054,19.646553],[-87.43675,19.472403],[-87.58656,19.04013],[-87.837191,18.259816],[-88.090664,18.516648],[-88.300031,18.499982],[-88.490123,18.486831],[-88.848344,17.883198],[-89.029857,18.001511],[-89.150909,17.955468],[-89.14308,17.808319],[-90.067934,17.819326],[-91.00152,17.817595],[-91.002269,17.254658],[-91.453921,17.252177],[-91.08167,16.918477],[-90.711822,16.687483],[-90.600847,16.470778],[-90.438867,16.41011],[-90.464473,16.069562],[-91.74796,16.066565],[-92.229249,15.251447],[-92.087216,15.064585],[-92.20323,14.830103],[-92.22775,14.538829],[-93.359464,15.61543],[-93.875169,15.940164],[-94.691656,16.200975],[-95.250227,16.128318],[-96.053382,15.752088],[-96.557434,15.653515],[-97.263592,15.917065],[-98.01303,16.107312],[-98.947676,16.566043],[-99.697397,16.706164],[-100.829499,17.171071],[-101.666089,17.649026],[-101.918528,17.91609],[-102.478132,17.975751],[-103.50099,18.292295],[-103.917527,18.748572],[-104.99201,19.316134],[-105.493038,19.946767],[-105.731396,20.434102],[-105.397773,20.531719],[-105.500661,20.816895],[-105.270752,21.076285],[-105.265817,21.422104],[-105.603161,21.871146],[-105.693414,22.26908],[-106.028716,22.773752],[-106.90998,23.767774],[-107.915449,24.548915],[-108.401905,25.172314],[-109.260199,25.580609],[-109.444089,25.824884],[-109.291644,26.442934],[-109.801458,26.676176],[-110.391732,27.162115],[-110.641019,27.859876],[-111.178919,27.941241],[-111.759607,28.467953],[-112.228235,28.954409],[-112.271824,29.266844],[-112.809594,30.021114],[-113.163811,30.786881],[-113.148669,31.170966],[-113.871881,31.567608],[-114.205737,31.524045],[-114.776451,31.799532],[-114.9367,31.393485],[-114.771232,30.913617],[-114.673899,30.162681],[-114.330974,29.750432],[-113.588875,29.061611],[-113.424053,28.826174],[-113.271969,28.754783],[-113.140039,28.411289],[-112.962298,28.42519],[-112.761587,27.780217],[-112.457911,27.525814],[-112.244952,27.171727],[-111.616489,26.662817],[-111.284675,25.73259],[-110.987819,25.294606],[-110.710007,24.826004],[-110.655049,24.298595],[-110.172856,24.265548],[-109.771847,23.811183],[-109.409104,23.364672],[-109.433392,23.185588],[-109.854219,22.818272],[-110.031392,22.823078],[-110.295071,23.430973],[-110.949501,24.000964],[-111.670568,24.484423],[-112.182036,24.738413],[-112.148989,25.470125],[-112.300711,26.012004],[-112.777297,26.32196],[-113.464671,26.768186],[-113.59673,26.63946],[-113.848937,26.900064],[-114.465747,27.14209],[-115.055142,27.722727],[-114.982253,27.7982],[-114.570366,27.741485],[-114.199329,28.115003],[-114.162018,28.566112],[-114.931842,29.279479],[-115.518654,29.556362],[-115.887365,30.180794],[-116.25835,30.836464],[-116.721526,31.635744],[-117.12776,32.53534],[-115.99135,32.61239],[-114.72139,32.72083],[-114.815,32.52528],[-113.30498,32.03914],[-111.02361,31.33472],[-109.035,31.34194],[-108.24194,31.34222],[-108.24,31.754854],[-106.50759,31.75452],[-106.1429,31.39995],[-105.63159,31.08383],[-105.03737,30.64402],[-104.70575,30.12173],[-104.45697,29.57196],[-103.94,29.27],[-103.11,28.97],[-102.48,29.76],[-101.6624,29.7793],[-100.9576,29.38071],[-100.45584,28.69612],[-100.11,28.11],[-99.52,27.54],[-99.3,26.84],[-99.02,26.37],[-98.24,26.06],[-97.53,25.84],[-97.140008,25.869997]]]}},{type:"Feature",id:"MKD",properties:{name:"Macedonia"},geometry:{type:"Polygon",coordinates:[[[20.59023,41.85541],[20.71731,41.84711],[20.76216,42.05186],[21.3527,42.2068],[21.576636,42.245224],[21.91708,42.30364],[22.380526,42.32026],[22.881374,41.999297],[22.952377,41.337994],[22.76177,41.3048],[22.597308,41.130487],[22.055378,41.149866],[21.674161,40.931275],[21.02004,40.842727],[20.60518,41.08622],[20.46315,41.51509],[20.59023,41.85541]]]}},{type:"Feature",id:"MLI",properties:{name:"Mali"},geometry:{type:"Polygon",coordinates:[[[-12.17075,14.616834],[-11.834208,14.799097],[-11.666078,15.388208],[-11.349095,15.411256],[-10.650791,15.132746],[-10.086846,15.330486],[-9.700255,15.264107],[-9.550238,15.486497],[-5.537744,15.50169],[-5.315277,16.201854],[-5.488523,16.325102],[-5.971129,20.640833],[-6.453787,24.956591],[-4.923337,24.974574],[-1.550055,22.792666],[1.823228,20.610809],[2.060991,20.142233],[2.683588,19.85623],[3.146661,19.693579],[3.158133,19.057364],[4.267419,19.155265],[4.27021,16.852227],[3.723422,16.184284],[3.638259,15.56812],[2.749993,15.409525],[1.385528,15.323561],[1.015783,14.968182],[.374892,14.928908],[-0.266257,14.924309],[-0.515854,15.116158],[-1.066363,14.973815],[-2.001035,14.559008],[-2.191825,14.246418],[-2.967694,13.79815],[-3.103707,13.541267],[-3.522803,13.337662],[-4.006391,13.472485],[-4.280405,13.228444],[-4.427166,12.542646],[-5.220942,11.713859],[-5.197843,11.375146],[-5.470565,10.95127],[-5.404342,10.370737],[-5.816926,10.222555],[-6.050452,10.096361],[-6.205223,10.524061],[-6.493965,10.411303],[-6.666461,10.430811],[-6.850507,10.138994],[-7.622759,10.147236],[-7.89959,10.297382],[-8.029944,10.206535],[-8.335377,10.494812],[-8.282357,10.792597],[-8.407311,10.909257],[-8.620321,10.810891],[-8.581305,11.136246],[-8.376305,11.393646],[-8.786099,11.812561],[-8.905265,12.088358],[-9.127474,12.30806],[-9.327616,12.334286],[-9.567912,12.194243],[-9.890993,12.060479],[-10.165214,11.844084],[-10.593224,11.923975],[-10.87083,12.177887],[-11.036556,12.211245],[-11.297574,12.077971],[-11.456169,12.076834],[-11.513943,12.442988],[-11.467899,12.754519],[-11.553398,13.141214],[-11.927716,13.422075],[-12.124887,13.994727],[-12.17075,14.616834]]]}},{type:"Feature",id:"MMR",properties:{name:"Myanmar"},geometry:{type:"Polygon",coordinates:[[[99.543309,20.186598],[98.959676,19.752981],[98.253724,19.708203],[97.797783,18.62708],[97.375896,18.445438],[97.859123,17.567946],[98.493761,16.837836],[98.903348,16.177824],[98.537376,15.308497],[98.192074,15.123703],[98.430819,14.622028],[99.097755,13.827503],[99.212012,13.269294],[99.196354,12.804748],[99.587286,11.892763],[99.038121,10.960546],[98.553551,9.93296],[98.457174,10.675266],[98.764546,11.441292],[98.428339,12.032987],[98.509574,13.122378],[98.103604,13.64046],[97.777732,14.837286],[97.597072,16.100568],[97.16454,16.928734],[96.505769,16.427241],[95.369352,15.71439],[94.808405,15.803454],[94.188804,16.037936],[94.533486,17.27724],[94.324817,18.213514],[93.540988,19.366493],[93.663255,19.726962],[93.078278,19.855145],[92.368554,20.670883],[92.303234,21.475485],[92.652257,21.324048],[92.672721,22.041239],[93.166128,22.27846],[93.060294,22.703111],[93.286327,23.043658],[93.325188,24.078556],[94.106742,23.850741],[94.552658,24.675238],[94.603249,25.162495],[95.155153,26.001307],[95.124768,26.573572],[96.419366,27.264589],[97.133999,27.083774],[97.051989,27.699059],[97.402561,27.882536],[97.327114,28.261583],[97.911988,28.335945],[98.246231,27.747221],[98.68269,27.508812],[98.712094,26.743536],[98.671838,25.918703],[97.724609,25.083637],[97.60472,23.897405],[98.660262,24.063286],[98.898749,23.142722],[99.531992,22.949039],[99.240899,22.118314],[99.983489,21.742937],[100.416538,21.558839],[101.150033,21.849984],[101.180005,21.436573],[100.329101,20.786122],[100.115988,20.41785],[99.543309,20.186598]]]}},{type:"Feature",id:"MNE",properties:{name:"Montenegro"},geometry:{type:"Polygon",coordinates:[[[19.801613,42.500093],[19.738051,42.688247],[19.30449,42.19574],[19.37177,41.87755],[19.16246,41.95502],[18.88214,42.28151],[18.45,42.48],[18.56,42.65],[18.70648,43.20011],[19.03165,43.43253],[19.21852,43.52384],[19.48389,43.35229],[19.63,43.21378],[19.95857,43.10604],[20.3398,42.89852],[20.25758,42.81275],[20.0707,42.58863],[19.801613,42.500093]]]}},{type:"Feature",id:"MNG",properties:{name:"Mongolia"},geometry:{type:"Polygon",coordinates:[[[87.751264,49.297198],[88.805567,49.470521],[90.713667,50.331812],[92.234712,50.802171],[93.104219,50.49529],[94.147566,50.480537],[94.815949,50.013433],[95.814028,49.977467],[97.259728,49.726061],[98.231762,50.422401],[97.82574,51.010995],[98.861491,52.047366],[99.981732,51.634006],[100.88948,51.516856],[102.065223,51.259921],[102.255909,50.510561],[103.676545,50.089966],[104.621552,50.275329],[105.886591,50.406019],[106.888804,50.274296],[107.868176,49.793705],[108.475167,49.282548],[109.402449,49.292961],[110.662011,49.130128],[111.581231,49.377968],[112.89774,49.543565],[114.362456,50.248303],[114.96211,50.140247],[115.485695,49.805177],[116.678801,49.888531],[116.191802,49.134598],[115.485282,48.135383],[115.742837,47.726545],[116.308953,47.85341],[117.295507,47.697709],[118.064143,48.06673],[118.866574,47.74706],[119.772824,47.048059],[119.66327,46.69268],[118.874326,46.805412],[117.421701,46.672733],[116.717868,46.388202],[115.985096,45.727235],[114.460332,45.339817],[113.463907,44.808893],[112.436062,45.011646],[111.873306,45.102079],[111.348377,44.457442],[111.667737,44.073176],[111.829588,43.743118],[111.129682,43.406834],[110.412103,42.871234],[109.243596,42.519446],[107.744773,42.481516],[106.129316,42.134328],[104.964994,41.59741],[104.522282,41.908347],[103.312278,41.907468],[101.83304,42.514873],[100.845866,42.663804],[99.515817,42.524691],[97.451757,42.74889],[96.349396,42.725635],[95.762455,43.319449],[95.306875,44.241331],[94.688929,44.352332],[93.480734,44.975472],[92.133891,45.115076],[90.94554,45.286073],[90.585768,45.719716],[90.970809,46.888146],[90.280826,47.693549],[88.854298,48.069082],[88.013832,48.599463],[87.751264,49.297198]]]}},{type:"Feature",id:"MOZ",properties:{name:"Mozambique"},geometry:{type:"Polygon",coordinates:[[[34.559989,-11.52002],[35.312398,-11.439146],[36.514082,-11.720938],[36.775151,-11.594537],[37.471284,-11.568751],[37.827645,-11.268769],[38.427557,-11.285202],[39.52103,-10.896854],[40.316589,-10.317096],[40.478387,-10.765441],[40.437253,-11.761711],[40.560811,-12.639177],[40.59962,-14.201975],[40.775475,-14.691764],[40.477251,-15.406294],[40.089264,-16.100774],[39.452559,-16.720891],[38.538351,-17.101023],[37.411133,-17.586368],[36.281279,-18.659688],[35.896497,-18.84226],[35.1984,-19.552811],[34.786383,-19.784012],[34.701893,-20.497043],[35.176127,-21.254361],[35.373428,-21.840837],[35.385848,-22.14],[35.562546,-22.09],[35.533935,-23.070788],[35.371774,-23.535359],[35.60747,-23.706563],[35.458746,-24.12261],[35.040735,-24.478351],[34.215824,-24.816314],[33.01321,-25.357573],[32.574632,-25.727318],[32.660363,-26.148584],[32.915955,-26.215867],[32.83012,-26.742192],[32.071665,-26.73382],[31.985779,-26.29178],[31.837778,-25.843332],[31.752408,-25.484284],[31.930589,-24.369417],[31.670398,-23.658969],[31.191409,-22.25151],[32.244988,-21.116489],[32.508693,-20.395292],[32.659743,-20.30429],[32.772708,-19.715592],[32.611994,-19.419383],[32.654886,-18.67209],[32.849861,-17.979057],[32.847639,-16.713398],[32.328239,-16.392074],[31.852041,-16.319417],[31.636498,-16.07199],[31.173064,-15.860944],[30.338955,-15.880839],[30.274256,-15.507787],[30.179481,-14.796099],[33.214025,-13.97186],[33.7897,-14.451831],[34.064825,-14.35995],[34.459633,-14.61301],[34.517666,-15.013709],[34.307291,-15.478641],[34.381292,-16.18356],[35.03381,-16.8013],[35.339063,-16.10744],[35.771905,-15.896859],[35.686845,-14.611046],[35.267956,-13.887834],[34.907151,-13.565425],[34.559989,-13.579998],[34.280006,-12.280025],[34.559989,-11.52002]]]}},{type:"Feature",id:"MRT",properties:{name:"Mauritania"},geometry:{type:"Polygon",coordinates:[[[-12.17075,14.616834],[-12.830658,15.303692],[-13.435738,16.039383],[-14.099521,16.304302],[-14.577348,16.598264],[-15.135737,16.587282],[-15.623666,16.369337],[-16.12069,16.455663],[-16.463098,16.135036],[-16.549708,16.673892],[-16.270552,17.166963],[-16.146347,18.108482],[-16.256883,19.096716],[-16.377651,19.593817],[-16.277838,20.092521],[-16.536324,20.567866],[-17.063423,20.999752],[-16.845194,21.333323],[-12.929102,21.327071],[-13.118754,22.77122],[-12.874222,23.284832],[-11.937224,23.374594],[-11.969419,25.933353],[-8.687294,25.881056],[-8.6844,27.395744],[-4.923337,24.974574],[-6.453787,24.956591],[-5.971129,20.640833],[-5.488523,16.325102],[-5.315277,16.201854],[-5.537744,15.50169],[-9.550238,15.486497],[-9.700255,15.264107],[-10.086846,15.330486],[-10.650791,15.132746],[-11.349095,15.411256],[-11.666078,15.388208],[-11.834208,14.799097],[-12.17075,14.616834]]]}},{type:"Feature",id:"MWI",properties:{name:"Malawi"},geometry:{type:"Polygon",coordinates:[[[34.559989,-11.52002],[34.280006,-12.280025],[34.559989,-13.579998],[34.907151,-13.565425],[35.267956,-13.887834],[35.686845,-14.611046],[35.771905,-15.896859],[35.339063,-16.10744],[35.03381,-16.8013],[34.381292,-16.18356],[34.307291,-15.478641],[34.517666,-15.013709],[34.459633,-14.61301],[34.064825,-14.35995],[33.7897,-14.451831],[33.214025,-13.97186],[32.688165,-13.712858],[32.991764,-12.783871],[33.306422,-12.435778],[33.114289,-11.607198],[33.31531,-10.79655],[33.485688,-10.525559],[33.231388,-9.676722],[32.759375,-9.230599],[33.739729,-9.417151],[33.940838,-9.693674],[34.280006,-10.16],[34.559989,-11.52002]]]}},{type:"Feature",id:"MYS",properties:{name:"Malaysia"},geometry:{type:"MultiPolygon",coordinates:[[[[101.075516,6.204867],[101.154219,5.691384],[101.814282,5.810808],[102.141187,6.221636],[102.371147,6.128205],[102.961705,5.524495],[103.381215,4.855001],[103.438575,4.181606],[103.332122,3.726698],[103.429429,3.382869],[103.502448,2.791019],[103.854674,2.515454],[104.247932,1.631141],[104.228811,1.293048],[103.519707,1.226334],[102.573615,1.967115],[101.390638,2.760814],[101.27354,3.270292],[100.695435,3.93914],[100.557408,4.76728],[100.196706,5.312493],[100.30626,6.040562],[100.085757,6.464489],[100.259596,6.642825],[101.075516,6.204867]]],[[[118.618321,4.478202],[117.882035,4.137551],[117.015214,4.306094],[115.865517,4.306559],[115.519078,3.169238],[115.134037,2.821482],[114.621355,1.430688],[113.80585,1.217549],[112.859809,1.49779],[112.380252,1.410121],[111.797548,.904441],[111.159138,.976478],[110.514061,.773131],[109.830227,1.338136],[109.66326,2.006467],[110.396135,1.663775],[111.168853,1.850637],[111.370081,2.697303],[111.796928,2.885897],[112.995615,3.102395],[113.712935,3.893509],[114.204017,4.525874],[114.659596,4.007637],[114.869557,4.348314],[115.347461,4.316636],[115.4057,4.955228],[115.45071,5.44773],[116.220741,6.143191],[116.725103,6.924771],[117.129626,6.928053],[117.643393,6.422166],[117.689075,5.98749],[118.347691,5.708696],[119.181904,5.407836],[119.110694,5.016128],[118.439727,4.966519],[118.618321,4.478202]]]]}},{type:"Feature",id:"NAM",properties:{name:"Namibia"},geometry:{type:"Polygon",coordinates:[[[16.344977,-28.576705],[15.601818,-27.821247],[15.210472,-27.090956],[14.989711,-26.117372],[14.743214,-25.39292],[14.408144,-23.853014],[14.385717,-22.656653],[14.257714,-22.111208],[13.868642,-21.699037],[13.352498,-20.872834],[12.826845,-19.673166],[12.608564,-19.045349],[11.794919,-18.069129],[11.734199,-17.301889],[12.215461,-17.111668],[12.814081,-16.941343],[13.462362,-16.971212],[14.058501,-17.423381],[14.209707,-17.353101],[18.263309,-17.309951],[18.956187,-17.789095],[21.377176,-17.930636],[23.215048,-17.523116],[24.033862,-17.295843],[24.682349,-17.353411],[25.07695,-17.578823],[25.084443,-17.661816],[24.520705,-17.887125],[24.217365,-17.889347],[23.579006,-18.281261],[23.196858,-17.869038],[21.65504,-18.219146],[20.910641,-18.252219],[20.881134,-21.814327],[19.895458,-21.849157],[19.895768,-24.76779],[19.894734,-28.461105],[19.002127,-28.972443],[18.464899,-29.045462],[17.836152,-28.856378],[17.387497,-28.783514],[17.218929,-28.355943],[16.824017,-28.082162],[16.344977,-28.576705]]]}},{type:"Feature",id:"NCL",properties:{name:"New Caledonia"},geometry:{type:"Polygon",coordinates:[[[165.77999,-21.080005],[166.599991,-21.700019],[167.120011,-22.159991],[166.740035,-22.399976],[166.189732,-22.129708],[165.474375,-21.679607],[164.829815,-21.14982],[164.167995,-20.444747],[164.029606,-20.105646],[164.459967,-20.120012],[165.020036,-20.459991],[165.460009,-20.800022],[165.77999,-21.080005]]]}},{type:"Feature",id:"NER",properties:{name:"Niger"},geometry:{type:"Polygon",coordinates:[[[2.154474,11.94015],[2.177108,12.625018],[1.024103,12.851826],[.993046,13.33575],[.429928,13.988733],[.295646,14.444235],[.374892,14.928908],[1.015783,14.968182],[1.385528,15.323561],[2.749993,15.409525],[3.638259,15.56812],[3.723422,16.184284],[4.27021,16.852227],[4.267419,19.155265],[5.677566,19.601207],[8.572893,21.565661],[11.999506,23.471668],[13.581425,23.040506],[14.143871,22.491289],[14.8513,22.86295],[15.096888,21.308519],[15.471077,21.048457],[15.487148,20.730415],[15.903247,20.387619],[15.685741,19.95718],[15.300441,17.92795],[15.247731,16.627306],[13.972202,15.684366],[13.540394,14.367134],[13.956699,13.996691],[13.954477,13.353449],[14.595781,13.330427],[14.495787,12.859396],[14.213531,12.802035],[14.181336,12.483657],[13.995353,12.461565],[13.318702,13.556356],[13.083987,13.596147],[12.302071,13.037189],[11.527803,13.32898],[10.989593,13.387323],[10.701032,13.246918],[10.114814,13.277252],[9.524928,12.851102],[9.014933,12.826659],[7.804671,13.343527],[7.330747,13.098038],[6.820442,13.115091],[6.445426,13.492768],[5.443058,13.865924],[4.368344,13.747482],[4.107946,13.531216],[3.967283,12.956109],[3.680634,12.552903],[3.61118,11.660167],[2.848643,12.235636],[2.490164,12.233052],[2.154474,11.94015]]]}},{type:"Feature",id:"NGA",properties:{name:"Nigeria"},geometry:{type:"Polygon",coordinates:[[[8.500288,4.771983],[7.462108,4.412108],[7.082596,4.464689],[6.698072,4.240594],[5.898173,4.262453],[5.362805,4.887971],[5.033574,5.611802],[4.325607,6.270651],[3.57418,6.2583],[2.691702,6.258817],[2.749063,7.870734],[2.723793,8.506845],[2.912308,9.137608],[3.220352,9.444153],[3.705438,10.06321],[3.60007,10.332186],[3.797112,10.734746],[3.572216,11.327939],[3.61118,11.660167],[3.680634,12.552903],[3.967283,12.956109],[4.107946,13.531216],[4.368344,13.747482],[5.443058,13.865924],[6.445426,13.492768],[6.820442,13.115091],[7.330747,13.098038],[7.804671,13.343527],[9.014933,12.826659],[9.524928,12.851102],[10.114814,13.277252],[10.701032,13.246918],[10.989593,13.387323],[11.527803,13.32898],[12.302071,13.037189],[13.083987,13.596147],[13.318702,13.556356],[13.995353,12.461565],[14.181336,12.483657],[14.577178,12.085361],[14.468192,11.904752],[14.415379,11.572369],[13.57295,10.798566],[13.308676,10.160362],[13.1676,9.640626],[12.955468,9.417772],[12.753672,8.717763],[12.218872,8.305824],[12.063946,7.799808],[11.839309,7.397042],[11.745774,6.981383],[11.058788,6.644427],[10.497375,7.055358],[10.118277,7.03877],[9.522706,6.453482],[9.233163,6.444491],[8.757533,5.479666],[8.500288,4.771983]]]}},{type:"Feature",id:"NIC",properties:{name:"Nicaragua"},geometry:{type:"Polygon",coordinates:[[[-85.71254,11.088445],[-86.058488,11.403439],[-86.52585,11.806877],[-86.745992,12.143962],[-87.167516,12.458258],[-87.668493,12.90991],[-87.557467,13.064552],[-87.392386,12.914018],[-87.316654,12.984686],[-87.005769,13.025794],[-86.880557,13.254204],[-86.733822,13.263093],[-86.755087,13.754845],[-86.520708,13.778487],[-86.312142,13.771356],[-86.096264,14.038187],[-85.801295,13.836055],[-85.698665,13.960078],[-85.514413,14.079012],[-85.165365,14.35437],[-85.148751,14.560197],[-85.052787,14.551541],[-84.924501,14.790493],[-84.820037,14.819587],[-84.649582,14.666805],[-84.449336,14.621614],[-84.228342,14.748764],[-83.975721,14.749436],[-83.628585,14.880074],[-83.489989,15.016267],[-83.147219,14.995829],[-83.233234,14.899866],[-83.284162,14.676624],[-83.182126,14.310703],[-83.4125,13.970078],[-83.519832,13.567699],[-83.552207,13.127054],[-83.498515,12.869292],[-83.473323,12.419087],[-83.626104,12.32085],[-83.719613,11.893124],[-83.650858,11.629032],[-83.85547,11.373311],[-83.808936,11.103044],[-83.655612,10.938764],[-83.895054,10.726839],[-84.190179,10.79345],[-84.355931,10.999226],[-84.673069,11.082657],[-84.903003,10.952303],[-85.561852,11.217119],[-85.71254,11.088445]]]}},{type:"Feature",id:"NLD",properties:{name:"Netherlands"},geometry:{type:"Polygon",coordinates:[[[6.074183,53.510403],[6.90514,53.482162],[7.092053,53.144043],[6.84287,52.22844],[6.589397,51.852029],[5.988658,51.851616],[6.156658,50.803721],[5.606976,51.037298],[4.973991,51.475024],[4.047071,51.267259],[3.314971,51.345755],[3.830289,51.620545],[4.705997,53.091798],[6.074183,53.510403]]]}},{type:"Feature",id:"NOR",properties:{name:"Norway"},geometry:{type:"MultiPolygon",coordinates:[[[[28.165547,71.185474],[31.293418,70.453788],[30.005435,70.186259],[31.101079,69.55808],[29.399581,69.156916],[28.59193,69.064777],[29.015573,69.766491],[27.732292,70.164193],[26.179622,69.825299],[25.689213,69.092114],[24.735679,68.649557],[23.66205,68.891247],[22.356238,68.841741],[21.244936,69.370443],[20.645593,69.106247],[20.025269,69.065139],[19.87856,68.407194],[17.993868,68.567391],[17.729182,68.010552],[16.768879,68.013937],[16.108712,67.302456],[15.108411,66.193867],[13.55569,64.787028],[13.919905,64.445421],[13.571916,64.049114],[12.579935,64.066219],[11.930569,63.128318],[11.992064,61.800362],[12.631147,61.293572],[12.300366,60.117933],[11.468272,59.432393],[11.027369,58.856149],[10.356557,59.469807],[8.382,58.313288],[7.048748,58.078884],[5.665835,58.588155],[5.308234,59.663232],[4.992078,61.970998],[5.9129,62.614473],[8.553411,63.454008],[10.527709,64.486038],[12.358347,65.879726],[14.761146,67.810642],[16.435927,68.563205],[19.184028,69.817444],[21.378416,70.255169],[23.023742,70.202072],[24.546543,71.030497],[26.37005,70.986262],[28.165547,71.185474]]],[[[24.72412,77.85385],[22.49032,77.44493],[20.72601,77.67704],[21.41611,77.93504],[20.8119,78.25463],[22.88426,78.45494],[23.28134,78.07954],[24.72412,77.85385]]],[[[18.25183,79.70175],[21.54383,78.95611],[19.02737,78.5626],[18.47172,77.82669],[17.59441,77.63796],[17.1182,76.80941],[15.91315,76.77045],[13.76259,77.38035],[14.66956,77.73565],[13.1706,78.02493],[11.22231,78.8693],[10.44453,79.65239],[13.17077,80.01046],[13.71852,79.66039],[15.14282,79.67431],[15.52255,80.01608],[16.99085,80.05086],[18.25183,79.70175]]],[[[25.447625,80.40734],[27.407506,80.056406],[25.924651,79.517834],[23.024466,79.400012],[20.075188,79.566823],[19.897266,79.842362],[18.462264,79.85988],[17.368015,80.318896],[20.455992,80.598156],[21.907945,80.357679],[22.919253,80.657144],[25.447625,80.40734]]]]}},{type:"Feature",id:"NPL",properties:{name:"Nepal"},geometry:{type:"Polygon",coordinates:[[[88.120441,27.876542],[88.043133,27.445819],[88.174804,26.810405],[88.060238,26.414615],[87.227472,26.397898],[86.024393,26.630985],[85.251779,26.726198],[84.675018,27.234901],[83.304249,27.364506],[81.999987,27.925479],[81.057203,28.416095],[80.088425,28.79447],[80.476721,29.729865],[81.111256,30.183481],[81.525804,30.422717],[82.327513,30.115268],[83.337115,29.463732],[83.898993,29.320226],[84.23458,28.839894],[85.011638,28.642774],[85.82332,28.203576],[86.954517,27.974262],[88.120441,27.876542]]]}},{type:"Feature",id:"NZL",properties:{name:"New Zealand"},geometry:{type:"MultiPolygon",coordinates:[[[[173.020375,-40.919052],[173.247234,-41.331999],[173.958405,-40.926701],[174.247587,-41.349155],[174.248517,-41.770008],[173.876447,-42.233184],[173.22274,-42.970038],[172.711246,-43.372288],[173.080113,-43.853344],[172.308584,-43.865694],[171.452925,-44.242519],[171.185138,-44.897104],[170.616697,-45.908929],[169.831422,-46.355775],[169.332331,-46.641235],[168.411354,-46.619945],[167.763745,-46.290197],[166.676886,-46.219917],[166.509144,-45.852705],[167.046424,-45.110941],[168.303763,-44.123973],[168.949409,-43.935819],[169.667815,-43.555326],[170.52492,-43.031688],[171.12509,-42.512754],[171.569714,-41.767424],[171.948709,-41.514417],[172.097227,-40.956104],[172.79858,-40.493962],[173.020375,-40.919052]]],[[[174.612009,-36.156397],[175.336616,-37.209098],[175.357596,-36.526194],[175.808887,-36.798942],[175.95849,-37.555382],[176.763195,-37.881253],[177.438813,-37.961248],[178.010354,-37.579825],[178.517094,-37.695373],[178.274731,-38.582813],[177.97046,-39.166343],[177.206993,-39.145776],[176.939981,-39.449736],[177.032946,-39.879943],[176.885824,-40.065978],[176.508017,-40.604808],[176.01244,-41.289624],[175.239567,-41.688308],[175.067898,-41.425895],[174.650973,-41.281821],[175.22763,-40.459236],[174.900157,-39.908933],[173.824047,-39.508854],[173.852262,-39.146602],[174.574802,-38.797683],[174.743474,-38.027808],[174.697017,-37.381129],[174.292028,-36.711092],[174.319004,-36.534824],[173.840997,-36.121981],[173.054171,-35.237125],[172.636005,-34.529107],[173.007042,-34.450662],[173.551298,-35.006183],[174.32939,-35.265496],[174.612009,-36.156397]]]]}},{type:"Feature",id:"OMN",properties:{name:"Oman"},geometry:{type:"MultiPolygon",coordinates:[[[[58.861141,21.114035],[58.487986,20.428986],[58.034318,20.481437],[57.826373,20.243002],[57.665762,19.736005],[57.7887,19.06757],[57.694391,18.94471],[57.234264,18.947991],[56.609651,18.574267],[56.512189,18.087113],[56.283521,17.876067],[55.661492,17.884128],[55.269939,17.632309],[55.2749,17.228354],[54.791002,16.950697],[54.239253,17.044981],[53.570508,16.707663],[53.108573,16.651051],[52.782184,17.349742],[52.00001,19.000003],[54.999982,19.999994],[55.666659,22.000001],[55.208341,22.70833],[55.234489,23.110993],[55.525841,23.524869],[55.528632,23.933604],[55.981214,24.130543],[55.804119,24.269604],[55.886233,24.920831],[56.396847,24.924732],[56.84514,24.241673],[57.403453,23.878594],[58.136948,23.747931],[58.729211,23.565668],[59.180502,22.992395],[59.450098,22.660271],[59.80806,22.533612],[59.806148,22.310525],[59.442191,21.714541],[59.282408,21.433886],[58.861141,21.114035]]],[[[56.391421,25.895991],[56.261042,25.714606],[56.070821,26.055464],[56.362017,26.395934],[56.485679,26.309118],[56.391421,25.895991]]]]}},{type:"Feature",id:"PAK",properties:{name:"Pakistan"},geometry:{type:"Polygon",coordinates:[[[75.158028,37.133031],[75.896897,36.666806],[76.192848,35.898403],[77.837451,35.49401],[76.871722,34.653544],[75.757061,34.504923],[74.240203,34.748887],[73.749948,34.317699],[74.104294,33.441473],[74.451559,32.7649],[75.258642,32.271105],[74.405929,31.692639],[74.42138,30.979815],[73.450638,29.976413],[72.823752,28.961592],[71.777666,27.91318],[70.616496,27.989196],[69.514393,26.940966],[70.168927,26.491872],[70.282873,25.722229],[70.844699,25.215102],[71.04324,24.356524],[68.842599,24.359134],[68.176645,23.691965],[67.443667,23.944844],[67.145442,24.663611],[66.372828,25.425141],[64.530408,25.237039],[62.905701,25.218409],[61.497363,25.078237],[61.874187,26.239975],[63.316632,26.756532],[63.233898,27.217047],[62.755426,27.378923],[62.72783,28.259645],[61.771868,28.699334],[61.369309,29.303276],[60.874248,29.829239],[62.549857,29.318572],[63.550261,29.468331],[64.148002,29.340819],[64.350419,29.560031],[65.046862,29.472181],[66.346473,29.887943],[66.381458,30.738899],[66.938891,31.304911],[67.683394,31.303154],[67.792689,31.58293],[68.556932,31.71331],[68.926677,31.620189],[69.317764,31.901412],[69.262522,32.501944],[69.687147,33.105499],[70.323594,33.358533],[69.930543,34.02012],[70.881803,33.988856],[71.156773,34.348911],[71.115019,34.733126],[71.613076,35.153203],[71.498768,35.650563],[71.262348,36.074388],[71.846292,36.509942],[72.920025,36.720007],[74.067552,36.836176],[74.575893,37.020841],[75.158028,37.133031]]]}},{type:"Feature",id:"PAN",properties:{name:"Panama"},geometry:{type:"Polygon",coordinates:[[[-77.881571,7.223771],[-78.214936,7.512255],[-78.429161,8.052041],[-78.182096,8.319182],[-78.435465,8.387705],[-78.622121,8.718124],[-79.120307,8.996092],[-79.557877,8.932375],[-79.760578,8.584515],[-80.164481,8.333316],[-80.382659,8.298409],[-80.480689,8.090308],[-80.00369,7.547524],[-80.276671,7.419754],[-80.421158,7.271572],[-80.886401,7.220541],[-81.059543,7.817921],[-81.189716,7.647906],[-81.519515,7.70661],[-81.721311,8.108963],[-82.131441,8.175393],[-82.390934,8.292362],[-82.820081,8.290864],[-82.850958,8.073823],[-82.965783,8.225028],[-82.913176,8.423517],[-82.829771,8.626295],[-82.868657,8.807266],[-82.719183,8.925709],[-82.927155,9.07433],[-82.932891,9.476812],[-82.546196,9.566135],[-82.187123,9.207449],[-82.207586,8.995575],[-81.808567,8.950617],[-81.714154,9.031955],[-81.439287,8.786234],[-80.947302,8.858504],[-80.521901,9.111072],[-79.9146,9.312765],[-79.573303,9.61161],[-79.021192,9.552931],[-79.05845,9.454565],[-78.500888,9.420459],[-78.055928,9.24773],[-77.729514,8.946844],[-77.353361,8.670505],[-77.474723,8.524286],[-77.242566,7.935278],[-77.431108,7.638061],[-77.753414,7.70984],[-77.881571,7.223771]]]}},{type:"Feature",id:"PER",properties:{name:"Peru"},geometry:{type:"Polygon",coordinates:[[[-69.590424,-17.580012],[-69.858444,-18.092694],[-70.372572,-18.347975],[-71.37525,-17.773799],[-71.462041,-17.363488],[-73.44453,-16.359363],[-75.237883,-15.265683],[-76.009205,-14.649286],[-76.423469,-13.823187],[-76.259242,-13.535039],[-77.106192,-12.222716],[-78.092153,-10.377712],[-79.036953,-8.386568],[-79.44592,-7.930833],[-79.760578,-7.194341],[-80.537482,-6.541668],[-81.249996,-6.136834],[-80.926347,-5.690557],[-81.410943,-4.736765],[-81.09967,-4.036394],[-80.302561,-3.404856],[-80.184015,-3.821162],[-80.469295,-4.059287],[-80.442242,-4.425724],[-80.028908,-4.346091],[-79.624979,-4.454198],[-79.205289,-4.959129],[-78.639897,-4.547784],[-78.450684,-3.873097],[-77.837905,-3.003021],[-76.635394,-2.608678],[-75.544996,-1.56161],[-75.233723,-0.911417],[-75.373223,-0.152032],[-75.106625,-0.057205],[-74.441601,-0.53082],[-74.122395,-1.002833],[-73.659504,-1.260491],[-73.070392,-2.308954],[-72.325787,-2.434218],[-71.774761,-2.16979],[-71.413646,-2.342802],[-70.813476,-2.256865],[-70.047709,-2.725156],[-70.692682,-3.742872],[-70.394044,-3.766591],[-69.893635,-4.298187],[-70.794769,-4.251265],[-70.928843,-4.401591],[-71.748406,-4.593983],[-72.891928,-5.274561],[-72.964507,-5.741251],[-73.219711,-6.089189],[-73.120027,-6.629931],[-73.724487,-6.918595],[-73.723401,-7.340999],[-73.987235,-7.52383],[-73.571059,-8.424447],[-73.015383,-9.032833],[-73.226713,-9.462213],[-72.563033,-9.520194],[-72.184891,-10.053598],[-71.302412,-10.079436],[-70.481894,-9.490118],[-70.548686,-11.009147],[-70.093752,-11.123972],[-69.529678,-10.951734],[-68.66508,-12.5613],[-68.88008,-12.899729],[-68.929224,-13.602684],[-68.948887,-14.453639],[-69.339535,-14.953195],[-69.160347,-15.323974],[-69.389764,-15.660129],[-68.959635,-16.500698],[-69.590424,-17.580012]]]}},{type:"Feature",id:"PHL",properties:{name:"Philippines"},geometry:{type:"MultiPolygon",coordinates:[[[[126.376814,8.414706],[126.478513,7.750354],[126.537424,7.189381],[126.196773,6.274294],[125.831421,7.293715],[125.363852,6.786485],[125.683161,6.049657],[125.396512,5.581003],[124.219788,6.161355],[123.93872,6.885136],[124.243662,7.36061],[123.610212,7.833527],[123.296071,7.418876],[122.825506,7.457375],[122.085499,6.899424],[121.919928,7.192119],[122.312359,8.034962],[122.942398,8.316237],[123.487688,8.69301],[123.841154,8.240324],[124.60147,8.514158],[124.764612,8.960409],[125.471391,8.986997],[125.412118,9.760335],[126.222714,9.286074],[126.306637,8.782487],[126.376814,8.414706]]],[[[123.982438,10.278779],[123.623183,9.950091],[123.309921,9.318269],[122.995883,9.022189],[122.380055,9.713361],[122.586089,9.981045],[122.837081,10.261157],[122.947411,10.881868],[123.49885,10.940624],[123.337774,10.267384],[124.077936,11.232726],[123.982438,10.278779]]],[[[118.504581,9.316383],[117.174275,8.3675],[117.664477,9.066889],[118.386914,9.6845],[118.987342,10.376292],[119.511496,11.369668],[119.689677,10.554291],[119.029458,10.003653],[118.504581,9.316383]]],[[[121.883548,11.891755],[122.483821,11.582187],[123.120217,11.58366],[123.100838,11.165934],[122.637714,10.741308],[122.00261,10.441017],[121.967367,10.905691],[122.03837,11.415841],[121.883548,11.891755]]],[[[125.502552,12.162695],[125.783465,11.046122],[125.011884,11.311455],[125.032761,10.975816],[125.277449,10.358722],[124.801819,10.134679],[124.760168,10.837995],[124.459101,10.88993],[124.302522,11.495371],[124.891013,11.415583],[124.87799,11.79419],[124.266762,12.557761],[125.227116,12.535721],[125.502552,12.162695]]],[[[121.527394,13.06959],[121.26219,12.20556],[120.833896,12.704496],[120.323436,13.466413],[121.180128,13.429697],[121.527394,13.06959]]],[[[121.321308,18.504065],[121.937601,18.218552],[122.246006,18.47895],[122.336957,18.224883],[122.174279,17.810283],[122.515654,17.093505],[122.252311,16.262444],[121.662786,15.931018],[121.50507,15.124814],[121.728829,14.328376],[122.258925,14.218202],[122.701276,14.336541],[123.950295,13.782131],[123.855107,13.237771],[124.181289,12.997527],[124.077419,12.536677],[123.298035,13.027526],[122.928652,13.55292],[122.671355,13.185836],[122.03465,13.784482],[121.126385,13.636687],[120.628637,13.857656],[120.679384,14.271016],[120.991819,14.525393],[120.693336,14.756671],[120.564145,14.396279],[120.070429,14.970869],[119.920929,15.406347],[119.883773,16.363704],[120.286488,16.034629],[120.390047,17.599081],[120.715867,18.505227],[121.321308,18.504065]]]]}},{type:"Feature",id:"PNG",properties:{name:"Papua New Guinea"},geometry:{type:"MultiPolygon",coordinates:[[[[155.880026,-6.819997],[155.599991,-6.919991],[155.166994,-6.535931],[154.729192,-5.900828],[154.514114,-5.139118],[154.652504,-5.042431],[154.759991,-5.339984],[155.062918,-5.566792],[155.547746,-6.200655],[156.019965,-6.540014],[155.880026,-6.819997]]],[[[151.982796,-5.478063],[151.459107,-5.56028],[151.30139,-5.840728],[150.754447,-6.083763],[150.241197,-6.317754],[149.709963,-6.316513],[148.890065,-6.02604],[148.318937,-5.747142],[148.401826,-5.437756],[149.298412,-5.583742],[149.845562,-5.505503],[149.99625,-5.026101],[150.139756,-5.001348],[150.236908,-5.53222],[150.807467,-5.455842],[151.089672,-5.113693],[151.647881,-4.757074],[151.537862,-4.167807],[152.136792,-4.14879],[152.338743,-4.312966],[152.318693,-4.867661],[151.982796,-5.478063]]],[[[147.191874,-7.388024],[148.084636,-8.044108],[148.734105,-9.104664],[149.306835,-9.071436],[149.266631,-9.514406],[150.038728,-9.684318],[149.738798,-9.872937],[150.801628,-10.293687],[150.690575,-10.582713],[150.028393,-10.652476],[149.78231,-10.393267],[148.923138,-10.280923],[147.913018,-10.130441],[147.135443,-9.492444],[146.567881,-8.942555],[146.048481,-8.067414],[144.744168,-7.630128],[143.897088,-7.91533],[143.286376,-8.245491],[143.413913,-8.983069],[142.628431,-9.326821],[142.068259,-9.159596],[141.033852,-9.117893],[141.017057,-5.859022],[141.00021,-2.600151],[142.735247,-3.289153],[144.583971,-3.861418],[145.27318,-4.373738],[145.829786,-4.876498],[145.981922,-5.465609],[147.648073,-6.083659],[147.891108,-6.614015],[146.970905,-6.721657],[147.191874,-7.388024]]],[[[153.140038,-4.499983],[152.827292,-4.766427],[152.638673,-4.176127],[152.406026,-3.789743],[151.953237,-3.462062],[151.384279,-3.035422],[150.66205,-2.741486],[150.939965,-2.500002],[151.479984,-2.779985],[151.820015,-2.999972],[152.239989,-3.240009],[152.640017,-3.659983],[153.019994,-3.980015],[153.140038,-4.499983]]]]}},{type:"Feature",id:"POL",properties:{name:"Poland"},geometry:{type:"Polygon",coordinates:[[[15.016996,51.106674],[14.607098,51.745188],[14.685026,52.089947],[14.4376,52.62485],[14.074521,52.981263],[14.353315,53.248171],[14.119686,53.757029],[14.8029,54.050706],[16.363477,54.513159],[17.622832,54.851536],[18.620859,54.682606],[18.696255,54.438719],[19.66064,54.426084],[20.892245,54.312525],[22.731099,54.327537],[23.243987,54.220567],[23.484128,53.912498],[23.527536,53.470122],[23.804935,53.089731],[23.799199,52.691099],[23.199494,52.486977],[23.508002,52.023647],[23.527071,51.578454],[24.029986,50.705407],[23.922757,50.424881],[23.426508,50.308506],[22.51845,49.476774],[22.776419,49.027395],[22.558138,49.085738],[21.607808,49.470107],[20.887955,49.328772],[20.415839,49.431453],[19.825023,49.217125],[19.320713,49.571574],[18.909575,49.435846],[18.853144,49.49623],[18.392914,49.988629],[17.649445,50.049038],[17.554567,50.362146],[16.868769,50.473974],[16.719476,50.215747],[16.176253,50.422607],[16.238627,50.697733],[15.490972,50.78473],[15.016996,51.106674]]]}},{type:"Feature",id:"PRI",properties:{name:"Puerto Rico"},geometry:{type:"Polygon",coordinates:[[[-66.282434,18.514762],[-65.771303,18.426679],[-65.591004,18.228035],[-65.847164,17.975906],[-66.599934,17.981823],[-67.184162,17.946553],[-67.242428,18.37446],[-67.100679,18.520601],[-66.282434,18.514762]]]}},{type:"Feature",id:"PRK",properties:{name:"North Korea"},geometry:{type:"Polygon",coordinates:[[[130.640016,42.395009],[130.780007,42.220007],[130.400031,42.280004],[129.965949,41.941368],[129.667362,41.601104],[129.705189,40.882828],[129.188115,40.661808],[129.0104,40.485436],[128.633368,40.189847],[127.967414,40.025413],[127.533436,39.75685],[127.50212,39.323931],[127.385434,39.213472],[127.783343,39.050898],[128.349716,38.612243],[128.205746,38.370397],[127.780035,38.304536],[127.073309,38.256115],[126.68372,37.804773],[126.237339,37.840378],[126.174759,37.749686],[125.689104,37.94001],[125.568439,37.752089],[125.27533,37.669071],[125.240087,37.857224],[124.981033,37.948821],[124.712161,38.108346],[124.985994,38.548474],[125.221949,38.665857],[125.132859,38.848559],[125.38659,39.387958],[125.321116,39.551385],[124.737482,39.660344],[124.265625,39.928493],[125.079942,40.569824],[126.182045,41.107336],[126.869083,41.816569],[127.343783,41.503152],[128.208433,41.466772],[128.052215,41.994285],[129.596669,42.424982],[129.994267,42.985387],[130.640016,42.395009]]]}},{type:"Feature",id:"PRT",properties:{name:"Portugal"},geometry:{type:"Polygon",coordinates:[[[-9.034818,41.880571],[-8.671946,42.134689],[-8.263857,42.280469],[-8.013175,41.790886],[-7.422513,41.792075],[-7.251309,41.918346],[-6.668606,41.883387],[-6.389088,41.381815],[-6.851127,41.111083],[-6.86402,40.330872],[-7.026413,40.184524],[-7.066592,39.711892],[-7.498632,39.629571],[-7.098037,39.030073],[-7.374092,38.373059],[-7.029281,38.075764],[-7.166508,37.803894],[-7.537105,37.428904],[-7.453726,37.097788],[-7.855613,36.838269],[-8.382816,36.97888],[-8.898857,36.868809],[-8.746101,37.651346],[-8.839998,38.266243],[-9.287464,38.358486],[-9.526571,38.737429],[-9.446989,39.392066],[-9.048305,39.755093],[-8.977353,40.159306],[-8.768684,40.760639],[-8.790853,41.184334],[-8.990789,41.543459],[-9.034818,41.880571]]]}},{type:"Feature",id:"PRY",properties:{name:"Paraguay"},geometry:{type:"Polygon",coordinates:[[[-62.685057,-22.249029],[-62.291179,-21.051635],[-62.265961,-20.513735],[-61.786326,-19.633737],[-60.043565,-19.342747],[-59.115042,-19.356906],[-58.183471,-19.868399],[-58.166392,-20.176701],[-57.870674,-20.732688],[-57.937156,-22.090176],[-56.88151,-22.282154],[-56.473317,-22.0863],[-55.797958,-22.35693],[-55.610683,-22.655619],[-55.517639,-23.571998],[-55.400747,-23.956935],[-55.027902,-24.001274],[-54.652834,-23.839578],[-54.29296,-24.021014],[-54.293476,-24.5708],[-54.428946,-25.162185],[-54.625291,-25.739255],[-54.788795,-26.621786],[-55.695846,-27.387837],[-56.486702,-27.548499],[-57.60976,-27.395899],[-58.618174,-27.123719],[-57.63366,-25.603657],[-57.777217,-25.16234],[-58.807128,-24.771459],[-60.028966,-24.032796],[-60.846565,-23.880713],[-62.685057,-22.249029]]]}},{type:"Feature",id:"QAT",properties:{name:"Qatar"},geometry:{type:"Polygon",coordinates:[[[50.810108,24.754743],[50.743911,25.482424],[51.013352,26.006992],[51.286462,26.114582],[51.589079,25.801113],[51.6067,25.21567],[51.389608,24.627386],[51.112415,24.556331],[50.810108,24.754743]]]}},{type:"Feature",id:"ROU",properties:{name:"Romania"},geometry:{type:"Polygon",coordinates:[[[22.710531,47.882194],[23.142236,48.096341],[23.760958,47.985598],[24.402056,47.981878],[24.866317,47.737526],[25.207743,47.891056],[25.945941,47.987149],[26.19745,48.220881],[26.619337,48.220726],[26.924176,48.123264],[27.233873,47.826771],[27.551166,47.405117],[28.12803,46.810476],[28.160018,46.371563],[28.054443,45.944586],[28.233554,45.488283],[28.679779,45.304031],[29.149725,45.464925],[29.603289,45.293308],[29.626543,45.035391],[29.141612,44.82021],[28.837858,44.913874],[28.558081,43.707462],[27.970107,43.812468],[27.2424,44.175986],[26.065159,43.943494],[25.569272,43.688445],[24.100679,43.741051],[23.332302,43.897011],[22.944832,43.823785],[22.65715,44.234923],[22.474008,44.409228],[22.705726,44.578003],[22.459022,44.702517],[22.145088,44.478422],[21.562023,44.768947],[21.483526,45.18117],[20.874313,45.416375],[20.762175,45.734573],[20.220192,46.127469],[21.021952,46.316088],[21.626515,46.994238],[22.099768,47.672439],[22.710531,47.882194]]]}},{type:"Feature",id:"RUS",properties:{name:"Russia"},geometry:{type:"MultiPolygon",coordinates:[[[[143.648007,50.7476],[144.654148,48.976391],[143.173928,49.306551],[142.558668,47.861575],[143.533492,46.836728],[143.505277,46.137908],[142.747701,46.740765],[142.09203,45.966755],[141.906925,46.805929],[142.018443,47.780133],[141.904445,48.859189],[142.1358,49.615163],[142.179983,50.952342],[141.594076,51.935435],[141.682546,53.301966],[142.606934,53.762145],[142.209749,54.225476],[142.654786,54.365881],[142.914616,53.704578],[143.260848,52.74076],[143.235268,51.75666],[143.648007,50.7476]]],[[[22.731099,54.327537],[20.892245,54.312525],[19.66064,54.426084],[19.888481,54.86616],[21.268449,55.190482],[22.315724,55.015299],[22.757764,54.856574],[22.651052,54.582741],[22.731099,54.327537]]],[[[-175.01425,66.58435],[-174.33983,66.33556],[-174.57182,67.06219],[-171.85731,66.91308],[-169.89958,65.97724],[-170.89107,65.54139],[-172.53025,65.43791],[-172.555,64.46079],[-172.95533,64.25269],[-173.89184,64.2826],[-174.65392,64.63125],[-175.98353,64.92288],[-176.20716,65.35667],[-177.22266,65.52024],[-178.35993,65.39052],[-178.90332,65.74044],[-178.68611,66.11211],[-179.88377,65.87456],[-179.43268,65.40411],[-180,64.979709],[-180,68.963636],[-177.55,68.2],[-174.92825,67.20589],[-175.01425,66.58435]]],[[[180,70.832199],[178.903425,70.78114],[178.7253,71.0988],[180,71.515714],[180,70.832199]]],[[[-178.69378,70.89302],[-180,70.832199],[-180,71.515714],[-179.871875,71.55762],[-179.02433,71.55553],[-177.577945,71.26948],[-177.663575,71.13277],[-178.69378,70.89302]]],[[[143.60385,73.21244],[142.08763,73.20544],[140.038155,73.31692],[139.86312,73.36983],[140.81171,73.76506],[142.06207,73.85758],[143.48283,73.47525],[143.60385,73.21244]]],[[[150.73167,75.08406],[149.575925,74.68892],[147.977465,74.778355],[146.11919,75.17298],[146.358485,75.49682],[148.22223,75.345845],[150.73167,75.08406]]],[[[145.086285,75.562625],[144.3,74.82],[140.61381,74.84768],[138.95544,74.61148],[136.97439,75.26167],[137.51176,75.94917],[138.831075,76.13676],[141.471615,76.09289],[145.086285,75.562625]]],[[[57.535693,70.720464],[56.944979,70.632743],[53.677375,70.762658],[53.412017,71.206662],[51.601895,71.474759],[51.455754,72.014881],[52.478275,72.229442],[52.444169,72.774731],[54.427614,73.627548],[53.50829,73.749814],[55.902459,74.627486],[55.631933,75.081412],[57.868644,75.60939],[61.170044,76.251883],[64.498368,76.439055],[66.210977,76.809782],[68.15706,76.939697],[68.852211,76.544811],[68.180573,76.233642],[64.637326,75.737755],[61.583508,75.260885],[58.477082,74.309056],[56.986786,73.333044],[55.419336,72.371268],[55.622838,71.540595],[57.535693,70.720464]]],[[[106.97013,76.97419],[107.24,76.48],[108.1538,76.72335],[111.07726,76.71],[113.33151,76.22224],[114.13417,75.84764],[113.88539,75.32779],[112.77918,75.03186],[110.15125,74.47673],[109.4,74.18],[110.64,74.04],[112.11919,73.78774],[113.01954,73.97693],[113.52958,73.33505],[113.96881,73.59488],[115.56782,73.75285],[118.77633,73.58772],[119.02,73.12],[123.20066,72.97122],[123.25777,73.73503],[125.38,73.56],[126.97644,73.56549],[128.59126,73.03871],[129.05157,72.39872],[128.46,71.98],[129.71599,71.19304],[131.28858,70.78699],[132.2535,71.8363],[133.85766,71.38642],[135.56193,71.65525],[137.49755,71.34763],[138.23409,71.62803],[139.86983,71.48783],[139.14791,72.41619],[140.46817,72.84941],[149.5,72.2],[150.35118,71.60643],[152.9689,70.84222],[157.00688,71.03141],[158.99779,70.86672],[159.83031,70.45324],[159.70866,69.72198],[160.94053,69.43728],[162.27907,69.64204],[164.05248,69.66823],[165.94037,69.47199],[167.83567,69.58269],[169.57763,68.6938],[170.81688,69.01363],[170.0082,69.65276],[170.45345,70.09703],[173.64391,69.81743],[175.72403,69.87725],[178.6,69.4],[180,68.963636],[180,64.979709],[179.99281,64.97433],[178.7072,64.53493],[177.41128,64.60821],[178.313,64.07593],[178.90825,63.25197],[179.37034,62.98262],[179.48636,62.56894],[179.22825,62.3041],[177.3643,62.5219],[174.56929,61.76915],[173.68013,61.65261],[172.15,60.95],[170.6985,60.33618],[170.33085,59.88177],[168.90046,60.57355],[166.29498,59.78855],[165.84,60.16],[164.87674,59.7316],[163.53929,59.86871],[163.21711,59.21101],[162.01733,58.24328],[162.05297,57.83912],[163.19191,57.61503],[163.05794,56.15924],[162.12958,56.12219],[161.70146,55.28568],[162.11749,54.85514],[160.36877,54.34433],[160.02173,53.20257],[158.53094,52.95868],[158.23118,51.94269],[156.78979,51.01105],[156.42,51.7],[155.99182,53.15895],[155.43366,55.38103],[155.91442,56.76792],[156.75815,57.3647],[156.81035,57.83204],[158.36433,58.05575],[160.15064,59.31477],[161.87204,60.343],[163.66969,61.1409],[164.47355,62.55061],[163.25842,62.46627],[162.65791,61.6425],[160.12148,60.54423],[159.30232,61.77396],[156.72068,61.43442],[154.21806,59.75818],[155.04375,59.14495],[152.81185,58.88385],[151.26573,58.78089],[151.33815,59.50396],[149.78371,59.65573],[148.54481,59.16448],[145.48722,59.33637],[142.19782,59.03998],[138.95848,57.08805],[135.12619,54.72959],[136.70171,54.60355],[137.19342,53.97732],[138.1647,53.75501],[138.80463,54.25455],[139.90151,54.18968],[141.34531,53.08957],[141.37923,52.23877],[140.59742,51.23967],[140.51308,50.04553],[140.06193,48.44671],[138.55472,46.99965],[138.21971,46.30795],[136.86232,45.1435],[135.51535,43.989],[134.86939,43.39821],[133.53687,42.81147],[132.90627,42.79849],[132.27807,43.28456],[130.93587,42.55274],[130.78,42.22],[130.64,42.395],[130.633866,42.903015],[131.144688,42.92999],[131.288555,44.11152],[131.02519,44.96796],[131.883454,45.321162],[133.09712,45.14409],[133.769644,46.116927],[134.11235,47.21248],[134.50081,47.57845],[135.026311,48.47823],[133.373596,48.183442],[132.50669,47.78896],[130.98726,47.79013],[130.582293,48.729687],[129.397818,49.4406],[127.6574,49.76027],[127.287456,50.739797],[126.939157,51.353894],[126.564399,51.784255],[125.946349,52.792799],[125.068211,53.161045],[123.57147,53.4588],[122.245748,53.431726],[121.003085,53.251401],[120.177089,52.753886],[120.725789,52.516226],[120.7382,51.96411],[120.18208,51.64355],[119.27939,50.58292],[119.288461,50.142883],[117.879244,49.510983],[116.678801,49.888531],[115.485695,49.805177],[114.96211,50.140247],[114.362456,50.248303],[112.89774,49.543565],[111.581231,49.377968],[110.662011,49.130128],[109.402449,49.292961],[108.475167,49.282548],[107.868176,49.793705],[106.888804,50.274296],[105.886591,50.406019],[104.62158,50.27532],[103.676545,50.089966],[102.25589,50.51056],[102.06521,51.25991],[100.88948,51.516856],[99.981732,51.634006],[98.861491,52.047366],[97.82574,51.010995],[98.231762,50.422401],[97.25976,49.72605],[95.81402,49.97746],[94.815949,50.013433],[94.147566,50.480537],[93.10421,50.49529],[92.234712,50.802171],[90.713667,50.331812],[88.805567,49.470521],[87.751264,49.297198],[87.35997,49.214981],[86.829357,49.826675],[85.54127,49.692859],[85.11556,50.117303],[84.416377,50.3114],[83.935115,50.889246],[83.383004,51.069183],[81.945986,50.812196],[80.568447,51.388336],[80.03556,50.864751],[77.800916,53.404415],[76.525179,54.177003],[76.8911,54.490524],[74.38482,53.54685],[73.425679,53.48981],[73.508516,54.035617],[72.22415,54.376655],[71.180131,54.133285],[70.865267,55.169734],[69.068167,55.38525],[68.1691,54.970392],[65.66687,54.60125],[65.178534,54.354228],[61.4366,54.00625],[60.978066,53.664993],[61.699986,52.979996],[60.739993,52.719986],[60.927269,52.447548],[59.967534,51.96042],[61.588003,51.272659],[61.337424,50.79907],[59.932807,50.842194],[59.642282,50.545442],[58.36332,51.06364],[56.77798,51.04355],[55.71694,50.62171],[54.532878,51.02624],[52.328724,51.718652],[50.766648,51.692762],[48.702382,50.605128],[48.577841,49.87476],[47.54948,50.454698],[46.751596,49.356006],[47.043672,49.152039],[46.466446,48.394152],[47.31524,47.71585],[48.05725,47.74377],[48.694734,47.075628],[48.59325,46.56104],[49.10116,46.39933],[48.64541,45.80629],[47.67591,45.64149],[46.68201,44.6092],[47.59094,43.66016],[47.49252,42.98658],[48.58437,41.80888],[47.987283,41.405819],[47.815666,41.151416],[47.373315,41.219732],[46.686071,41.827137],[46.404951,41.860675],[45.7764,42.09244],[45.470279,42.502781],[44.537623,42.711993],[43.93121,42.55496],[43.75599,42.74083],[42.3944,43.2203],[40.92219,43.38215],[40.076965,43.553104],[39.955009,43.434998],[38.68,44.28],[37.53912,44.65721],[36.67546,45.24469],[37.40317,45.40451],[38.23295,46.24087],[37.67372,46.63657],[39.14767,47.04475],[39.1212,47.26336],[38.223538,47.10219],[38.255112,47.5464],[38.77057,47.82562],[39.738278,47.898937],[39.89562,48.23241],[39.67465,48.78382],[40.080789,49.30743],[40.06904,49.60105],[38.594988,49.926462],[38.010631,49.915662],[37.39346,50.383953],[36.626168,50.225591],[35.356116,50.577197],[35.37791,50.77394],[35.022183,51.207572],[34.224816,51.255993],[34.141978,51.566413],[34.391731,51.768882],[33.7527,52.335075],[32.715761,52.238465],[32.412058,52.288695],[32.15944,52.06125],[31.78597,52.10168],[31.540018,52.742052],[31.305201,53.073996],[31.49764,53.16743],[32.304519,53.132726],[32.693643,53.351421],[32.405599,53.618045],[31.731273,53.794029],[31.791424,53.974639],[31.384472,54.157056],[30.757534,54.811771],[30.971836,55.081548],[30.873909,55.550976],[29.896294,55.789463],[29.371572,55.670091],[29.229513,55.918344],[28.176709,56.16913],[27.855282,56.759326],[27.770016,57.244258],[27.288185,57.474528],[27.716686,57.791899],[27.42015,58.72457],[28.131699,59.300825],[27.98112,59.47537],[29.1177,60.02805],[28.07,60.50352],[30.211107,61.780028],[31.139991,62.357693],[31.516092,62.867687],[30.035872,63.552814],[30.444685,64.204453],[29.54443,64.948672],[30.21765,65.80598],[29.054589,66.944286],[29.977426,67.698297],[28.445944,68.364613],[28.59193,69.064777],[29.39955,69.15692],[31.10108,69.55811],[32.13272,69.90595],[33.77547,69.30142],[36.51396,69.06342],[40.29234,67.9324],[41.05987,67.45713],[41.12595,66.79158],[40.01583,66.26618],[38.38295,65.99953],[33.91871,66.75961],[33.18444,66.63253],[34.81477,65.90015],[34.878574,65.436213],[34.94391,64.41437],[36.23129,64.10945],[37.01273,63.84983],[37.14197,64.33471],[36.539579,64.76446],[37.17604,65.14322],[39.59345,64.52079],[40.4356,64.76446],[39.7626,65.49682],[42.09309,66.47623],[43.01604,66.41858],[43.94975,66.06908],[44.53226,66.75634],[43.69839,67.35245],[44.18795,67.95051],[43.45282,68.57079],[46.25,68.25],[46.82134,67.68997],[45.55517,67.56652],[45.56202,67.01005],[46.34915,66.66767],[47.89416,66.88455],[48.13876,67.52238],[50.22766,67.99867],[53.71743,68.85738],[54.47171,68.80815],[53.48582,68.20131],[54.72628,68.09702],[55.44268,68.43866],[57.31702,68.46628],[58.802,68.88082],[59.94142,68.27844],[61.07784,68.94069],[60.03,69.52],[60.55,69.85],[63.504,69.54739],[64.888115,69.234835],[68.51216,68.09233],[69.18068,68.61563],[68.16444,69.14436],[68.13522,69.35649],[66.93008,69.45461],[67.25976,69.92873],[66.72492,70.70889],[66.69466,71.02897],[68.54006,71.9345],[69.19636,72.84336],[69.94,73.04],[72.58754,72.77629],[72.79603,72.22006],[71.84811,71.40898],[72.47011,71.09019],[72.79188,70.39114],[72.5647,69.02085],[73.66787,68.4079],[73.2387,67.7404],[71.28,66.32],[72.42301,66.17267],[72.82077,66.53267],[73.92099,66.78946],[74.18651,67.28429],[75.052,67.76047],[74.46926,68.32899],[74.93584,68.98918],[73.84236,69.07146],[73.60187,69.62763],[74.3998,70.63175],[73.1011,71.44717],[74.89082,72.12119],[74.65926,72.83227],[75.15801,72.85497],[75.68351,72.30056],[75.28898,71.33556],[76.35911,71.15287],[75.90313,71.87401],[77.57665,72.26717],[79.65202,72.32011],[81.5,71.75],[80.61071,72.58285],[80.51109,73.6482],[82.25,73.85],[84.65526,73.80591],[86.8223,73.93688],[86.00956,74.45967],[87.16682,75.11643],[88.31571,75.14393],[90.26,75.64],[92.90058,75.77333],[93.23421,76.0472],[95.86,76.14],[96.67821,75.91548],[98.92254,76.44689],[100.75967,76.43028],[101.03532,76.86189],[101.99084,77.28754],[104.3516,77.69792],[106.06664,77.37389],[104.705,77.1274],[106.97013,76.97419]]],[[[105.07547,78.30689],[99.43814,77.921],[101.2649,79.23399],[102.08635,79.34641],[102.837815,79.28129],[105.37243,78.71334],[105.07547,78.30689]]],[[[51.136187,80.54728],[49.793685,80.415428],[48.894411,80.339567],[48.754937,80.175468],[47.586119,80.010181],[46.502826,80.247247],[47.072455,80.559424],[44.846958,80.58981],[46.799139,80.771918],[48.318477,80.78401],[48.522806,80.514569],[49.09719,80.753986],[50.039768,80.918885],[51.522933,80.699726],[51.136187,80.54728]]],[[[99.93976,78.88094],[97.75794,78.7562],[94.97259,79.044745],[93.31288,79.4265],[92.5454,80.14379],[91.18107,80.34146],[93.77766,81.0246],[95.940895,81.2504],[97.88385,80.746975],[100.186655,79.780135],[99.93976,78.88094]]]]}},{type:"Feature",id:"RWA",properties:{name:"Rwanda"},geometry:{type:"Polygon",coordinates:[[[30.419105,-1.134659],[30.816135,-1.698914],[30.758309,-2.28725],[30.469696,-2.413858],[29.938359,-2.348487],[29.632176,-2.917858],[29.024926,-2.839258],[29.117479,-2.292211],[29.254835,-2.21511],[29.291887,-1.620056],[29.579466,-1.341313],[29.821519,-1.443322],[30.419105,-1.134659]]]}},{type:"Feature",id:"ESH",properties:{name:"Western Sahara"},geometry:{type:"Polygon",coordinates:[[[-8.794884,27.120696],[-8.817828,27.656426],[-8.66559,27.656426],[-8.665124,27.589479],[-8.6844,27.395744],[-8.687294,25.881056],[-11.969419,25.933353],[-11.937224,23.374594],[-12.874222,23.284832],[-13.118754,22.77122],[-12.929102,21.327071],[-16.845194,21.333323],[-17.063423,20.999752],[-17.020428,21.42231],[-17.002962,21.420734],[-14.750955,21.5006],[-14.630833,21.86094],[-14.221168,22.310163],[-13.89111,23.691009],[-12.500963,24.770116],[-12.030759,26.030866],[-11.71822,26.104092],[-11.392555,26.883424],[-10.551263,26.990808],[-10.189424,26.860945],[-9.735343,26.860945],[-9.413037,27.088476],[-8.794884,27.120696]]]}},{type:"Feature",id:"SAU",properties:{name:"Saudi Arabia"},geometry:{type:"Polygon",coordinates:[[[42.779332,16.347891],[42.649573,16.774635],[42.347989,17.075806],[42.270888,17.474722],[41.754382,17.833046],[41.221391,18.6716],[40.939341,19.486485],[40.247652,20.174635],[39.801685,20.338862],[39.139399,21.291905],[39.023696,21.986875],[39.066329,22.579656],[38.492772,23.688451],[38.02386,24.078686],[37.483635,24.285495],[37.154818,24.858483],[37.209491,25.084542],[36.931627,25.602959],[36.639604,25.826228],[36.249137,26.570136],[35.640182,27.37652],[35.130187,28.063352],[34.632336,28.058546],[34.787779,28.607427],[34.83222,28.957483],[34.956037,29.356555],[36.068941,29.197495],[36.501214,29.505254],[36.740528,29.865283],[37.503582,30.003776],[37.66812,30.338665],[37.998849,30.5085],[37.002166,31.508413],[39.004886,32.010217],[39.195468,32.161009],[40.399994,31.889992],[41.889981,31.190009],[44.709499,29.178891],[46.568713,29.099025],[47.459822,29.002519],[47.708851,28.526063],[48.416094,28.552004],[48.807595,27.689628],[49.299554,27.461218],[49.470914,27.109999],[50.152422,26.689663],[50.212935,26.277027],[50.113303,25.943972],[50.239859,25.60805],[50.527387,25.327808],[50.660557,24.999896],[50.810108,24.754743],[51.112415,24.556331],[51.389608,24.627386],[51.579519,24.245497],[51.617708,24.014219],[52.000733,23.001154],[55.006803,22.496948],[55.208341,22.70833],[55.666659,22.000001],[54.999982,19.999994],[52.00001,19.000003],[49.116672,18.616668],[48.183344,18.166669],[47.466695,17.116682],[47.000005,16.949999],[46.749994,17.283338],[46.366659,17.233315],[45.399999,17.333335],[45.216651,17.433329],[44.062613,17.410359],[43.791519,17.319977],[43.380794,17.579987],[43.115798,17.08844],[43.218375,16.66689],[42.779332,16.347891]]]}},{type:"Feature",id:"SDN",properties:{name:"Sudan"},geometry:{type:"Polygon",coordinates:[[[33.963393,9.464285],[33.824963,9.484061],[33.842131,9.981915],[33.721959,10.325262],[33.206938,10.720112],[33.086766,11.441141],[33.206938,12.179338],[32.743419,12.248008],[32.67475,12.024832],[32.073892,11.97333],[32.314235,11.681484],[32.400072,11.080626],[31.850716,10.531271],[31.352862,9.810241],[30.837841,9.707237],[29.996639,10.290927],[29.618957,10.084919],[29.515953,9.793074],[29.000932,9.604232],[28.966597,9.398224],[27.97089,9.398224],[27.833551,9.604232],[27.112521,9.638567],[26.752006,9.466893],[26.477328,9.55273],[25.962307,10.136421],[25.790633,10.411099],[25.069604,10.27376],[24.794926,9.810241],[24.537415,8.917538],[24.194068,8.728696],[23.88698,8.61973],[23.805813,8.666319],[23.459013,8.954286],[23.394779,9.265068],[23.55725,9.681218],[23.554304,10.089255],[22.977544,10.714463],[22.864165,11.142395],[22.87622,11.38461],[22.50869,11.67936],[22.49762,12.26024],[22.28801,12.64605],[21.93681,12.58818],[22.03759,12.95546],[22.29658,13.37232],[22.18329,13.78648],[22.51202,14.09318],[22.30351,14.32682],[22.56795,14.94429],[23.02459,15.68072],[23.88689,15.61084],[23.83766,19.58047],[23.85,20],[25,20.00304],[25,22],[29.02,22],[32.9,22],[36.86623,22],[37.18872,21.01885],[36.96941,20.83744],[37.1147,19.80796],[37.48179,18.61409],[37.86276,18.36786],[38.41009,17.998307],[37.904,17.42754],[37.16747,17.26314],[36.85253,16.95655],[36.75389,16.29186],[36.32322,14.82249],[36.42951,14.42211],[36.27022,13.56333],[35.86363,12.57828],[35.26049,12.08286],[34.83163,11.31896],[34.73115,10.91017],[34.25745,10.63009],[33.96162,9.58358],[33.963393,9.464285]]]}},{type:"Feature",id:"SDS",properties:{name:"South Sudan"},geometry:{type:"Polygon",coordinates:[[[33.963393,9.464285],[33.97498,8.68456],[33.8255,8.37916],[33.2948,8.35458],[32.95418,7.78497],[33.56829,7.71334],[34.0751,7.22595],[34.25032,6.82607],[34.70702,6.59422],[35.298007,5.506],[34.620196,4.847123],[34.005,4.249885],[33.39,3.79],[32.68642,3.79232],[31.88145,3.55827],[31.24556,3.7819],[30.83385,3.50917],[29.95349,4.1737],[29.715995,4.600805],[29.159078,4.389267],[28.696678,4.455077],[28.428994,4.287155],[27.979977,4.408413],[27.374226,5.233944],[27.213409,5.550953],[26.465909,5.946717],[26.213418,6.546603],[25.796648,6.979316],[25.124131,7.500085],[25.114932,7.825104],[24.567369,8.229188],[23.88698,8.61973],[24.194068,8.728696],[24.537415,8.917538],[24.794926,9.810241],[25.069604,10.27376],[25.790633,10.411099],[25.962307,10.136421],[26.477328,9.55273],[26.752006,9.466893],[27.112521,9.638567],[27.833551,9.604232],[27.97089,9.398224],[28.966597,9.398224],[29.000932,9.604232],[29.515953,9.793074],[29.618957,10.084919],[29.996639,10.290927],[30.837841,9.707237],[31.352862,9.810241],[31.850716,10.531271],[32.400072,11.080626],[32.314235,11.681484],[32.073892,11.97333],[32.67475,12.024832],[32.743419,12.248008],[33.206938,12.179338],[33.086766,11.441141],[33.206938,10.720112],[33.721959,10.325262],[33.842131,9.981915],[33.824963,9.484061],[33.963393,9.464285]]]}},{type:"Feature",id:"SEN",properties:{name:"Senegal"},geometry:{type:"Polygon",coordinates:[[[-16.713729,13.594959],[-17.126107,14.373516],[-17.625043,14.729541],[-17.185173,14.919477],[-16.700706,15.621527],[-16.463098,16.135036],[-16.12069,16.455663],[-15.623666,16.369337],[-15.135737,16.587282],[-14.577348,16.598264],[-14.099521,16.304302],[-13.435738,16.039383],[-12.830658,15.303692],[-12.17075,14.616834],[-12.124887,13.994727],[-11.927716,13.422075],[-11.553398,13.141214],[-11.467899,12.754519],[-11.513943,12.442988],[-11.658301,12.386583],[-12.203565,12.465648],[-12.278599,12.35444],[-12.499051,12.33209],[-13.217818,12.575874],[-13.700476,12.586183],[-15.548477,12.62817],[-15.816574,12.515567],[-16.147717,12.547762],[-16.677452,12.384852],[-16.841525,13.151394],[-15.931296,13.130284],[-15.691001,13.270353],[-15.511813,13.27857],[-15.141163,13.509512],[-14.712197,13.298207],[-14.277702,13.280585],[-13.844963,13.505042],[-14.046992,13.794068],[-14.376714,13.62568],[-14.687031,13.630357],[-15.081735,13.876492],[-15.39877,13.860369],[-15.624596,13.623587],[-16.713729,13.594959]]]}},{type:"Feature",id:"SLB",properties:{name:"Solomon Islands"},geometry:{type:"MultiPolygon",coordinates:[[[[162.119025,-10.482719],[162.398646,-10.826367],[161.700032,-10.820011],[161.319797,-10.204751],[161.917383,-10.446701],[162.119025,-10.482719]]],[[[160.852229,-9.872937],[160.462588,-9.89521],[159.849447,-9.794027],[159.640003,-9.63998],[159.702945,-9.24295],[160.362956,-9.400304],[160.688518,-9.610162],[160.852229,-9.872937]]],[[[161.679982,-9.599982],[161.529397,-9.784312],[160.788253,-8.917543],[160.579997,-8.320009],[160.920028,-8.320009],[161.280006,-9.120011],[161.679982,-9.599982]]],[[[159.875027,-8.33732],[159.917402,-8.53829],[159.133677,-8.114181],[158.586114,-7.754824],[158.21115,-7.421872],[158.359978,-7.320018],[158.820001,-7.560003],[159.640003,-8.020027],[159.875027,-8.33732]]],[[[157.538426,-7.34782],[157.33942,-7.404767],[156.90203,-7.176874],[156.491358,-6.765943],[156.542828,-6.599338],[157.14,-7.021638],[157.538426,-7.34782]]]]}},{type:"Feature",id:"SLE",properties:{name:"Sierra Leone"},geometry:{type:"Polygon",coordinates:[[[-11.438779,6.785917],[-11.708195,6.860098],[-12.428099,7.262942],[-12.949049,7.798646],[-13.124025,8.163946],[-13.24655,8.903049],[-12.711958,9.342712],[-12.596719,9.620188],[-12.425929,9.835834],[-12.150338,9.858572],[-11.917277,10.046984],[-11.117481,10.045873],[-10.839152,9.688246],[-10.622395,9.26791],[-10.65477,8.977178],[-10.494315,8.715541],[-10.505477,8.348896],[-10.230094,8.406206],[-10.695595,7.939464],[-11.146704,7.396706],[-11.199802,7.105846],[-11.438779,6.785917]]]}},{type:"Feature",id:"SLV",properties:{name:"El Salvador"},geometry:{type:"Polygon",coordinates:[[[-87.793111,13.38448],[-87.904112,13.149017],[-88.483302,13.163951],[-88.843228,13.259734],[-89.256743,13.458533],[-89.812394,13.520622],[-90.095555,13.735338],[-90.064678,13.88197],[-89.721934,14.134228],[-89.534219,14.244816],[-89.587343,14.362586],[-89.353326,14.424133],[-89.058512,14.340029],[-88.843073,14.140507],[-88.541231,13.980155],[-88.503998,13.845486],[-88.065343,13.964626],[-87.859515,13.893312],[-87.723503,13.78505],[-87.793111,13.38448]]]}},{type:"Feature",id:"-99",properties:{name:"Somaliland"},geometry:{type:"Polygon",coordinates:[[[48.93813,9.451749],[48.486736,8.837626],[47.78942,8.003],[46.948328,7.996877],[43.67875,9.18358],[43.296975,9.540477],[42.92812,10.02194],[42.55876,10.57258],[42.776852,10.926879],[43.145305,11.46204],[43.47066,11.27771],[43.666668,10.864169],[44.117804,10.445538],[44.614259,10.442205],[45.556941,10.698029],[46.645401,10.816549],[47.525658,11.127228],[48.021596,11.193064],[48.378784,11.375482],[48.948206,11.410622],[48.942005,11.394266],[48.938491,10.982327],[48.938233,9.9735],[48.93813,9.451749]]]}},{type:"Feature",id:"SOM",properties:{name:"Somalia"},geometry:{type:"Polygon",coordinates:[[[49.72862,11.5789],[50.25878,11.67957],[50.73202,12.0219],[51.1112,12.02464],[51.13387,11.74815],[51.04153,11.16651],[51.04531,10.6409],[50.83418,10.27972],[50.55239,9.19874],[50.07092,8.08173],[49.4527,6.80466],[48.59455,5.33911],[47.74079,4.2194],[46.56476,2.85529],[45.56399,2.04576],[44.06815,1.05283],[43.13597,.2922],[42.04157,-0.91916],[41.81095,-1.44647],[41.58513,-1.68325],[40.993,-0.85829],[40.98105,2.78452],[41.855083,3.918912],[42.12861,4.23413],[42.76967,4.25259],[43.66087,4.95755],[44.9636,5.00162],[47.78942,8.003],[48.486736,8.837626],[48.93813,9.451749],[48.938233,9.9735],[48.938491,10.982327],[48.942005,11.394266],[48.948205,11.410617],[49.26776,11.43033],[49.72862,11.5789]]]}},{type:"Feature",id:"SRB",properties:{name:"Republic of Serbia"},geometry:{type:"Polygon",coordinates:[[[20.874313,45.416375],[21.483526,45.18117],[21.562023,44.768947],[22.145088,44.478422],[22.459022,44.702517],[22.705726,44.578003],[22.474008,44.409228],[22.65715,44.234923],[22.410446,44.008063],[22.500157,43.642814],[22.986019,43.211161],[22.604801,42.898519],[22.436595,42.580321],[22.545012,42.461362],[22.380526,42.32026],[21.91708,42.30364],[21.576636,42.245224],[21.54332,42.32025],[21.66292,42.43922],[21.77505,42.6827],[21.63302,42.67717],[21.43866,42.86255],[21.27421,42.90959],[21.143395,43.068685],[20.95651,43.13094],[20.81448,43.27205],[20.63508,43.21671],[20.49679,42.88469],[20.25758,42.81275],[20.3398,42.89852],[19.95857,43.10604],[19.63,43.21378],[19.48389,43.35229],[19.21852,43.52384],[19.454,43.5681],[19.59976,44.03847],[19.11761,44.42307],[19.36803,44.863],[19.00548,44.86023],[19.390476,45.236516],[19.072769,45.521511],[18.82982,45.90888],[19.596045,46.17173],[20.220192,46.127469],[20.762175,45.734573],[20.874313,45.416375]]]}},{type:"Feature",id:"SUR",properties:{name:"Suriname"},geometry:{type:"Polygon",coordinates:[[[-57.147436,5.97315],[-55.949318,5.772878],[-55.84178,5.953125],[-55.03325,6.025291],[-53.958045,5.756548],[-54.478633,4.896756],[-54.399542,4.212611],[-54.006931,3.620038],[-54.181726,3.18978],[-54.269705,2.732392],[-54.524754,2.311849],[-55.097587,2.523748],[-55.569755,2.421506],[-55.973322,2.510364],[-56.073342,2.220795],[-55.9056,2.021996],[-55.995698,1.817667],[-56.539386,1.899523],[-57.150098,2.768927],[-57.281433,3.333492],[-57.601569,3.334655],[-58.044694,4.060864],[-57.86021,4.576801],[-57.914289,4.812626],[-57.307246,5.073567],[-57.147436,5.97315]]]}},{type:"Feature",id:"SVK",properties:{name:"Slovakia"},geometry:{type:"Polygon",coordinates:[[[18.853144,49.49623],[18.909575,49.435846],[19.320713,49.571574],[19.825023,49.217125],[20.415839,49.431453],[20.887955,49.328772],[21.607808,49.470107],[22.558138,49.085738],[22.280842,48.825392],[22.085608,48.422264],[21.872236,48.319971],[20.801294,48.623854],[20.473562,48.56285],[20.239054,48.327567],[19.769471,48.202691],[19.661364,48.266615],[19.174365,48.111379],[18.777025,48.081768],[18.696513,47.880954],[17.857133,47.758429],[17.488473,47.867466],[16.979667,48.123497],[16.879983,48.470013],[16.960288,48.596982],[17.101985,48.816969],[17.545007,48.800019],[17.886485,48.903475],[17.913512,48.996493],[18.104973,49.043983],[18.170498,49.271515],[18.399994,49.315001],[18.554971,49.495015],[18.853144,49.49623]]]}},{type:"Feature",id:"SVN",properties:{name:"Slovenia"},geometry:{type:"Polygon",coordinates:[[[13.806475,46.509306],[14.632472,46.431817],[15.137092,46.658703],[16.011664,46.683611],[16.202298,46.852386],[16.370505,46.841327],[16.564808,46.503751],[15.768733,46.238108],[15.67153,45.834154],[15.323954,45.731783],[15.327675,45.452316],[14.935244,45.471695],[14.595109,45.634941],[14.411968,45.466166],[13.71506,45.500324],[13.93763,45.591016],[13.69811,46.016778],[13.806475,46.509306]]]}},{type:"Feature",id:"SWE",properties:{name:"Sweden"},geometry:{type:"Polygon",coordinates:[[[22.183173,65.723741],[21.213517,65.026005],[21.369631,64.413588],[19.778876,63.609554],[17.847779,62.7494],[17.119555,61.341166],[17.831346,60.636583],[18.787722,60.081914],[17.869225,58.953766],[16.829185,58.719827],[16.44771,57.041118],[15.879786,56.104302],[14.666681,56.200885],[14.100721,55.407781],[12.942911,55.361737],[12.625101,56.30708],[11.787942,57.441817],[11.027369,58.856149],[11.468272,59.432393],[12.300366,60.117933],[12.631147,61.293572],[11.992064,61.800362],[11.930569,63.128318],[12.579935,64.066219],[13.571916,64.049114],[13.919905,64.445421],[13.55569,64.787028],[15.108411,66.193867],[16.108712,67.302456],[16.768879,68.013937],[17.729182,68.010552],[17.993868,68.567391],[19.87856,68.407194],[20.025269,69.065139],[20.645593,69.106247],[21.978535,68.616846],[23.539473,67.936009],[23.56588,66.396051],[23.903379,66.006927],[22.183173,65.723741]]]}},{type:"Feature",id:"SWZ",properties:{name:"Swaziland"},geometry:{type:"Polygon",coordinates:[[[32.071665,-26.73382],[31.86806,-27.177927],[31.282773,-27.285879],[30.685962,-26.743845],[30.676609,-26.398078],[30.949667,-26.022649],[31.04408,-25.731452],[31.333158,-25.660191],[31.837778,-25.843332],[31.985779,-26.29178],[32.071665,-26.73382]]]}},{type:"Feature",id:"SYR",properties:{name:"Syria"},geometry:{type:"Polygon",coordinates:[[[38.792341,33.378686],[36.834062,32.312938],[35.719918,32.709192],[35.700798,32.716014],[35.836397,32.868123],[35.821101,33.277426],[36.06646,33.824912],[36.61175,34.201789],[36.448194,34.593935],[35.998403,34.644914],[35.905023,35.410009],[36.149763,35.821535],[36.41755,36.040617],[36.685389,36.259699],[36.739494,36.81752],[37.066761,36.623036],[38.167727,36.90121],[38.699891,36.712927],[39.52258,36.716054],[40.673259,37.091276],[41.212089,37.074352],[42.349591,37.229873],[41.837064,36.605854],[41.289707,36.358815],[41.383965,35.628317],[41.006159,34.419372],[38.792341,33.378686]]]}},{type:"Feature",id:"TCD",properties:{name:"Chad"},geometry:{type:"Polygon",coordinates:[[[14.495787,12.859396],[14.595781,13.330427],[13.954477,13.353449],[13.956699,13.996691],[13.540394,14.367134],[13.97217,15.68437],[15.247731,16.627306],[15.300441,17.92795],[15.685741,19.95718],[15.903247,20.387619],[15.487148,20.730415],[15.47106,21.04845],[15.096888,21.308519],[14.8513,22.86295],[15.86085,23.40972],[19.84926,21.49509],[23.83766,19.58047],[23.88689,15.61084],[23.02459,15.68072],[22.56795,14.94429],[22.30351,14.32682],[22.51202,14.09318],[22.18329,13.78648],[22.29658,13.37232],[22.03759,12.95546],[21.93681,12.58818],[22.28801,12.64605],[22.49762,12.26024],[22.50869,11.67936],[22.87622,11.38461],[22.864165,11.142395],[22.231129,10.971889],[21.723822,10.567056],[21.000868,9.475985],[20.059685,9.012706],[19.094008,9.074847],[18.81201,8.982915],[18.911022,8.630895],[18.389555,8.281304],[17.96493,7.890914],[16.705988,7.508328],[16.456185,7.734774],[16.290562,7.754307],[16.106232,7.497088],[15.27946,7.421925],[15.436092,7.692812],[15.120866,8.38215],[14.979996,8.796104],[14.544467,8.965861],[13.954218,9.549495],[14.171466,10.021378],[14.627201,9.920919],[14.909354,9.992129],[15.467873,9.982337],[14.923565,10.891325],[14.960152,11.555574],[14.89336,12.21905],[14.495787,12.859396]]]}},{type:"Feature",id:"TGO",properties:{name:"Togo"},geometry:{type:"Polygon",coordinates:[[[1.865241,6.142158],[1.060122,5.928837],[.836931,6.279979],[.570384,6.914359],[.490957,7.411744],[.712029,8.312465],[.461192,8.677223],[.365901,9.465004],[.36758,10.191213],[-0.049785,10.706918],[.023803,11.018682],[.899563,10.997339],[.772336,10.470808],[1.077795,10.175607],[1.425061,9.825395],[1.463043,9.334624],[1.664478,9.12859],[1.618951,6.832038],[1.865241,6.142158]]]}},{type:"Feature",id:"THA",properties:{name:"Thailand"},geometry:{type:"Polygon",coordinates:[[[102.584932,12.186595],[101.687158,12.64574],[100.83181,12.627085],[100.978467,13.412722],[100.097797,13.406856],[100.018733,12.307001],[99.478921,10.846367],[99.153772,9.963061],[99.222399,9.239255],[99.873832,9.207862],[100.279647,8.295153],[100.459274,7.429573],[101.017328,6.856869],[101.623079,6.740622],[102.141187,6.221636],[101.814282,5.810808],[101.154219,5.691384],[101.075516,6.204867],[100.259596,6.642825],[100.085757,6.464489],[99.690691,6.848213],[99.519642,7.343454],[98.988253,7.907993],[98.503786,8.382305],[98.339662,7.794512],[98.150009,8.350007],[98.25915,8.973923],[98.553551,9.93296],[99.038121,10.960546],[99.587286,11.892763],[99.196354,12.804748],[99.212012,13.269294],[99.097755,13.827503],[98.430819,14.622028],[98.192074,15.123703],[98.537376,15.308497],[98.903348,16.177824],[98.493761,16.837836],[97.859123,17.567946],[97.375896,18.445438],[97.797783,18.62708],[98.253724,19.708203],[98.959676,19.752981],[99.543309,20.186598],[100.115988,20.41785],[100.548881,20.109238],[100.606294,19.508344],[101.282015,19.462585],[101.035931,18.408928],[101.059548,17.512497],[102.113592,18.109102],[102.413005,17.932782],[102.998706,17.961695],[103.200192,18.309632],[103.956477,18.240954],[104.716947,17.428859],[104.779321,16.441865],[105.589039,15.570316],[105.544338,14.723934],[105.218777,14.273212],[104.281418,14.416743],[102.988422,14.225721],[102.348099,13.394247],[102.584932,12.186595]]]}},{type:"Feature",id:"TJK",properties:{name:"Tajikistan"},geometry:{type:"Polygon",coordinates:[[[71.014198,40.244366],[70.648019,39.935754],[69.55961,40.103211],[69.464887,39.526683],[70.549162,39.604198],[71.784694,39.279463],[73.675379,39.431237],[73.928852,38.505815],[74.257514,38.606507],[74.864816,38.378846],[74.829986,37.990007],[74.980002,37.41999],[73.948696,37.421566],[73.260056,37.495257],[72.63689,37.047558],[72.193041,36.948288],[71.844638,36.738171],[71.448693,37.065645],[71.541918,37.905774],[71.239404,37.953265],[71.348131,38.258905],[70.806821,38.486282],[70.376304,38.138396],[70.270574,37.735165],[70.116578,37.588223],[69.518785,37.608997],[69.196273,37.151144],[68.859446,37.344336],[68.135562,37.023115],[67.83,37.144994],[68.392033,38.157025],[68.176025,38.901553],[67.44222,39.140144],[67.701429,39.580478],[68.536416,39.533453],[69.011633,40.086158],[69.329495,40.727824],[70.666622,40.960213],[70.45816,40.496495],[70.601407,40.218527],[71.014198,40.244366]]]}},{type:"Feature",id:"TKM",properties:{name:"Turkmenistan"},geometry:{type:"Polygon",coordinates:[[[61.210817,35.650072],[61.123071,36.491597],[60.377638,36.527383],[59.234762,37.412988],[58.436154,37.522309],[57.330434,38.029229],[56.619366,38.121394],[56.180375,37.935127],[55.511578,37.964117],[54.800304,37.392421],[53.921598,37.198918],[53.735511,37.906136],[53.880929,38.952093],[53.101028,39.290574],[53.357808,39.975286],[52.693973,40.033629],[52.915251,40.876523],[53.858139,40.631034],[54.736845,40.951015],[54.008311,41.551211],[53.721713,42.123191],[52.91675,41.868117],[52.814689,41.135371],[52.50246,41.783316],[52.944293,42.116034],[54.079418,42.324109],[54.755345,42.043971],[55.455251,41.259859],[55.968191,41.308642],[57.096391,41.32231],[56.932215,41.826026],[57.78653,42.170553],[58.629011,42.751551],[59.976422,42.223082],[60.083341,41.425146],[60.465953,41.220327],[61.547179,41.26637],[61.882714,41.084857],[62.37426,40.053886],[63.518015,39.363257],[64.170223,38.892407],[65.215999,38.402695],[66.54615,37.974685],[66.518607,37.362784],[66.217385,37.39379],[65.745631,37.661164],[65.588948,37.305217],[64.746105,37.111818],[64.546479,36.312073],[63.982896,36.007957],[63.193538,35.857166],[62.984662,35.404041],[62.230651,35.270664],[61.210817,35.650072]]]}},{type:"Feature",id:"TLS",properties:{name:"East Timor"},geometry:{type:"Polygon",coordinates:[[[124.968682,-8.89279],[125.086246,-8.656887],[125.947072,-8.432095],[126.644704,-8.398247],[126.957243,-8.273345],[127.335928,-8.397317],[126.967992,-8.668256],[125.925885,-9.106007],[125.08852,-9.393173],[125.07002,-9.089987],[124.968682,-8.89279]]]}},{type:"Feature",id:"TTO",properties:{name:"Trinidad and Tobago"},geometry:{type:"Polygon",coordinates:[[[-61.68,10.76],[-61.105,10.89],[-60.895,10.855],[-60.935,10.11],[-61.77,10],[-61.95,10.09],[-61.66,10.365],[-61.68,10.76]]]}},{type:"Feature",id:"TUN",properties:{name:"Tunisia"},geometry:{type:"Polygon",coordinates:[[[9.48214,30.307556],[9.055603,32.102692],[8.439103,32.506285],[8.430473,32.748337],[7.612642,33.344115],[7.524482,34.097376],[8.140981,34.655146],[8.376368,35.479876],[8.217824,36.433177],[8.420964,36.946427],[9.509994,37.349994],[10.210002,37.230002],[10.18065,36.724038],[11.028867,37.092103],[11.100026,36.899996],[10.600005,36.41],[10.593287,35.947444],[10.939519,35.698984],[10.807847,34.833507],[10.149593,34.330773],[10.339659,33.785742],[10.856836,33.76874],[11.108501,33.293343],[11.488787,33.136996],[11.432253,32.368903],[10.94479,32.081815],[10.636901,31.761421],[9.950225,31.37607],[10.056575,30.961831],[9.970017,30.539325],[9.48214,30.307556]]]}},{type:"Feature",id:"TUR",properties:{name:"Turkey"},geometry:{type:"MultiPolygon",coordinates:[[[[36.913127,41.335358],[38.347665,40.948586],[39.512607,41.102763],[40.373433,41.013673],[41.554084,41.535656],[42.619549,41.583173],[43.582746,41.092143],[43.752658,40.740201],[43.656436,40.253564],[44.400009,40.005],[44.79399,39.713003],[44.109225,39.428136],[44.421403,38.281281],[44.225756,37.971584],[44.772699,37.170445],[44.293452,37.001514],[43.942259,37.256228],[42.779126,37.385264],[42.349591,37.229873],[41.212089,37.074352],[40.673259,37.091276],[39.52258,36.716054],[38.699891,36.712927],[38.167727,36.90121],[37.066761,36.623036],[36.739494,36.81752],[36.685389,36.259699],[36.41755,36.040617],[36.149763,35.821535],[35.782085,36.274995],[36.160822,36.650606],[35.550936,36.565443],[34.714553,36.795532],[34.026895,36.21996],[32.509158,36.107564],[31.699595,36.644275],[30.621625,36.677865],[30.391096,36.262981],[29.699976,36.144357],[28.732903,36.676831],[27.641187,36.658822],[27.048768,37.653361],[26.318218,38.208133],[26.8047,38.98576],[26.170785,39.463612],[27.28002,40.420014],[28.819978,40.460011],[29.240004,41.219991],[31.145934,41.087622],[32.347979,41.736264],[33.513283,42.01896],[35.167704,42.040225],[36.913127,41.335358]]],[[[27.192377,40.690566],[26.358009,40.151994],[26.043351,40.617754],[26.056942,40.824123],[26.294602,40.936261],[26.604196,41.562115],[26.117042,41.826905],[27.135739,42.141485],[27.99672,42.007359],[28.115525,41.622886],[28.988443,41.299934],[28.806438,41.054962],[27.619017,40.999823],[27.192377,40.690566]]]]}},{type:"Feature",id:"TWN",properties:{name:"Taiwan"},geometry:{type:"Polygon",coordinates:[[[121.777818,24.394274],[121.175632,22.790857],[120.74708,21.970571],[120.220083,22.814861],[120.106189,23.556263],[120.69468,24.538451],[121.495044,25.295459],[121.951244,24.997596],[121.777818,24.394274]]]}},{type:"Feature",id:"TZA",properties:{name:"Tanzania"},geometry:{type:"Polygon",coordinates:[[[33.903711,-0.95],[34.07262,-1.05982],[37.69869,-3.09699],[37.7669,-3.67712],[39.20222,-4.67677],[38.74054,-5.90895],[38.79977,-6.47566],[39.44,-6.84],[39.47,-7.1],[39.19469,-7.7039],[39.25203,-8.00781],[39.18652,-8.48551],[39.53574,-9.11237],[39.9496,-10.0984],[40.31659,-10.3171],[39.521,-10.89688],[38.427557,-11.285202],[37.82764,-11.26879],[37.47129,-11.56876],[36.775151,-11.594537],[36.514082,-11.720938],[35.312398,-11.439146],[34.559989,-11.52002],[34.28,-10.16],[33.940838,-9.693674],[33.73972,-9.41715],[32.759375,-9.230599],[32.191865,-8.930359],[31.556348,-8.762049],[31.157751,-8.594579],[30.74,-8.34],[30.2,-7.08],[29.62,-6.52],[29.419993,-5.939999],[29.519987,-5.419979],[29.339998,-4.499983],[29.753512,-4.452389],[30.11632,-4.09012],[30.50554,-3.56858],[30.75224,-3.35931],[30.74301,-3.03431],[30.52766,-2.80762],[30.46967,-2.41383],[30.758309,-2.28725],[30.816135,-1.698914],[30.419105,-1.134659],[30.76986,-1.01455],[31.86617,-1.02736],[33.903711,-0.95]]]}},{type:"Feature",id:"UGA",properties:{name:"Uganda"},geometry:{type:"Polygon",coordinates:[[[31.86617,-1.02736],[30.76986,-1.01455],[30.419105,-1.134659],[29.821519,-1.443322],[29.579466,-1.341313],[29.587838,-0.587406],[29.8195,-0.2053],[29.875779,.59738],[30.086154,1.062313],[30.468508,1.583805],[30.85267,1.849396],[31.174149,2.204465],[30.77332,2.33989],[30.83385,3.50917],[31.24556,3.7819],[31.88145,3.55827],[32.68642,3.79232],[33.39,3.79],[34.005,4.249885],[34.47913,3.5556],[34.59607,3.05374],[35.03599,1.90584],[34.6721,1.17694],[34.18,.515],[33.893569,.109814],[33.903711,-0.95],[31.86617,-1.02736]]]}},{type:"Feature",id:"UKR",properties:{name:"Ukraine"},geometry:{type:"Polygon",coordinates:[[[31.785998,52.101678],[32.159412,52.061267],[32.412058,52.288695],[32.715761,52.238465],[33.7527,52.335075],[34.391731,51.768882],[34.141978,51.566413],[34.224816,51.255993],[35.022183,51.207572],[35.377924,50.773955],[35.356116,50.577197],[36.626168,50.225591],[37.39346,50.383953],[38.010631,49.915662],[38.594988,49.926462],[40.069058,49.601055],[40.080789,49.30743],[39.674664,48.783818],[39.895632,48.232405],[39.738278,47.898937],[38.770585,47.825608],[38.255112,47.5464],[38.223538,47.10219],[37.425137,47.022221],[36.759855,46.6987],[35.823685,46.645964],[34.962342,46.273197],[35.020788,45.651219],[35.510009,45.409993],[36.529998,45.46999],[36.334713,45.113216],[35.239999,44.939996],[33.882511,44.361479],[33.326421,44.564877],[33.546924,45.034771],[32.454174,45.327466],[32.630804,45.519186],[33.588162,45.851569],[33.298567,46.080598],[31.74414,46.333348],[31.675307,46.706245],[30.748749,46.5831],[30.377609,46.03241],[29.603289,45.293308],[29.149725,45.464925],[28.679779,45.304031],[28.233554,45.488283],[28.485269,45.596907],[28.659987,45.939987],[28.933717,46.25883],[28.862972,46.437889],[29.072107,46.517678],[29.170654,46.379262],[29.759972,46.349988],[30.024659,46.423937],[29.83821,46.525326],[29.908852,46.674361],[29.559674,46.928583],[29.415135,47.346645],[29.050868,47.510227],[29.122698,47.849095],[28.670891,48.118149],[28.259547,48.155562],[27.522537,48.467119],[26.857824,48.368211],[26.619337,48.220726],[26.19745,48.220881],[25.945941,47.987149],[25.207743,47.891056],[24.866317,47.737526],[24.402056,47.981878],[23.760958,47.985598],[23.142236,48.096341],[22.710531,47.882194],[22.64082,48.15024],[22.085608,48.422264],[22.280842,48.825392],[22.558138,49.085738],[22.776419,49.027395],[22.51845,49.476774],[23.426508,50.308506],[23.922757,50.424881],[24.029986,50.705407],[23.527071,51.578454],[24.005078,51.617444],[24.553106,51.888461],[25.327788,51.910656],[26.337959,51.832289],[27.454066,51.592303],[28.241615,51.572227],[28.617613,51.427714],[28.992835,51.602044],[29.254938,51.368234],[30.157364,51.416138],[30.555117,51.319503],[30.619454,51.822806],[30.927549,52.042353],[31.785998,52.101678]]]}},{type:"Feature",id:"URY",properties:{name:"Uruguay"},geometry:{type:"Polygon",coordinates:[[[-57.625133,-30.216295],[-56.976026,-30.109686],[-55.973245,-30.883076],[-55.60151,-30.853879],[-54.572452,-31.494511],[-53.787952,-32.047243],[-53.209589,-32.727666],[-53.650544,-33.202004],[-53.373662,-33.768378],[-53.806426,-34.396815],[-54.935866,-34.952647],[-55.67409,-34.752659],[-56.215297,-34.859836],[-57.139685,-34.430456],[-57.817861,-34.462547],[-58.427074,-33.909454],[-58.349611,-33.263189],[-58.132648,-33.040567],[-58.14244,-32.044504],[-57.874937,-31.016556],[-57.625133,-30.216295]]]}},{type:"Feature",id:"USA",properties:{name:"United States of America"},geometry:{type:"MultiPolygon",coordinates:[[[[-155.54211,19.08348],[-155.68817,18.91619],[-155.93665,19.05939],[-155.90806,19.33888],[-156.07347,19.70294],[-156.02368,19.81422],[-155.85008,19.97729],[-155.91907,20.17395],[-155.86108,20.26721],[-155.78505,20.2487],[-155.40214,20.07975],[-155.22452,19.99302],[-155.06226,19.8591],[-154.80741,19.50871],[-154.83147,19.45328],[-155.22217,19.23972],[-155.54211,19.08348]]],[[[-156.07926,20.64397],[-156.41445,20.57241],[-156.58673,20.783],[-156.70167,20.8643],[-156.71055,20.92676],[-156.61258,21.01249],[-156.25711,20.91745],[-155.99566,20.76404],[-156.07926,20.64397]]],[[[-156.75824,21.17684],[-156.78933,21.06873],[-157.32521,21.09777],[-157.25027,21.21958],[-156.75824,21.17684]]],[[[-157.65283,21.32217],[-157.70703,21.26442],[-157.7786,21.27729],[-158.12667,21.31244],[-158.2538,21.53919],[-158.29265,21.57912],[-158.0252,21.71696],[-157.94161,21.65272],[-157.65283,21.32217]]],[[[-159.34512,21.982],[-159.46372,21.88299],[-159.80051,22.06533],[-159.74877,22.1382],[-159.5962,22.23618],[-159.36569,22.21494],[-159.34512,21.982]]],[[[-94.81758,49.38905],[-94.64,48.84],[-94.32914,48.67074],[-93.63087,48.60926],[-92.61,48.45],[-91.64,48.14],[-90.83,48.27],[-89.6,48.01],[-89.272917,48.019808],[-88.378114,48.302918],[-87.439793,47.94],[-86.461991,47.553338],[-85.652363,47.220219],[-84.87608,46.900083],[-84.779238,46.637102],[-84.543749,46.538684],[-84.6049,46.4396],[-84.3367,46.40877],[-84.14212,46.512226],[-84.091851,46.275419],[-83.890765,46.116927],[-83.616131,46.116927],[-83.469551,45.994686],[-83.592851,45.816894],[-82.550925,45.347517],[-82.337763,44.44],[-82.137642,43.571088],[-82.43,42.98],[-82.9,42.43],[-83.12,42.08],[-83.142,41.975681],[-83.02981,41.832796],[-82.690089,41.675105],[-82.439278,41.675105],[-81.277747,42.209026],[-80.247448,42.3662],[-78.939362,42.863611],[-78.92,42.965],[-79.01,43.27],[-79.171674,43.466339],[-78.72028,43.625089],[-77.737885,43.629056],[-76.820034,43.628784],[-76.5,44.018459],[-76.375,44.09631],[-75.31821,44.81645],[-74.867,45.00048],[-73.34783,45.00738],[-71.50506,45.0082],[-71.405,45.255],[-71.08482,45.30524],[-70.66,45.46],[-70.305,45.915],[-69.99997,46.69307],[-69.237216,47.447781],[-68.905,47.185],[-68.23444,47.35486],[-67.79046,47.06636],[-67.79134,45.70281],[-67.13741,45.13753],[-66.96466,44.8097],[-68.03252,44.3252],[-69.06,43.98],[-70.11617,43.68405],[-70.645476,43.090238],[-70.81489,42.8653],[-70.825,42.335],[-70.495,41.805],[-70.08,41.78],[-70.185,42.145],[-69.88497,41.92283],[-69.96503,41.63717],[-70.64,41.475],[-71.12039,41.49445],[-71.86,41.32],[-72.295,41.27],[-72.87643,41.22065],[-73.71,40.931102],[-72.24126,41.11948],[-71.945,40.93],[-73.345,40.63],[-73.982,40.628],[-73.952325,40.75075],[-74.25671,40.47351],[-73.96244,40.42763],[-74.17838,39.70926],[-74.90604,38.93954],[-74.98041,39.1964],[-75.20002,39.24845],[-75.52805,39.4985],[-75.32,38.96],[-75.071835,38.782032],[-75.05673,38.40412],[-75.37747,38.01551],[-75.94023,37.21689],[-76.03127,37.2566],[-75.72205,37.93705],[-76.23287,38.319215],[-76.35,39.15],[-76.542725,38.717615],[-76.32933,38.08326],[-76.989998,38.239992],[-76.30162,37.917945],[-76.25874,36.9664],[-75.9718,36.89726],[-75.86804,36.55125],[-75.72749,35.55074],[-76.36318,34.80854],[-77.397635,34.51201],[-78.05496,33.92547],[-78.55435,33.86133],[-79.06067,33.49395],[-79.20357,33.15839],[-80.301325,32.509355],[-80.86498,32.0333],[-81.33629,31.44049],[-81.49042,30.72999],[-81.31371,30.03552],[-80.98,29.18],[-80.535585,28.47213],[-80.53,28.04],[-80.056539,26.88],[-80.088015,26.205765],[-80.13156,25.816775],[-80.38103,25.20616],[-80.68,25.08],[-81.17213,25.20126],[-81.33,25.64],[-81.71,25.87],[-82.24,26.73],[-82.70515,27.49504],[-82.85526,27.88624],[-82.65,28.55],[-82.93,29.1],[-83.70959,29.93656],[-84.1,30.09],[-85.10882,29.63615],[-85.28784,29.68612],[-85.7731,30.15261],[-86.4,30.4],[-87.53036,30.27433],[-88.41782,30.3849],[-89.18049,30.31598],[-89.593831,30.159994],[-89.413735,29.89419],[-89.43,29.48864],[-89.21767,29.29108],[-89.40823,29.15961],[-89.77928,29.30714],[-90.15463,29.11743],[-90.880225,29.148535],[-91.626785,29.677],[-92.49906,29.5523],[-93.22637,29.78375],[-93.84842,29.71363],[-94.69,29.48],[-95.60026,28.73863],[-96.59404,28.30748],[-97.14,27.83],[-97.37,27.38],[-97.38,26.69],[-97.33,26.21],[-97.14,25.87],[-97.53,25.84],[-98.24,26.06],[-99.02,26.37],[-99.3,26.84],[-99.52,27.54],[-100.11,28.11],[-100.45584,28.69612],[-100.9576,29.38071],[-101.6624,29.7793],[-102.48,29.76],[-103.11,28.97],[-103.94,29.27],[-104.45697,29.57196],[-104.70575,30.12173],[-105.03737,30.64402],[-105.63159,31.08383],[-106.1429,31.39995],[-106.50759,31.75452],[-108.24,31.754854],[-108.24194,31.34222],[-109.035,31.34194],[-111.02361,31.33472],[-113.30498,32.03914],[-114.815,32.52528],[-114.72139,32.72083],[-115.99135,32.61239],[-117.12776,32.53534],[-117.295938,33.046225],[-117.944,33.621236],[-118.410602,33.740909],[-118.519895,34.027782],[-119.081,34.078],[-119.438841,34.348477],[-120.36778,34.44711],[-120.62286,34.60855],[-120.74433,35.15686],[-121.71457,36.16153],[-122.54747,37.55176],[-122.51201,37.78339],[-122.95319,38.11371],[-123.7272,38.95166],[-123.86517,39.76699],[-124.39807,40.3132],[-124.17886,41.14202],[-124.2137,41.99964],[-124.53284,42.76599],[-124.14214,43.70838],[-124.020535,44.615895],[-123.89893,45.52341],[-124.079635,46.86475],[-124.39567,47.72017],[-124.68721,48.184433],[-124.566101,48.379715],[-123.12,48.04],[-122.58736,47.096],[-122.34,47.36],[-122.5,48.18],[-122.84,49],[-120,49],[-117.03121,49],[-116.04818,49],[-113,49],[-110.05,49],[-107.05,49],[-104.04826,48.99986],[-100.65,49],[-97.22872,49.0007],[-95.15907,49],[-95.15609,49.38425],[-94.81758,49.38905]]],[[[-153.006314,57.115842],[-154.00509,56.734677],[-154.516403,56.992749],[-154.670993,57.461196],[-153.76278,57.816575],[-153.228729,57.968968],[-152.564791,57.901427],[-152.141147,57.591059],[-153.006314,57.115842]]],[[[-165.579164,59.909987],[-166.19277,59.754441],[-166.848337,59.941406],[-167.455277,60.213069],[-166.467792,60.38417],[-165.67443,60.293607],[-165.579164,59.909987]]],[[[-171.731657,63.782515],[-171.114434,63.592191],[-170.491112,63.694975],[-169.682505,63.431116],[-168.689439,63.297506],[-168.771941,63.188598],[-169.52944,62.976931],[-170.290556,63.194438],[-170.671386,63.375822],[-171.553063,63.317789],[-171.791111,63.405846],[-171.731657,63.782515]]],[[[-155.06779,71.147776],[-154.344165,70.696409],[-153.900006,70.889989],[-152.210006,70.829992],[-152.270002,70.600006],[-150.739992,70.430017],[-149.720003,70.53001],[-147.613362,70.214035],[-145.68999,70.12001],[-144.920011,69.989992],[-143.589446,70.152514],[-142.07251,69.851938],[-140.985988,69.711998],[-140.985988,69.711998],[-140.992499,66.000029],[-140.99777,60.306397],[-140.012998,60.276838],[-139.039,60.000007],[-138.34089,59.56211],[-137.4525,58.905],[-136.47972,59.46389],[-135.47583,59.78778],[-134.945,59.27056],[-134.27111,58.86111],[-133.355549,58.410285],[-132.73042,57.69289],[-131.70781,56.55212],[-130.00778,55.91583],[-129.979994,55.284998],[-130.53611,54.802753],[-131.085818,55.178906],[-131.967211,55.497776],[-132.250011,56.369996],[-133.539181,57.178887],[-134.078063,58.123068],[-135.038211,58.187715],[-136.628062,58.212209],[-137.800006,58.499995],[-139.867787,59.537762],[-140.825274,59.727517],[-142.574444,60.084447],[-143.958881,59.99918],[-145.925557,60.45861],[-147.114374,60.884656],[-148.224306,60.672989],[-148.018066,59.978329],[-148.570823,59.914173],[-149.727858,59.705658],[-150.608243,59.368211],[-151.716393,59.155821],[-151.859433,59.744984],[-151.409719,60.725803],[-150.346941,61.033588],[-150.621111,61.284425],[-151.895839,60.727198],[-152.57833,60.061657],[-154.019172,59.350279],[-153.287511,58.864728],[-154.232492,58.146374],[-155.307491,57.727795],[-156.308335,57.422774],[-156.556097,56.979985],[-158.117217,56.463608],[-158.433321,55.994154],[-159.603327,55.566686],[-160.28972,55.643581],[-161.223048,55.364735],[-162.237766,55.024187],[-163.069447,54.689737],[-164.785569,54.404173],[-164.942226,54.572225],[-163.84834,55.039431],[-162.870001,55.348043],[-161.804175,55.894986],[-160.563605,56.008055],[-160.07056,56.418055],[-158.684443,57.016675],[-158.461097,57.216921],[-157.72277,57.570001],[-157.550274,58.328326],[-157.041675,58.918885],[-158.194731,58.615802],[-158.517218,58.787781],[-159.058606,58.424186],[-159.711667,58.93139],[-159.981289,58.572549],[-160.355271,59.071123],[-161.355003,58.670838],[-161.968894,58.671665],[-162.054987,59.266925],[-161.874171,59.633621],[-162.518059,59.989724],[-163.818341,59.798056],[-164.662218,60.267484],[-165.346388,60.507496],[-165.350832,61.073895],[-166.121379,61.500019],[-165.734452,62.074997],[-164.919179,62.633076],[-164.562508,63.146378],[-163.753332,63.219449],[-163.067224,63.059459],[-162.260555,63.541936],[-161.53445,63.455817],[-160.772507,63.766108],[-160.958335,64.222799],[-161.518068,64.402788],[-160.777778,64.788604],[-161.391926,64.777235],[-162.45305,64.559445],[-162.757786,64.338605],[-163.546394,64.55916],[-164.96083,64.446945],[-166.425288,64.686672],[-166.845004,65.088896],[-168.11056,65.669997],[-166.705271,66.088318],[-164.47471,66.57666],[-163.652512,66.57666],[-163.788602,66.077207],[-161.677774,66.11612],[-162.489715,66.735565],[-163.719717,67.116395],[-164.430991,67.616338],[-165.390287,68.042772],[-166.764441,68.358877],[-166.204707,68.883031],[-164.430811,68.915535],[-163.168614,69.371115],[-162.930566,69.858062],[-161.908897,70.33333],[-160.934797,70.44769],[-159.039176,70.891642],[-158.119723,70.824721],[-156.580825,71.357764],[-155.06779,71.147776]]]]}},{type:"Feature",id:"UZB",properties:{name:"Uzbekistan"},geometry:{type:"Polygon",coordinates:[[[66.518607,37.362784],[66.54615,37.974685],[65.215999,38.402695],[64.170223,38.892407],[63.518015,39.363257],[62.37426,40.053886],[61.882714,41.084857],[61.547179,41.26637],[60.465953,41.220327],[60.083341,41.425146],[59.976422,42.223082],[58.629011,42.751551],[57.78653,42.170553],[56.932215,41.826026],[57.096391,41.32231],[55.968191,41.308642],[55.928917,44.995858],[58.503127,45.586804],[58.689989,45.500014],[60.239972,44.784037],[61.05832,44.405817],[62.0133,43.504477],[63.185787,43.650075],[64.900824,43.728081],[66.098012,42.99766],[66.023392,41.994646],[66.510649,41.987644],[66.714047,41.168444],[67.985856,41.135991],[68.259896,40.662325],[68.632483,40.668681],[69.070027,41.384244],[70.388965,42.081308],[70.962315,42.266154],[71.259248,42.167711],[70.420022,41.519998],[71.157859,41.143587],[71.870115,41.3929],[73.055417,40.866033],[71.774875,40.145844],[71.014198,40.244366],[70.601407,40.218527],[70.45816,40.496495],[70.666622,40.960213],[69.329495,40.727824],[69.011633,40.086158],[68.536416,39.533453],[67.701429,39.580478],[67.44222,39.140144],[68.176025,38.901553],[68.392033,38.157025],[67.83,37.144994],[67.075782,37.356144],[66.518607,37.362784]]]}},{type:"Feature",id:"VEN",properties:{name:"Venezuela"},geometry:{type:"Polygon",coordinates:[[[-71.331584,11.776284],[-71.360006,11.539994],[-71.94705,11.423282],[-71.620868,10.96946],[-71.633064,10.446494],[-72.074174,9.865651],[-71.695644,9.072263],[-71.264559,9.137195],[-71.039999,9.859993],[-71.350084,10.211935],[-71.400623,10.968969],[-70.155299,11.375482],[-70.293843,11.846822],[-69.943245,12.162307],[-69.5843,11.459611],[-68.882999,11.443385],[-68.233271,10.885744],[-68.194127,10.554653],[-67.296249,10.545868],[-66.227864,10.648627],[-65.655238,10.200799],[-64.890452,10.077215],[-64.329479,10.389599],[-64.318007,10.641418],[-63.079322,10.701724],[-61.880946,10.715625],[-62.730119,10.420269],[-62.388512,9.948204],[-61.588767,9.873067],[-60.830597,9.38134],[-60.671252,8.580174],[-60.150096,8.602757],[-59.758285,8.367035],[-60.550588,7.779603],[-60.637973,7.415],[-60.295668,7.043911],[-60.543999,6.856584],[-61.159336,6.696077],[-61.139415,6.234297],[-61.410303,5.959068],[-60.733574,5.200277],[-60.601179,4.918098],[-60.966893,4.536468],[-62.08543,4.162124],[-62.804533,4.006965],[-63.093198,3.770571],[-63.888343,4.02053],[-64.628659,4.148481],[-64.816064,4.056445],[-64.368494,3.79721],[-64.408828,3.126786],[-64.269999,2.497006],[-63.422867,2.411068],[-63.368788,2.2009],[-64.083085,1.916369],[-64.199306,1.492855],[-64.611012,1.328731],[-65.354713,1.095282],[-65.548267,.789254],[-66.325765,.724452],[-66.876326,1.253361],[-67.181294,2.250638],[-67.447092,2.600281],[-67.809938,2.820655],[-67.303173,3.318454],[-67.337564,3.542342],[-67.621836,3.839482],[-67.823012,4.503937],[-67.744697,5.221129],[-67.521532,5.55687],[-67.34144,6.095468],[-67.695087,6.267318],[-68.265052,6.153268],[-68.985319,6.206805],[-69.38948,6.099861],[-70.093313,6.960376],[-70.674234,7.087785],[-71.960176,6.991615],[-72.198352,7.340431],[-72.444487,7.423785],[-72.479679,7.632506],[-72.360901,8.002638],[-72.439862,8.405275],[-72.660495,8.625288],[-72.78873,9.085027],[-73.304952,9.152],[-73.027604,9.73677],[-72.905286,10.450344],[-72.614658,10.821975],[-72.227575,11.108702],[-71.973922,11.608672],[-71.331584,11.776284]]]}},{type:"Feature",id:"VNM",properties:{name:"Vietnam"},geometry:{type:"Polygon",coordinates:[[[108.05018,21.55238],[106.715068,20.696851],[105.881682,19.75205],[105.662006,19.058165],[106.426817,18.004121],[107.361954,16.697457],[108.269495,16.079742],[108.877107,15.276691],[109.33527,13.426028],[109.200136,11.666859],[108.36613,11.008321],[107.220929,10.364484],[106.405113,9.53084],[105.158264,8.59976],[104.795185,9.241038],[105.076202,9.918491],[104.334335,10.486544],[105.199915,10.88931],[106.24967,10.961812],[105.810524,11.567615],[107.491403,12.337206],[107.614548,13.535531],[107.382727,14.202441],[107.564525,15.202173],[107.312706,15.908538],[106.556008,16.604284],[105.925762,17.485315],[105.094598,18.666975],[103.896532,19.265181],[104.183388,19.624668],[104.822574,19.886642],[104.435,20.758733],[103.203861,20.766562],[102.754896,21.675137],[102.170436,22.464753],[102.706992,22.708795],[103.504515,22.703757],[104.476858,22.81915],[105.329209,23.352063],[105.811247,22.976892],[106.725403,22.794268],[106.567273,22.218205],[107.04342,21.811899],[108.05018,21.55238]]]}},{type:"Feature",id:"VUT",properties:{name:"Vanuatu"},geometry:{type:"MultiPolygon",coordinates:[[[[167.844877,-16.466333],[167.515181,-16.59785],[167.180008,-16.159995],[167.216801,-15.891846],[167.844877,-16.466333]]],[[[167.107712,-14.93392],[167.270028,-15.740021],[167.001207,-15.614602],[166.793158,-15.668811],[166.649859,-15.392704],[166.629137,-14.626497],[167.107712,-14.93392]]]]}},{type:"Feature",id:"PSE",properties:{name:"West Bank"},geometry:{type:"Polygon",coordinates:[[[35.545665,32.393992],[35.545252,31.782505],[35.397561,31.489086],[34.927408,31.353435],[34.970507,31.616778],[35.225892,31.754341],[34.974641,31.866582],[35.18393,32.532511],[35.545665,32.393992]]]}},{type:"Feature",id:"YEM",properties:{name:"Yemen"},geometry:{type:"Polygon",coordinates:[[[53.108573,16.651051],[52.385206,16.382411],[52.191729,15.938433],[52.168165,15.59742],[51.172515,15.17525],[49.574576,14.708767],[48.679231,14.003202],[48.238947,13.94809],[47.938914,14.007233],[47.354454,13.59222],[46.717076,13.399699],[45.877593,13.347764],[45.62505,13.290946],[45.406459,13.026905],[45.144356,12.953938],[44.989533,12.699587],[44.494576,12.721653],[44.175113,12.58595],[43.482959,12.6368],[43.222871,13.22095],[43.251448,13.767584],[43.087944,14.06263],[42.892245,14.802249],[42.604873,15.213335],[42.805015,15.261963],[42.702438,15.718886],[42.823671,15.911742],[42.779332,16.347891],[43.218375,16.66689],[43.115798,17.08844],[43.380794,17.579987],[43.791519,17.319977],[44.062613,17.410359],[45.216651,17.433329],[45.399999,17.333335],[46.366659,17.233315],[46.749994,17.283338],[47.000005,16.949999],[47.466695,17.116682],[48.183344,18.166669],[49.116672,18.616668],[52.00001,19.000003],[52.782184,17.349742],[53.108573,16.651051]]]}},{type:"Feature",id:"ZAF",properties:{name:"South Africa"},geometry:{type:"Polygon",coordinates:[[[31.521001,-29.257387],[31.325561,-29.401978],[30.901763,-29.909957],[30.622813,-30.423776],[30.055716,-31.140269],[28.925553,-32.172041],[28.219756,-32.771953],[27.464608,-33.226964],[26.419452,-33.61495],[25.909664,-33.66704],[25.780628,-33.944646],[25.172862,-33.796851],[24.677853,-33.987176],[23.594043,-33.794474],[22.988189,-33.916431],[22.574157,-33.864083],[21.542799,-34.258839],[20.689053,-34.417175],[20.071261,-34.795137],[19.616405,-34.819166],[19.193278,-34.462599],[18.855315,-34.444306],[18.424643,-33.997873],[18.377411,-34.136521],[18.244499,-33.867752],[18.25008,-33.281431],[17.92519,-32.611291],[18.24791,-32.429131],[18.221762,-31.661633],[17.566918,-30.725721],[17.064416,-29.878641],[17.062918,-29.875954],[16.344977,-28.576705],[16.824017,-28.082162],[17.218929,-28.355943],[17.387497,-28.783514],[17.836152,-28.856378],[18.464899,-29.045462],[19.002127,-28.972443],[19.894734,-28.461105],[19.895768,-24.76779],[20.165726,-24.917962],[20.758609,-25.868136],[20.66647,-26.477453],[20.889609,-26.828543],[21.605896,-26.726534],[22.105969,-26.280256],[22.579532,-25.979448],[22.824271,-25.500459],[23.312097,-25.26869],[23.73357,-25.390129],[24.211267,-25.670216],[25.025171,-25.71967],[25.664666,-25.486816],[25.765849,-25.174845],[25.941652,-24.696373],[26.485753,-24.616327],[26.786407,-24.240691],[27.11941,-23.574323],[28.017236,-22.827754],[29.432188,-22.091313],[29.839037,-22.102216],[30.322883,-22.271612],[30.659865,-22.151567],[31.191409,-22.25151],[31.670398,-23.658969],[31.930589,-24.369417],[31.752408,-25.484284],[31.837778,-25.843332],[31.333158,-25.660191],[31.04408,-25.731452],[30.949667,-26.022649],[30.676609,-26.398078],[30.685962,-26.743845],[31.282773,-27.285879],[31.86806,-27.177927],[32.071665,-26.73382],[32.83012,-26.742192],[32.580265,-27.470158],[32.462133,-28.301011],[32.203389,-28.752405],[31.521001,-29.257387]],[[28.978263,-28.955597],[28.5417,-28.647502],[28.074338,-28.851469],[27.532511,-29.242711],[26.999262,-29.875954],[27.749397,-30.645106],[28.107205,-30.545732],[28.291069,-30.226217],[28.8484,-30.070051],[29.018415,-29.743766],[29.325166,-29.257387],[28.978263,-28.955597]]]}},{type:"Feature",id:"ZMB",properties:{name:"Zambia"},geometry:{type:"Polygon",coordinates:[[[32.759375,-9.230599],[33.231388,-9.676722],[33.485688,-10.525559],[33.31531,-10.79655],[33.114289,-11.607198],[33.306422,-12.435778],[32.991764,-12.783871],[32.688165,-13.712858],[33.214025,-13.97186],[30.179481,-14.796099],[30.274256,-15.507787],[29.516834,-15.644678],[28.947463,-16.043051],[28.825869,-16.389749],[28.467906,-16.4684],[27.598243,-17.290831],[27.044427,-17.938026],[26.706773,-17.961229],[26.381935,-17.846042],[25.264226,-17.73654],[25.084443,-17.661816],[25.07695,-17.578823],[24.682349,-17.353411],[24.033862,-17.295843],[23.215048,-17.523116],[22.562478,-16.898451],[21.887843,-16.08031],[21.933886,-12.898437],[24.016137,-12.911046],[23.930922,-12.565848],[24.079905,-12.191297],[23.904154,-11.722282],[24.017894,-11.237298],[23.912215,-10.926826],[24.257155,-10.951993],[24.314516,-11.262826],[24.78317,-11.238694],[25.418118,-11.330936],[25.75231,-11.784965],[26.553088,-11.92444],[27.16442,-11.608748],[27.388799,-12.132747],[28.155109,-12.272481],[28.523562,-12.698604],[28.934286,-13.248958],[29.699614,-13.257227],[29.616001,-12.178895],[29.341548,-12.360744],[28.642417,-11.971569],[28.372253,-11.793647],[28.49607,-10.789884],[28.673682,-9.605925],[28.449871,-9.164918],[28.734867,-8.526559],[29.002912,-8.407032],[30.346086,-8.238257],[30.740015,-8.340007],[31.157751,-8.594579],[31.556348,-8.762049],[32.191865,-8.930359],[32.759375,-9.230599]]]}},{type:"Feature",id:"ZWE",properties:{name:"Zimbabwe"},geometry:{type:"Polygon",coordinates:[[[31.191409,-22.25151],[30.659865,-22.151567],[30.322883,-22.271612],[29.839037,-22.102216],[29.432188,-22.091313],[28.794656,-21.639454],[28.02137,-21.485975],[27.727228,-20.851802],[27.724747,-20.499059],[27.296505,-20.39152],[26.164791,-19.293086],[25.850391,-18.714413],[25.649163,-18.536026],[25.264226,-17.73654],[26.381935,-17.846042],[26.706773,-17.961229],[27.044427,-17.938026],[27.598243,-17.290831],[28.467906,-16.4684],[28.825869,-16.389749],[28.947463,-16.043051],[29.516834,-15.644678],[30.274256,-15.507787],[30.338955,-15.880839],[31.173064,-15.860944],[31.636498,-16.07199],[31.852041,-16.319417],[32.328239,-16.392074],[32.847639,-16.713398],[32.849861,-17.979057],[32.654886,-18.67209],[32.611994,-19.419383],[32.772708,-19.715592],[32.659743,-20.30429],[32.508693,-20.395292],[32.244988,-21.116489],[31.191409,-22.25151]]]}}]},e.geo_json_by_fullname={};for(i=0;i<e.raw_geo_json.features.length;i++){var t=e.raw_geo_json.features[i].geometry.coordinates,n=0,r=0,s=0;for(j=0;j<t.length;j++){var o=t[j];for(k=0;k<o.length;k++)n+=o[k][0],r+=o[k][1],s++}n/=s,r/=s;var u=e.raw_geo_json.features[i].properties.name;u=="Myanmar"&&(r=20.797201,95.799866),u=="Thailand"&&(r=15.411319,n=100.67688),u=="Laos"&&(r=20.112682,n=102.45758),u=="Vietnam"&&(r=12.951029,n=109.125366),u=="Papua New Guinea"&&(r=-6.184246,n=143.433837),e.raw_geo_json.features[i].centerLong=n,e.raw_geo_json.features[i].centerLatt=r,e.geo_json_by_fullname[e.raw_geo_json.features[i].properties.name]=e.raw_geo_json.features[i]}return e}),define("DQX/lib/geo_json",[],function(){var e=function(e,t){var n=function(e,t,s){var o;switch(e.type){case"Point":t.position=new google.maps.LatLng(e.coordinates[1],e.coordinates[0]),o=new google.maps.Marker(t),s&&o.set("geojsonProperties",s);break;case"MultiPoint":o=[];for(var u=0;u<e.coordinates.length;u++)t.position=new google.maps.LatLng(e.coordinates[u][1],e.coordinates[u][0]),o.push(new google.maps.Marker(t));if(s)for(var a=0;a<o.length;a++)o[a].set("geojsonProperties",s);break;case"LineString":var f=[];for(var u=0;u<e.coordinates.length;u++){var l=e.coordinates[u],c=new google.maps.LatLng(l[1],l[0]);f.push(c)}t.path=f,o=new google.maps.Polyline(t),s&&o.set("geojsonProperties",s);break;case"MultiLineString":o=[];for(var u=0;u<e.coordinates.length;u++){var f=[];for(var h=0;h<e.coordinates[u].length;h++){var l=e.coordinates[u][h],c=new google.maps.LatLng(l[1],l[0]);f.push(c)}t.path=f,o.push(new google.maps.Polyline(t))}if(s)for(var a=0;a<o.length;a++)o[a].set("geojsonProperties",s);break;case"Polygon":var p=[],d,v;for(var u=0;u<e.coordinates.length;u++){var f=[];for(var h=0;h<e.coordinates[u].length;h++){var c=new google.maps.LatLng(e.coordinates[u][h][1],e.coordinates[u][h][0]);f.push(c)}u?u==1?(v=i(f),d==v?p.push(f.reverse()):p.push(f)):d==v?p.push(f.reverse()):p.push(f):(d=i(f),p.push(f))}t.paths=p,o=new google.maps.Polygon(t),s&&o.set("geojsonProperties",s);break;case"MultiPolygon":o=[];for(var u=0;u<e.coordinates.length;u++){var p=[],d,v;for(var h=0;h<e.coordinates[u].length;h++){var f=[];for(var a=0;a<e.coordinates[u][h].length;a++){var c=new google.maps.LatLng(e.coordinates[u][h][a][1],e.coordinates[u][h][a][0]);f.push(c)}h?h==1?(v=i(f),d==v?p.push(f.reverse()):p.push(f)):d==v?p.push(f.reverse()):p.push(f):(d=i(f),p.push(f))}t.paths=p,o.push(new google.maps.Polygon(t))}if(s)for(var a=0;a<o.length;a++)o[a].set("geojsonProperties",s);break;case"GeometryCollection":o=[];if(!e.geometries)o=r('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');else for(var u=0;u<e.geometries.length;u++)o.push(n(e.geometries[u],t,s||null));break;default:o=r('Invalid GeoJSON object: Geometry object must be one of "Point", "LineString", "Polygon" or "MultiPolygon".')}return o},r=function(e){return{type:"Error",message:e}},i=function(e){var t,n=0;for(var r=0;r<e.length-2;r++)n+=(e[r+1].lat()-e[r].lat())*(e[r+2].lng()-e[r].lng())-(e[r+2].lat()-e[r].lat())*(e[r+1].lng()-e[r].lng());return n>0?t=!0:t=!1,t},s,o=t||{};switch(e.type){case"FeatureCollection":if(!e.features)s=r('Invalid GeoJSON object: FeatureCollection object missing "features" member.');else{s=[];for(var u=0;u<e.features.length;u++)s.push(n(e.features[u].geometry,o,e.features[u].properties))}break;case"GeometryCollection":if(!e.geometries)s=r('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');else{s=[];for(var u=0;u<e.geometries.length;u++)s.push(n(e.geometries[u],o))}break;case"Feature":!e.properties||!e.geometry?s=r('Invalid GeoJSON object: Feature object missing "properties" or "geometry" member.'):s=n(e.geometry,o,e.properties);break;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":s=e.coordinates?s=n(e,o):r('Invalid GeoJSON object: Geometry object missing "coordinates" member.');break;default:s=r('Invalid GeoJSON object: GeoJSON object must be one of "Point", "LineString", "Polygon", "MultiPolygon", "Feature", "FeatureCollection" or "GeometryCollection".')}return Object.prototype.toString.call(s)!=="[object Array]"&&(s=[s]),s};return e}),define("DQX/lib/StyledMarker",[],function(){function r(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e}var e={},t,n;return function(){var i="https://chart.googleapis.com/chart?chst=";try{var s=google.maps}catch(o){return}var u=s.Point,a=s.event,f=s.MarkerImage;t=function(e){s.Marker.call(this);var t=this,n=t.styleIcon=e.styleIcon;t.bindTo("icon",n),t.bindTo("shadow",n),t.bindTo("shape",n),t.setOptions(e)},r(t,s.Marker),n=function(t,n,r){function h(){var e=document.createElement("img"),n=document.createElement("img");a.addDomListenerOnce(n,"load",function(){var e=n.width,r=n.height;s.set(u,new f(t.getShadowURL(s),null,null,t.getShadowAnchor(s,e,r))),simage=null}),a.addDomListenerOnce(e,"load",function(){var n=e.width,r=e.height;s.set(o,new f(t.getURL(s),null,null,t.getAnchor(s,n,r))),s.set(l,t.getShape(s,n,r)),e=null}),e.src=t.getURL(s),n.src=t.getShadowURL(s)}var i,s=this,o="icon",u="shadow",l="shape",c=[];s.as_=function(e){c.push(e);for(i in n)e.set(i,n[i])};if(t!==e.CLASS){for(i in t.defaults)s.set(i,t.defaults[i]);s.setValues(n),s.set(o,t.getURL(s)),s.set(u,t.getShadowURL(s)),r&&r.as_(s),h(),s.changed=function(e){e!==o&&e!==l&&e!==u&&h()}}else s.setValues(n),s.changed=function(e){n[e]=s.get(e);for(i=0;i<c.length;i++)c[i].set(e,s.get(e))},r&&r.as_(s)},n.prototype=new s.MVCObject,e.CLASS={},e.MARKER={defaults:{text:"",color:"00ff00",fore:"000000",starcolor:null},getURL:function(e){var t,n=e.get("starcolor"),r=e.get("text"),s=e.get("color").replace(/#/,""),o=e.get("fore").replace(/#/,"");return n?t=i+"d_map_xpin_letter&chld=pin_star|":t=i+"d_map_pin_letter&chld=",r&&(r=r.substr(0,2)),t+=r+"|",t+=s+"|",t+=o,n&&(t+="|"+n.replace(/#/,"")),t},getShadowURL:function(e){return e.get("starcolor")?i+"d_map_xpin_shadow&chld=pin_star":i+"d_map_pin_shadow"},getAnchor:function(e,t,n){return new u(t/2,n)},getShadowAnchor:function(e,t,n){return new u(t/4,n)},getShape:function(e,t,n){var r={};r.coord=[t/2,n,7/16*t,5/8*n,5/16*t,7/16*n,7/32*t,5/16*n,5/16*t,1/8*n,.5*t,0,.6875*t,1/8*n,25/32*t,5/16*n,.6875*t,7/16*n,9/16*t,5/8*n];for(var i=0;i<r.coord.length;i++)r.coord[i]=Math.round(r.coord[i]);return r.type="poly",r}},e.BUBBLE={defaults:{text:"",color:"00ff00",fore:"000000"},getURL:function(e){var t=i+"d_bubble_text_small&chld=bb|";return t+=e.get("text")+"|",t+=e.get("color").replace(/#/,"")+"|",t+=e.get("fore").replace(/#/,""),t},getShadowURL:function(e){return i+"d_bubble_text_small_shadow&chld=bb|"+e.get("text")},getAnchor:function(e,t,n){return new google.maps.Point(0,42)},getShadowAnchor:function(e,t,n){return new google.maps.Point(0,44)},getShape:function(e,t,n){var r={};return r.coord=[0,44,13,26,13,6,17,1,t-4,1,t,6,t,21,t-4,26,21,26],r.type="poly",r}}}(),{StyledMarker:t,StyledIcon:n,StyledIconTypes:e}}),define("DQX/Map",["jquery","DQX/data/countries","DQX/lib/geo_json","DQX/lib/StyledMarker","DQX/Msg","DQX/DocEl","DQX/Utils","DQX/FramePanel"],function(e,t,n,r,i,s,o,u){var a={};try{a.defaults={zoom:2,center:new google.maps.LatLng(0,0)}}catch(f){return}return a.Coord=function(e,t){var n={};return n.longit=e,n.lattit=t,n.toGoogleLatLng=function(){return new google.maps.LatLng(this.lattit,this.longit)},n},a.GoogleLatLng2Coord=function(e){return a.Coord(e.lng(),e.lat())},a.MapItemLayouter=function(e,t,n){var r={};return r.mapObject=e,r.id=t,r.items=[],r.offset=.4,n&&(r.offset=n),r.addItem=function(e,t,n){this.items.push({longit:e,lattit:t,radius:n,longit2:e,lattit2:t})},r.DX2Longit=function(e,t){return e/Math.cos(t/180*Math.PI)/4e4*360},r.DY2Lattit=function(e){return e/4e4*360},r.Longit2X=function(e,t){return e*Math.cos(t/180*Math.PI)*4e4/360},r.Lattit2Y=function(e){return e/360*4e4},r.correctIdenticalPositions=function(){for(var e=0;e<this.items.length;e++){var t=this.items[e],n=0,r=0;for(var i=0;i<this.items.length;i++)if(e!=i){var s=this.items[i];Math.abs(t.longit-s.longit)+Math.abs(t.lattit-s.lattit)<1e-9&&(t.longit-=1e-9,s.longit+=1e-9)}}},r.calculatePositions0=function(){r.correctIdenticalPositions();for(var e=0;e<this.items.length;e++){var t=this.items[e];t.x0=this.Longit2X(t.longit,t.lattit),t.y0=this.Lattit2Y(t.lattit),t.dx=0,t.dy=0}for(var n=0;n<50;n++)for(var i=0;i<this.items.length;i++){var s=this.items[i],o=0,u=0;for(var a=0;a<this.items.length;a++)if(i!=a){var f=this.items[a],l=f.x0+f.dx-(s.x0+s.dx),c=f.y0+f.dy-(s.y0+s.dy),h=Math.sqrt(l*l+c*c);dst2=Math.max(.5,h/50),l/=h,c/=h;var p=.5/(dst2*dst2);o+=-l*p,u+=-c*p}s.dx+=.5*o,s.dy+=.5*u}for(var e=0;e<this.items.length;e++){var t=this.items[e],d=t.longit+this.DX2Longit(t.dx,t.lattit),v=t.lattit+this.DY2Lattit(t.dy);t.longit2=d,t.lattit2=v}},r.calculatePositions=function(){r.correctIdenticalPositions();for(var e=0;e<this.items.length;e++){var t=this.items[e];t.x0=this.Longit2X(t.longit,t.lattit),t.y0=this.Lattit2Y(t.lattit),t.dx=0,t.dy=0}for(var n=0;n<100;n++)for(var i=0;i<this.items.length;i++){var s=this.items[i],o=0,u=0;for(var a=0;a<this.items.length;a++)if(i!=a){var f=this.items[a],l=f.x0-s.x0,c=f.y0-s.y0,h=Math.sqrt(l*l+c*c);o+=-l/(h*h*h),u+=-c/(h*h*h)}var p=Math.sqrt(o*o+u*u);p>0&&(s.dx=30*o/p,s.dy=30*u/p)}for(var n=0;n<50;n++)for(var i=0;i<this.items.length;i++){var s=this.items[i],o=0,u=0;for(var a=0;a<this.items.length;a++)if(i!=a){var f=this.items[a],l=f.x0+f.dx-(s.x0+s.dx),c=f.y0+f.dy-(s.y0+s.dy),h=Math.sqrt(l*l+c*c),d=(1+r.offset/2)*(s.radius+f.radius);if(h<d&&h>0){var v=(d-h)/h;o+=-l*v,u+=-c*v}else if(h<4*d&&h>0){var v=.05/(h*h*h);o+=-l*v,u+=-c*v}}if(n>1)for(var a=0;a<this.items.length;a++){var f=this.items[a],l=f.x0-(s.x0+s.dx),c=f.y0-(s.y0+s.dy),h=Math.sqrt(l*l+c*c),d=(1+r.offset)*s.radius;if(h<d&&h>0){var v=(d-h)/h;o+=-l*v,u+=-c*v}}s.dx+=.1*o,s.dy+=.1*u}for(var e=0;e<this.items.length;e++){var t=this.items[e],m=t.longit+this.DX2Longit(t.dx,t.lattit),g=t.lattit+this.DY2Lattit(t.dy);t.longit2=m,t.lattit2=g}},r},a.KML=function(e,t,n){var r={};return r.myID=e,r.myMapObject=t,r.myMapObject._addOverlay(r),r.myKmlUrl=n,r.kml=new google.maps.KmlLayer(r.myKmlUrl),r.kml.setMap(r.myMapObject.myMap),r.remove=function(){this.kml.setMap(null)},r},a.Country=function(e,r,s,o){google_objs=n(t.geo_json_by_fullname[s],o);if(google_objs.error){console.log(google_objs);return}var u={};u.myID=e,u.myMapObject=r,u.myMapObject._addOverlay(u),u.myData=s,u.myObjects=[];for(var a=0;a<google_objs.length;a++)u.myObjects.push(google_objs[a]),google_objs[a].setMap(u.myMapObject.myMap),google.maps.event.addListener(google_objs[a],"click",function(){i.broadcast({type:"ClickMapPoint",id:u.myID},u.myID)});return u.remove=function(){for(var e=0;e<this.myObjects.length;e++)this.myObjects[e].setMap(null)},u},a.Polygon=function(e,t,n){var r={};r.myID=e,r.myMapObject=t,r.myMapObject._addOverlay(r),r.myData=n;var i=[];for(var s=0;s<n.length;s++)i.push(new google.maps.LatLng(n[s].lattit,n[s].longit));var o={path:i,strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:3,fillColor:"#FF0000",fillOpacity:.15};return r.myObject=new google.maps.Polygon(o),r.myObject.setMap(r.myMapObject.myMap),r.remove=function(){this.myObject.setMap(null)},r},a.PointSet=function(s,o,u,f,l){var c={};return l||(l={showMarkers:!0,polygonOptions:null}),l.labelScaleFactor||(l.labelScaleFactor=1),c.myID=s,c.myMapObject=o,c.displayOptions=l,c.minZoomlevel=u,c.myMapObject._addOverlay(c),c.myPointSet=[],c._pointClickCallBack=null,f.length>0&&(c.image=new google.maps.MarkerImage(f,null,null,new google.maps.Point(10,10))),c.visibleUser=!0,c.visibleZoomlevel=o.myMap.zoom>=u,c._currentVisible=!1,c.clearPoints=function(){for(var e=0;e<this.myPointSet.length;e++)for(var t=0;t<this.myPointSet[e].markers.length;t++)this.myPointSet[e].markers[t].setMap(null);this.myPointSet=[]},c.remove=function(){this.clearPoints()},c.setPointClickCallBack=function(e){c._pointClickCallBack=e},c._handleOnPointClicked=function(e){i.broadcast({type:"ClickMapPoint",id:this.myID},this.myPointSet[e].id),c._pointClickCallBack&&c._pointClickCallBack(this.myPointSet[e].id)},c._updateVisible=function(){var e=this.visibleUser&&this.myMapObject.myMap.zoom>=this.minZoomlevel;if(e!=this._currentVisible){this._currentVisible=e;for(var t=0;t<this.myPointSet.length;t++)if(!e)for(var n=0;n<this.myPointSet[t].markers.length;n++)this.myPointSet[t].markers[n].setMap(null);else for(var n=0;n<this.myPointSet[t].markers.length;n++)this.myPointSet[t].markers[n].setMap(this.myMapObject.myMap)}},c.setPoints=function(s){this.clearPoints(),this.myPointSet=s;var o=this;e.each(this.myPointSet,function(e,t){t.markers=[]});if(this.displayOptions.showLabels){var u=a.MapItemLayouter(this.myMapObject,"");for(var f=0;f<s.length;f++){var l=s[f];u.addItem(l.longit,l.lattit,150)}u.calculatePositions0(),e.each(this.myPointSet,function(e,t){var n=u.items[e].dx,r=u.items[e].dy;n==0&&r==0&&(n=1,r=1);var s=Math.sqrt(n*n+r*r);n*=30/s,r*=30/s;var f=a.Overlay.LabelArrow(o.myMapObject,"",a.Coord(u.items[e].longit,u.items[e].lattit),n,-r,c.displayOptions.labelScaleFactor),l=a.Overlay.Label(o.myMapObject,"",a.Coord(u.items[e].longit,u.items[e].lattit),n,-r,t.labelName,!1,c.displayOptions.labelScaleFactor),h=a.Overlay.Label(o.myMapObject,"",a.Coord(u.items[e].longit,u.items[e].lattit),n,-r,t.labelName,!0,c.displayOptions.labelScaleFactor);h.pointID=t.id,h.setOnClick(function(){i.broadcast({type:"ClickMapPoint",id:c.myID},this.pointID),c._pointClickCallBack&&c._pointClickCallBack(this.pointID)}),t.markers.push(f),t.markers.push(l),t.markers.push(h)})}if(this.displayOptions.showMarkers)for(var f=0;f<s.length;f++)(function(e){var i=e,u=s[i],a=null,f={position:new google.maps.LatLng(u.lattit,u.longit),map:o.myMapObject.myMap,icon:o.image};u.title&&(f.title=u.title),"styleIcon"in u&&(f.styleIcon=new r.StyledIcon(r.StyledIconTypes.MARKER,u.styleIcon),a=new r.StyledMarker(f));if(u.labelName){var l="ffffff";u.labelColor&&(l=u.labelColor)}a||(a=new google.maps.Marker(f));if(o.myPointSet[i].location_type=="country"){google_objs=n(t.geo_json_by_fullname[o.myPointSet[i].given_name],o.polygon_options);if(!google_objs[0].error){o.myPointSet[i].markers=google_objs;for(var c=0;c<google_objs.length;c++)google.maps.event.addListener(o.myPointSet[i].markers[c],"click",function(){o._handleOnPointClicked(i)})}else console.log(o.myPointSet[i].given_name),console.log(google_objs)}else a!=null&&(o.myPointSet[i].markers.push(a),google.maps.event.addListener(a,"click",function(){o._handleOnPointClicked(i)}))})(f);this._updateVisible()},c.isInView=function(){var e=this.myMapObject.myMap.getBounds();if(!e)return!1;for(var t=0;t<this.myPointSet.length;t++)if(!e.contains(new google.maps.LatLng(this.myPointSet[t].lattit,this.myPointSet[t].longit)))return!1;return!0},c.zoomFit=function(e){if(this.myPointSet.length==0)return;var t=new google.maps.LatLngBounds;for(var n=0;n<this.myPointSet.length;n++)t.extend(new google.maps.LatLng(this.myPointSet[n].lattit,this.myPointSet[n].longit));var r=t.getNorthEast(),i=t.getSouthWest(),s=r.lat()-i.lat(),o=e/4e4*360;s<o&&(t.extend(new google.maps.LatLng(Math.min(89.9,r.lat()+(o-s)/2),r.lng())),t.extend(new google.maps.LatLng(Math.max(-89.9,i.lat()-(o-s)/2),i.lng()))),this.myMapObject.myMap.fitBounds(t)},c.setVisible=function(e){this.visibleUser=e,this._updateVisible()},c.onZoomLevelChanged=function(){this._updateVisible()},c},a.PointSetHeatmap=function(e,t){var n={};return n.myMapObject=e,n.myPointSet=[],n._myHeatMap=null,n.myGradient=t,n.clearPoints=function(){n._myHeatMap!=null&&n._myHeatMap.setMap(null),n._myHeatMap=null},n.setPoints=function(e){this.clearPoints();var t=[];for(var r=0;r<e.length;r++)t.push({location:new google.maps.LatLng(pointInfo.lattit,pointInfo.longit),weight:1});n._myHeatMap=new google.maps.visualization.HeatmapLayer({data:t,dissipating:!1,radius:3.5,opacity:.4,maxIntensity:5,gradient:this.myGradient}),n._myHeatMap.setMap(this.myMapObject.myMap)},n},a.Overlay={},a._overlayIDNr=0,a.Overlay._Base=function(t,n,r){var i=new google.maps.OverlayView;return i.myMapObject=t,n||(a._overlayIDNr++,n="GMapOverlay"+a._overlayIDNr),i.myID=n,t._addOverlay(i),i.setMap(i.myMapObject.myMap),i.convCoordToPixels=function(e,t){var n=this.getProjection(),r=n.fromLatLngToDivPixel(e.toGoogleLatLng());if(typeof t!="undefined"){var i=a.Coord(e.longit+t/4e4*360,e.lattit),s=n.fromLatLngToDivPixel(i.toGoogleLatLng());r.dist=Math.abs(r.x-s.x)}return r},i.remove=function(){this.setMap(null)},i.onAdd=function(){this.myDiv=document.createElement("div"),this.myDiv.style.position="absolute",this.myDiv.style.overflow="visible";var t=this.getPanes();r?t.overlayLayer.appendChild(this.myDiv):(t.overlayMouseTarget.appendChild(this.myDiv),google.maps.event.addDomListener(this.myDiv,"mouseover",function(){e(i.myDiv).css("cursor","pointer")}))},i.draw=function(){if(this.render){var e=this.render();this.myDiv.style.left=e.x0+"px",this.myDiv.style.top=e.y0+"px",this.myDiv.style.width=e.x1-e.x0+1+"px",this.myDiv.style.height=e.y1-e.y0+"px"}},i.onRemove=function(){this.myDiv.parentNode.removeChild(this.myDiv),this.myDiv=null},i},a.Overlay.PieChart=function(e,t,n,r,i){var s=a.Overlay._Base(e,t);return s._centerCoordPieChart=n,s._centerCoord=n,s.myRadius=r,s.myChart=i,s.myChart.myCallbackObject=s,o.ObjectMapper.Add(s),r<0&&(o,reportError("Negative pie chart radius")),s.setCoord=function(e){s._centerCoordPieChart=e},s.setOrigCoord=function(e){s._centerCoord=e},s.render=function(){var e=this.convCoordToPixels(this._centerCoordPieChart,this.myRadius),t=e.dist,n=this.convCoordToPixels(this._centerCoord,0),r={};r.x0=Math.min(n.x,e.x-e.dist),r.y0=Math.min(n.y,e.y-e.dist),r.x1=Math.max(n.x,e.x+e.dist)+3,r.y1=Math.max(n.y,e.y+e.dist)+3;var i='<svg width={w} height={h} style="overflow:visible">'.DQXformat({w:r.x1-r.x0,h:r.y1-r.y0});i+=this.myChart.render(e.x-r.x0,e.y-r.y0,e.dist);var s=n.x-e.x,o=n.y-e.y,u=Math.sqrt(s*s+o*o);if(u>2){var a=s/u,f=o/u,l=e.x+e.dist*a,c=e.y+e.dist*f,h=t/10;i+='<polygon points="{x1},{y1},{x2},{y2},{x3},{y3}" style="stroke-width: 2px; stroke: rgb(40,40,40); fill:rgb(40,40,40)"/>'.DQXformat({x1:n.x-r.x0,y1:n.y-r.y0,x2:l+h*f-r.x0,y2:c-h*a-r.y0,x3:l-h*f-r.x0,y3:c+h*a-r.y0})}return i+="</svg>",this.myDiv.innerHTML=i,r},s.pieClick=function(e){s.onClick&&s.onClick(this,e)},s},a.Overlay.RectSVG=function(e,t,n,r,i,s){var u=a.Overlay._Base(e,t);return u._centerCoordSVG=n,u._centerCoord=n,u.mySizeX=r,u.mySizeY=i,o.ObjectMapper.Add(u),u.setOrigCoord=function(e){u._centerCoord=e},u.render=function(){var e=this.convCoordToPixels(this._centerCoordSVG,u.mySizeX/2),t=e.dist/(u.mySizeX/2),n=e.dist,r=this.convCoordToPixels(this._centerCoord,0),i={};i.x0=Math.min(r.x,e.x-t*u.mySizeX/2),i.y0=Math.min(r.y,e.y-t*u.mySizeY/2),i.x1=Math.max(r.x,e.x+t*u.mySizeX/2)+3,i.y1=Math.max(r.y,e.y+t*u.mySizeY/2)+3;var o='<svg width={w} height={h} style="overflow:visible">'.DQXformat({w:i.x1-i.x0,h:i.y1-i.y0}),a=r.x-e.x,f=r.y-e.y,l=Math.sqrt(a*a+f*f);if(l>2){var c=a/l,h=f/l,p=e.x+e.dist*c,d=e.y+e.dist*h,v=n/10;o+='<polygon points="{x1},{y1},{x2},{y2},{x3},{y3}" style="stroke-width: 2px; stroke: rgb(40,40,40); fill:rgb(40,40,40)"/>'.DQXformat({x1:r.x-i.x0,y1:r.y-i.y0,x2:p+v*h-i.x0,y2:d-v*c-i.y0,x3:p-v*h-i.x0,y3:d+v*c-i.y0})}o+='<rect x="{x}" y="{y}" width="{w}" height="{h}" style="stroke-width: 0px; stroke: none; fill:rgb(190,190,190)"/>'.DQXformat({x:e.x-t*u.mySizeX/2-i.x0,y:e.y-t*u.mySizeY/2-i.y0,w:t*u.mySizeX,h:t*u.mySizeY});var m=3;return o+='<g transform="translate({tx},{ty}) scale({sx},{sy})">'.DQXformat({tx:e.x-t*u.mySizeX/2-i.x0+m,ty:e.y-t*u.mySizeY/2-i.y0+m,sx:t*u.mySizeX-2*m,sy:t*u.mySizeY-2*m}),o+=s,o+="</g>",o+='<rect x="{x}" y="{y}" width="{w}" height="{h}" style="stroke-width: 3px; stroke: rgb(40,40,40); fill:none"/>'.DQXformat({x:e.x-t*u.mySizeX/2-i.x0,y:e.y-t*u.mySizeY/2-i.y0,w:t*u.mySizeX,h:t*u.mySizeY}),o+="</svg>",this.myDiv.innerHTML=o,i},u.pieClick=function(e){u.onClick&&u.onClick(this,e)},u},a.Overlay.LabelArrow=function(e,t,n,r,i,s){var o=a.Overlay._Base(e,t,!0);return o._centerCoord=n,o._offsetX=r,o._offsetY=i,o._scaleFactor=s,o.render=function(){var e=this.convCoordToPixels(this._centerCoord,8),t=.75*e.dist*o._scaleFactor,n=Math.sqrt(t),r={x:e.x+this._offsetX,y:e.y+this._offsetY},i={},s=Math.max(1,Math.min(4,Math.round(4*n))),u=Math.max(0,Math.min(1,n));i.x0=Math.min(e.x,r.x)-s,i.y0=Math.min(e.y,r.y)-s,i.x1=Math.max(e.x,r.x)+s,i.y1=Math.max(e.y,r.y)+s;var a=r.x-e.x,f=r.y-e.y,l=Math.sqrt(a*a+f*f),c=a/l,h=f/l,p="<svg width={w} height={h}>".DQXformat({w:i.x1-i.x0,h:i.y1-i.y0});return p+='<polygon points="{x1},{y1},{x2},{y2},{x3},{y3}" style="stroke-width: 2px; fill:rgb(40,40,40); fill-opacity:{op};"/>'.DQXformat({x1:e.x-i.x0,y1:e.y-i.y0,x2:r.x+s*h-i.x0,y2:r.y-s*c-i.y0,x3:r.x-s*h-i.x0,y3:r.y+s*c-i.y0,op:u.toFixed(3)}),p+="</svg>",this.myDiv.innerHTML=p,i},o},a.Overlay.Label=function(t,n,r,i,o,u,f,l){var c=a.Overlay._Base(t,n,!f);return c._centerCoord=r,c._offsetX=i,c._offsetY=o,c._text=u,c._onClickHandler=null,c._scaleFactor=l,c.setOnClick=function(e){this._onClickHandler=e},c.render=function(){var t=this.convCoordToPixels(this._centerCoord,8),n={x:Math.round(t.x+this._offsetX),y:Math.round(t.y+this._offsetY)},r=c._scaleFactor*t.dist,i=Math.sqrt(r),o=Math.max(4,Math.min(9,Math.round(9*i))),u=Math.min(1,r),a=Math.min(1,r);f&&(u=0,a=0);var l="<svg width={w} height={h}>".DQXformat({w:300,h:2*o+2});if(!f){var h=s.Create("rect");h.addAttribute("x",1),h.addAttribute("y",1),h.addAttribute("width",90),h.addAttribute("height",2*o),h.addStyle("fill","rgb(255,220,30)"),h.addStyle("stroke-width","1"),h.addStyle("stroke","rgb(0,0,0)"),h.addStyle("shape-rendering","crispEdges"),h.addStyle("fill-opacity",u),h.addStyle("stroke-opacity",u),l+=h.toString()}var h=s.Create("text");h.addAttribute("x",5),h.addAttribute("y",1+2*o-o/2),h.addAttribute("font-size",o*1.4),h.addAttribute("font-weight","bold"),h.addAttribute("fill","black"),h.addStyle("fill-opacity",a),h.addElem(this._text),l+=h.toString(),l+="</svg>",this.myDiv.innerHTML=l;var p=this.myDiv.getElementsByTagName("text")[0],d=p.getComputedTextLength(),v=d+10;if(!f){var m=this.myDiv.getElementsByTagName("rect")[0];m.width.baseVal.value=v}var g=this.myDiv.getElementsByTagName("svg")[0];g.width.baseVal.value=v+2,this._onClickHandler&&e(g).click(e.proxy(c._onClickHandler,c));var y={};return n.x>=t.x?y.x0=n.x-1-o:y.x0=n.x-1-v+o,y.x1=y.x0+v+2,y.y0=n.y-o-1,y.y1=y.y0+2*o+2,y},c},a.GMap=function(t,n,r,i){function d(e,t){for(var n=!1,r=-1,i=e.length,s=i-1;++r<i;s=r)(e[r].y<=t.y&&t.y<e[s].y||e[s].y<=t.y&&t.y<e[r].y)&&t.x<(e[s].x-e[r].x)*(t.y-e[r].y)/(e[s].y-e[r].y)+e[r].x&&(n=!n);return n}var s=u(t);s.getRootElem().css("background-color","rgb(210,230,255)");var f=[{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"all",stylers:[{lightness:25}]}];i&&f.push({featureType:"All",elementType:"All",stylers:[{lightness:40},{saturation:0}]});var l=new google.maps.StyledMapType(f,{name:"Simple"}),c=a.defaults.zoom,h=a.defaults.center;r&&(c=r),n&&(h=new google.maps.LatLng(n.lattit,n.longit));var p={zoom:c,center:h,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.SATELLITE,"map_style_simple"]}};return s.myMap=new google.maps.Map(document.getElementById(s.getDivID()),p),s.myMap.mapTypes.set("map_style_simple",l),s._myOverlays=[],s._addOverlay=function(e){s._myOverlays.push(e)},s.getOverlayCount=function(){return s._myOverlays.length},s.getOverlay=function(e){return this._myOverlays[e]},s.removeOverlay=function(e){for(var t=0;t<s._myOverlays.length;t++)if(s._myOverlays[t].myID==e){s._myOverlays[t].remove(),s._myOverlays.splice(t,1);return}},s._handleOnZoomChanged=function(){a.defaults.zoom=s.myMap.getZoom();for(var e=0;e<this._myOverlays.length;e++)"onZoomLevelChanged"in this._myOverlays[e]&&this._myOverlays[e].onZoomLevelChanged()},s._handleOnCenterChanged=function(){a.defaults.center=s.myMap.getCenter()},s.lassoPointImage=new google.maps.MarkerImage(o.BMP("circle1.png"),null,null,new google.maps.Point(8,8)),s.isSelecting=function(){return s.lassoSelecting||s.rectSelecting},s.startLassoSelection=function(e){if(s.lassoSelecting)return;s.lassoSelecting=!0,s.lassoSelectingCallbackOnComplete=e,s.lassoPolygon1=new google.maps.Polygon({strokeColor:"#000000",strokeOpacity:1,strokeWeight:2,fillColor:"rgb(255,128,0)",fillOpacity:.3,map:s.myMap,clickable:!1,idx:0}),s.lassoPolygon2=new google.maps.Polygon({strokeColor:"#000000",strokeOpacity:.25,strokeWeight:1,fillColor:"rgb(0,0,0)",fillOpacity:.1,map:s.myMap,clickable:!1,idx:0}),s.lassoPoints=[],s.selectionPolygonPoints=[],s.selectionPolygonLattLongPoints=[],s.lassoEventListener_click=google.maps.event.addListener(s.myMap,"click",function(e){s.lassoPolygon1.getPath().push(e.latLng),s.lassoPolygon2.getPath().push(e.latLng);var t=new google.maps.Marker({position:e.latLng,map:s.theMap,icon:s.lassoPointImage,clickable:!1});t.setMap(s.myMap),s.lassoPoints.push(t);var n=s.myMap.getProjection().fromLatLngToPoint(e.latLng);s.selectionPolygonLattLongPoints.push({longit:e.latLng.lng(),lattit:e.latLng.lat()}),s.selectionPolygonPoints.push({x:n.x,y:n.y})}),s.lassoEventListener_dblclick=google.maps.event.addListener(s.myMap,"dblclick",function(e){setTimeout(function(){s.stopLassoSelection(),s.lassoSelectingCallbackOnComplete&&s.lassoSelectingCallbackOnComplete()},100)}),s.lassoEventListener_mousemove=google.maps.event.addListener(s.myMap,"mousemove",function(e){var t=s.lassoPolygon2.getPath();t.length>0&&(t.length>1&&t.pop(),t.push(e.latLng))}),s.myMap.set("draggableCursor","crosshair"),s.myMap.set("disableDoubleClickZoom",!0)},s.stopLassoSelection=function(){if(!s.lassoSelecting)return;s.lassoSelecting=!1,google.maps.event.removeListener(s.lassoEventListener_click),google.maps.event.removeListener(s.lassoEventListener_mousemove),google.maps.event.removeListener(s.lassoEventListener_dblclick),s.myMap.set("draggableCursor","default"),s.myMap.set("disableDoubleClickZoom",!1),s.lassoPolygon1.setMap(null),s.lassoPolygon1=null,s.lassoPolygon2.setMap(null),s.lassoPolygon2=null,e.each(s.lassoPoints,function(e,t){t.setMap(null)}),s.lassoPoints=null},s.isCoordInsideLassoSelection=function(e){if(!s.selectionPolygonPoints)return!1;var t=s.myMap.getProjection().fromLatLngToPoint(e.toGoogleLatLng());return d(s.selectionPolygonPoints,{x:t.x,y:t.y})},s.startRectSelection=function(e){if(s.rectSelecting)return;s.rectSelecting=!0,s.rectPointSelectCount=0,s.rectSelectingCallbackOnComplete=e,s.lassoPolygon1=new google.maps.Polygon({strokeColor:"#000000",strokeOpacity:1,strokeWeight:2,fillColor:"rgb(255,128,0)",fillOpacity:.3,map:s.myMap,clickable:!1,idx:0}),s.rectEventListener_click=google.maps.event.addListener(s.myMap,"click",function(e){if(s.rectPointSelectCount==0){s.rectSelectPoint1=e.latLng,s.rectPointSelectCount=1;return}if(s.rectPointSelectCount==1){setTimeout(function(){s.stopRectSelection(),s.rectSelectingCallbackOnComplete&&s.rectSelectingCallbackOnComplete(a.GoogleLatLng2Coord(s.rectSelectPoint1),a.GoogleLatLng2Coord(s.rectSelectPoint2))},100);return}}),s.rectEventListener_mousemove=google.maps.event.addListener(s.myMap,"mousemove",function(e){if(s.rectPointSelectCount==1){s.rectSelectPoint2=e.latLng;var t=s.lassoPolygon1.getPath();while(t.length>0)t.pop();t.push(s.rectSelectPoint1),t.push(new google.maps.LatLng(s.rectSelectPoint1.lat(),s.rectSelectPoint2.lng())),t.push(s.rectSelectPoint2),t.push(new google.maps.LatLng(s.rectSelectPoint2.lat(),s.rectSelectPoint1.lng()))}}),s.myMap.set("draggableCursor","crosshair"),s.myMap.set("disableDoubleClickZoom",!0)},s.stopRectSelection=function(){if(!s.rectSelecting)return;s.rectSelecting=!1,google.maps.event.removeListener(s.rectEventListener_click),google.maps.event.removeListener(s.rectEventListener_mousemove),s.myMap.set("draggableCursor","default"),s.myMap.set("disableDoubleClickZoom",!1),s.lassoPolygon1.setMap(null),s.lassoPolygon1=null},s.eventListener_Zoom=google.maps.event.addListener(s.myMap,"zoom_changed",e.proxy(s._handleOnZoomChanged,s)),s.eventListener_Moved=google.maps.event.addListener(s.myMap,"center_changed",e.proxy(s._handleOnCenterChanged,s)),s.storeSettings=function(){var e={zoomFactor:s.myMap.zoom,centerLongit:s.myMap.getCenter().lng(),centerLattit:s.myMap.getCenter().lat()};return e},s.recallSettings=function(e){s.myMap.setZoom(e.zoomFactor),s.myMap.setCenter(new google.maps.LatLng(e.centerLattit,e.centerLongit))},s.setCenter=function(e,t){t&&s.myMap.setZoom(t),s.myMap.setCenter(new google.maps.LatLng(e.lattit,e.longit))},s.handleResize=function(){var e=this.myMap.getZoom(),t=this.myMap.getCenter();google.maps.event.trigger(this.myMap,"resize"),this.myMap.setZoom(e),this.myMap.setCenter(t)},s.tearDown=function(){google.maps.event.removeListener(s.eventListener_Zoom),google.maps.event.removeListener(s.eventListener_Moved),s.myMap=null},s},a}),define("DQX/ChannelPlot/ChannelCanvas",["_","jquery","DQX/DocEl","DQX/Msg","DQX/Scroller"],function(e,t,n,r,s){var o={};return o.Base=function(r){r||(r="Channel_"+DQX.getNextUniqueID());var o={};return o._myID=r,o._height=120,o._variableHeight=!1,o._title="",o._subTitle="",o._toolTipInfo={ID:null},o._onClickHandler=null,o._isVisible=!0,o.canHide=!0,o._maxViewportSizeX=1e9,o._isMarkVisible=!0,o.getID=function(){return o._myID},o.getRequiredRightWidth=function(){return 0},o.needVScrollbar=function(){return!1},o.getVisible=function(){return this._isVisible},o._setVisible=function(e){e||(this._isOnTopPart&&DQX.reportError("Invalid action"),this.canHide||DQX.reportError("Channel cannot be hidden")),this._isVisible=e,this._updateVisibility()},o._updateVisibility=function(){this._isVisible?t("#"+this.getCanvasID("wrapper")).show():t("#"+this.getCanvasID("wrapper")).hide()},o.scrollInView=function(){o._myPlotter.channelScrollInView(o.getID())},o.getMyPlotter=function(){return this._myPlotter||DQX.reportError("Channel is not yet associated to a plotter"),this._myPlotter},o.getHeight=function(){return this._height},o.setHeight=function(e,t){return this._height=e,this._variableHeight=t==1,this},o.setAutoFillHeight=function(){this._autoFillHeight=!0},o.getAutoFillHeight=function(){return this._autoFillHeight},o.setMaxViewportSizeX=function(e){return this._maxViewportSizeX=e,this},o.setTitle=function(e){return this._title=DQX.interpolate(e),this},o.setSubTitle=function(e){return this._subTitle=DQX.interpolate(e),this},o.setHeaderTooltip=function(e){o._headerTooltip=e},o.getTitle=function(){return this._title},o.getSubTitle=function(){return this._subTitle},o.getVScroller=function(){return this.vScroller||DQX.reportError("No VScroller present"),this.vScroller},o.setPlotter=function(e){},o.setOnClickHandler=function(e){o._onClickHandler=e},o.setMarkVisible=function(e){o._isMarkVisible=e},o.hideToolTip=function(){},o.onHoverOverChannel=function(e,t){return!1},o.onStopHoverOverChannel=function(){return!1},o.getCanvasID=function(e){return this.getMyPlotter().getSubID("")+"_channel_"+this._myID.replace(".","_period_").replace(":","_colon_")+"_"+e},o.getCenterElementID=function(e){return this.getCanvasID("center")},o.getCanvasElement=function(e){return t("#"+this.getCanvasID(e))[0]},o.getCanvasElementJQ=function(e){return t("#"+this.getCanvasID(e))},o.posXCenterCanvas2Screen=function(e){return e+t(this.getCanvasElement("center")).offset().left},o.posYCenterCanvas2Screen=function(e){return e+t(this.getCanvasElement("center")).offset().top},o.posXLeftCanvas2Screen=function(e){return e+t(this.getCanvasElement("left")).offset().left},o.posYLeftCanvas2Screen=function(e){return e+t(this.getCanvasElement("left")).offset().top},o.renderHtml=function(){var e=n.Div({id:this.getCanvasID("wrapper")});e.addStyle("white-space","nowrap").addStyle("overflow","hidden").addStyle("position","relative");var t=n.Create("canvas",{id:this.getCanvasID("left"),parent:e});t.addAttribute("width",this.getMyPlotter().getLeftWidth()),t.addAttribute("height",this._height),t.addStyle("display","inline-block"),t.setWidthPx(this.getMyPlotter().getLeftWidth()).setHeightPx(o._height);var r=n.Create("canvas",{id:this.getCanvasID("center"),parent:e});r.setCssClass("DQXChannelPlotChannelCenter"),r.addAttribute("height",o._height),r.addStyle("display","inline-block"),r.setWidthPx(10).setHeightPx(o._height);var i=n.Create("canvas",{id:this.getCanvasID("right"),parent:e});i.addAttribute("width",this.getMyPlotter().getRightWidth()),i.addAttribute("height",this._height),i.addStyle("display","inline-block"),i.setWidthPx(this.getMyPlotter().getRightWidth()).setHeightPx(o._height);if(this.needVScrollbar()){var u=this.getCanvasID("VSC"),a=n.Create("canvas",{id:u,parent:e});a.addAttribute("width",s.vScrollWidth).addAttribute("height",this.getHeight()),a.addStyle("display","inline-block")}return e.toString()},o.modifyHeight=function(e){this._height=e,t("#"+this.getCanvasID("left")).height(e),t("#"+this.getCanvasID("left")).attr("height",e),t("#"+this.getCanvasID("center")).height(e),t("#"+this.getCanvasID("center")).attr("height",e),t("#"+this.getCanvasID("right")).height(e),t("#"+this.getCanvasID("right")).attr("height",e)},o.postCreateHtml=function(){t("#"+this.getCanvasID("center")).click(t.proxy(e.partialRight(o._onMouseClick,"center"),o)),t("#"+this.getCanvasID("left")).click(t.proxy(e.partialRight(o._onMouseClick,"left"),o)),t("#"+this.getCanvasID("center")).mousedown(t.proxy(o._onMouseDown,o)),t("#"+this.getCanvasID("center")).mousemove(t.proxy(o._onMouseMove,o)),t("#"+this.getCanvasID("center")).mouseenter(t.proxy(o._onMouseEnter,o)),t("#"+this.getCanvasID("center")).mouseleave(t.proxy(o._onMouseLeave,o)),t("#"+this.getCanvasID("left")).mouseenter(t.proxy(o._onLeftMouseEnter,o)),t("#"+this.getCanvasID("left")).mouseleave(t.proxy(o._onLeftMouseLeave,o)),t("#"+this.getCanvasID("left")).mousemove(t.proxy(o._onLeftMouseMove,o)),DQX.augmentTouchEvents(this,this.getCanvasID("center"),!0,!0),this.needVScrollbar()&&(this.vScroller=s.VScrollBar(this.getCanvasID("VSC")),this.vScroller.myConsumer=this,this.vScroller.draw()),this._updateVisibility()},o.resizeY=function(e){this._height=e,t("#"+this.getCanvasID("left")).height(e),this.getCanvasElement("left").height=e,t("#"+this.getCanvasID("center")).height(e),this.getCanvasElement("center").height=e,t("#"+this.getCanvasID("right")).height(e),this.getCanvasElement("right").height=e,this.vScroller&&this.vScroller.resize(e)},o.handleResizeX=function(e){var n=e-this.getMyPlotter().getLeftWidth()-this.getMyPlotter().getRightWidth()-this.getMyPlotter().getRightOffset();t("#"+this.getCanvasID("center")).width(n),this.getCanvasElement("center").width=n,t("#"+this.getCanvasID("right")).width(this.getMyPlotter().getRightWidth()),this.getCanvasElement("right").width=this.getMyPlotter().getRightWidth()},o._onMouseClick=function(e,t){if(o._wasDragged){o._wasDragged=!1;return}var t=t||"center",n=this.getEventPosX(e),r=this.getEventPosY(e);t=="left"&&(n=this.getEventLeftPosX(e));var i={shiftPressed:e.shiftKey,controlPressed:e.ctrlKey,altPressed:e.altKey};this.handleMouseClicked(n,r,t,i)},o.handleTouchStart=function(e,t){this.touchMoved=!1,this.touchStartElemX=e.elemX,this.touchStartElemY=e.elemY,this.getMyPlotter().handleMouseDown(o,t,{x:e.elemX,channelY:e.elemY,pageY:e.pageY})},o.handleTouchMove=function(e,t){Math.abs(e.elemX-this.touchStartElemX)+Math.abs(e.elemY-this.touchStartElemY)>20&&(this.touchMoved=!0),this.getMyPlotter().handleMouseMove(o,t,{x:e.elemX,channelY:e.elemY,pageY:e.pageY})},o.handleTouchEnd=function(e){this.getMyPlotter().handleMouseUp(o,e,null),this.touchMoved||this.handleMouseClicked(this.touchStartElemX,this.touchStartElemY,"center",{})},o.handleTouchCancel=function(e){this.getMyPlotter().handleMouseUp(o,e,null)},o.handleGestureStart=function(e){this.previousScale=1,this.scaleCenterPosxX=200,e.pageX&&(this.scaleCenterPosxX=e.pageX-t(this.getCanvasElement("center")).offset().left)},o.handleGestureChange=function(e){e.scale&&(this.getMyPlotter().reScale(e.scale/this.previousScale,this.scaleCenterPosxX),this.previousScale=e.scale)},o.handleGestureEnd=function(e){},o._onMouseDown=function(e){return o._wasDragged=!1,o._mouseDownStartPos={x:this.getEventPosX(e),y:this.getEventPosY(e)},t(document).bind("mouseup.ChannelCanvas",t.proxy(o._onMouseDragUp,o)),t(document).bind("mousemove.ChannelCanvas",t.proxy(o._onMouseDragMove,o)),this.getMyPlotter().handleMouseDown(o,e,{x:o._mouseDownStartPos.x,channelY:o._mouseDownStartPos.y,pageY:e.pageY}),e.returnValue=!1,!1},o._onMouseDragUp=function(e){return t(document).unbind("mouseup.ChannelCanvas"),t(document).unbind("mousemove.ChannelCanvas"),this.getMyPlotter().handleMouseUp(o,e,{x:this.getEventPosX(e),channelY:this.getEventPosY(e),pageY:e.pageY}),e.returnValue=!1,!1},o._onMouseDragMove=function(e){var t={x:this.getEventPosX(e),y:this.getEventPosY(e)};if(Math.abs(t.x-o._mouseDownStartPos.x)>4||Math.abs(t.y-o._mouseDownStartPos.y)>4)o._wasDragged=!0;return this.getMyPlotter().handleMouseMove(o,e,{x:t.x,channelY:t.y,pageY:e.pageY}),e.returnValue=!1,!1},o.getEventPosX=function(e){var n=e;return e.originalEvent&&(n=e.originalEvent),n.pageX-t(this.getCanvasElement("center")).offset().left},o.getEventPosY=function(e){var n=e;return e.originalEvent&&(n=e.originalEvent),n.pageY-t(this.getCanvasElement("center")).offset().top},o.getEventLeftPosX=function(e){var n=e;return e.originalEvent&&(n=e.originalEvent),n.pageX-t(this.getCanvasElement("left")).offset().left},o._onMouseEnter=function(e){},o._onMouseLeave=function(e){this.onStopHoverOverChannel(),this.hideToolTip()},o.handleMouseClicked=function(e,t,n,r){},o.getToolTipInfo=function(e,t){return null},o._onMouseMove=function(e){var r=this.getEventPosX(e),i=this.getEventPosY(e);this.onHoverOverChannel(r,i);var s=this.getToolTipInfo(r,i),o=!1;if(s){s.showPointer&&(o=!0);if(this._toolTipInfo.ID!=s.ID){this.hideToolTip(),this._toolTipInfo=s;var u=n.Div();u.setCssClass("DQXChannelToolTip"),u.addStyle("position","absolute"),u.addStyle("left",this.posXCenterCanvas2Screen(this._toolTipInfo.px)+10+"px"),u.addStyle("top",this.posYCenterCanvas2Screen(this._toolTipInfo.py)+10+"px"),u.addElem(this._toolTipInfo.content||""),t("#DQXUtilContainer").append(u.toString());if(this._toolTipInfo.highlightPoint){var u=n.Div();u.setCssClass("DQXChannelToolTipHighlightPoint"),u.addStyle("position","absolute"),u.addStyle("left",this.posXCenterCanvas2Screen(this._toolTipInfo.px)-5+"px"),u.addStyle("top",this.posYCenterCanvas2Screen(this._toolTipInfo.py)-5+"px"),t("#DQXUtilContainer").append(u.toString())}}}else this.hideToolTip();var a="auto";this._myPlotter&&this._myPlotter.isSelecting&&(a="ew-resize"),o&&(a="pointer"),t("#"+this.getCanvasID("center")).css("cursor",a)},o.hideToolTip=function(){this._toolTipInfo.ID=null,t("#DQXUtilContainer").find(".DQXChannelToolTip").remove(),t("#DQXUtilContainer").find(".DQXChannelToolTipHighlightPoint").remove()},o._onLeftMouseLeave=function(e){this.onStopHoverOverChannel(),this.hideHeaderToolTip(),this.hideToolTip()},o._onLeftMouseEnter=function(e){if(!o._currentHeaderTooltipID&&o._headerTooltip){o._currentHeaderTooltipID="ChannelHeaderTooltip_"+DQX.getNextUniqueID();var r=this.getEventPosX(e),i=this.getEventPosY(e),s=n.Div({id:o._currentHeaderTooltipID});s.setCssClass("DQXChannelToolTip"),s.addStyle("position","absolute");var u=t("#Div1").width();s.addStyle("right",u-this.posXLeftCanvas2Screen(0)-0+"px"),s.addStyle("top",this.posYLeftCanvas2Screen(0)+"px"),s.addElem(o._headerTooltip),t("#DQXUtilContainer").append(s.toString())}},o.hideHeaderToolTip=function(){t("#"+o._currentHeaderTooltipID).remove(),o._currentHeaderTooltipID=null},o._onLeftMouseMove=function(e){var r=this.getEventLeftPosX(e),i=this.getEventPosY(e);if(o.getLeftToolTipInfo){var s=o.getLeftToolTipInfo(r,i),u=!1;if(s){s.showPointer&&(u=!0);if(this._toolTipInfo.ID!=s.ID){this.hideToolTip(),this._toolTipInfo=s;var a=n.Div();a.setCssClass("DQXChannelToolTip"),a.addStyle("position","absolute"),a.addStyle("left",this.posXLeftCanvas2Screen(this._toolTipInfo.px)+10+"px"),a.addStyle("top",this.posYLeftCanvas2Screen(this._toolTipInfo.py)+10+"px"),a.addElem(this._toolTipInfo.content||""),t("#DQXUtilContainer").append(a.toString())}}else this.hideToolTip();u?t("#"+this.getCanvasID("left")).css("cursor","pointer"):t("#"+this.getCanvasID("left")).css("cursor","auto")}},o.drawStandardGradientCenter=function(e,t){var n=e.centerContext.createLinearGradient(0,0,0,e.sizeY);n.addColorStop(0,DQX.Color(t,t,t)),n.addColorStop(1,DQX.Color(.95*t,.95*t,.95*t)),e.centerContext.fillStyle=n,e.centerContext.fillRect(0,0,e.sizeCenterX,e.sizeY),e.centerContext.fillStyle=DQX.Color(.7*t,.7*t,.7*t).toString(),e.centerContext.fillRect(0,e.sizeY-1,e.sizeCenterX,1),e.centerContext.fillStyle=DQX.Color(.8*t,.8*t,.8*t).toString(),e.centerContext.fillRect(0,e.sizeY-2,e.sizeCenterX,1)},o.drawStandardGradientLeft=function(e,t){var n=e.leftContext.createLinearGradient(0,0,0,e.sizeY);n.addColorStop(0,DQX.Color(.95*t,.95*t,.95*t)),n.addColorStop(1,DQX.Color(.9*t,.9*t,.9*t)),e.leftContext.fillStyle=n,e.leftContext.fillRect(0,0,e.sizeLeftX,e.sizeY),e.leftContext.fillStyle=DQX.Color(.6*t,.6*t,.6*t).toString(),e.leftContext.fillRect(0,e.sizeY-1,e.sizeLeftX,1),e.leftContext.fillStyle=DQX.Color(.7*t,.7*t,.7*t).toString(),e.leftContext.fillRect(0,e.sizeY-2,e.sizeLeftX,1)},o.drawStandardGradientRight=function(e,t){if(e.sizeRightX>2){var n=e.rightContext.createLinearGradient(0,0,0,e.sizeY);n.addColorStop(0,DQX.Color(.9*t,.9*t,.9*t)),n.addColorStop(1,DQX.Color(.8*t,.8*t,.8*t)),e.rightContext.fillStyle=n,e.rightContext.fillRect(0,0,e.sizeRightX,e.sizeY),e.rightContext.fillStyle=DQX.Color(.6*t,.6*t,.6*t).toString(),e.rightContext.fillRect(0,e.sizeY-1,e.sizeRightX,1)}},o.drawMessage=function(e,t,n){e.centerContext.fillStyle="rgb(210,210,210)",e.centerContext.globalAlpha=.2,e.centerContext.fillRect(0,0,e.sizeCenterX,e.sizeY),e.centerContext.globalAlpha=1,e.leftContext.fillStyle="rgb(210,210,210)",e.leftContext.globalAlpha=.2,e.leftContext.fillRect(0,0,e.sizeLeftX,e.sizeY),e.leftContext.globalAlpha=1,e.centerContext.fillStyle="black",e.centerContext.font="bold 15px sans-serif",e.centerContext.textBaseline="bottom",e.centerContext.textAlign="center",e.centerContext.globalAlpha=.6,e.centerContext.fillText(t,e.sizeCenterX/2,Math.min(50,e.sizeY/2+7)),n&&e.centerContext.fillText(n,e.sizeCenterX/2,Math.min(77,e.sizeY/2+7+27)),e.centerContext.globalAlpha=1},o.drawFetchBusyMessage=function(e){e.centerContext.fillStyle="rgb(0,192,0)",e.centerContext.font="13px sans-serif",e.centerContext.textBaseline="top",e.centerContext.textAlign="center",e.centerContext.fillText("Fetching data...",e.sizeCenterX/2,0)},o.drawFetchFailedMessage=function(e){e.centerContext.fillStyle="rgb(255,0,0)",e.centerContext.font="13px sans-serif",e.centerContext.textBaseline="top",e.centerContext.textAlign="center",e.centerContext.fillText("Fetch failed !",e.sizeCenterX/2,0)},o.drawVertScale=function(e,t,n,r){var i=.1,s=.8;r&&typeof r.offsetFrac!="undefined"&&(i=r.offsetFrac),r&&typeof r.rangeFrac!="undefined"&&(s=r.rangeFrac);var o=e.sizeY*.125,u=DQX.DrawUtil.getScaleJump((n-t)/o);e.leftContext.fillStyle="black",e.leftContext.font="10px sans-serif",e.leftContext.textBaseline="bottom",e.leftContext.textAlign="right",e.leftContext.strokeStyle="black",e.centerContext.strokeStyle="black",e.leftContext.globalAlpha=.6,e.centerContext.globalAlpha=.05,e.centerContext.lineWidth=1;var a=0;for(j=Math.ceil(t/u.Jump1);j<=Math.floor(n/u.Jump1);j++){vl=j*u.Jump1,yp=Math.round(e.sizeY-e.sizeY*i-(vl-t)/(n-t)*e.sizeY*s)-.5;if(j%u.JumpReduc==0){e.leftContext.beginPath(),e.leftContext.moveTo(e.sizeLeftX-8,yp),e.leftContext.lineTo(e.sizeLeftX,yp),e.leftContext.stroke();if(yp<e.sizeY-2){var f=vl.toFixed(u.textDecimalCount);e.leftContext.fillText(f,e.sizeLeftX-12,yp+5),a=Math.max(a,e.leftContext.measureText(f).width)}e.centerContext.beginPath(),e.centerContext.moveTo(0,yp),e.centerContext.lineTo(e.sizeCenterX,yp),e.centerContext.stroke()}else e.leftContext.beginPath(),e.leftContext.moveTo(e.sizeLeftX-4,yp),e.leftContext.lineTo(e.sizeLeftX,yp),e.leftContext.stroke()}e.leftPanelRightOffset=a+15,e.leftContext.globalAlpha=1,e.centerContext.globalAlpha=1},o.drawTitle=function(e){function n(e,t){var n=e.split(" "),i=[],s="";for(var o=0;o<n.length;o++){var u=s+n[o]+" ",a=r.measureText(u),f=a.width;f>t&&o>0?(i.push(s),s=n[o]+" "):s=u}return i.push(s),i}var r=e.leftContext;r.font="11px sans-serif",r.fillStyle="black";var i=12,s=e.sizeLeftX;e.leftPanelRightOffset&&(s-=e.leftPanelRightOffset);var u=e.sizeY-15,a=u>=s*1.5;r.save();if(a){r.translate(0,e.sizeY/2),r.rotate(-Math.PI/2),r.textAlign="center",r.textBaseline="top";var f=u,l=s,c=!1}else{r.translate(2,e.sizeY/2),r.textAlign="left",r.textBaseline="top";var f=s,l=u,c=!0}var h=[],p=[];l>20?(o._title&&(h=n(o._title,f)),o._subTitle&&(p=n(o._subTitle,f))):(o._title&&(h=[o._title]),o._subTitle&&(p=[o._subTitle]));var d=h.length+p.length,v=5;c&&(v=-d*i/2),t.each(h,function(e,t){r.fillText(t,0,v),v+=i}),r.font="10px sans-serif",r.fillStyle="rgb(100,100,100)",t.each(p,function(e,t){r.fillText(t,0,v),v+=i}),r.restore()},o.drawMark=function(e,t){if(!o._isMarkVisible)return;if(e.mark.present){var n=Math.round(e.mark.pos1*e.zoomFactX-e.offsetX)-.5,r=Math.round(e.mark.pos2*e.zoomFactX-e.offsetX)+.5;if(r<n){var i=n;n=r,r=i}r-n<5&&(n--,r++);var s=e.centerContext.createLinearGradient(n,0,r,0),u=Math.max(1,r-n);s.addColorStop(0,"rgba(255,50,0,0.2)"),s.addColorStop(Math.min(.45,30/u),"rgba(255,50,0,0.05)"),s.addColorStop(Math.max(.55,1-30/u),"rgba(255,50,0,0.05)"),s.addColorStop(1,"rgba(255,50,0,0.2)"),e.centerContext.fillStyle=s,e.centerContext.fillRect(n,0,r-n,e.sizeY),e.centerContext.globalAlpha=.5,e.centerContext.strokeStyle="rgb(255,50,0)",e.centerContext.beginPath(),e.centerContext.moveTo(n,0),e.centerContext.lineTo(n,e.sizeY),e.centerContext.moveTo(r,0),e.centerContext.lineTo(r,e.sizeY),e.centerContext.stroke(),e.centerContext.globalAlpha=1;if(t){e.centerContext.shadowColor="rgb(255,255,255)",e.centerContext.shadowBlur=6,e.centerContext.shadowOffsetX=0,e.centerContext.shadowOffsetY=0,e.centerContext.fillStyle="rgb(255,50,0)",e.centerContext.font="bold 12px sans-serif",e.centerContext.textBaseline="top",e.centerContext.textAlign="right",e.centerContext.strokeStyle="rgb(192,192,192)";var a=Math.min(e.mark.pos1,e.mark.pos2).toFixed(0);e.centerContext.strokeText(a,n-1,10),e.centerContext.fillText(a,n-1,10),e.centerContext.textAlign="left";var f=Math.abs(e.mark.pos2-e.mark.pos1);a=f.toFixed(0),e.centerContext.strokeText(a,r,10),e.centerContext.fillText(a,r,10),e.centerContext.shadowBlur=0,e.centerContext.shadowColor="transparent"}}},o.drawXScale=function(e){e.centerContext.strokeStyle="black";var t=Math.round((-50+e.offsetX)/e.zoomFactX/e.HorAxisScaleJumps.Jump1);t<0&&(t=0);var n=Math.round((e.sizeCenterX+50+e.offsetX)/e.zoomFactX/e.HorAxisScaleJumps.Jump1);for(i=t;i<=n;i++){var r=i*e.HorAxisScaleJumps.Jump1,s=Math.round(r*e.zoomFactX-e.offsetX)+.5;s>=-50&&s<=e.sizeCenterX+50&&(e.centerContext.globalAlpha=.05,i%e.HorAxisScaleJumps.JumpReduc==0&&(e.centerContext.globalAlpha=.15),e.centerContext.beginPath(),e.centerContext.moveTo(s,0),e.centerContext.lineTo(s,e.sizeY),e.centerContext.stroke())}e.centerContext.globalAlpha=1},o.quick_top=function(e){if(!e[0])return;var t=e.offsetParent().offset(),n=e.offset();return n.top-t.top},o.render=function(e){if(!this._isVisible)return;var t=this.getCanvasElementJQ("center"),n=t.parent(),r=n.parent(),i=this.quick_top(r)-this.quick_top(n),s=i+r.height();if(s<0||i>this._height)return;var u={offsetX:e.offsetX,zoomFactX:e.zoomFactX,HorAxisScaleJumps:e.HorAxisScaleJumps,leftContext:this.getCanvasElement("left").getContext("2d"),centerContext:this.getCanvasElement("center").getContext("2d"),rightContext:this.getCanvasElement("right").getContext("2d"),sizeLeftX:e.sizeLeftX,sizeCenterX:e.sizeCenterX,sizeRightX:e.sizeRightX,mark:e.mark,sizeY:this._height,needZoomIn:!1,top_visible:i,bottom_visible:s};e.sizeCenterX/e.zoomFactX>o._maxViewportSizeX&&(u.needZoomIn=!0);if(u.needZoomIn){var a=.9;this.drawStandardGradientCenter(u,a),this.drawStandardGradientLeft(u,a),this.drawStandardGradientRight(u,a),this.drawMessage(u,"Zoom in to see "+this._title),this._always_call_draw&&this.draw(u)}else this.draw(u);"postDraw"in this&&this.postDraw(u);var f=18;if(e.offsetX>0){var l=u.centerContext.createLinearGradient(0,0,f,0);l.addColorStop(0,"rgba(230,230,230,0.85)"),l.addColorStop(1,"rgba(230,230,230,0.0)"),u.centerContext.fillStyle=l,u.centerContext.fillRect(0,1,f,u.sizeY-2)}if(e.rightSideNotComplete){var l=u.centerContext.createLinearGradient(u.sizeCenterX-f,0,u.sizeCenterX,0);l.addColorStop(0,"rgba(230,230,230,0.0)"),l.addColorStop(1,"rgba(230,230,230,0.85)"),u.centerContext.fillStyle=l,u.centerContext.fillRect(u.sizeCenterX-f,1,f,u.sizeY-2)}},o},o.XScale=function(e){var t=o.Base(e);return t._height=22,t.draw=function(e){this.drawStandardGradientCenter(e,.84),this.drawStandardGradientLeft(e,.84),this.drawStandardGradientRight(e,.84),e.centerContext.fillStyle=DQX.Color(0,0,0).toString(),e.centerContext.font="11px sans-serif",e.centerContext.textBaseline="top",e.centerContext.textAlign="center";var n=e.zoomFactX>.5,r="Mb";n&&(r="bp");var s=Math.round((-50+e.offsetX)/e.zoomFactX/e.HorAxisScaleJumps.Jump1);s<0&&(s=0);var o=Math.round((e.sizeCenterX+50+e.offsetX)/e.zoomFactX/e.HorAxisScaleJumps.Jump1);for(i=s;i<=o;i++){e.centerContext.beginPath();var u=i*e.HorAxisScaleJumps.Jump1,a=Math.round(u*e.zoomFactX-e.offsetX)+.5;if(a>=-50&&a<=e.sizeCenterX+50)if(i%e.HorAxisScaleJumps.JumpReduc==0){e.centerContext.strokeStyle=DQX.Color(0,0,0).toString(),e.centerContext.moveTo(a,t._height-6),e.centerContext.lineTo(a,t._height),e.centerContext.stroke();if(n){var f=u.toFixed(0);f=f.split("").reverse().join("");var l=[];for(var c=0;c<f.length;c++)c>0&&c%3==0&&l.push(","),l.push(f[c]);f=l.reverse().join(""),f==="0"?e.centerContext.fillText(f,a+2,3):e.centerContext.fillText(f,a,3)}else u===0?e.centerContext.fillText(u/1e6,a+2,3):e.centerContext.fillText(u/1e6,a,3)}else e.centerContext.strokeStyle=DQX.Color(.3,.3,.3).toString(),e.centerContext.moveTo(a,t._height-3),e.centerContext.lineTo(a,t._height),e.centerContext.stroke()}this.drawMark(e,!0),e.leftContext.fillStyle=DQX.Color(0,0,0).toString(),e.leftContext.font="11px sans-serif",e.leftContext.textBaseline="top",e.leftContext.textAlign="left",e.leftContext.fillText("Position ({unit})".DQXformat({unit:r}),2,3)},t},o}),define("DQX/ChannelPlot/ChannelYVals",["jquery","DQX/DocEl","DQX/Msg","DQX/Controls","DQX/ChannelPlot/ChannelCanvas","DQX/DataFetcher/DataFetchers"],function(e,t,n,r,s,o){var u={};return u.PlotHints=function(){var e={};return e.drawLines=!1,e.drawPoints=!0,e.interruptLineAtAbsent=!1,e.color=DQX.Color(0,0,0),e.opacity=1,e.pointStyle=0,e.getOpacity=function(){return e.opacity},e.makeDrawLines=function(e){this.drawLines=!0,this.maxLineDist=e},e},u.Comp=function(e,t,n,r){var s={};s.myfetcher=t,e||(e=n),s.ID=e,s.valueID=n,s.isActive=!1,s.myPlotHints=u.PlotHints(),s._maxViewportSizeX=1e99;if("addFetchColumnValue"in s.myfetcher&&!s.myfetcher.hasFetchColumn(s.valueID))if(!r)var o=s.myfetcher.addFetchColumnValue(s.valueID);else var o=s.myfetcher.addFetchColumnHighPrecisionValue(s.valueID);return s.myfetcher.hasFetchColumn(s.valueID)||DQX.reportError("Data fetcher does not have column "+s.valueID),s.getID=function(){return this.ID},s.getColor=function(){return this.myPlotHints.color},s.setColor=function(e){this.myPlotHints.color=e},s.getActive=function(){return s.isActive},s.modifyComponentActiveStatus=function(e){if(this.isActive==e)return;this.isActive=e,e?this.myfetcher.activateFetchColumn(this.valueID):this.myfetcher.deactivateFetchColumn(this.valueID)},s.setMaxViewportSizeX=function(e){return s._maxViewportSizeX=e,s},s.draw=function(e,t){this._pointsX=[],this._pointsY=[],this._pointsIndex=[];if(e.sizeCenterX/e.zoomFactX>s._maxViewportSizeX+1){e.centerContext.fillStyle="black",e.centerContext.font="bold 14px sans-serif",e.centerContext.textBaseline="bottom",e.centerContext.textAlign="left",e.centerContext.globalAlpha=.5,e.centerContext.fillText("Zoom in to see individual points",10,15),e.centerContext.globalAlpha=1;return}var n=t.rangemin,r=t.rangemax,o=this.myfetcher.getColumnPoints(t.PosMin,t.PosMax,this.valueID),u=o.xVals,a=o.YVals,f=o.blockSize,l=3;u.length>1e4&&(l=2);var c=this.myPlotHints,h="YFunction"in this,p=this._pointsX,d=this._pointsY,v=this._pointsIndex,m=1/(r-n)*e.sizeY*.8,g=e.sizeY-e.sizeY*.1+n*m;if(c.drawLines){e.centerContext.strokeStyle=c.color.toStringCanvas(),e.centerContext.globalAlpha=c.getOpacity(),c.drawPoints&&(e.centerContext.globalAlpha=.4),e.centerContext.beginPath();var y=!0,b=c.maxLineDist;for(i=0;i<u.length;i++)if(a[i]!=null){var w=u[i],E=a[i];h&&(E=this.YFunction(E));var S=w*e.zoomFactX-e.offsetX,x=g-E*m;!y&&w-T>b&&(y=!0),y?e.centerContext.moveTo(S,x):e.centerContext.lineTo(S,x),y=!1;var T=w,N=S,C=x}else!y&&c.interruptLineAtAbsent&&(e.centerContext.moveTo(N,C-1),e.centerContext.lineTo(N,C+1),e.centerContext.moveTo(N-1,C),e.centerContext.lineTo(N+1,C),y=!0);e.centerContext.stroke(),e.centerContext.globalAlpha=1}var k=c.pointStyle,L=e.centerContext;if(c.drawPoints){u.length<200&&(k=3);if(k==2)var A=document.getElementById(c.pointBitmapID);k==1&&(e.centerContext.strokeStyle=c.color.toStringCanvas(),e.centerContext.beginPath()),e.centerContext.fillStyle=c.color.toStringCanvas();for(i=0;i<u.length;i++)if(a[i]!=null){var w=u[i],E=a[i];h&&(E=this.YFunction(E));var S=Math.round(w*e.zoomFactX-e.offsetX),x=Math.round(g-E*m);p.push(S),d.push(x),v.push(i+o.startIndex);switch(k){case 0:L.fillRect(S-1,x-1,l,l);break;case 1:L.moveTo(S-2,x-.5),L.lineTo(S+1,x-.5),L.moveTo(S-.5,x-2),L.lineTo(S-.5,x+1);break;case 2:L.drawImage(A,S,x);break;case 3:L.beginPath(),L.arc(S,x,2,0,2*Math.PI,!1),L.closePath(),L.fill()}}}k==1&&e.centerContext.stroke(),f&&(e.leftContext.textBaseline="top",e.leftContext.textAlign="left",e.leftContext.font="9px sans-serif",e.leftContext.fillStyle="rgba(0,0,0,0.5)",e.leftContext.fillText(f.toString()+"bp",1,0))},s.getClosestPoint=function(e,t){var n=6,r=null,i=null,s=null,o=this._pointsX,u=this._pointsY,a=this._pointsIndex,f=o.length;for(var l=0;l<f;l++){var c=Math.abs(o[l]-e)+Math.abs(u[l]-t);c<n&&(n=c,r=a[l],i=o[l],s=u[l])}return{minDistance:n,closestPointIndex:r,px:i,py:s,highlightPoint:!0}},s},u.CompFilled=function(e,t,n){var r={};r.myfetcher=t,e||(e=n),r.ID=e,r.valueID=n,r.isActive=!1,r.myPlotHints=u.PlotHints(),r.myPlotHints.opacity=.5;if("addFetchColumnValue"in r.myfetcher&&!r.myfetcher.hasFetchColumn(r.valueID))var s=r.myfetcher.addFetchColumnValue(r.valueID);return r.myfetcher.hasFetchColumn(r.valueID)||DQX.reportError("Data fetcher does not have column "+r.valueID),r.getID=function(){return this.ID},r.getColor=function(){return this.myPlotHints.color},r.setColor=function(e,t){this.myPlotHints.color=e,t&&(r.myPlotHints.opacity=t)},r.getActive=function(){return r.isActive},r.modifyComponentActiveStatus=function(e){if(this.isActive==e)return;this.isActive=e,e?this.myfetcher.activateFetchColumn(this.valueID):this.myfetcher.deactivateFetchColumn(this.valueID)},r.draw=function(e,t){var n=t.rangemin,s=t.rangemax,o=this.myfetcher.getColumnPoints(t.PosMin,t.PosMax,this.valueID),u=o.xVals,a=o.YVals,f=3;u.length>1e4&&(f=2);var l=this.myPlotHints,c="YFunction"in this;this._pointsX=[],this._pointsY=[],this._pointsIndex=[];var h=this._pointsX,p=this._pointsY,d=this._pointsIndex,v=1/(s-n)*e.sizeY*.8,m=e.sizeY-e.sizeY*.1+n*v,g=function(){b||(e.centerContext.lineTo(x,m),e.centerContext.globalAlpha=.5*r.myPlotHints.getOpacity(),e.centerContext.fill(),e.centerContext.globalAlpha=r.myPlotHints.getOpacity(),e.centerContext.stroke(),e.centerContext.globalAlpha=1,theFirst=!0)},y=function(){b&&(e.centerContext.beginPath(),e.centerContext.moveTo(x,m))};e.centerContext.fillStyle=l.color.toStringCanvas(),e.centerContext.strokeStyle=l.color.toStringCanvas();var b=!0,w=l.maxLineDist;for(i=0;i<u.length;i++)if(a[i]!=null){var E=u[i],S=a[i];c&&(S=this.YFunction(S));var x=E*e.zoomFactX-e.offsetX,T=m-S*v;!b&&E-N>w&&(g(),b=!0),b&&y(),e.centerContext.lineTo(x,T),b=!1;var N=E}else!b&&l.interruptLineAtAbsent&&(g(),b=!0);g()},r.getClosestPoint=function(e,t){return null},r},u.YRange=function(e,t,n,r,i){var s={};s.myfetcher=t,e||(e=n),s.ID=e,s.YIDMin=n,s.YIDMax=r,s.myColor=i,s.isActive=!1,s.myPlotHints=u.PlotHints();if("addFetchColumnValue"in s.myfetcher&&!s.myfetcher.hasFetchColumn(s.valueID))var o=s.myfetcher.addFetchColumnValue(s.YIDMin),o=s.myfetcher.addFetchColumnValue(s.YIDMax);return s.myfetcher.hasFetchColumn(s.YIDMin)||DQX.reportError("Data fetcher does not have column "+s.YIDMin),s.myfetcher.hasFetchColumn(s.YIDMax)||DQX.reportError("Data fetcher does not have column "+s.YIDMax),s.getID=function(){return this.ID},s.getColor=function(){return this.myPlotHints.color},s.setColor=function(e){this.myPlotHints.color=e},s.getActive=function(){return s.isActive},s.modifyComponentActiveStatus=function(e){if(this.isActive==e)return;this.isActive=e,e?(this.myfetcher.activateFetchColumn(this.YIDMin),this.myfetcher.activateFetchColumn(this.YIDMax)):(this.myfetcher.deactivateFetchColumn(this.YIDMin),this.myfetcher.deactivateFetchColumn(this.YIDMax))},s.draw=function(e,t){s._drawViewportSize=e.sizeCenterX/e.zoomFactX;var n=t.rangemin,r=t.rangemax,i=this.myfetcher.getColumnPoints(t.PosMin,t.PosMax,this.YIDMin),o=this.myfetcher.getColumnPoints(t.PosMin,t.PosMax,this.YIDMax);if(i.missingData||o.missingData)e.centerContext.fillStyle="red",e.centerContext.font="15px sans-serif",e.centerContext.textBaseline="middle",e.centerContext.fillText("Data missing",100,15);var u=i.xVals,a=i.YVals,f=i.xVals,l=o.YVals,c=!0;e.centerContext.fillStyle=this.myColor.toStringCanvas(),e.centerContext.globalAlpha=s.myPlotHints.getOpacity();var h=1/(r-n)*e.sizeY*.8,p=e.sizeY-e.sizeY*.1+n*h,d="YFunction"in this,v=[],m=[],g=[],y=function(){var t=v.length;if(t>0){e.centerContext.beginPath(),e.centerContext.moveTo(v[0],m[0]);for(var n=1;n<t;n++)e.centerContext.lineTo(v[n],m[n]);for(var n=t-1;n>=0;n--)e.centerContext.lineTo(v[n],g[n]);e.centerContext.closePath(),e.centerContext.fill()}};for(var b=0;b<u.length;b++){psx=u[b]*e.zoomFactX-e.offsetX;if(a[b]!=null&&l[b]!=null){var w=a[b],E=l[b];d&&(w=this.YFunction(w),E=this.YFunction(E)),v.push(u[b]*e.zoomFactX-e.offsetX),m.push(p-E*h),g.push(p-w*h)}else v.length>0&&(y(),v=[],m=[],g=[])}y()},s.getClosestPoint=function(e,t){return null},s},u.YColorZone=function(e,t,n,r){var i={};return e||(e="YValComp"+DQX.getNextUniqueID()),i.ID=e,i.minVal=t,i.maxVal=n,i.myColor=r,i.isActive=!0,i.getID=function(){return this.ID},i.modifyComponentActiveStatus=function(e){if(this.isActive==e)return;this.isActive=e},i.getActive=function(){return i.isActive},i.draw=function(e,t){var n=t.rangemin,r=t.rangemax,s=1/(r-n)*e.sizeY*.8,o=e.sizeY-e.sizeY*.1+n*s,u=Math.round(o-this.minVal*s)-.5,a=Math.round(o-this.maxVal*s)-.5;e.centerContext.fillStyle=i.myColor.toStringCanvas(),e.centerContext.fillRect(0,a,e.sizeCenterX,u-a+1),e.centerContext.strokeStyle=i.myColor.toStringCanvas(),e.centerContext.beginPath(),e.centerContext.moveTo(0,u),e.centerContext.lineTo(e.sizeCenterX,u),e.centerContext.moveTo(0,a),e.centerContext.lineTo(e.sizeCenterX,a),e.centerContext.moveTo(0,a),e.centerContext.lineTo(e.sizeCenterX,a),e.centerContext.stroke(),e.centerContext.beginPath(),e.centerContext.moveTo(0,u),e.centerContext.lineTo(e.sizeCenterX,u),e.centerContext.moveTo(0,a),e.centerContext.lineTo(e.sizeCenterX,a),e.centerContext.moveTo(0,a),e.centerContext.lineTo(e.sizeCenterX,a),e.centerContext.stroke()},i.getClosestPoint=function(e,t){return null},i},u.Channel=function(t,n){var i=s.Base(t);i._height=120,i._minVal=n.minVal,i._maxVal=n.maxVal,i.myComponents={},i.minDrawZoomFactX=0,i.addComponent=function(e,t){return i._myPlotter||DQX.reportError("Channel should be attached to a plotter before adding components"),e.myfetcher&&i._myPlotter.addDataFetcher(e.myfetcher),e.level=0,e.getID()in this.myComponents&&DQX.reportError("YValue channel component already present: "+e.getID()),this.myComponents[e.getID()]=e,e.myChannel=this,t&&i.modifyComponentActiveStatus(e.getID(),!0),e},i.getComponentList=function(){return this.myComponents},i.findComponent=function(e){return e in this.myComponents||DQX.reportError("Invalid component "+e),this.myComponents[e]},i.modifyComponentActiveStatus=function(e,t,n){this.myComponents[e].modifyComponentActiveStatus(t),n&&this._myPlotter.render()},i.createComponentVisibilityControl=function(e,t,n,s){var o=t;if(s){i.modifyComponentActiveStatus(e,!1,!1);var u=!1;for(var a in i.myComponents)i.myComponents[a].getActive()&&(u=!0);i._myPlotter.channelModifyVisibility(i.getID(),u)}n&&(o='<span style="background-color:{cl}">&nbsp&nbsp&nbsp</span>&nbsp'.DQXformat({cl:i.myComponents[e].myPlotHints.color})+o);var f=r.Check(null,{label:o,value:!s}).setClassID("compvisib_"+e).setOnChanged(function(){i.modifyComponentActiveStatus(e,f.getValue(),!1);var t=!1;for(var n in i.myComponents)i.myComponents[n].getActive()&&(t=!0);i._myPlotter.channelModifyVisibility(i.getID(),t),f.getValue()&&i.scrollInView(),i._myPlotter.render()});return f},i.createVisibilityControl=function(e){if(e){for(var t in i.myComponents)i.modifyComponentActiveStatus(t,!1,!1);i._myPlotter.channelModifyVisibility(i.getID(),!1)}var n=r.Check(null,{label:i.getTitle(),value:!e}).setClassID(i._myID).setOnChanged(function(){i.modifyVisibility(n.getValue()),n.getValue()&&i.scrollInView()});return n},i.modifyVisibility=function(e,t){for(var n in i.myComponents)i.modifyComponentActiveStatus(n,e,!1);i._myPlotter.channelModifyVisibility(i.getID(),e,t),t||i._myPlotter.render()},i.setChangeYScale=function(e,t){return i._canChangeYScaleBottom=e,i._canChangeYScaleTop=t,i},i.getActiveDataFetchers=function(){var e=[];for(var t in this.myComponents)if(this.myComponents[t].isActive){var n=this.myComponents[t].myfetcher;if(n){var r=!1;for(var i=0;i<e.length;i++)n==e[i]&&(r=!0);r||e.push(n)}}return e};var u=e.proxy(i.postCreateHtml,i);return i.postCreateHtml=function(){u(),e("#"+this.getCanvasID("left")).mousedown(e.proxy(i._onMouseDownLeft,i)),e("#"+this.getCanvasID("left")).mousemove(e.proxy(i._onMouseMoveLeft,i))},i._onMouseMoveLeft=function(t){var n=this.getEventPosX(t),r=this.getEventPosY(t);if(this._canChangeYScaleTop||this._canChangeYScaleBottom){if(n>-50)var s="row-resize";else if(i._onClickHandler)var s="pointer";else var s="auto";e("#"+this.getCanvasID("left")).css("cursor",s)}},i._onMouseDownLeft=function(t){e(document).bind("mouseup.ChannelCanvasLeft",e.proxy(i._onMouseDragUpLeft,i)),e(document).bind("mousemove.ChannelCanvasLeft",e.proxy(i._onMouseDragMoveLeft,i));var n=this.getEventPosX(t),r=this.getEventPosY(t),s=e("#"+this.getCanvasID("left")).height();return this._draggingYScaleTop=!1,this._draggingYScaleBottom=!1,this._draggingYScaleTop=this._canChangeYScaleTop&&n>-50,this._canChangeYScaleBottom&&n>-50&&r>=s/2&&(this._draggingYScaleTop=!1,this._draggingYScaleBottom=!0),this._draggingY0=r,this.draggingMinVal0=this._minVal,this.draggingMaxVal0=this._maxVal,!this._draggingYScaleTop&&!this._draggingYScaleBottom&&this._onClickHandler&&this._onClickHandler(),t.returnValue=!1,!1},i._onMouseDragUpLeft=function(t){return e(document).unbind("mouseup.ChannelCanvasLeft"),e(document).unbind("mousemove.ChannelCanvasLeft"),t.returnValue=!1,!1},i._onMouseDragMoveLeft=function(e){var t=this.getEventPosX(e),n=this.getEventPosY(e);return this._draggingYScaleTop&&(this._maxVal=this.draggingMinVal0+(this.draggingMaxVal0-this.draggingMinVal0)*Math.exp((n-this._draggingY0)/70),this.getMyPlotter().render()),this._draggingYScaleBottom&&(this._minVal=this.draggingMaxVal0-(this.draggingMaxVal0-this.draggingMinVal0)*Math.exp(-(n-this._draggingY0)/70),this.getMyPlotter().render()),e.returnValue=!1,!1},i.draw=function(e){this.drawStandardGradientCenter(e,1),this.drawStandardGradientLeft(e,1),this.drawStandardGradientRight(e,1),this.drawVertScale(e,this._minVal,this._maxVal);var t=!1;for(var n in this.myComponents)this.myComponents[n].isActive&&(t=!0);if(e.needZoomIn||e.zoomFactX<this.minDrawZoomFactX){t?this.drawMessage(e,"Zoom in to see "+this.getTitle()):this.drawMessage(e,"");return}if(!t)return;e.centerContext.strokeStyle="black",this.PosMin=Math.round((-50+e.offsetX)/e.zoomFactX),this.PosMax=Math.round((e.sizeCenterX+50+e.offsetX)/e.zoomFactX);var r=this.getActiveDataFetchers(),i=!0,s=!1;for(var u=0;u<r.length;u++)r[u].IsDataReady(this.PosMin,this.PosMax,o.RecordCountFetchType.NONE)||(i=!1),r[u].hasFetchFailed&&(s=!0);!i&&!s&&this.drawFetchBusyMessage(e),s&&this.drawFetchFailedMessage(e);if(i)var a=0;for(var f=0;f<2;f++)for(var n in this.myComponents){var l=this.myComponents[n];l.isActive&&f==l.level&&l.draw(e,{PosMin:this.PosMin,PosMax:this.PosMax,rangemin:this._minVal,rangemax:this._maxVal})}this.drawMark(e),this.drawTitle(e),this.drawXScale(e)},i.handleMouseClicked=function(e,t,n,r){var s=i.getToolTipInfo(e,t);s&&i.handlePointClicked(s.compID,s.closestPointIndex)},i.getToolTipInfo=function(e,t){var n={minDistance:6,closestPointIndex:null};for(var r in this.myComponents){var i=this.myComponents[r];if(i.isActive){var s=i.getClosestPoint(e,t);s&&s.minDistance<n.minDistance&&(n=s,n.compID=r,n.ID=r+"_"+n.closestPointIndex,n.showPointer=!0)}}return n.ID?(n.content=this.getToolTipContent(n.compID,n.closestPointIndex),n):null},i.getToolTipContent=function(e,t){var n=this.myComponents[e],r=n.myfetcher.getColumnPoint(t,e);return e+"= "+r},i.handlePointClicked=function(e,t){},i},u}),define("DQX/ChannelPlot/ChannelPlotter",["jquery","DQX/DocEl","DQX/Msg","DQX/FramePanel","DQX/Scroller","DQX/ChannelPlot/ChannelCanvas","DQX/ChannelPlot/ChannelYVals"],function(e,t,n,r,i,s,o){var u={};return u.Panel=function(o,u){var a=r(o);a._leftWidth=140,"leftWidth"in u&&(a._leftWidth=u.leftWidth),a._rightWidth=0,a._rightOffset=0,a.scaleConversionFactor=1e6,a.hasIntegralPositions=!1,a._headerHeight=30,a._hasHeader=!0,"hasHeader"in u&&(a._hasHeader=u.hasHeader),a._hasHeader||(a._headerHeight=0),a._footerHeight=32,a._hasFooter=!0,"hasFoother"in u&&(a._hasFooter=u.hasFoother),a._hasFoother||(a._footerHeight=0),a._hasXScale=!0,"hasXScale"in u&&(a._hasXScale=u.hasXScale),a._navigatorHeight=25,a._channels=[],a._idChannelMap={},a._offsetX=0,a._BaseZoomFactX=2e-5,a._MaxZoomFactX=1/30,a._fullRangeMin=-25e4,a._fullRangeMax=25e7,a._zoomFactX=a._BaseZoomFactX,a._myDataFetchers=[],a._sizeCenterX=null,a.getSubID=function(e){return a.getDivID()+e},a.getElemJQ=function(t){return e("#"+this.getSubID(t))},a.getLeftWidth=function(){return a._leftWidth},a.getRightWidth=function(){return a._rightWidth},a.getRightOffset=function(){return a._rightOffset},a.setRange=function(e,t,n){this._sizeCenterX||DQX.reportError("Not initialised"),a._fullRangeMin=e,a._fullRangeMax=t,a._offsetX=0,a._zoomFactX=this._sizeCenterX/(this._fullRangeMax-this._fullRangeMin),n&&(a._MaxZoomFactX=n,a.getNavigator().setMinScrollSize(1/a._MaxZoomFactX)),a.render(),a.updateNavigator()},a.addChannel=function(t,n){n&&(t._isOnTopPart=!0),t._myID in a._idChannelMap&&DQX.reportError("Channel id already present: "+t._myID),this._channels.push(t),a._idChannelMap[t._myID]=t,"_setPlotter"in t&&t._setPlotter(this),t._myPlotter=this,this.getElemJQ(n?"BodyFixed":"BodyScroll").append(t.renderHtml()),t.postCreateHtml(),e("#"+t.getCenterElementID()).bind("DOMMouseScroll mousewheel",e.proxy(a.handleMouseWheel,a)),t.setPlotter(this),this._rightWidth=Math.max(this._rightWidth,t.getRequiredRightWidth()),t.needVScrollbar()&&(this._rightOffset=i.vScrollWidth)},a.getChannelList=function(){return a._channels},a.findChannel=function(e){return a._idChannelMap[e]},a.findChannelRequired=function(e){return rs=a._idChannelMap[e],rs||DQX.reportError("Invalid channel "+e),rs},a.delChannel=function(t){if(t in a._idChannelMap){var n=-1;e.each(a._channels,function(e,r){r._myID==t&&(n=e)});var r=a._idChannelMap[t].getCanvasID("wrapper");this.getElemJQ("Body").find("#"+r).remove(),a._channels.splice(n,1),delete a._idChannelMap[t]}},a.setOnRangeSelected=function(e){a._onRangeSelected=e},a.handleScrollBar=function(){a.suppressScrollEvent||(a.hideToolTip(),a.render()),a.suppressScrollEvent=!1};var f="",l=t.Div({id:a.getSubID("Header")});l.addStyle("white-space","nowrap").addStyle("overflow","hidden"),l.setWidthFull(),l.setCssClass("DQXButtonBar"),l.addStyle("overflow","hidden"),f+=l;var c=t.Div({id:a.getSubID("Navigator")});c.setWidthFull(),c.addStyle("white-space","nowrap").addStyle("overflow","hidden");var h=t.Create("canvas",{parent:c,id:a.getSubID("HScroller")});h.setWidthPx(10).addAttribute("height",a._navigatorHeight-2),h.setWidthPx(10).setHeightPx(a._navigatorHeight-2),h.addStyle("border-top","1px solid rgb(192,192,192)"),h.addStyle("border-bottom","1px solid rgb(192,192,192)"),f+=c;var p=t.Div({id:a.getSubID("Body")});p.setWidthFull(),p.addStyle("overflow","hidden");var d=t.Div({id:a.getSubID("BodyFixed"),parent:p});d.setWidthFull(),d.addStyle("overflow","hidden");var v=t.Div({id:a.getSubID("BodyScroll"),parent:p});v.setWidthFull(),v.addStyle("overflow-x","hidden"),v.addStyle("overflow-y","scroll"),f+=p;var m=t.Div({id:a.getSubID("Footer")});return m.setWidthFull(),m.setCssClass("DQXLight2"),m.addStyle("overflow","hidden"),f+=m,a.getElemJQ("").html(f),a.getElemJQ("BodyScroll").scroll(a.handleScrollBar),a._myNavigator=i.HScrollBar(a.getSubID("HScroller")),a._myNavigator.myConsumer=a,a.addDataFetcher=function(t){var n=!1;e.each(this._myDataFetchers,function(e,r){r===t&&(n=!0)}),n||this._myDataFetchers.push(t),t.myDataConsumer=this,this._chromosomes[this.currentChromoNr-1]&&t.setChromoID(this._chromosomes[this.currentChromoNr-1].id)},a.delDataFetcher=function(t){var n=-1;e.each(this._myDataFetchers,function(e,r){r===t&&(n=e)}),n>=0&&(t.myDataConsumer=null,this._myDataFetchers.splice(n,1))},a.channelModifyVisibility=function(e,t,n){var r=this._idChannelMap[e];r||DQX.reportError("Invalid channel id "+e),t!=r.getVisible()&&(r._setVisible(t),n||this.render())},a.channelScrollInView=function(e){if(a.recallingSettings)return;a.channelScrollInViewThrottled(e)},a.channelScrollInViewThrottled=DQX.debounce(function(t){var n=this._idChannelMap[t];n||DQX.reportError("Invalid channel id "+t);var r=e("#"+n.getCanvasID("wrapper")).offset().top-a.getElemJQ("BodyScroll").offset().top,i=a.getElemJQ("BodyScroll").scrollTop(),s=e("#"+n.getCanvasID("wrapper")).height(),o=a.getElemJQ("BodyScroll").height();r<0?a.getElemJQ("BodyScroll").scrollTop(r+i):r+s>o&&a.getElemJQ("BodyScroll").scrollTop(Math.min(r+i-o+s,r+i))},200),a._notifyZoomChanged=function(){n.broadcast({type:"ZoomFactorXChanged",id:a.myID})},a.setPosition=function(e,t){var n=this.getViewPortWidth();if(n>0){var r=this._zoomFactX;this._zoomFactX=n/t,Math.abs(this._zoomFactX-r)>1e-6*this._zoomFactX&&this._notifyZoomChanged(),this._offsetX=(e-.5*t)*this._zoomFactX,this.render(),this.updateNavigator()}},a.getPosition=function(e,t){var n={};n.left=this._offsetX/this._zoomFactX;var r=this.getViewPortWidth();return r>0&&(n.right=(this._offsetX+r)/this._zoomFactX),n},a.screenPos2XVal=function(e){return(e+this._offsetX)/this._zoomFactX},a.getNavigator=function(){return this._myNavigator},a.getVisibleRange=function(){return{min:this._offsetX/this._zoomFactX,max:(this._sizeCenterX+this._offsetX)/this._zoomFactX}},a.updateNavigator=function(){if(!this._sizeCenterX)return;var e=(this.screenPos2XVal(0)-this._fullRangeMin)/(this._fullRangeMax-this._fullRangeMin),t=(this.screenPos2XVal(this._sizeCenterX)-this._fullRangeMin)/(this._fullRangeMax-this._fullRangeMin);this._myNavigator.setRange(this._fullRangeMin/a.scaleConversionFactor,this._fullRangeMax/a.scaleConversionFactor),this._myNavigator.setValue(e,t-e),this._preventSendPositionChangeNotification||n.broadcast({type:"PosOrZoomFactorXChanged",id:a.myID})},a.scrollTo=function(e){var t=this._fullRangeMin+e*(this._fullRangeMax-this._fullRangeMin);this._offsetX=t*this._zoomFactX,this.render(),this._preventSendPositionChangeNotification||n.broadcast({type:"PosOrZoomFactorXChanged",id:a.myID})},a.zoomScrollTo=function(e,t){if(!this._sizeCenterX)return;var r=this._zoomFactX;this._zoomFactX=this._sizeCenterX/((this._fullRangeMax-this._fullRangeMin)*t),Math.abs(this._zoomFactX-r)>1e-6*this._zoomFactX&&this._notifyZoomChanged();var i=this._fullRangeMin+e*(this._fullRangeMax-this._fullRangeMin);this._offsetX=i*this._zoomFactX,this.render(),this._preventSendPositionChangeNotification||n.broadcast({type:"PosOrZoomFactorXChanged",id:a.myID})},a.clipViewRange=function(e){this._zoomFactX=Math.max(this._zoomFactX,this._sizeCenterX/(this._fullRangeMax-this._fullRangeMin)),this._offsetX=Math.min(this._fullRangeMax*this._zoomFactX-this._sizeCenterX,this._offsetX),this._offsetX=Math.max(this._fullRangeMin*this._zoomFactX,this._offsetX)},a.handleMouseDown=function(e,t,n){this._mousePressX0=n.x,this._mousePressY0=n.pageY,this._hasMouseMoved=!1,this._dragging=!1,this._mousemarking=!1;if(!t.shiftKey&&!this.isSelecting)this._dragging=!0,this._dragstartoffsetX=this._offsetX,this._dragstartx=n.x,this._dragstartoffsetY=this.getElemJQ("BodyScroll").scrollTop(),this._dragstarty=n.pageY,this._lastmouseposx=n.x;else{this._mousemarking=!0,this._markPresent=!1;var r=this.screenPos2XVal(n.x);e.mapPositionsReverse&&(r=e.mapPositionsReverse(r)),this._markPos1=r,this._markPos2=this.markPos1,this.render()}},a.handleMouseUp=function(e,t,n){a._mousemarking&&a._onRangeSelected&&a._onRangeSelected()},a.handleMouseMove=function(e,t,n){var r=n.x,i=n.pageY;Math.abs(r-this._mousePressX0)+Math.abs(i-this._mousePressY0)>5&&(this._hasMouseMoved=!0);if(this._dragging){var s=n.x;this._offsetX=this._dragstartoffsetX-(s-this._dragstartx),this.clipViewRange(),n.pageY!=this._dragstarty&&(a.suppressScrollEvent=!0),this.getElemJQ("BodyScroll").scrollTop(this._dragstartoffsetY-(n.pageY-this._dragstarty)),this.updateNavigator(),this.render(),this._lastmouseposx=s}if(this._mousemarking){var o=this.screenPos2XVal(r);e.mapPositionsReverse&&(o=e.mapPositionsReverse(o)),this._markPos2=o,this._markPresent=!0,this.hideToolTip(),this.render()}},a.hideToolTip=function(){for(var e=0;e<this._channels.length;e++)this._channels[e].hideToolTip()},a.handleMouseWheel=function(e){if(this._channels[0].length==0)return;var t=this._channels[0].getEventPosX(e),n=DQX.getMouseWheelDelta(e);if(n!=0){if(n<0)var r=1/(1+.4*Math.abs(n));else var r=1+.4*Math.abs(n);return this.reScale(r,t),e.returnValue=!1,!1}var i=DQX.getMouseWheelDeltaX(e);i!=0&&(this._myNavigator.setValue(Math.max(0,Math.min(1-this._myNavigator.ScrollSize,this._myNavigator.scrollPos-this._myNavigator.ScrollSize*i*.07))),this.zoomScrollTo(this._myNavigator.scrollPos,this._myNavigator.ScrollSize),this.render())},a.reScale=function(e,t){t||(t=this.getElemJQ("").innerHeight()/2),dff=Math.min(e,this._MaxZoomFactX/this._zoomFactX),this._offsetX=this._offsetX*dff+t*(dff-1);var n=this._zoomFactX;this._zoomFactX*=dff,this.clipViewRange(),Math.abs(this._zoomFactX-n)>1e-6*this._zoomFactX&&this._notifyZoomChanged(),this.updateNavigator(),this.render()},a.notifyDataReady=function(){this.render()},a.clearData=function(){for(var e=0;e<this._myDataFetchers.length;e++)this._myDataFetchers[e].clearData()},a.setMark=function(e,t){this._markPresent=!0,this._markPos1=e,this._markPos2=t,this.render()},a.delMark=function(){this._markPresent=!1,this.render()},a.getMark=function(){return this._markPresent?{min:this._markPos1,max:this._markPos2}:null},a.render=function(){if(!this._sizeCenterX)return;var e={offsetX:this._offsetX,zoomFactX:this._zoomFactX,sizeLeftX:a._leftWidth,sizeCenterX:this._sizeCenterX,sizeRightX:a.getRightWidth(),mark:{present:this._markPresent,pos1:this._markPos1,pos2:this._markPos2},HorAxisScaleJumps:DQX.DrawUtil.getScaleJump(30/this._zoomFactX)};a.hasIntegralPositions&&e.HorAxisScaleJumps.Jump1<1&&(e.HorAxisScaleJumps.Jump1=1,e.HorAxisScaleJumps.JumpReduc=5),this._myNavigator&&(e.rightSideNotComplete=this._myNavigator.canScrollRight());for(var t=0;t<this._channels.length;t++)this._channels[t].render(e);this._myNavigator.draw()},a.getViewPortWidth=function(){return this._sizeX},a.getZoomFactorX=function(){return this._zoomFactX},a.resizeHeight=function(e){var t=this.getElemJQ("").innerHeight(),n=t-this._headerHeight-this._footerHeight-this._navigatorHeight,r=0;for(var i=0;i<this._channels.length;i++)this._channels[i].getAutoFillHeight()&&r++;if(r>0){var s=0;for(var i=0;i<this._channels.length;i++)this._channels[i].getAutoFillHeight()||(s+=this._channels[i].getHeight());var o=(n-s)/r}var u=0,a=!1;for(var i=0;i<this._channels.length;i++)this._channels[i]._isOnTopPart?this._channels[i].getAutoFillHeight()?u+=o:u+=this._channels[i].getHeight():a=!0;r>0&&a&&DQX.reportError("Scrolling channels and auto height channels are not compatible"),this.getElemJQ("Header").height(this._headerHeight),this.getElemJQ("Body").height(n),this.getElemJQ("Footer").height(this._footerHeight),this.getElemJQ("BodyFixed").height(u),this.getElemJQ("BodyScroll").height(n-u),a?this.getElemJQ("BodyScroll").show():this.getElemJQ("BodyScroll").hide();for(var i=0;i<this._channels.length;i++)this._channels[i].getAutoFillHeight()&&this._channels[i].resizeY(o);e&&this.render()},a.resizeWidth=function(){var e=!1;for(var t=0;t<this._channels.length;t++)this._channels[t]._isOnTopPart||(e=!0);var n=0;e&&(n=DQX.scrollBarWidth);var r=this.getElemJQ("").innerWidth()-n;if(r<5)return;this._sizeX=r-this._leftWidth-this.getRightWidth()-this.getRightOffset(),this._sizeX<1&&(this._sizeX=1),this._sizeCenterX=r-this._leftWidth-this.getRightWidth()-this.getRightOffset(),this._sizeCenterX<1&&(this._sizeCenterX=1),a._myNavigator.resize(r+n);for(var t=0;t<this._channels.length;t++)this._channels[t].handleResizeX(r);this._preventSendPositionChangeNotification=!0,this.zoomScrollTo(this._myNavigator.scrollPos,this._myNavigator.ScrollSize),this._preventSendPositionChangeNotification=!1},a.handleResize=function(){a.resizeHeight(),a.resizeWidth(),this.render()},a._hasXScale&&a.addChannel(s.XScale("_XScale"),!0),a},u}),define("DQX/DataFetcher/DataFetcherAnnotation",["jquery","DQX/SQL","DQX/Utils","DQX/DataDecoders"],function(e,t,n,r){var s={};return s.Fetcher=function(s){this instanceof arguments.callee||n.reportError("Should be called as constructor!"),this.config=s,n.assertPresence(this.config,"serverURL"),n.assertPresence(this.config,"database"),n.assertPresence(this.config,"annotTableName"),this.database=s.database,this.annotTableName=s.annotTableName,this.fetchSubFeatures=!0,this.field_start="fstart",this.field_stop="fstop",this.field_chrom="chromid",this.field_name="fname",this.field_id="fid",this.ftype="gene",this.fsubtype="exon",this.showFeatureType=!1,this._myChromoID="",this._currentRangeMin=1e3,this._currentRangeMax=-1e3,this.myStartList=[],this.myStopList=[],this.myNameList=[],this.myIDList=[],this.myTypeList=[],this.myParentIDList=[],this._isFetching=!1,this.hasFetchFailed=!1,this._requestNr=0,this._userQuery2=null,this.translateChromoId=function(e){return e},this.setFeatureType=function(e,t){this.ftype=e,this.fsubtype=t},this.setUserQuery2=function(e){e.isTrivial?this._userQuery2=null:this._userQuery2=e,this.clearData()},this.clearData=function(){this._requestNr++,this._currentRangeMin=1e3,this._currentRangeMax=-1e3,this.myStartList=[],this.myStopList=[],this.myNameList=[],this.myIDList=[],this.myTypeList=[],this.myParentIDList=[]},this.AjaxResponse=function(t,i){this.hasFetchFailed=!1,this._isFetching=!1;var s=r.ValueListDecoder(),o=n.parseResponse(t);if("Error"in o){this.hasFetchFailed=!0,setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),n.timeoutRetry);return}if(o.requestnr!=this._requestNr){this.myDataConsumer.notifyDataReady();return}this._currentRangeMin=parseFloat(o.start),this._currentRangeMax=parseFloat(o.stop),this.myStartList=s.doDecode(o.Starts);var u=s.doDecode(o.Sizes);this.myStopList=[];for(var a=0;a<this.myStartList.length;a++)this.myStopList.push(this.myStartList[a]+u[a]);this.myNameList=s.doDecode(o.Names);var f=this.myNameList;e.each(f,function(e,t){f[e]=decodeURIComponent(t)}),this.myIDList=s.doDecode(o.IDs),this.myTypeList=s.doDecode(o.Types),this.myParentIDList=s.doDecode(o.ParentIDs),this.myExtraField1List=null,this.extrafield1&&(this.myExtraField1List=s.doDecode(o.ExtraField1));if(i){var l=[];for(var a=0;a<this.myStartList.length;a++)l.push({start:this.myStartList[a],stop:this.myStopList[a],width:this.myStopList[a]-this.myStartList[a],name:this.myNameList[a],id:this.myIDList[a],type:this.myTypeList[a],parent:this.myParentIDList[a]});i(l)}else this.myDataConsumer.notifyDataReady()},this._ajaxFailure=function(t,r){this.hasFetchFailed=!0,this._isFetching=!1,r?r(t):setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),n.timeoutRetry)},this._fetchRange=function(r,i,s,o){if(!this._isFetching){range=Math.max(0,i-r)+1,r-=range,i+=range,this._requestNr++;var u=n.Url(this.config.serverURL);u.addUrlQueryItem("datatype","annot"),u.addUrlQueryItem("database",this.database),u.addUrlQueryItem("requestnr",this._requestNr),u.addUrlQueryItem("chrom",this.translateChromoId(this._myChromoID)),u.addUrlQueryItem("start",r),u.addUrlQueryItem("stop",i),u.addUrlQueryItem("table",this.annotTableName),u.addUrlQueryItem("fieldstart",this.field_start),u.addUrlQueryItem("fieldstop",this.field_stop),u.addUrlQueryItem("fieldchrom",this.field_chrom),u.addUrlQueryItem("fieldid",this.field_id),this.field_name?u.addUrlQueryItem("fieldname",this.field_name):u.addUrlQueryItem("fieldname",this.field_id),this.ftype&&u.addUrlQueryItem("ftype",this.ftype),this.fsubtype&&u.addUrlQueryItem("fsubtype",this.fsubtype),this.extrafield1&&u.addUrlQueryItem("extrafield1",this.extrafield1),u.addUrlQueryItem("subfeatures",this.fetchSubFeatures?"1":0),this._userQuery2&&u.addUrlQueryItem("qry",t.WhereClause.encode(this._userQuery2)),this._isFetching=!0;var a=this;e.ajax({url:u.toString(),success:function(e){a.AjaxResponse(e,s)},error:function(e){a._ajaxFailure(e,o)}})}},this.setChromoID=function(e){this._myChromoID=e},this.IsDataReady=function(e,t){return e>=this._currentRangeMin&&t<=this._currentRangeMax?!0:(this._fetchRange(e,t),!1)},this.getData=function(t,n){var r={};r.myStartList=[],r.myStopList=[],r.myNameList=[],r.myIDList=[],r.myExonStarts=[],r.myExonStops=[],r.extraField1List=null,this.extrafield1&&(r.extraField1List=[]);var s={},o=[];this.ftype&&e.each(this.ftype.split(","),function(e,t){o[t]=!0});for(i=0;i<this.myStartList.length;i++)if(this.myStopList[i]>=t&&this.myStartList[i]<=n&&(o[this.myTypeList[i]]||this.ftype.length==0)){s[this.myIDList[i]]=r.myIDList.length,r.myStartList.push(this.myStartList[i]),r.myStopList.push(this.myStopList[i]);var u=this.myNameList[i];this.showFeatureType&&(u=this.myTypeList[i]+" "+u),r.myNameList.push(u),r.myIDList.push(this.myIDList[i]),r.myExonStarts.push([]),r.myExonStops.push([]),this.extrafield1&&r.extraField1List.push(this.myExtraField1List[i])}for(i=0;i<this.myStartList.length;i++)if(this.myStopList[i]>=t&&this.myStartList[i]<=n&&this.myTypeList[i]==this.fsubtype){var a=s[this.myParentIDList[i]];a>=0&&(r.myExonStarts[a].push(this.myStartList[i]),r.myExonStops[a].push(this.myStopList[i]))}return r},this.fetchFullAnnotInfo=function(t,r,i){var s=n.Url(this.config.serverURL);s.addUrlQueryItem("datatype","fullannotinfo"),s.addUrlQueryItem("database",this.database),s.addUrlQueryItem("table",this.annotTableName),s.addUrlQueryItem("id",t);var o=function(e){r(n.parseResponse(e).Data)};e.ajax({url:s.toString(),success:o,error:i})}},s}),define("DQX/ChannelPlot/ChannelAnnotation",["jquery","DQX/DocEl","DQX/Msg","DQX/Controls","DQX/ChannelPlot/ChannelCanvas"],function(e,t,n,r,i){var s={};return s.Channel=function(e,t,n){var s=i.Base(e);return s._annotationFetcher=t,s.setHeight(55),n&&n.annotationChannelHeight&&s.setHeight(n.annotationChannelHeight),s._minDrawZoomFactX=1/300,s._clickInfo=[],s.darkenFactor=1,s._drawLabels=!0,s._showIDInToolTip=!0,s._autoVerticalPosition=!0,s._colorByName=!1,s._slotH=10,s.setSlotHeight=function(e){s._slotH=e},s.setMinDrawZoomFactX=function(e){this._minDrawZoomFactX=e},s.setDrawLabels=function(e){this._drawLabels=e},s.setAutoVerticalPosition=function(e){s._autoVerticalPosition=e},s.showIDInToolTip=function(e){s._showIDInToolTip=e},s.setColorByName=function(e){s._colorByName=!0,s._name2ColorMap=e},s.draw=function(e){this.drawStandardGradientCenter(e,this.darkenFactor),this.drawStandardGradientLeft(e,this.darkenFactor),this.drawStandardGradientRight(e,this.darkenFactor),this._clickInfo=[];if(e.needZoomIn||e.zoomFactX<this._minDrawZoomFactX){this.drawMessage(e,"Zoom in to see "+this._title);return}var t=Math.round((-400+e.offsetX)/e.zoomFactX),n=Math.round((e.sizeCenterX+10+e.offsetX)/e.zoomFactX);this._annotationFetcher.IsDataReady(t,n)||this.drawFetchBusyMessage(e);var r=this._annotationFetcher.getData(t,n),i=!!this._annotationFetcher.extrafield1&&this.funcMapExtraField2Color;if(i)var o=this.funcMapExtraField2Color(r.extraField1List);var u=-4500;ranseed=0,e.centerContext.strokeStyle="black";var a=Math.floor((this._height-5)/s._slotH),f=[];for(var l=0;l<3;l++)f[l]=-1e4;var c=!1;if(r.myStartList.length>0&&this._drawLabels&&this._annotationFetcher.field_name){c=!0;var h=0;for(var l=0;l<r.myStartList.length;l++)h+=r.myNameList[l].length;var p=r.myStartList[0]*e.zoomFactX-e.offsetX,d=r.myStartList[r.myStartList.length-1]*e.zoomFactX-e.offsetX,v=-1;if(d>p&&5*h>d-p){var v=Math.round(3*(d-p)/h);v<4&&(c=!1)}}for(var l=0;l<r.myStartList.length;l++){var m="";this._annotationFetcher.field_name&&(m=r.myNameList[l]),u=r.myStartList[l];var g=r.myStopList[l]-r.myStartList[l],p=u*e.zoomFactX-e.offsetX,d=(u+g)*e.zoomFactX-e.offsetX;e.centerContext.fillStyle="black",e.centerContext.font="10px sans-serif",e.centerContext.textBaseline="bottom",e.centerContext.textAlign="left";var y=m;v>0&&(y=DQX.truncateString(m,v,".."));var b=0;if(s._autoVerticalPosition)for(var b=0;b<a&&f[b]>p;b++);if(b<a){if(c)var w=e.centerContext.measureText(y).width+5;else var w=0;var E={};E.x0=Math.round(p+2),E.y0=Math.round(3+s._slotH*b),E.Y1=E.y0+s._slotH,E.name=m,E.ID=r.myIDList[l],E.StartPs=r.myStartList[l],E.Len=g,e.centerContext.fillStyle="rgb(180,225,230)",e.centerContext.strokeStyle="rgb(128,128,128)",s._colorByName&&(e.centerContext.fillStyle=s._name2ColorMap[r.myNameList[l]].toStringCanvas());if(i)if(o[l]){var S=o[l].toString();e.centerContext.fillStyle=S,e.centerContext.strokeStyle=S}else e.centerContext.fillStyle="rgb(128,128,128)",e.centerContext.strokeStyle="rgb(128,128,128)";e.centerContext.beginPath(),e.centerContext.rect(Math.round(p)+.5,Math.round(E.y0)+.5,Math.round(d-p),s._slotH-2),e.centerContext.fill(),e.centerContext.stroke();if(n-t<2e6){e.centerContext.fillStyle="rgb(128,194,200)",e.centerContext.strokeStyle="rgb(0,0,0)";var x=r.myExonStarts[l],T=r.myExonStops[l];for(var N=0;N<x.length;N++){var C=x[N]*e.zoomFactX-e.offsetX,k=T[N]*e.zoomFactX-e.offsetX;e.centerContext.beginPath(),e.centerContext.rect(Math.round(C)+.5,Math.round(E.y0)+.5,Math.round(k-C)+1,s._slotH-2),e.centerContext.fill(),e.centerContext.stroke()}}c?(e.centerContext.fillStyle="rgb(80,80,80)",e.centerContext.fillText(y,Math.round(d+2)+.5,E.Y1+.5),f[b]=d+w):f[b]=d+1,E.XCent=Math.round((p+d)/2),E.X1=d+w,this._clickInfo.push(E)}b==a&&(e.centerContext.fillStyle="rgb(255,200,100)",e.centerContext.fillRect(Math.round(p+2)+.5,this.getHeight()-4+.5,20,1.5)),u+=g}this.drawMark(e),this.drawXScale(e),this.drawTitle(e)},s.getClickInfoAtPoint=function(e,t){var n=5,r=null;for(var i=0;i<this._clickInfo.length;i++){var s=this._clickInfo[i],o=0,u=0;e<s.x0&&(o=s.x0-e),e>s.X1&&(o=e-s.X1),t<s.y0&&(u=s.y0-t),t>s.Y1&&(u=t-s.Y1);var a=Math.max(o,u);a<=n&&(n=a,r=s)}return r},s.getToolTipInfo=function(e,t){var n=this.getClickInfoAtPoint(e,t),r=null;return n!=null&&(r={},r.px=Math.min(n.X1-50,Math.max(n.x0,e)),r.py=n.Y1-5,r.content=n.name,s._showIDInToolTip&&(r.content+="<br>"+n.ID),r.ID=n.ID,r.showPointer=!0),r},s.handleMouseClicked=function(e,t,n,r){var i=s.getToolTipInfo(e,t);i&&this.handleFeatureClicked(i.ID)},s.handleFeatureClicked=function(e){},s.modifyVisibility=function(e,t){s._myPlotter.channelModifyVisibility(s.getID(),e,t),t||s._myPlotter.render()},s.createVisibilityControl=function(e,t){e&&s._myPlotter.channelModifyVisibility(s.getID(),!1);var n=r.Check(null,{label:t||s.getTitle(),value:!e}).setClassID(s._myID).setOnChanged(function(){s.modifyVisibility(n.getValue()),n.getValue()&&s.scrollInView()});return n},s},s}),define("DQX/ChannelPlot/GenomePlotter",["jquery","DQX/Utils","DQX/Msg","DQX/ChannelPlot/ChannelPlotter","DQX/DataFetcher/DataFetcherAnnotation","DQX/ChannelPlot/ChannelAnnotation","DQX/SQL","DQX/DocEl","DQX/DataDecoders","DQX/Controls"],function(e,t,n,r,i,s,o,u,a,f){var l={};return l.Panel=function(l,c){var h=r.Panel(l,c);h.hasIntegralPositions=!0,t.assertPresence(c,"viewID"),h.viewID=c.viewID,h._chromosomes=[],c.chromoIdField?h.chromoIdField=c.chromoIdField:(t.assertPresence(c,"chromnrfield"),h.chromoNrField=c.chromnrfield),h.variableHeightFactor=1,h._annotationFetcher=new i.Fetcher(c),h.addDataFetcher(h._annotationFetcher),h._MaxZoomFactX=5,h.getNavigator().setMinScrollSize(1e-4),h.minZoomWindowSize=600;var p={};c.annotationChannelHeight&&(p.annotationChannelHeight=c.annotationChannelHeight),h.annotationChannel=s.Channel("_Annotation",h._annotationFetcher,p),h.annotationChannel.setTitle("Genes"),h.annotationChannel.darkenFactor=.95,h.addChannel(h.annotationChannel,!0),n.listen("",{type:"PosOrZoomFactorXChanged",id:h.myID},function(){n.broadcast({type:"ChromosomePositionChanged",id:h.myID})}),h.setMaxXZoomFactor=function(e,t){h._MaxZoomFactX=e,h.getNavigator().setMinScrollSize(1/t)},h.getAnnotationFetcher=function(){return this._annotationFetcher},h.getAnnotationChannel=function(){return this.annotationChannel},h.getChromoNr=function(e){for(var t=0;t<this._chromosomes.length;t++)if(this._chromosomes[t].id==e)return t+1;for(var t=0;t<this._chromosomes.length;t++)if(this._annotationFetcher.translateChromoId(this._chromosomes[t].id)==e)return t+1;return null},h.getChromoID=function(e){return e||t.reportError("Invalid chromosome nr"),this._chromosomes[e-1].id},h.getCurrentChromoID=function(){return this.currentChromoNr?this.getChromoID(this.currentChromoNr):null},h.setChromosome=function(e,t,r){var i=this.getChromoNr(e);if(i==null)return alert("Invalid chromosome id: "+e),!1;i!=this.currentChromoNr&&(this.clearData(),h.delMark()),this._fullRangeMin=0,-this._chromosomes[i-1].size*1e6/2e3,this._fullRangeMax=this._chromosomes[i-1].size*1e6,this.currentChromoNr=i,t&&h.getElemJQ("ChromoPicker").val(i);if(h.chromoIdField)var s=o.WhereClause.CompareFixed(h.chromoIdField,"=",this._chromosomes[this.currentChromoNr-1].id);else var s=o.WhereClause.CompareFixed(h.chromoNrField,"=",h.currentChromoNr);for(var u=0;u<this._myDataFetchers.length;u++)"setUserQuery1"in this._myDataFetchers[u]&&this._myDataFetchers[u].setUserQuery1(s),"setChromoID"in this._myDataFetchers[u]&&this._myDataFetchers[u].setChromoID(this._chromosomes[this.currentChromoNr-1].id);return this.clearData(),r&&this.render(),n.broadcast({type:"ChromosomePositionChanged",id:h.myID}),!0},h.addChromosome=function(e,t,n){this._fullRangeMin=-25e4,this._chromosomes.push({id:e,name:t,size:n});var r="";for(var i=0;i<this._chromosomes.length;i++)r+='<option value="'+(i+1).toString()+'">'+this._chromosomes[i].name+"</option>";h.getElemJQ("ChromoPicker").html(r)},h.highlightRegion=function(e,t,n){if(!this.setChromosome(e,!0,!1))return;n<1&&(n=1),this.setMark(t-n/2,t+n/2);var r=n*3;r<this.minZoomWindowSize&&(r=this.minZoomWindowSize),this.setPosition(t,r)},h.showRegion=function(e,t,n){this.setChromosome(e,!0,!1),this.setPosition(t+n/2,n)},h._onChangeChromosome=function(){var e=parseInt(h.getElemJQ("ChromoPicker").val());this.setChromosome(this._chromosomes[e-1].id,!1),this._offsetX=0,this._myNavigator.rangeMax=this._chromosomes[e-1].size,this._myNavigator.scrollPos=0,this.zoomScrollTo(this._myNavigator.scrollPos,this._myNavigator.ScrollSize),this.render()},h._onScrollRight=function(){this._myNavigator.setValue(Math.min(1-this._myNavigator.ScrollSize,this._myNavigator.scrollPos+this._myNavigator.ScrollSize/2)),this.zoomScrollTo(this._myNavigator.scrollPos,this._myNavigator.ScrollSize),this.render()},h._onScrollLeft=function(){this._myNavigator.setValue(Math.max(0,this._myNavigator.scrollPos-this._myNavigator.ScrollSize/2)),this.zoomScrollTo(this._myNavigator.scrollPos,this._myNavigator.ScrollSize),this.render()},h._onZoomIn=function(){this.reScale(1.5)},h._onZoomOut=function(){this.reScale(1/1.5)},h._onZoomInVert=function(){h.variableHeightFactor*=1.25,e.each(this._channels,function(e,t){t._variableHeight&&t.modifyHeight(Math.round(t.getHeight()*1.25))}),this.handleResize()},h._onZoomOutVert=function(){h.variableHeightFactor/=1.25,e.each(this._channels,function(e,t){t._variableHeight&&t.modifyHeight(Math.round(t.getHeight()/1.25))}),this.handleResize()},h._onToggleSelection=function(){h.isSelecting=!h.isSelecting;if(!h.isSelecting)var e='<span style="position:relative;vertical-align: middle"><i class="fa fa-crosshairs" style="font-size: 20px"></i></span>';else var e='<span style="position:relative;vertical-align: middle"><i class="fa fa-crosshairs" style="text-shadow: 0px 0px 4px rgb(8, 195, 198);color:black;font-size: 20px"></i></span>';h.selectionButton.changeIcon(null,"",e)},h._ajaxResponse_FindGene=function(r){var i=t.parseResponse(r);if("Error"in i){this.getElemJQ("FeatureHits").html("Failed to fetch data: "+i.Error);return}var s=a.ValueListDecoder(),o=s.doDecode(i.Hits),f=s.doDecode(i.Chroms),l=s.doDecode(i.Starts),p=s.doDecode(i.Ends);rs="",this._uniqueFeatureHit=null;var d=this.getElemJQ("FeaturePicker").val().toLowerCase();if(o.length>0&&o[0].length>0){for(genenr in o){o[genenr].toLowerCase()==d&&(this._uniqueFeatureHit={chromid:f[0],start:l[0],end:p[0]});var v=p[genenr]-l[genenr],m=u.Create("a",c);m.addAttribute("href","javascript:void(0)"),m.addElem(o[genenr]),m.addAttribute("id","ChromoBrowserFeatureLink_"+genenr),rs+=" "+m.toString()}o.length>=6&&(rs+=" ..."),this.getElemJQ("FeatureHits").html(rs);for(genenr in o)(function(r){var i=r;e("#ChromoBrowserFeatureLink_"+genenr).mousedown(function(e){n.send({type:"JumpgenomeRegion"+h.viewID},{chromNr:h.getChromoNr(f[i]),start:l[i],end:p[i]})})})(genenr)}else this.getElemJQ("FeatureHits").html("No hits found")},h._ajaxFailure_FindGene=function(e){this.getElemJQ("FeatureHits").html("Failed to fetch data")},h._onChangeFeaturePicker=function(){var n=this.getElemJQ("FeaturePicker").val();if(n.length==0)this.getElemJQ("FeatureHits").html("");else{var r=t.Url(this._annotationFetcher.config.serverURL);r.addUrlQueryItem("datatype","findgene"),r.addUrlQueryItem("pattern",n),r.addUrlQueryItem("database",this._annotationFetcher.database),r.addUrlQueryItem("table",this._annotationFetcher.annotTableName),r.addUrlQueryItem("chromnrfield",this.chromoNrField),this.getElemJQ("FeatureHits").html("Fetching data..."),e.ajax({url:r.toString(),success:function(e){h._ajaxResponse_FindGene(e)},error:function(e){h._ajaxFailure_FindGene(e)}})}};var d=u.Div();d.addStyle("padding","1px");var v=u.Div({parent:d});v.addStyle("float","left"),v.addElem("Chromosome: "),v.addStyle("padding-left","5px"),v.addStyle("padding-top","4px"),v.addStyle("padding-right","15px");var m=u.Div({parent:v});m.addStyle("display","inline-block"),m.setCssClass("DQXSelectWrapper");var g=u.Select([],"",{id:h.getSubID("ChromoPicker"),parent:m}),y=u.Div({parent:d});y.addStyle("float","left"),y.addStyle("padding-top","3px"),navButtonControls=[],navButtonControls.push(f.Button(h.getSubID("BtZoomin"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-search-plus" style="font-size: 20px"></i><i class="fa fa-arrows-h" style="font-size: 13px;position:absolute;left:1px;top:8px"></i></span>',description:"Zoom in horizontally",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(h._onZoomIn,h))),navButtonControls.push(f.Button(h.getSubID("BtZoomOut"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-search-minus" style="font-size: 20px"></i><i class="fa fa-arrows-h" style="font-size: 13px;position:absolute;left:1px;top:8px"></i></span>',description:"Zoom out horizontally",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(h._onZoomOut,h))),c.canZoomVert&&(navButtonControls.push(f.Button(h.getSubID("BtZoominVert"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-search-plus" style="font-size: 20px"></i><i class="fa fa-arrows-v" style="font-size: 13px;position:absolute;right:-3px;top:-4px"></i></span>',description:"Zoom in vertically",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(h._onZoomInVert,h))),navButtonControls.push(f.Button(h.getSubID("BtZoomoutVert"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-search-minus" style="font-size: 20px"></i><i class="fa fa-arrows-v" style="font-size: 13px;position:absolute;right:-3px;top:-4px"></i></span>',description:"Zoom out vertically",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(h._onZoomOutVert,h)))),navButtonControls.push(f.HorizontalSeparator(9)),navButtonControls.push(f.Button(h.getSubID("BtScrollLeft"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-play" style="font-size: 20px"></i></span>',description:"Scroll left",buttonClass:"DQXButtonBarButton fa-flip-horizontal",fastTouch:!0}).setOnChanged(e.proxy(h._onScrollLeft,h))),navButtonControls.push(f.Button(h.getSubID("BtScrollRight"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-play" style="font-size: 20px"></i></span>',description:"Scroll right",buttonClass:"DQXButtonBarButton",fastTouch:!0}).setOnChanged(e.proxy(h._onScrollRight,h))),navButtonControls.push(f.HorizontalSeparator(9)),h.selectionButton=f.Button(h.getSubID("BtToggleSelection"),{content:'<span style="position:relative;vertical-align: middle"><i class="fa fa-crosshairs" style="font-size: 20px"></i></span>',description:"Select region",buttonClass:"DQXButtonBarButton"}).setOnChanged(e.proxy(h._onToggleSelection,h)),navButtonControls.push(h.selectionButton),e.each(navButtonControls,function(e,t){y.addElem(t.renderHtml())}),h.getElemJQ("Header").html(d.toString()),h.getElemJQ("ChromoPicker").change(e.proxy(h._onChangeChromosome,h)),f.ExecPostCreateHtml();var b=u.Div();b.addStyle("padding","3px"),b.setCssClass("DQXButtonBarDarker"),b.addStyle("border-top","1px solid rgb(150,150,150)"),b.addElem("<b>Find feature:</b> ");var w=u.Edit("",{id:h.getSubID("FeaturePicker"),parent:b,placeHolder:"Enter search text"});b.addElem(" "),b.addElem(u.Span({id:h.getSubID("FeatureHits"),parent:b})),h.getElemJQ("Footer").html(b.toString());var E=h.getElemJQ("FeaturePicker"),S=e.proxy(h._onChangeFeaturePicker,h);return E.change(S),E.keyup(S),E.keydown(S),E.bind("paste",function(){setTimeout(S,50)}),h.currentChromoNr=0,h.setPostInitialiseHandler(function(){h.showRegion(h._chromosomes[0].id,0,h._chromosomes[0].size*1e6/6)}),h},l}),define("DQX/ChannelPlot/ChannelPositions",["require","DQX/Framework","DQX/Controls","DQX/Msg","DQX/Utils","DQX/ChannelPlot/ChannelCanvas","DQX/DataFetcher/DataFetchers"],function(e,t,n,r,i,s,o){var u={};return u.Channel=function(e,t,n){var r=s.Base(e);return r.dataFetcher=t,r.positionIDField=n,r._height=20,r._toolTipHandler=null,r._clickHandler=null,r.dataFetcher.addFetchColumnActive(r.positionIDField,"String"),r._selectionQuery=null,r.makeCategoricalColors=function(e,t){r._catColorFieldName=e,r._catColorStates=t,r.dataFetcher.addFetchColumnActive(r._catColorFieldName,"String")},r.setSelectionStateHandler=function(e){r._selectionQuery=e},r.setToolTipHandler=function(e){r._toolTipHandler=e},r.setClickHandler=function(e){r._clickHandler=e},r._setPlotter=function(e){r._myPlotter=e,e.addDataFetcher(r.dataFetcher)},r.draw=function(e,t){var n=Math.round((-50+e.offsetX)/e.zoomFactX),s=Math.round((e.sizeCenterX+50+e.offsetX)/e.zoomFactX);this.drawStandardGradientCenter(e,1),this.drawStandardGradientLeft(e,1),this.drawStandardGradientRight(e,1);var u=this.dataFetcher.IsDataReady(n,s,o.RecordCountFetchType.IMMEDIATE),a=this.dataFetcher.hasFetchFailed,f=this.dataFetcher.getColumnPoints(n,s,this.positionIDField),l=f.xVals,c=f.YVals,h=null;this._catColorFieldName&&(h=this.dataFetcher.getColumnPoints(n,s,this._catColorFieldName).YVals),e.centerContext.fillStyle=i.Color(.7,.7,.7).toStringCanvas(),e.centerContext.strokeStyle=i.Color(0,0,0).toString(),this._pointsX=[];var p=this._pointsX;this._pointsIndex=[];var d=this._pointsIndex;this.startIndex=f.startIndex;var v=null;for(var m=0;m<l.length;m++){var g=l[m],y=Math.round(g*e.zoomFactX-e.offsetX)+.5,b=!1;r._selectionQuery&&(b=r._selectionQuery(c[m]));if(Math.abs(y-v)>.9||b){p.push(y),d.push(m+f.startIndex);var w=4.5;b&&(e.centerContext.fillStyle=i.Color(1,0,0,.5).toStringCanvas(),e.centerContext.beginPath(),e.centerContext.moveTo(y,w-5),e.centerContext.lineTo(y+4+4,w+8+3),e.centerContext.lineTo(y-4-5,w+8+3),e.centerContext.closePath(),e.centerContext.fill(),e.centerContext.fillStyle=i.Color(.7,.7,.7).toStringCanvas());if(h){var E=i.Color(.7,.7,.7);h[m]in r._catColorStates&&(E=r._catColorStates[h[m]]),e.centerContext.fillStyle=E.toStringCanvas()}e.centerContext.beginPath(),e.centerContext.moveTo(y,w),e.centerContext.lineTo(y+4,w+8),e.centerContext.lineTo(y-4,w+8),e.centerContext.closePath(),e.centerContext.fill(),e.centerContext.stroke(),v=y}}!u&&!a&&this.drawFetchBusyMessage(e),a&&this.drawFetchFailedMessage(e),this.drawMark(e),this.drawXScale(e),this.drawTitle(e)},r.getToolTipInfo=function(e,t){if(t>=0&&t<=20){var n=this._pointsX,i=this._pointsIndex,s=12,o=-1,u=null;if(!n)return;for(var a=0;a<n.length;a++)Math.abs(e-n[a])<=s&&(s=Math.abs(e-n[a]),o=i[a],u=n[a]);if(o>=0){var f={ID:"pos"+o};return f.px=u,f.py=13,f.positionID=this.dataFetcher.getColumnPoint(o,r.positionIDField),f.content=f.positionID,r._toolTipHandler&&(f.content=r._toolTipHandler(f.positionID,o)),r._clickHandler&&(f.showPointer=!0),f}}return null},r.handleMouseClicked=function(e,t,n,i){var s=r.getToolTipInfo(e,t);s&&r._clickHandler&&r._clickHandler(s.positionID)},r},u}),define("DQX/DataFetcher/DataFetcherSummary",["jquery","DQX/SQL","DQX/Utils","DQX/DataDecoders"],function(e,t,n,r){var i={};return i.SummaryBlockLevel=function(e){var t={};return t._currentRangeMin=1e3,t._currentRangeMax=-1e3,t._blockStart=0,t._blockSize=e,t._blockCount=0,t._buffer={},t.isRangeComplete=function(e,t){return e>=this._currentRangeMin&&t<=this._currentRangeMax},t._fetchRange=function(e){this._currentRangeMin=parseFloat(e.start),this._currentRangeMax=parseFloat(e.stop),this._blockStart=parseFloat(e.blockstart),this._blockCount=parseFloat(e.blockcount),this._buffer={};var t=e.results;this._propertyBuffers=[];for(prop in t){var n=t[prop];n?this._buffer[prop]=r.Encoder.Create(n.encoder).decodeArray(n.data):this._buffer[prop]=null}},t.getPointsInRange=function(e,n){var r=Math.max(0,Math.floor(e/this._blockSize)-this._blockStart),i=Math.min(t._blockCount-1,Math.ceil(n/this._blockSize)-this._blockStart);return i-r},t.getColumnPoints=function(e,n,r){var i={blockSize:t._blockSize};i.xVals=[],i.YVals=[];if(r in this._buffer){var s=this._buffer[r];if(!s)return i.missingData=!0,i;var o=Math.max(0,Math.floor(e/this._blockSize)-this._blockStart),u=Math.min(s.length-1,Math.ceil(n/this._blockSize)-this._blockStart);i.extraInfo={},i.startIndex=o,i.extraInfo.startBlockNr=this._blockStart+o,i.extraInfo.blockSize=this._blockSize;for(var a=o;a<=u;a++)i.xVals.push((this._blockStart+a+.5)*this._blockSize),i.YVals.push(s[a]);return i}return i},t.getColumnPoint=function(e,t){if(t in this._buffer){var n=this._buffer[t];return e<0||e>=n.length?null:n[e]}return null},t},i.SummaryColumn=function(e,t,n,r,i){var s={};return s.myID=e,s.myFolder=t,s.myConfig=n,s.myPropID=r,s.myActiveCount=0,s.isActive=function(){return this.myActiveCount>0},s},i.Fetcher=function(t,r,s){this instanceof arguments.callee||n.reportError("Should be called as constructor!"),this.desiredPointCount=s,this.serverurl=t,this.minBlockSize=r,this.maxBlockSize=1e9,this.myColumns={},this._myChromoID="",this._isFetching=!1,this._levelBuffers=[],this._requestNr=0,this.translateChromoId=function(e){return e},this.addFetchColumn=function(e,t,n,r){var s=e+"_"+t+"_"+n;return s in this.myColumns?this.myColumns[s]:(this.myColumns[s]=i.SummaryColumn(s,e,t,n,r),this.clearData(),this.myColumns[s])},this.hasFetchColumn=function(e){return e in this.myColumns},this.delFetchColumn=function(e){delete this.myColumns[e]},this.activateFetchColumn=function(e){this.myColumns[e].myActiveCount==0&&this.clearData(),this.myColumns[e].myActiveCount++},this.deactivateFetchColumn=function(e){this.myColumns[e].myActiveCount--},this.setChromoID=function(e){this._myChromoID=e,this.clearData()},this.clearData=function(){this._requestNr++,this._levelBuffers=[]},this._getLevelBuffer=function(e){var t=e.toString();return t in this._levelBuffers||(this._levelBuffers[t]=i.SummaryBlockLevel(e)),this._levelBuffers[t]},this.getOptimalBlockSize=function(e,t){var n=(t-e)/this.desiredPointCount,r=Math.max(1,Math.pow(2,Math.round(Math.log(n/this.minBlockSize)/Math.log(2))))*this.minBlockSize;return r=Math.min(r,this.maxBlockSize),r},this.IsDataReady=function(e,t){var n=this.getOptimalBlockSize(e,t),r=this._getLevelBuffer(n);return r.isRangeComplete(e,t)?!0:(this._fetchRange(n,e,t),!1)},this.getColumnPoints=function(e,t,n){var r=this.getOptimalBlockSize(e,t),i=this._getLevelBuffer(r),s=!0;if(!i.isRangeComplete(e,t)){s=!1;var o=i.getPointsInRange(e,t);for(otherbuffid in this._levelBuffers){var u=this._levelBuffers[otherbuffid],a=u.getPointsInRange(e,t);a>o&&(o=a,i=u)}}var f=i.getColumnPoints(e,t,n);return f.isOptimalResolution=s,f},this.getCurrentBlockSize=function(e,t){var n=this.getOptimalBlockSize(e,t),r=this._getLevelBuffer(n);return r._blockSize},this.getColumnPoint=function(e,t,n){var r=this._getLevelBuffer(e);return r.getColumnPoint(t,n)},this._createActiveColumnListString=function(){var e="";for(var t in this.myColumns)this.myColumns[t].isActive()&&(e.length>0&&(e+="~"),e+=this.myColumns[t].myFolder,e+="~"+this.myColumns[t].myConfig,e+="~"+this.myColumns[t].myPropID);return e},this._ajaxResponse_FetchRange=function(t){if(!this._isFetching)return;this.hasFetchFailed=!1,this._isFetching=!1;var r=n.parseResponse(t);if("Error"in r){this.hasFetchFailed=!0,setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),n.timeoutRetry);return}if(r.requestnr!=this._requestNr){this.myDataConsumer.notifyDataReady();return}for(var i in this.myColumns)if(this.myColumns[i].isActive()&&!(i in r.results)){this.myDataConsumer.notifyDataReady();return}var s=r.blocksize;this._getLevelBuffer(s)._fetchRange(r);var o=r.results;this._propertySummerariserInfo={};for(prop in o)o[prop]&&(this._propertySummerariserInfo[prop]=o[prop].summariser);this.myDataConsumer.notifyDataReady()},this._ajaxFailure_FetchRange=function(t){this.hasFetchFailed=!0,this._isFetching=!1,setTimeout(e.proxy(this.myDataConsumer.notifyDataReady,this.myDataConsumer),n.timeoutRetry)},this._fetchRange=function(t,r,i,s){if(!this._isFetching){var o=this._createActiveColumnListString(),u=i-r;r-=Math.round(1.5*u),i+=Math.round(1.5*u);var a=Math.max(0,Math.floor(r/t)),f=Math.ceil((i-r)/t);if(!this._myChromoID)return;var l=n.Url(this.serverurl);l.addUrlQueryItem("datatype","summinfo"),l.addUrlQueryItem("requestnr",this._requestNr),l.addUrlQueryItem("dataid",this.translateChromoId(this._myChromoID)),l.addUrlQueryItem("ids",o),l.addUrlQueryItem("blocksize",t),l.addUrlQueryItem("blockstart",a),l.addUrlQueryItem("blockcount",f),l.addUrlQueryItem("start",r),l.addUrlQueryItem("stop",i);var c=l.toString();if(o.length>0){this._isFetching=!0;var h=this;e.ajax({url:c,success:function(e){h._ajaxResponse_FetchRange(e)},error:function(e){h._ajaxFailure_FetchRange(e)}})}else var p=0}}},i}),define("DQX/ChannelPlot/ChannelSequence",["jquery","DQX/DocEl","DQX/Msg","DQX/ChannelPlot/ChannelCanvas","DQX/DataFetcher/DataFetcherSummary"],function(e,t,n,r,s){var o={};return o.Channel=function(e,t,n,o){var u=r.Base("Sequence");return u._height=17,u.myFolder=t,u.myConfig=n,u.setTitle("Sequence"),u.baseList=["A","T","C","G"],u.colors={A:"rgb(255,50,50)",T:"rgb(255,170,0)",C:"rgb(0,128,192)",G:"rgb(0,192,120)"},o&&(u.baseList=["a","t","c","g"],u.colors={a:"rgb(255,50,50)",t:"rgb(255,170,0)",c:"rgb(0,128,192)",g:"rgb(0,192,120)"}),u.myfetcher=new s.Fetcher(e,1,800),u.mycol=u.myfetcher.addFetchColumn(u.myFolder,u.myConfig,"Base_avg",DQX.Color(1,0,0)),u.myfetcher.activateFetchColumn(u.mycol.myID),u.setPlotter=function(e){e.addDataFetcher(this.myfetcher)},u.drawTitle=function(e){e.leftContext.save(),e.leftContext.globalAlpha=.6,e.leftContext.translate(2,e.sizeY/2-3),e.leftContext.textAlign="left",e.leftContext.textBaseline="baseline",e.leftContext.font="11px sans-serif";var t=5;for(var n=0;n<4;n++){var r=this.baseList[n];e.leftContext.fillStyle=this.colors[r],e.leftContext.fillRect(t,-2,5,9),e.leftContext.fillStyle="black",e.leftContext.fillText(r,t+7,5),t+=20}e.leftContext.globalAlpha=1,e.leftContext.restore()},u.draw=function(e,t){var n=Math.round((-50+e.offsetX)/e.zoomFactX),r=Math.round((e.sizeCenterX+50+e.offsetX)/e.zoomFactX);this.drawStandardGradientCenter(e,.85),this.drawStandardGradientLeft(e,.85);var s=!0,o=!1;u.myfetcher.IsDataReady(n,r)||(s=!1),u.myfetcher.hasFetchFailed&&(o=!0);var a=this.myfetcher.getColumnPoints(n,r,this.mycol.myID),f=a.xVals,l=a.YVals,c=a.blockSize,h=(f[f.length-1]-f[0])*e.zoomFactX/f.length;if(f.length>3e3)return;var p="extraInfo"in a&&a.extraInfo.blockSize>1,d=p?6:16;if(a.isOptimalResolution){e.centerContext.globalAlpha=.6;if(h<=2)for(var v=0;v<4;v++){var m=this.baseList[v];e.centerContext.strokeStyle=this.colors[m],e.centerContext.beginPath();for(i=0;i<f.length-1;i++)if(l[i]==m){var g=f[i+1]*e.zoomFactX-e.offsetX,y=f[i+2]*e.zoomFactX-e.offsetX;e.centerContext.moveTo(g,0),e.centerContext.lineTo(g,0+d),y>g+1&&(e.centerContext.moveTo(g+1,0),e.centerContext.lineTo(g+1,0+d))}e.centerContext.stroke()}else for(i=0;i<f.length-1;i++){var m=l[i],g=Math.round(f[i+1]*e.zoomFactX-e.offsetX),y=Math.round(f[i+2]*e.zoomFactX-e.offsetX),b=0;m in this.colors&&(e.centerContext.fillStyle=this.colors[m],e.centerContext.fillRect(g,0,y-g+1,d))}if(h>3){var w=1;h>6&&(w=2),e.centerContext.fillStyle="rgba(255,255,255,0.75)";for(i=0;i<f.length-1;i++){var g=Math.round(f[i+1]*e.zoomFactX-e.offsetX),y=Math.round(f[i+2]*e.zoomFactX-e.offsetX);e.centerContext.fillRect(g-w/2,0,w,d)}}if(h>e.centerContext.measureText("G").width){e.centerContext.save(),e.centerContext.textAlign="center",e.centerContext.textBaseline="middle",e.centerContext.font="11px sans-serif",e.centerContext.fillStyle="black";for(i=0;i<f.length-1;i++){var g=Math.round(f[i+1]*e.zoomFactX-e.offsetX),y=Math.round(f[i+2]*e.zoomFactX-e.offsetX),m=l[i];e.centerContext.fillText(m,(g+y)/2,d/2)}e.centerContext.restore()}e.centerContext.globalAlpha=1;if(p){e.centerContext.textAlign="left",e.centerContext.textBaseline="top",e.centerContext.font="9px sans-serif",e.centerContext.fillStyle="rgb(90,90,90)";var E="Majority vote summarised";c&&(E+=" (Window size: {blocksize}bp)".DQXformat({blocksize:c})),e.centerContext.fillText(E,20,6)}}!s&&!o&&this.drawFetchBusyMessage(e),o&&this.drawFetchFailedMessage(e),this.drawMark(e),this.drawTitle(e)},u},o}),define("Utils/GetFullDataItemInfo",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","MetaData"],function(e,t,n,r,i,s,o,u,a,f){var l={};return l.Get=function(e,t,n){function s(e,t){var n={};return i.add([],function(){var r=a.Url(f.serverUrl);r.addUrlQueryItem("datatype","recordinfo");var u=f.getTableInfo(e).primkey;r.addUrlQueryItem("qry",o.WhereClause.encode(o.WhereClause.CompareFixed(u,"=",t))),r.addUrlQueryItem("database",f.database),r.addUrlQueryItem("tbname",e+"CMB_"+f.workspaceid),$.ajax({url:r.toString(),success:function(r){i.setCompleted(e);var s=a.parseResponse(r);n.tableid=e;if("Error"in s){alert("Unable to fetch {tableid}, {itemid}: \n{error}".DQXformat({tableid:e,itemid:t,error:s.Error})),n.fields={};return}n.fields=s.Data},error:function(){i.setCompleted(e)}}),i.add([e],function(){var t=f.mapTableCatalog[e];n.parents=[],$.each(t.relationsChildOf,function(e,t){var r=n.fields[t.childpropid];if(r){var i=s(t.parenttableid,r);i.relation=t,n.parents.push(i)}})})}),n}var r={},i=a.Scheduler();i.setOnFullyCompleted(function(){n(r)}),r=s(e,t),i.execute()},l}),define("Utils/MiscUtils",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/QueryTable","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={},y=function(e,t){var n=t-e;return n||(n=1),function(t){if(t==null)return"white";t=parseFloat(t),t=(t-e)/n,t=Math.max(0,t),t=Math.min(1,t),t>0&&(t=.05+t*.95),t=Math.sqrt(t);var r=255,i=255*(1-.15*t*t),s=255*(1-.3*t);return"rgb("+parseInt(s)+","+parseInt(i)+","+parseInt(r)+")"}};return g.createEncoderId=function(e,t){var n=m.mapTableCatalog[e],r=m.findProperty(e,t),i="String";if(r.datatype=="Value"){i="Float3";if(r.settings.decimDigits==0||r.isPrimKey)i="Int"}r.datatype=="HighPrecisionValue"&&(i="FloatH"),r.datatype=="Value"&&r.propid==n.PositionField&&n.hasGenomePositions&&(i="Int"),r.datatype=="Boolean"&&(i="Int");if(r.datatype=="GeoLongitude"||r.datatype=="GeoLattitude")i="Float4";return r.datatype=="Date"&&(i="Float4"),i},g.createItemTableViewerColumn=function(e,t,n){var r=m.mapTableCatalog[t],i=m.findProperty(t,n),a=g.createEncoderId(t,n),l=1;i.isPrimKey&&(l=0);var c=!0;r.hasGenomePositions&&(i.propid==r.ChromosomeField||i.propid===r.PositionField)&&(c=!1),r.hasGenomeRegions&&(i.propid==r.settings.Chromosome||i.propid===r.settings.RegionStart||i.propid===r.settings.RegionStop)&&(c=!1);var h=!1;c&&(h=n==r.settings.SortDefault);var p=e.createTableColumn(u.Column(i.name,i.propid,l),a,c,h);i.settings.Description&&p.setToolTip(i.settings.Description);if(r.hasGenomePositions&&e.findColumn(r.ChromosomeField)&&e.findColumn(r.PositionField)&&n==r.PositionField){if(!r.settings.SortDefault)var h=!0;e.addSortOption("Position",o.TableSort([r.ChromosomeField,r.PositionField]),h)}r.hasGenomeRegions&&i.propid===r.settings.RegionStart&&(h=n==r.settings.SortDefault,e.addSortOption("Position",o.TableSort([r.settings.Chromosome,r.settings.RegionStart]),h)),i.datatype=="Boolean"&&p.setDataType_MultipleChoiceInt([{id:0,name:"No"},{id:1,name:"Yes"}]),i.propid==r.ChromosomeField&&p.setDataType_MultipleChoiceString(m.chromosomes);if(i.propCategories){var d=[];$.each(i.propCategories,function(e,t){d.push({id:t,name:t})}),p.setDataType_MultipleChoiceString(d)}return i.isPrimKey&&p.setCellClickHandler(function(n,r){var o=e.getCellValue(r,i.propid);s.send({type:"ItemPopup"},{tableid:t,itemid:o})}),i.relationParentTableId&&p.setCellClickHandler(function(t,n){var r=e.getCellValue(n,i.propid);s.send({type:"ItemPopup"},{tableid:i.relationParentTableId,itemid:r})}),i.settings.ExternalUrl&&p.setCellClickHandler(function(t,n){var r=e.getCellValue(n,i.propid),s=i.settings.ExternalUrl,o=r.split(";");o.forEach(function(e){var t=s.DQXformat({value:e});window.open(t,"_blank")})},!0),p.CellToText=i.toDisplayString,p.CellToTextInv=i.fromDisplayString,i.group&&(p.GroupName=i.group.Name),i.isFloat&&(i.settings.minval||i.settings.maxval)&&(p.minval=i.settings.minval,p.maxval=i.settings.maxval,i.settings.BarWidth?p.barGraphWidth=i.settings.BarWidth:i.settings.hasValueRange&&(p.CellToColor=y(i.settings.minval,i.settings.maxval))),i.settings.MaxColumnWidth&&(p.maxColumnWidth=i.settings.MaxColumnWidth),i.settings.categoryColors?p.CellToColor=function(e){return i.mapSingleColor(e).lighten(.5)}:i.isBoolean&&(p.CellToColor=function(e){return e?f.Color(.88,.97,.88):f.Color(1,.95,.9)}),p.checkCanSort=function(){var t=r,n=!1;r.hasGenomePositions&&r.PositionField==i.propid&&(n=!0);if(!i.settings.Index&&!n){var s=e.getRecordCount();return s>1e6?(alert("Unable to sort this column: data set is too large"),!1):s===null||e.getIsTruncatedRecordCount()?(alert("Unable to sort this column: unknown data set size"),!1):!0}return!0},p},g.createDataItemTable=function(e,t,n,r){var i=d.Table(m.serverUrl,m.database,t.getQueryTableName(r.subSampling));r.maxResultSet?i.setMaxRecordCount(r.maxResultSet):i.setMaxRecordCount(t.settings.MaxCountQueryAggregated||1e6),i.setReportIfError(!0);var o=u.Panel(e,i,{leftfraction:50}),a=o.getTable();return a.fetchBuffer=300,a.recordCountFetchType=d.RecordCountFetchType.DELAYED,a.setQuery(n),r.hasSelection&&a.createSelectionColumn("sel","",t.id,t.primkey,t,f.Color(.8,.2,0),function(){s.broadcast({type:"SelectionUpdated"},t.id)}),$.each(m.customProperties,function(e,n){if(n.tableid==t.id&&n.settings.showInTable&&t.isPropertyColumnVisible(n.propid)){var r=g.createItemTableViewerColumn(a,t.id,n.propid);r.propid=n.propid}}),o.onResize(),o},g.selectQuery=function(e,t,n){["replace","add","restrict","exclude"].indexOf(n)<0&&f.reportError("Invalid selection method");var r=1e5,i=d.RecordsetFetcher(m.serverUrl,m.database,e.getQueryTableName(t.isSubSampling()));i.setMaxResultCount(r);var o=e.primkey;t.isSubSampling()&&(o="RandPrimKey");var u=!!m.findProperty(e.id,e.primkey).isFloat;i.addColumn(e.primkey,u?"IN":"ST"),f.setProcessing(),i.getData(t.getForFetching(),o,function(t){f.stopProcessing();var i=t[e.primkey];i.length>=r&&alert("WARNING: maximum number of items reached. Only {nr} will be selected".DQXformat({nr:r})),n=="replace"&&(e.currentSelection={},$.each(i,function(t,n){e.selectItem(n,!0)})),n=="add"&&$.each(i,function(t,n){e.selectItem(n,!0)});if(n=="restrict"){var o=e.getSelectedList(),u={};$.each(i,function(e,t){u[t]=!0}),$.each(o,function(t,n){u[n]||e.selectItem(n,!1)})}if(n=="exclude"){var o=e.getSelectedList(),u={};$.each(i,function(e,t){u[t]=!0}),$.each(o,function(t,n){u[n]&&e.selectItem(n,!1)})}s.broadcast({type:"SelectionUpdated"},e.id)},function(e){f.stopProcessing(),f.reportError("Query failed")})},g.createPolygonRestrictionQuery=function(e,t,n,r){var i=e,s=0,o=!1;return $.each(r,function(e,t){pt2=r[(e+1)%r.length],pt3=r[(e+2)%r.length];var n=pt2.x-t.x,i=pt2.y-t.y,u=pt3.x-pt2.x,a=pt3.y-pt2.y,f=n*a-i*u;Math.abs(f)>0&&(f>0&&(s<0&&(o=!0),s=1),f<0&&(s>0&&(o=!0),s=-1))}),o?i=null:$.each(r,function(e,o){var u=r[(e+1)%r.length],a={x:s*(u.x-o.x),y:s*(u.y-o.y)};i=g.createHalfPlaneRestrictionQuery(i,t,n,o,a).query}),{query:i}},g.createHalfPlaneRestrictionQuery=function(e,t,n,r,i){var s=null,u=null,a=Math.abs(i.x)+Math.abs(i.y);if(Math.abs(i.x/a)>1e-9&&Math.abs(i.y/a)>1e-9){var f=i.y/i.x,l=r.y-r.x*i.y/i.x;if(i.x>0){var c=o.WhereClause.CompareField(">FIELD");u=function(e,t){return t>l+f*e}}else{var c=o.WhereClause.CompareField("<FIELD");u=function(e,t){return t<l+f*e}}c.ColName=n,c.ColName2=t,c.Factor=f,c.Offset=l;var s=o.WhereClause.createRestriction(e,c)}else i.x>0&&(s=o.WhereClause.createValueRestriction(e,n,r.y,">"),u=function(e,t){return t>r.y}),i.x<0&&(s=o.WhereClause.createValueRestriction(e,n,r.y,"<"),u=function(e,t){return t<r.y}),i.y>0&&(s=o.WhereClause.createValueRestriction(e,t,r.x,"<"),u=function(e,t){return e<r.x}),i.y<0&&(s=o.WhereClause.createValueRestriction(e,t,r.x,">"),u=function(e,t){return e>r.x});return{query:s,selector:u}},g.createDateScaleInfo=function(e,t){var n,r,i=1e9,s=function(t){return Math.abs(t/e-1)},o={namedDays:null,monthInterval:null,yearInterval:null};return n=1*t,r=s(n),r<i&&(i=r,o.namedDays=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,39,31]),n=2*t,r=s(n),r<i&&(i=r,o.namedDays=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30]),n=5*t,r=s(n),r<i&&(i=r,o.namedDays=[1,5,10,15,20,25]),n=10*t,r=s(n),r<i&&(i=r,o.namedDays=[1,10,20]),n=15*t,r=s(n),r<i&&(i=r,o.namedDays=[1,15]),$.each([1,2,3,6,12],function(e,u){n=u*30*t,r=s(n),r<i&&(i=r,o.monthInterval=u,o.namedDays=null,o.yearInterval=null)}),$.each([1,2,5,10,20,50,100,200,500,1e3],function(e,u){n=u*365*t,r=s(n),r<i&&(i=r,o.monthInterval=null,o.namedDays=null,o.yearInterval=u)}),o.isOnScale=function(e,t,n){return this.yearInterval?e%this.yearInterval==0&&t==1&&n==1?!0:!1:this.monthInterval?(t-1)%this.monthInterval==0&&n==1?!0:!1:this.namedDays.indexOf(n)>=0?!0:!1},o},g.createPropertyScale=function(e,t,n,r,i){var s=m.findProperty(e,t);if(s.isDate){var o=function(e){return e<10?"0"+e:e},u=g.createDateScaleInfo(80,n),a=g.createDateScaleInfo(20,n),l=[],c=Math.floor(r),h=Math.ceil(i);for(var p=c;p<=h;p++){var d=f.JD2DateTime(p),v=d.getUTCFullYear(),y=d.getUTCMonth()+1,b=d.getUTCDate();if(u.isOnScale(v,y,b)){var w={value:p,label:v.toString()};l.push(w),u.yearInterval||(w.label2="-"+o(y)+"-"+o(b))}else a.isOnScale(v,y,b)&&l.push({value:p})}return l}var E=f.DrawUtil.getScaleJump(30/n),l=[];for(var S=Math.ceil(r/E.Jump1);S<=Math.floor(i/E.Jump1);S++){var w={};w.value=S*E.Jump1,S%E.JumpReduc==0&&(w.label=E.value2String(w.value)),l.push(w)}return l},g.parseCrossLink=function(e){var t={},n=e.split("::");n.length!=2&&f.reportError("Invalid crosslink: "+e),t.tableid=n[0],t.itemid=n[1];var r=m.mapTableCatalog[t.tableid];return r||f.reportError("Invalid crosslink: "+e),t.dispName=r.tableNameSingle,t},g.openCrossLink=function(e){if(!e)return;(!e.tableid||!e.itemid||!m.mapTableCatalog[e.tableid])&&f.reportError("Invalid crosslink"),s.send({type:"ItemPopup"},{tableid:e.tableid,itemid:e.itemid})},g.getReverseCrossLinkList=function(e,t){var n=[],r=e+"::"+t;return $.each(m.tableCatalog,function(e,t){$.each(t.trees,function(e,i){r==i.crossLink&&n.push({tpe:"tree",dispName:"tree",bitmap:"Bitmaps/unroottree.png",tableid:t.id,treeid:i.id})})}),n},g.openReverseCrossLink=function(e){if(e.tpe=="tree"){s.send({type:"OpenTree"},e);return}f.reportError("Invalid reverse crosslink")},g.createDocButton=function(e){var t=i.Button(null,{buttonClass:"PnButtonHelp",bitmap:"Bitmaps/Icons/Small/documentationgreen.png",bitmapHeight:25,content:'<span style="color:rgb(0,120,0)"><b>Help</b></span>',width:80,height:35}).setOnChanged(function(){var t=m.urlDocumentation+e+".html";window.open(t,"_blank")});return t},g}),define("DQX/ChannelPlot/ChannelMultiCatDensity",["jquery","DQX/DocEl","DQX/Msg","DQX/Controls","DQX/ChannelPlot/ChannelCanvas","DQX/DataFetcher/DataFetchers"],function(e,t,n,r,i,s){var o={};return o.Channel=function(t,n,r,s){var o=i.Base(t);o._height=120,o.myfetcher=n,o._minVal=0,o._maxVal=1,o._categoryColors={},o._scaleRelative=!1,o._canChangeYScaleTop=!0,o._canChangeYScaleBottom=!1,o.mycol=r,s.categoryColors&&(o._categoryColors=s.categoryColors),s.maxVal&&(o._maxVal=s.maxVal),o.minDrawZoomFactX=0,o.setChangeYScale=function(e,t){return o._canChangeYScaleBottom=e,o._canChangeYScaleTop=t,o},o.getActiveDataFetchers=function(){return[this.myfetcher]},o.setPlotter=function(e){e.addDataFetcher(this.myfetcher)};var u=e.proxy(o.postCreateHtml,o);return o.postCreateHtml=function(){u(),e("#"+this.getCanvasID("left")).mousedown(e.proxy(o._onMouseDownLeft,o)),e("#"+this.getCanvasID("left")).mousemove(e.proxy(o._onMouseMoveLeft,o))},o._onMouseMoveLeft=function(t){var n=this.getEventPosX(t),r=this.getEventPosY(t);if(!o._scaleRelative&&(this._canChangeYScaleTop||this._canChangeYScaleBottom)){if(n>-50)var i="row-resize";else if(o._onClickHandler)var i="pointer";else var i="auto";e("#"+this.getCanvasID("left")).css("cursor",i)}},o._onMouseDownLeft=function(t){e(document).bind("mouseup.ChannelCanvasLeft",e.proxy(o._onMouseDragUpLeft,o)),e(document).bind("mousemove.ChannelCanvasLeft",e.proxy(o._onMouseDragMoveLeft,o));var n=this.getEventPosX(t),r=this.getEventPosY(t),i=e("#"+this.getCanvasID("left")).height();return this._draggingYScaleTop=!1,this._draggingYScaleBottom=!1,this._draggingYScaleTop=this._canChangeYScaleTop&&n>-50,this._canChangeYScaleBottom&&n>-50&&r>=i/2&&(this._draggingYScaleTop=!1,this._draggingYScaleBottom=!0),this._draggingY0=r,this.draggingMinVal0=this._minVal,this.draggingMaxVal0=this._maxVal,!o._scaleRelative&&!this._draggingYScaleTop&&!this._draggingYScaleBottom&&this._onClickHandler&&this._onClickHandler(),t.returnValue=!1,!1},o._onMouseDragUpLeft=function(t){return e(document).unbind("mouseup.ChannelCanvasLeft"),e(document).unbind("mousemove.ChannelCanvasLeft"),t.returnValue=!1,!1},o._onMouseDragMoveLeft=function(e){var t=this.getEventPosX(e),n=this.getEventPosY(e);return this._draggingYScaleTop&&(this._maxVal=this.draggingMinVal0+(this.draggingMaxVal0-this.draggingMinVal0)*Math.exp((n-this._draggingY0)/70),this.getMyPlotter().render()),this._draggingYScaleBottom&&(this._minVal=this.draggingMaxVal0-(this.draggingMaxVal0-this.draggingMinVal0)*Math.exp(-(n-this._draggingY0)/70),this.getMyPlotter().render()),e.returnValue=!1,!1},o.draw=function(t){this.drawStandardGradientCenter(t,1),this.drawStandardGradientLeft(t,1),this.drawStandardGradientRight(t,1);if(!o._scaleRelative){o.drawVertScale(t,o._minVal,o._maxVal,{offsetFrac:.07,rangeFrac:.86});var n=1/(o._maxVal-o._minVal)*t.sizeY*.86,r=t.sizeY-t.sizeY*.07+o._minVal*n}else{o.drawVertScale(t,0,100,{offsetFrac:.07,rangeFrac:.86});var n=.01*t.sizeY*.9,r=t.sizeY-t.sizeY*.05}var i=Math.round((-50+t.offsetX)/t.zoomFactX),s=Math.round((t.sizeCenterX+50+t.offsetX)/t.zoomFactX);o.myfetcher.IsDataReady(i,s)||(alldataready=!1),o.myfetcher.hasFetchFailed&&(fetcherror=!0);var u=this.myfetcher.getColumnPoints(i,s,o.mycol.myID),a=u.xVals,f=u.YVals,l=u.blockSize,c=null;o.myfetcher._propertySummerariserInfo&&o.myfetcher._propertySummerariserInfo[o.mycol.myID]&&(c=o.myfetcher._propertySummerariserInfo[o.mycol.myID].Categories);if(c){categoryColors=[];for(var h=0;h<c.length;h++){var p=o._categoryColors[c[h]];p||(p=DQX.Color(.75,.75,.75).toStringCanvas()),categoryColors.push(p)}for(var d=0;d<a.length;d++){var v=Math.round((a[d]-l/2)*t.zoomFactX-t.offsetX),m=Math.round((a[d]+l/2)*t.zoomFactX-t.offsetX),g=0;e.each(f[d],function(e,t){g+=t});if(g>0){g/=l,g||(g=1);var y=0,b=r;for(var h=0;h<c.length;h++){t.centerContext.fillStyle=categoryColors[h];var w=f[d][h],E=y+w/l;if(!o._scaleRelative)var S=r-E*n;else var S=r-E/g*100*n;t.centerContext.fillRect(v,b,m-v+1,S-b),y=E,b=S}}}t.leftContext.textBaseline="top",t.leftContext.textAlign="left",t.leftContext.font="9px sans-serif",t.leftContext.fillStyle="rgba(0,0,0,0.5)",t.leftContext.fillText(l.toString()+"bp",1,0)}this.drawMark(t),this.drawTitle(t),this.drawXScale(t)},o.handleMouseClicked=function(e,t,n,r){},o.getToolTipInfo=function(e,t){return null},o.getToolTipContent=function(e,t){},o.handlePointClicked=function(e,t){},o},o}),define("Wizards/EditTableBasedSummaryValues",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/QueryTable","DQX/QueryBuilder","DQX/DataFetcher/DataFetchers","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","Utils/QueryTool","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.storedValues={},g.prompt=function(e){var t=m.getTableInfo(e),r="",s=i.Html(null,"");r+=s.renderHtml()+"<p>";var o=function(){s.modifyValue("Currently active: "+t.genomeTrackSelectionManager.getSelectedCount())},u=i.Button(null,{buttonClass:"DQXToolButton2",height:45,width:140,icon:"fa-crosshairs",content:"Pick "+t.name+"..."}).setOnChanged(function(){p.closeIfNeeded(h),g.CreateDialogBox(e)});r+=u.renderHtml();var a="Use current query",f=n.getView("table_"+e).getRecordCount();f!=null&&(a+="<br>("+f+" items)");var u=i.Button(null,{buttonClass:"DQXToolButton2",height:45,width:140,icon:"fa-filter",content:a}).setOnChanged(function(){p.closeIfNeeded(h),c.executeProcessing(function(){g.loadCurrentQuery(e)})});r+=u.renderHtml(),r+="<br>";var a="Use currently highlighted",f=t.getSelectedList().length;a+="<br>("+f+" items)";var u=i.Button(null,{buttonClass:"DQXToolButton2",height:45,width:140,icon:"fa-check-circle",content:a}).setOnChanged(function(){p.closeIfNeeded(h),c.executeProcessing(function(){g.loadCurrentSelection(e)})});r+=u.renderHtml();var u=i.Button(null,{buttonClass:"DQXToolButton2",height:45,width:140,icon:"fa-ban",content:"Clear all"}).setOnChanged(function(){c.executeProcessing(function(){p.closeIfNeeded(h),t.genomeTrackSelectionManager.clearAll()})});r+=u.renderHtml(),r+="<p/>";var l=v.CreateStoredQueryPicker(e,function(t){g.loadQuery(e,t),p.closeIfNeeded(h)});r+="Load a query: "+l.renderHtml(),r+="<p/>";var h=p.create(t.name+" active genome tracks",r);o()},g.loadCurrentQuery=function(e){var t=m.getTableInfo(e),r=n.getView("table_"+e),i=r.theQuery.get();i||(i=o.WhereClause.Trivial()),i.sortColumn=r.getSortColumn(),g.loadQuery(e,i)},g.loadQuery=function(e,t){var r=m.getTableInfo(e),i=n.getView("table_"+e);r.genomeTrackSelectionManager.clearAll();var s=t.sortColumn;s||(s=r.primkey);var o=200,u=f.RecordsetFetcher(m.serverUrl,m.database,e+"CMB_"+m.workspaceid);u.setMaxResultCount(o),u.addColumn(r.primkey,"GN"),u.getData(t,s,function(e){var t=e[r.primkey];t.length>=o&&alert("WARNING: set will be truncated to "+o);var n=0;$.each(t,function(e,t){n+=1,n<=o&&r.genomeTrackSelectionManager.selectItem(t,!0,!0)}),r.genomeTrackSelectionManager.notifyChanged()})},g.loadCurrentSelection=function(e){var t=m.getTableInfo(e);t.genomeTrackSelectionManager.clearAll(),$.each(t.getSelectedList(),function(e,n){t.genomeTrackSelectionManager.selectItem(n,!0,!0)}),t.genomeTrackSelectionManager.notifyChanged()},g.CreateDialogBox=function(e){var t=d.PopupFrame("EditTableBasedSummaryValues",{title:"Active genome tracks",blocking:!0,sizeX:700,sizeY:500});return t.tableInfo=m.getTableInfo(e),t.createFrames=function(){t.frameRoot.makeGroupVert(),t.frameQuery=t.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,60).setFrameClassClient("DQXGrayClient"),t.frameBody=t.frameRoot.addMemberFrame(r.FrameFinal("",.7)).setAllowScrollBars(!0,!0),t.frameButtons=t.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,70).setFrameClassClient("DQXGrayClient")},t.createPanels=function(){t.panelQuery=r.Form(t.frameQuery);var e=[];t.queryControls={},$.each(t.tableInfo.quickFindFields,function(n,r){var s=m.findProperty(t.tableInfo.id,r);if(!s.propCategories)var o=i.Edit(null,{size:12});else{var u=[{id:"",name:"[All]"}];$.each(s.propCategories,function(e,t){u.push({id:t,name:t})});var o=i.Combo(null,{size:18,label:"",states:u})}r in g.storedValues&&o.modifyValue(g.storedValues[r]),o.setOnChanged(c.debounce(t.updateQuery,200)),t.queryControls[r]=o,e.push(i.HorizontalSeparator(5)),e.push(i.CompoundVert([i.Static(s.name+":"),o]).setTreatAsBlock())}),t.panelQuery.addControl(i.CompoundHor(e)),t.panelButtons=r.Form(t.frameButtons);var n=i.Button(null,{buttonClass:"DQXWizardButton",content:"Clear all"}).setOnChanged(function(){t.tableInfo.genomeTrackSelectionManager.clearAll(),t.myTable.render()}),s=i.Button(null,{buttonClass:"DQXWizardButton",content:"Close",bitmap:c.BMP("ok.png"),width:80,height:25}).setOnChanged(function(){t.close()});t.panelButtons.addControl(i.CompoundHor([i.HorizontalSeparator(7),n])),t.panelButtons.addControl(i.AlignRight(i.CompoundHor([s,i.HorizontalSeparator(7)]))),t.tableInfo.summaryValuesTableFetcher||(t.tableInfo.summaryValuesTableFetcher=f.Table(m.serverUrl,m.database,t.tableInfo.id)),t.panelTable=u.Panel(t.frameBody,t.tableInfo.summaryValuesTableFetcher,{leftfraction:50}),t.myTable=t.panelTable.getTable(),t.myTable.fetchBuffer=300,t.myTable.recordCountFetchType=f.RecordCountFetchType.DELAYED,t.myTable.setQuery(o.WhereClause.Trivial()),t.myTable.createSelectionColumn("selection","Active",t.tableInfo.id,t.tableInfo.primkey,t.tableInfo.genomeTrackSelectionManager,c.Color(0,.5,0),function(){t.myTable.render()}),$.each(t.tableInfo.quickFindFields,function(e,n){var r=m.findProperty(t.tableInfo.id,n),i=t.myTable.createTableColumn(u.Column(r.name,n,1),"String",!0)}),t.updateQuery(),t.panelTable.onResize()},t.updateQuery=function(){var e=[];$.each(t.tableInfo.quickFindFields,function(n,r){var i=m.findProperty(t.tableInfo.id,r),s=t.queryControls[r].getValue();s?(g.storedValues[r]=s,i.propCategories?e.push(o.WhereClause.CompareFixed(r,"=",s)):e.push(o.WhereClause.CompareFixed(r,"LIKE","%"+s+"%"))):delete g.storedValues[r]});if(e.length>0)var n=o.WhereClause.AND(e);else var n=o.WhereClause.Trivial();t.myTable.setQuery(n),t.myTable.reLoadTable()},t.onOK=function(){var e=t.builder.getQuery();t.close()},t.create(),t},g}),d3=function(){function u(e){return e.target}function a(e){return e.source}function v(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function g(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function y(e){return Array.prototype.slice.call(e)}function E(){}function T(e){return e}function N(){return!0}function C(e){return typeof e=="function"?e:function(){return e}}function k(e,t,n){return function(){var r=n.apply(t,arguments);return arguments.length?e:r}}function L(e){return e!=null&&!isNaN(e)}function A(e){return e.length}function M(e){return e.trim().replace(/\s+/g," ")}function _(e){var t=1;while(e*t%1)t*=10;return t}function P(e){return e.length===1?function(t,n){e(t==null?n:null)}:e}function H(e){return e.responseText}function B(e){return JSON.parse(e.responseText)}function j(e){var t=s.createRange();return t.selectNode(s.body),t.createContextualFragment(e.responseText)}function F(e){return e.responseXML}function q(){}function R(e){function r(){var n=t,r=-1,i=n.length,s;while(++r<i)(s=n[r].on)&&s.apply(this,arguments);return e}var t=[],n=new E;return r.on=function(r,i){var s=n.get(r),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,t=t.slice(0,o=t.indexOf(s)).concat(t.slice(o+1)),n.remove(r)),i&&t.push(n.set(r,{on:i})),e)},r}function W(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function X(e){return e+""}function K(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function Z(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function et(e){return function(t){return 1-e(1-t)}}function tt(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function nt(e){return e*e}function rt(e){return e*e*e}function it(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function st(e){return function(t){return Math.pow(t,e)}}function ot(t){return 1-Math.cos(t*e/2)}function ut(e){return Math.pow(2,10*(e-1))}function at(e){return 1-Math.sqrt(1-e*e)}function ft(t,n){var r;return arguments.length<2&&(n=.45),arguments.length?r=n/(2*e)*Math.asin(1/t):(t=1,r=n/4),function(i){return 1+t*Math.pow(2,10*-i)*Math.sin((i-r)*2*e/n)}}function lt(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function ct(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function ht(){n.event.stopPropagation(),n.event.preventDefault()}function pt(){var e=n.event,t;while(t=e.sourceEvent)e=t;return e}function dt(e){var t=new q,r=0,i=arguments.length;while(++r<i)t[arguments[r]]=R(t);return t.of=function(r,i){return function(s){try{var o=s.sourceEvent=n.event;s.target=e,n.event=s,t[s.type].apply(r,i)}finally{n.event=o}}},t}function vt(e){var t=[e.a,e.b],n=[e.c,e.d],r=gt(t),s=mt(t,n),o=gt(yt(n,t,-s))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,s*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*i,this.translate=[e.e,e.f],this.scale=[r,o],this.skew=o?Math.atan2(s,o)*i:0}function mt(e,t){return e[0]*t[0]+e[1]*t[1]}function gt(e){var t=Math.sqrt(mt(e,e));return t&&(e[0]/=t,e[1]/=t),t}function yt(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function Et(e){return e=="transform"?n.interpolateTransform:n.interpolate}function St(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function xt(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function Tt(){}function Nt(e,t,n){return new Ct(e,t,n)}function Ct(e,t,n){this.r=e,this.g=t,this.b=n}function Lt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function At(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(Dt(u[0]),Dt(u[1]),Dt(u[2]))}}return(a=Pt.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function Ot(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,Ht(o,u,a)}function Mt(e,t,n){e=_t(e),t=_t(t),n=_t(n);var r=Zt((.4124564*e+.3575761*t+.1804375*n)/Vt),i=Zt((.2126729*e+.7151522*t+.072175*n)/$t),s=Zt((.0193339*e+.119192*t+.9503041*n)/Jt);return zt(116*i-16,500*(r-i),200*(i-s))}function _t(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function Ht(e,t,n){return new Bt(e,t,n)}function Bt(e,t,n){this.h=e,this.s=t,this.l=n}function Ft(e,t,n){function s(e){return e>360?e-=360:e<0&&(e+=360),e<60?r+(i-r)*e/60:e<180?i:e<240?r+(i-r)*(240-e)/60:r}function o(e){return Math.round(s(e)*255)}var r,i;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i,Nt(o(e+120),o(e),o(e-120))}function It(e,t,n){return new qt(e,t,n)}function qt(e,t,n){this.h=e,this.c=t,this.l=n}function Ut(e,t,n){return zt(n,Math.cos(e*=r)*t,Math.sin(e)*t)}function zt(e,t,n){return new Wt(e,t,n)}function Wt(e,t,n){this.l=e,this.a=t,this.b=n}function Qt(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=Yt(i)*Vt,r=Yt(r)*$t,s=Yt(s)*Jt,Nt(en(3.2404542*i-1.5371385*r-.4985314*s),en(-0.969266*i+1.8760108*r+.041556*s),en(.0556434*i-.2040259*r+1.0572252*s))}function Gt(t,n,r){return It(Math.atan2(r,n)/e*180,Math.sqrt(n*n+r*r),t)}function Yt(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function Zt(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function en(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function tn(e){return w(e,an),e}function fn(e){return function(){return nn(e,this)}}function ln(e){return function(){return rn(e,this)}}function cn(e,t){function r(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function s(){this.setAttribute(e,t)}function o(){this.setAttributeNS(e.space,e.local,t)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function a(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=n.ns.qualify(e),t==null?e.local?i:r:typeof t=="function"?e.local?a:u:e.local?o:s}function hn(e){return new RegExp("(?:^|\\s+)"+n.requote(e)+"(?:\\s+|$)","g")}function pn(e,t){function r(){var r=-1;while(++r<n)e[r](this,t)}function i(){var r=-1,i=t.apply(this,arguments);while(++r<n)e[r](this,i)}e=e.trim().split(/\s+/).map(dn);var n=e.length;return typeof t=="function"?i:r}function dn(e){var t=hn(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.className,s=i.baseVal!=null,o=s?i.baseVal:i;r?(t.lastIndex=0,t.test(o)||(o=M(o+" "+e),s?i.baseVal=o:n.className=o)):o&&(o=M(o.replace(t," ")),s?i.baseVal=o:n.className=o)}}function vn(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function mn(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function gn(e){return{__data__:e}}function yn(e){return function(){return un(this,e)}}function bn(e){return arguments.length||(e=n.ascending),function(t,n){return!t-!n||e(t.__data__,n.__data__)}}function wn(e,t,r){function o(){var t=this[i];t&&(this.removeEventListener(e,t,t.$),delete this[i])}function u(){function a(e){var r=n.event;n.event=e,u[0]=s.__data__;try{t.apply(s,u)}finally{n.event=r}}var s=this,u=m(arguments);o.call(this),this.addEventListener(e,this[i]=a,a.$=r),a._=t}var i="__on"+e,s=e.indexOf(".");return s>0&&(e=e.substring(0,s)),t?u:o}function En(e,t){for(var n=0,r=e.length;n<r;n++)for(var i=e[n],s=0,o=i.length,u;s<o;s++)(u=i[s])&&t(u,s,n);return e}function xn(e){return w(e,Tn),e}function Nn(e,t){return w(e,Cn),e.id=t,e}function On(e,t,r,i){var s=e.__transition__||(e.__transition__={active:0,count:0}),o=s[r];if(!o){var u=i.time;return o=s[r]={tween:new E,event:n.dispatch("start","end"),time:u,ease:i.ease,delay:i.delay,duration:i.duration},++s.count,n.timer(function(i){function d(i){return s.active>r?m():(s.active=r,l.start.call(e,a,t),o.tween.forEach(function(n,r){(r=r.call(e,a,t))&&p.push(r)}),v(i)||n.timer(v,0,u),1)}function v(n){if(s.active!==r)return m();var i=(n-c)/h,o=f(i),u=p.length;while(u>0)p[--u].call(e,o);if(i>=1)return m(),l.end.call(e,a,t),1}function m(){return--s.count?delete s[r]:delete e.__transition__,1}var a=e.__data__,f=o.ease,l=o.event,c=o.delay,h=o.duration,p=[];return c<=i?d(i):n.timer(d,c,u),1},0,u),o}}function Mn(e){return e==null&&(e=""),function(){this.textContent=e}}function _n(e,t,n,r){var i=e.id;return En(e,typeof n=="function"?function(e,s,o){e.__transition__[i].tween.set(t,r(n.call(e,e.__data__,s,o)))}:(n=r(n),function(e){e.__transition__[i].tween.set(t,n)}))}function Fn(){var e,t=Date.now(),n=Hn;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=In()-t;r>24?(isFinite(r)&&(clearTimeout(jn),jn=setTimeout(Fn,r)),Bn=0):(Bn=1,qn(Fn))}function In(){var e=null,t=Hn,n=Infinity;while(t)t.flush?(delete Pn[t.callback.id],t=e?e.next=t.next:Hn=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Un(e,t){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var i=r.createSVGPoint();if(Rn<0&&(o.scrollX||o.scrollY)){r=n.select(s.body).append("svg").style("position","absolute").style("top",0).style("left",0);var u=r[0][0].getScreenCTM();Rn=!u.f&&!u.e,r.remove()}return Rn?(i.x=t.pageX,i.y=t.pageY):(i.x=t.clientX,i.y=t.clientY),i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}function zn(){}function Wn(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Xn(e){return e.rangeExtent?e.rangeExtent():Wn(e.range())}function Vn(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i))e[n]=t.floor(i),e[r]=t.ceil(s);return e}function $n(){return Math}function Jn(e,t,r,i){function u(){var u=Math.min(e.length,t.length)>2?tr:er,f=i?xt:St;return s=u(e,t,f,r),o=u(t,e,f,n.interpolate),a}function a(e){return s(e)}var s,o;return a.invert=function(e){return o(e)},a.domain=function(t){return arguments.length?(e=t.map(Number),u()):e},a.range=function(e){return arguments.length?(t=e,u()):t},a.rangeRound=function(e){return a.range(e).interpolate(n.interpolateRound)},a.clamp=function(e){return arguments.length?(i=e,u()):i},a.interpolate=function(e){return arguments.length?(r=e,u()):r},a.ticks=function(t){return Yn(e,t)},a.tickFormat=function(t){return Zn(e,t)},a.nice=function(){return Vn(e,Qn),u()},a.copy=function(){return Jn(e,t,r,i)},u()}function Kn(e,t){return n.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Qn(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function Gn(e,t){var n=Wn(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function Yn(e,t){return n.range.apply(n,Gn(e,t))}function Zn(e,t){return n.format(",."+Math.max(0,-Math.floor(Math.log(Gn(e,t)[2])/Math.LN10+.01))+"f")}function er(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function tr(e,t,r,i){var s=[],o=[],u=0,a=Math.min(e.length,t.length)-1;e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++u<=a)s.push(r(e[u-1],e[u])),o.push(i(t[u-1],t[u]));return function(t){var r=n.bisect(e,t,1,a)-1;return o[r](s[r](t))}}function nr(e,t){function r(n){return e(t(n))}var n=t.pow;return r.invert=function(t){return n(e.invert(t))},r.domain=function(i){return arguments.length?(t=i[0]<0?sr:ir,n=t.pow,e.domain(i.map(t)),r):e.domain().map(n)},r.nice=function(){return e.domain(Vn(e.domain(),$n)),r},r.ticks=function(){var r=Wn(e.domain()),i=[];if(r.every(isFinite)){var s=Math.floor(r[0]),o=Math.ceil(r[1]),u=n(r[0]),a=n(r[1]);if(t===sr){i.push(n(s));for(;s++<o;)for(var f=9;f>0;f--)i.push(n(s)*f)}else{for(;s<o;s++)for(var f=1;f<10;f++)i.push(n(s)*f);i.push(n(s))}for(s=0;i[s]<u;s++);for(o=i.length;i[o-1]>a;o--);i=i.slice(s,o)}return i},r.tickFormat=function(e,i){arguments.length<2&&(i=rr);if(!arguments.length)return i;var s=Math.max(.1,e/r.ticks().length),o=t===sr?(u=-1e-12,Math.floor):(u=1e-12,Math.ceil),u;return function(e){return e/n(o(t(e)+u))<=s?i(e):""}},r.copy=function(){return nr(e.copy(),t)},Kn(r,e)}function ir(e){return Math.log(e<0?0:e)/Math.LN10}function sr(e){return-Math.log(e>0?0:-e)/Math.LN10}function or(e,t){function i(t){return e(n(t))}var n=ur(t),r=ur(1/t);return i.invert=function(t){return r(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain(t.map(n)),i):e.domain().map(r)},i.ticks=function(e){return Yn(i.domain(),e)},i.tickFormat=function(e){return Zn(i.domain(),e)},i.nice=function(){return i.domain(Vn(i.domain(),Qn))},i.exponent=function(e){if(!arguments.length)return t;var s=i.domain();return n=ur(t=e),r=ur(1/t),i.domain(s)},i.copy=function(){return or(e.copy(),t)},Kn(i,e)}function ur(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ar(e,t){function o(t){return i[((r.get(t)||r.set(t,e.push(t)))-1)%i.length]}function u(t,r){return n.range(e.length).map(function(e){return t+r*e})}var r,i,s;return o.domain=function(n){if(!arguments.length)return e;e=[],r=new E;var i=-1,s=n.length,u;while(++i<s)r.has(u=n[i])||r.set(u,e.push(u));return o[t.t].apply(o,t.a)},o.range=function(e){return arguments.length?(i=e,s=0,t={t:"range",a:arguments},o):i},o.rangePoints=function(n,r){arguments.length<2&&(r=0);var a=n[0],f=n[1],l=(f-a)/(Math.max(1,e.length-1)+r);return i=u(e.length<2?(a+f)/2:a+l*r/2,l),s=0,t={t:"rangePoints",a:arguments},o},o.rangeBands=function(n,r,a){arguments.length<2&&(r=0),arguments.length<3&&(a=r);var f=n[1]<n[0],l=n[f-0],c=n[1-f],h=(c-l)/(e.length-r+2*a);return i=u(l+h*a,h),f&&i.reverse(),s=h*(1-r),t={t:"rangeBands",a:arguments},o},o.rangeRoundBands=function(n,r,a){arguments.length<2&&(r=0),arguments.length<3&&(a=r);var f=n[1]<n[0],l=n[f-0],c=n[1-f],h=Math.floor((c-l)/(e.length-r+2*a)),p=c-l-(e.length-r)*h;return i=u(l+Math.round(p/2),h),f&&i.reverse(),s=Math.round(h*(1-r)),t={t:"rangeRoundBands",a:arguments},o},o.rangeBand=function(){return s},o.rangeExtent=function(){return Wn(t.a[0])},o.copy=function(){return ar(e,t)},o.domain(e)}function pr(e,t){function i(){var i=0,o=t.length;r=[];while(++i<o)r[i-1]=n.quantile(e,i/o);return s}function s(e){return isNaN(e=+e)?NaN:t[n.bisect(r,e)]}var r;return s.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(n.ascending),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.quantiles=function(){return r},s.copy=function(){return pr(e,t)},i()}function dr(e,t,n){function s(t){return n[Math.max(0,Math.min(i,Math.floor(r*(t-e))))]}function o(){return r=n.length/(t-e),i=n.length-1,s}var r,i;return s.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],o()):[e,t]},s.range=function(e){return arguments.length?(n=e,o()):n},s.copy=function(){return dr(e,t,n)},o()}function vr(e,t){function r(r){return t[n.bisect(e,r)]}return r.domain=function(t){return arguments.length?(e=t,r):e},r.range=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return vr(e,t)},r}function mr(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return Yn(e,t)},t.tickFormat=function(t){return Zn(e,t)},t.copy=function(){return mr(e)},t}function br(e){return e.innerRadius}function wr(e){return e.outerRadius}function Er(e){return e.startAngle}function Sr(e){return e.endAngle}function xr(e){function u(s){function d(){u.push("M",i(e(a),o))}var u=[],a=[],f=-1,l=s.length,c,h=C(t),p=C(n);while(++f<l)r.call(this,c=s[f],f)?a.push([+h.call(this,c,f),+p.call(this,c,f)]):a.length&&(d(),a=[]);return a.length&&d(),u.length?u.join(""):null}var t=Tr,n=Nr,r=N,i=kr,s=i.key,o=.7;return u.x=function(e){return arguments.length?(t=e,u):t},u.y=function(e){return arguments.length?(n=e,u):n},u.defined=function(e){return arguments.length?(r=e,u):r},u.interpolate=function(e){return arguments.length?(typeof e=="function"?s=i=e:s=(i=Cr.get(e)||kr).key,u):s},u.tension=function(e){return arguments.length?(o=e,u):o},u}function Tr(e){return e[0]}function Nr(e){return e[1]}function kr(e){return e.join("L")}function Lr(e){return kr(e)+"Z"}function Ar(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function Or(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function Mr(e,t){return e.length<4?kr(e):e[1]+Pr(e.slice(1,e.length-1),Hr(e,t))}function _r(e,t){return e.length<3?kr(e):e[0]+Pr((e.push(e[0]),e),Hr([e[e.length-2]].concat(e,[e[1]]),t))}function Dr(e,t){return e.length<3?kr(e):e[0]+Pr(e,Hr(e,t))}function Pr(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return kr(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function Hr(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a)i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function Br(e){if(e.length<3)return kr(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];Wr(a,o,u);while(++t<n)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Wr(a,o,u);t=-1;while(++t<2)o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Wr(a,o,u);return a.join("")}function jr(e){if(e.length<4)return kr(e);var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3)i=e[n],s.push(i[0]),o.push(i[1]);t.push(qr(zr,s)+","+qr(zr,o)),--n;while(++n<r)i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Wr(t,s,o);return t.join("")}function Fr(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4)s=e[n%r],o.push(s[0]),u.push(s[1]);t=[qr(zr,o),",",qr(zr,u)],--n;while(++n<i)s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),Wr(t,o,u);return t.join("")}function Ir(e,t){var n=e.length-1;if(n){var r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n)a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o)}return Br(e)}function qr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Wr(e,t,n){e.push("C",qr(Rr,t),",",qr(Rr,n),",",qr(Ur,t),",",qr(Ur,n),",",qr(zr,t),",",qr(zr,n))}function Xr(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Vr(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=Xr(i,s);while(++t<n)r[t]=(o+(o=Xr(i=s,s=e[t+1])))/2;return r[t]=o,r}function $r(e){var t=[],n,r,i,s,o=Vr(e),u=-1,a=e.length-1;while(++u<a)n=Xr(e[u],e[u+1]),Math.abs(n)<1e-6?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i));u=-1;while(++u<=a)s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0]);return t}function Jr(e){return e.length<3?kr(e):e[0]+Pr(e,$r(e))}function Kr(e){var t,n=-1,r=e.length,i,s;while(++n<r)t=e[n],i=t[0],s=t[1]+gr,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s);return e}function Qr(e){function c(u){function x(){c.push("M",o(e(p),l),f,a(e(h.reverse()),l),"Z")}var c=[],h=[],p=[],d=-1,v=u.length,m,g=C(t),y=C(r),b=t===n?function(){return E}:C(n),w=r===i?function(){return S}:C(i),E,S;while(++d<v)s.call(this,m=u[d],d)?(h.push([E=+g.call(this,m,d),S=+y.call(this,m,d)]),p.push([+b.call(this,m,d),+w.call(this,m,d)])):h.length&&(x(),h=[],p=[]);return h.length&&x(),c.length?c.join(""):null}var t=Tr,n=Tr,r=0,i=Nr,s=N,o=kr,u=o.key,a=o,f="L",l=.7;return c.x=function(e){return arguments.length?(t=n=e,c):n},c.x0=function(e){return arguments.length?(t=e,c):t},c.x1=function(e){return arguments.length?(n=e,c):n},c.y=function(e){return arguments.length?(r=i=e,c):i},c.y0=function(e){return arguments.length?(r=e,c):r},c.y1=function(e){return arguments.length?(i=e,c):i},c.defined=function(e){return arguments.length?(s=e,c):s},c.interpolate=function(e){return arguments.length?(typeof e=="function"?u=o=e:u=(o=Cr.get(e)||kr).key,a=o.reverse||o,f=o.closed?"M":"L",c):u},c.tension=function(e){return arguments.length?(l=e,c):l},c}function Gr(e){return e.radius}function Yr(e){return[e.x,e.y]}function Zr(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+gr;return[n*Math.cos(r),n*Math.sin(r)]}}function ei(){return 64}function ti(){return"circle"}function ni(t){var n=Math.sqrt(t/e);return"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+ -n+"A"+n+","+n+" 0 1,1 0,"+n+"Z"}function ai(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function fi(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function li(e,t,n){i=[];if(n&&t.length>1){var r=Wn(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o)for(a=n;--a>0;)(f=+t[s]-a*u)>=r[0]&&i.push(f);for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];)i.push(f)}return i}function mi(e){var t=e.source,n=e.target,r=yi(t,n),i=[t];while(t!==r)t=t.parent,i.push(t);var s=i.length;while(n!==r)i.splice(s,0,n),n=n.parent;return i}function gi(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function yi(e,t){if(e===t)return e;var n=gi(e),r=gi(t),i=n.pop(),s=r.pop(),o=null;while(i===s)o=i,i=n.pop(),s=r.pop();return o}function bi(e){e.fixed|=2}function wi(e){e.fixed&=-7}function Ei(e){e.fixed|=4,e.px=e.x,e.py=e.y}function Si(e){e.fixed&=-5}function xi(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;xi(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function ki(e){return e.x}function Li(e){return e.y}function Ai(e,t,n){e.y0=t,e.y=n}function _i(e){return n.range(e.length)}function Di(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}function Pi(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function Hi(e){return e.reduce(Bi,0)}function Bi(e,t){return e+t[1]}function ji(e,t){return Fi(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Fi(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function Ii(e){return[n.min(e),n.max(e)]}function qi(e,t){return n.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=Wi,e}function Ri(e){return e.children}function Ui(e){return e.value}function zi(e,t){return t.value-e.value}function Wi(e){return n.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function Xi(e,t){return e.value-t.value}function Vi(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function $i(e,t){e._pack_next=t,t._pack_prev=e}function Ji(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function Ki(e){function p(e){n=Math.min(e.x-e.r,n),r=Math.max(e.x+e.r,r),i=Math.min(e.y-e.r,i),s=Math.max(e.y+e.r,s)}if(!(t=e.children)||!(h=t.length))return;var t,n=Infinity,r=-Infinity,i=Infinity,s=-Infinity,o,u,a,f,l,c,h;t.forEach(Qi),o=t[0],o.x=-o.r,o.y=0,p(o);if(h>1){u=t[1],u.x=u.r,u.y=0,p(u);if(h>2){a=t[2],Zi(o,u,a),p(a),Vi(o,a),o._pack_prev=a,Vi(a,u),u=o._pack_next;for(f=3;f<h;f++){Zi(o,u,a=t[f]);var d=0,v=1,m=1;for(l=u._pack_next;l!==u;l=l._pack_next,v++)if(Ji(l,a)){d=1;break}if(d==1)for(c=o._pack_prev;c!==l._pack_prev;c=c._pack_prev,m++)if(Ji(c,a))break;d?(v<m||v==m&&u.r<o.r?$i(o,u=l):$i(o=c,u),f--):(Vi(o,a),u=a,p(a))}}}var g=(n+r)/2,y=(i+s)/2,b=0;for(f=0;f<h;f++)a=t[f],a.x-=g,a.y-=y,b=Math.max(b,a.r+Math.sqrt(a.x*a.x+a.y*a.y));e.r=b,t.forEach(Gi)}function Qi(e){e._pack_next=e._pack_prev=e}function Gi(e){delete e._pack_next,delete e._pack_prev}function Yi(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)Yi(i[s],t,n,r)}}function Zi(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function es(e){return 1+n.max(e,function(e){return e.y})}function ts(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function ns(e){var t=e.children;return t&&t.length?ns(t[0]):e}function rs(e){var t=e.children,n;return t&&(n=t.length)?rs(t[n-1]):e}function is(e,t){return e.parent==t.parent?1:2}function ss(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function os(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function us(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=us(n[s],t),e)>0&&(e=r)}return e}function as(e,t){return e.x-t.x}function fs(e,t){return t.x-e.x}function ls(e,t){return e.depth-t.depth}function cs(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function hs(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function ps(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function ds(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function vs(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function ms(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function gs(e,t){function s(e,r){return n.xhr(e,t,r).response(o)}function o(e){return s.parse(e.responseText)}function u(t){return t.map(a).join(e)}function a(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var r=new RegExp('["'+e+"\n]"),i=e.charCodeAt(0);return s.parse=function(e){var t;return s.parseRows(e,function(e){if(t)return t(e);t=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")})},s.parseRows=function(e,t){function c(){if(u>=o)return r;if(l)return l=!1,n;var t=u;if(e.charCodeAt(t)===34){var s=t;while(s++<o)if(e.charCodeAt(s)===34){if(e.charCodeAt(s+1)!==34)break;++s}u=s+2;var a=e.charCodeAt(s+1);return a===13?(l=!0,e.charCodeAt(s+2)===10&&++u):a===10&&(l=!0),e.substring(t+1,s).replace(/""/g,'"')}while(u<o){var a=e.charCodeAt(u++),f=1;if(a===10)l=!0;else if(a===13)l=!0,e.charCodeAt(u)===10&&(++u,++f);else if(a!==i)continue;return e.substring(t,u-f)}return e.substring(t)}var n={},r={},s=[],o=e.length,u=0,a=0,f,l;while((f=c())!==r){var h=[];while(f!==n&&f!==r)h.push(f),f=c();if(t&&!(h=t(h,a++)))continue;s.push(h)}return s},s.format=function(e){return e.map(u).join("\n")},s}function ys(e,t){ws.hasOwnProperty(e.type)&&ws[e.type](e,t)}function Es(e,t,n){var r=-1,i=e.length-n,s;t.lineStart();while(++r<i)s=e[r],t.point(s[0],s[1]);t.lineEnd()}function Ss(e,t){var n=-1,r=e.length;t.polygonStart();while(++n<r)Es(e[n],t,1);t.polygonEnd()}function xs(e){return[Math.atan2(e[1],e[0]),Math.asin(Math.max(-1,Math.min(1,e[2])))]}function Ts(e,n){return Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t}function Ns(e){var t=e[0],n=e[1],r=Math.cos(n);return[r*Math.cos(t),r*Math.sin(t),Math.sin(n)]}function Cs(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ks(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ls(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function As(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Os(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ms(e){function i(t){function c(n,r){n=e(n,r),t.point(n[0],n[1])}function h(){i=NaN,l.point=p,t.lineStart()}function p(l,c){var h=Ns([l,c]),p=e(l,c);s(i,o,n,u,a,f,i=p[0],o=p[1],n=l,u=h[0],a=h[1],f=h[2],r,t),t.point(i,o)}function d(){l.point=c,t.lineEnd()}function v(){var e,c,v,m,g,y,b;h(),l.point=function(t,n){p(e=t,c=n),v=i,m=o,g=u,y=a,b=f,l.point=p},l.lineEnd=function(){s(i,o,n,u,a,f,v,m,e,g,y,b,r,t),l.lineEnd=d,d()}}var n,i,o,u,a,f,l={point:c,lineStart:h,lineEnd:d,polygonStart:function(){t.polygonStart(),l.lineStart=v},polygonEnd:function(){t.polygonEnd(),l.lineStart=h}};return l}function s(r,i,o,u,a,f,l,c,h,p,d,v,m,g){var y=l-r,b=c-i,w=y*y+b*b;if(w>4*n&&m--){var E=u+p,S=a+d,x=f+v,T=Math.sqrt(E*E+S*S+x*x),N=Math.asin(x/=T),C=Math.abs(Math.abs(x)-1)<t?(o+h)/2:Math.atan2(S,E),k=e(C,N),L=k[0],A=k[1],O=L-r,M=A-i,_=b*O-y*M;if(_*_/w>n||Math.abs((y*O+b*M)/w-.5)>.3)s(r,i,o,u,a,f,L,A,C,E/=T,S/=T,x,m,g),g.point(L,A),s(L,A,C,E,S,x,l,c,h,p,d,v,m,g)}}var n=.5,r=16;return i.precision=function(e){return arguments.length?(r=(n=e*e)>0&&16,i):Math.sqrt(n)},i}function _s(e,t){function o(e,t){var n=Math.sqrt(i-2*r*Math.sin(t))/r;return[n*Math.sin(e*=r),s-n*Math.cos(e)]}var n=Math.sin(e),r=(n+Math.sin(t))/2,i=1+n*(2*r-n),s=Math.sqrt(i)/r;return o.invert=function(e,t){var n=s-t;return[Math.atan2(e,n)/r,Math.asin((i-(e*e+n*n)*r*r)/(2*r))]},o}function Hs(e){function u(e,n){e<t&&(t=e),e>i&&(i=e),n<r&&(r=n),n>s&&(s=n)}function a(){o.point=o.lineEnd=zn}var t,r,i,s,o={point:u,lineStart:zn,lineEnd:zn,polygonStart:function(){o.lineEnd=a},polygonEnd:function(){o.point=u}};return function(u){return s=i=-(t=r=Infinity),n.geo.stream(u,e(o)),[[t,r],[i,s]]}}function Us(e,t){if(Bs)return;++js,e*=r;var n=Math.cos(t*=r);Fs+=(n*Math.cos(e)-Fs)/js,Is+=(n*Math.sin(e)-Is)/js,qs+=(Math.sin(t)-qs)/js}function zs(){var e,t;Bs=1,Ws(),Bs=2;var n=Rs.point;Rs.point=function(r,i){n(e=r,t=i)},Rs.lineEnd=function(){Rs.point(e,t),Xs(),Rs.lineEnd=Xs}}function Ws(){function i(i,s){i*=r;var o=Math.cos(s*=r),u=o*Math.cos(i),a=o*Math.sin(i),f=Math.sin(s),l=Math.atan2(Math.sqrt((l=t*f-n*a)*l+(l=n*u-e*f)*l+(l=e*a-t*u)*l),e*u+t*a+n*f);js+=l,Fs+=l*(e+(e=u)),Is+=l*(t+(t=a)),qs+=l*(n+(n=f))}var e,t,n;if(Bs>1)return;Bs<1&&(Bs=1,js=Fs=Is=qs=0),Rs.point=function(s,o){s*=r;var u=Math.cos(o*=r);e=u*Math.cos(s),t=u*Math.sin(s),n=Math.sin(o),Rs.point=i}}function Xs(){Rs.point=Us}function Vs(t,n){var r=Math.cos(t),i=Math.sin(t);return function(s,o,u,a){if(s!=null){s=$s(r,s),o=$s(r,o);if(u>0?s<o:s>o)s+=u*2*e}else s=t+u*2*e,o=t;var f;for(var l=u*n,c=s;u>0?c>o:c<o;c-=l)a.point((f=xs([r,-i*Math.cos(c),-i*Math.sin(c)]))[0],f[1])}}function $s(e,n){var r=Ns(n);r[0]-=e,Os(r);var i=Math.acos(Math.max(-1,Math.min(1,-r[1])));return((-r[2]<0?-i:i)+2*Math.PI-t)%(2*Math.PI)}function Js(e,r,i){return function(s){function a(t,n){e(t,n)&&s.point(t,n)}function f(e,t){o.point(e,t)}function l(){u.point=f,o.lineStart()}function c(){u.point=a,o.lineEnd()}function b(e,t){g.point(e,t),y.push([e,t])}function w(){g.lineStart(),y=[]}function E(){b(y[0][0],y[0][1]),g.lineEnd();var e=g.clean(),t=m.buffer(),n,r=t.length;if(!r){v=!0,d+=eo(y,-1),y=null;return}y=null;if(e&1){n=t[0],p+=eo(n,1);var r=n.length-1,i=-1,o;s.lineStart();while(++i<r)s.point((o=n[i])[0],o[1]);s.lineEnd();return}r>1&&e&2&&t.push(t.pop().concat(t.shift())),h.push(t.filter(Ys))}var o=r(s),u={point:a,lineStart:l,lineEnd:c,polygonStart:function(){u.point=b,u.lineStart=w,u.lineEnd=E,v=!1,d=p=0,h=[],s.polygonStart()},polygonEnd:function(){u.point=a,u.lineStart=l,u.lineEnd=c,h=n.merge(h);if(h.length)Ks(h,i,s);else if(p<-t||v&&d<-t)s.lineStart(),i(null,null,1,s),s.lineEnd();s.polygonEnd(),h=null},sphere:function(){s.polygonStart(),s.lineStart(),i(null,null,1,s),s.lineEnd(),s.polygonEnd()}},h,p,d,v,m=Zs(),g=r(m),y;return u}}function Ks(e,t,n){var r=[],i=[];e.forEach(function(e){var t=e.length;if(t<=1)return;var n=e[0],s=e[t-1],o={point:n,points:e,other:null,visited:!1,entry:!0,subject:!0},u={point:n,points:[n],other:o,visited:!1,entry:!1,subject:!1};o.other=u,r.push(o),i.push(u),o={point:s,points:[s],other:null,visited:!1,entry:!1,subject:!0},u={point:s,points:[s],other:o,visited:!1,entry:!0,subject:!1},o.other=u,r.push(o),i.push(u)}),i.sort(Gs),Qs(r),Qs(i);if(!r.length)return;var s=r[0],o,u,a;for(;;){o=s;while(o.visited)if((o=o.next)===s)return;u=o.points,n.lineStart();do{o.visited=o.other.visited=!0;if(o.entry){if(o.subject)for(var f=0;f<u.length;f++)n.point((a=u[f])[0],a[1]);else t(o.point,o.next.point,1,n);o=o.next}else{if(o.subject){u=o.prev.points;for(var f=u.length;--f>=0;)n.point((a=u[f])[0],a[1])}else t(o.point,o.prev.point,-1,n);o=o.prev}o=o.other,u=o.points}while(!o.visited);n.lineEnd()}}function Qs(e){if(!(t=e.length))return;var t,n=0,r=e[0],i;while(++n<t)r.next=i=e[n],i.prev=r,r=i;r.next=i=e[0],i.prev=r}function Gs(n,r){return((n=n.point)[0]<0?n[1]-e/2-t:e/2-n[1])-((r=r.point)[0]<0?r[1]-e/2-t:e/2-r[1])}function Ys(e){return e.length>1}function Zs(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:zn,buffer:function(){var n=e;return e=[],t=null,n}}}function eo(n,r){if(!(i=n.length))return 0;var i,s=0,o=0,u=n[0],a=u[0],f=u[1],l=Math.cos(f),c=Math.atan2(r*Math.sin(a)*l,Math.sin(f)),h=1-r*Math.cos(a)*l,p=c,d,v;while(++s<i){u=n[s],l=Math.cos(f=u[1]),d=Math.atan2(r*Math.sin(a=u[0])*l,Math.sin(f)),v=1-r*Math.cos(a)*l;if(Math.abs(h-2)<t&&Math.abs(v-2)<t)continue;Math.abs(v)<t||Math.abs(h)<t||(Math.abs(Math.abs(d-c)-e)<t?v+h>2&&(o+=4*(d-c)):Math.abs(h-2)<t?o+=4*(d-p):o+=((3*e+d-c)%(2*e)-e)*(h+v)),p=c,c=d,h=v}return o}function no(n){var r=NaN,i=NaN,s=NaN,o;return{lineStart:function(){n.lineStart(),o=1},point:function(u,a){var f=u>0?e:-e,l=Math.abs(u-r);Math.abs(l-e)<t?(n.point(r,i=(i+a)/2>0?e/2:-e/2),n.point(s,i),n.lineEnd(),n.lineStart(),n.point(f,i),n.point(u,i),o=0):s!==f&&l>=e&&(Math.abs(r-s)<t&&(r-=s*t),Math.abs(u-f)<t&&(u-=f*t),i=ro(r,i,u,a),n.point(s,i),n.lineEnd(),n.lineStart(),n.point(f,i),o=0),n.point(r=u,i=a),s=f},lineEnd:function(){n.lineEnd(),r=i=NaN},clean:function(){return 2-o}}}function ro(e,n,r,i){var s,o,u=Math.sin(e-r);return Math.abs(u)>t?Math.atan((Math.sin(n)*(o=Math.cos(i))*Math.sin(r)-Math.sin(i)*(s=Math.cos(n))*Math.sin(e))/(s*o*u)):(n+i)/2}function io(n,r,i,s){var o;if(n==null)o=i*e/2,s.point(-e,o),s.point(0,o),s.point(e,o),s.point(e,0),s.point(e,-o),s.point(0,-o),s.point(-e,-o),s.point(-e,0),s.point(-e,o);else if(Math.abs(n[0]-r[0])>t){var u=(n[0]<r[0]?1:-1)*e;o=i*u/2,s.point(-u,o),s.point(0,o),s.point(u,o)}else s.point(r[0],r[1])}function so(e){function o(e,t){return Math.cos(e)*Math.cos(t)>i}function u(e){var n,r,i,s;return{lineStart:function(){i=r=!1,s=1},point:function(u,f){var l=[u,f],c,h=o(u,f);!n&&(i=r=h)&&e.lineStart();if(h!==r){c=a(n,l);if(Ts(n,c)||Ts(l,c))l[0]+=t,l[1]+=t,h=o(l[0],l[1])}h!==r&&(s=0,(r=h)?(e.lineStart(),c=a(l,n),e.point(c[0],c[1])):(c=a(n,l),e.point(c[0],c[1]),e.lineEnd()),n=c),h&&(!n||!Ts(n,l))&&e.point(l[0],l[1]),n=l},lineEnd:function(){r&&e.lineEnd(),n=null},clean:function(){return s|(i&&r)<<1}}}function a(e,t){var n=Ns(e,0),r=Ns(t,0),s=[1,0,0],o=ks(n,r),u=Cs(o,o),a=o[0],f=u-a*a;if(!f)return e;var l=i*u/f,c=-i*a/f,h=ks(s,o),p=As(s,l),d=As(o,c);Ls(p,d);var v=h,m=Cs(p,v),g=Cs(v,v),y=Math.sqrt(m*m-g*(Cs(p,p)-1)),b=As(v,(-m-y)/g);return Ls(b,p),xs(b)}var n=e*r,i=Math.cos(n),s=Vs(n,6*r);return Js(o,u,s)}function oo(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),n}function uo(e,t){return[e,t]}function fo(e,r,i){var s=n.range(e,r-t,i).concat(r);return function(e){return s.map(function(t){return[e,t]})}}function lo(e,r,i){var s=n.range(e,r-t,i).concat(r);return function(e){return s.map(function(t){return[t,e]})}}function co(e,t,n,i){function v(e){var t=Math.sin(e*=p)*d,n=Math.sin(p-e)*d,i=n*f+t*c,s=n*l+t*h,u=n*o+t*a;return[Math.atan2(s,i)/r,Math.atan2(u,Math.sqrt(i*i+s*s))/r]}var s=Math.cos(t),o=Math.sin(t),u=Math.cos(i),a=Math.sin(i),f=s*Math.cos(e),l=s*Math.sin(e),c=u*Math.cos(n),h=u*Math.sin(n),p=Math.acos(Math.max(-1,Math.min(1,o*a+s*u*Math.cos(n-e)))),d=1/Math.sin(p);return v.distance=p,v}function ho(t,n){return[t/(2*e),Math.max(-0.5,Math.min(.5,Math.log(Math.tan(e/4+n/2))/(2*e)))]}function vo(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+ -2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function mo(e){var t=Ms(function(t,n){return e([t*i,n*i])});return function(e){return e=t(e),{point:function(t,n){e.point(t*r,n*r)},sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}}function go(){function r(n,r){t.push("M",n,",",r,e)}function i(e,r){t.push("M",e,",",r),n.point=s}function s(e,n){t.push("L",e,",",n)}function o(){n.point=r}function u(){t.push("Z")}var e=vo(4.5),t=[],n={point:r,lineStart:function(){n.point=i},lineEnd:o,polygonStart:function(){n.lineEnd=u},polygonEnd:function(){n.lineEnd=o,n.point=r},pointRadius:function(t){return e=vo(t),n},result:function(){if(t.length){var e=t.join("");return t=[],e}}};return n}function yo(t){function i(r,i){t.moveTo(r,i),t.arc(r,i,n,0,2*e)}function s(e,n){t.moveTo(e,n),r.point=o}function o(e,n){t.lineTo(e,n)}function u(){r.point=i}function a(){t.closePath()}var n=4.5,r={point:i,lineStart:function(){r.point=s},lineEnd:u,polygonStart:function(){r.lineEnd=a},polygonEnd:function(){r.lineEnd=u,r.point=i},pointRadius:function(e){return n=e,r},result:zn};return r}function So(){function i(e,t){wo+=r*e-n*t,n=e,r=t}var e,t,n,r;Eo.point=function(s,o){Eo.point=i,e=n=s,t=r=o},Eo.lineEnd=function(){i(e,t)}}function To(e,t){if(Bs)return;Fs+=e,Is+=t,++qs}function No(){function n(n,r){var i=n-e,s=r-t,o=Math.sqrt(i*i+s*s);Fs+=o*(e+n)/2,Is+=o*(t+r)/2,qs+=o,e=n,t=r}var e,t;if(Bs!==1){if(!(Bs<1))return;Bs=1,Fs=Is=qs=0}xo.point=function(r,i){xo.point=n,e=r,t=i}}function Co(){xo.point=To}function ko(){function i(e,t){var i=r*e-n*t;Fs+=i*(n+e),Is+=i*(r+t),qs+=i*3,n=e,r=t}var e,t,n,r;Bs<2&&(Bs=2,Fs=Is=qs=0),xo.point=function(s,o){xo.point=i,e=n=s,t=r=o},xo.lineEnd=function(){i(e,t)}}function _o(){function u(t,n){t*=r,n=n*r/2+e/4;var u=t-i,a=Math.cos(n),f=Math.sin(n),l=o*f,c=Ao,h=Oo,p=s*a+l*Math.cos(u),d=l*Math.sin(u);Ao=c*p-h*d,Oo=h*p+c*d,i=t,s=a,o=f}var t,n,i,s,o;Mo.point=function(a,f){Mo.point=u,i=(t=a)*r,s=Math.cos(f=(n=f)*r/2+e/4),o=Math.sin(f)},Mo.lineEnd=function(){u(t,n)}}function Do(e){return Po(function(){return e})()}function Po(e){function w(e){return e=o(e[0]*r,e[1]*r),[e[0]*a+m,g-e[1]*a]}function E(e){return e=o.invert((e[0]-m)/a,(g-e[1])/a),e&&[e[0]*i,e[1]*i]}function S(){o=oo(s=Bo(p,d,v),t);var e=t(c,h);return m=f-e[0]*a,g=l+e[1]*a,w}var t,s,o,u=Ms(function(e,n){return e=t(e,n),[e[0]*a+m,g-e[1]*a]}),a=150,f=480,l=250,c=0,h=0,p=0,d=0,v=0,m,g,y=to,b=null;return w.stream=function(e){return Ho(s,y(u(e)))},w.clipAngle=function(e){return arguments.length?(y=e==null?(b=e,to):so(b=+e),w):b},w.scale=function(e){return arguments.length?(a=+e,S()):a},w.translate=function(e){return arguments.length?(f=+e[0],l=+e[1],S()):[f,l]},w.center=function(e){return arguments.length?(c=e[0]%360*r,h=e[1]%360*r,S()):[c*i,h*i]},w.rotate=function(e){return arguments.length?(p=e[0]%360*r,d=e[1]%360*r,v=e.length>2?e[2]%360*r:0,S()):[p*i,d*i,v*i]},n.rebind(w,u,"precision"),function(){return t=e.apply(this,arguments),w.invert=t.invert&&E,S()}}function Ho(t,n){return{point:function(i,s){s=t(i*r,s*r),i=s[0],n.point(i>e?i-2*e:i<-e?i+2*e:i,s[1])},sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function Bo(e,t,n){return e?t||n?oo(Fo(e),Io(t,n)):Fo(e):t||n?Io(t,n):uo}function jo(t){return function(n,r){return n+=t,[n>e?n-2*e:n<-e?n+2*e:n,r]}}function Fo(e){var t=jo(e);return t.invert=jo(-e),t}function Io(e,t){function o(e,t){var o=Math.cos(t),u=Math.cos(e)*o,a=Math.sin(e)*o,f=Math.sin(t),l=f*n+u*r;return[Math.atan2(a*i-l*s,u*n-f*r),Math.asin(Math.max(-1,Math.min(1,l*i+a*s)))]}var n=Math.cos(e),r=Math.sin(e),i=Math.cos(t),s=Math.sin(t);return o.invert=function(e,t){var o=Math.cos(t),u=Math.cos(e)*o,a=Math.sin(e)*o,f=Math.sin(t),l=f*i-a*s;return[Math.atan2(a*i+f*s,u*n+l*r),Math.asin(Math.max(-1,Math.min(1,l*n-u*r)))]},o}function Ro(e,t){function n(t,n){var r=Math.cos(t),i=Math.cos(n),s=e(r*i);return[s*i*Math.sin(t),s*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),i=t(r),s=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*s,r*o),Math.asin(r&&n*s/r)]},n}function Uo(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function zo(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function Wo(e,t,n,r){var i=e[0],s=n[0],o=t[0]-i,u=r[0]-s,a=e[1],f=n[1],l=t[1]-a,c=r[1]-f,h=(u*(a-f)-c*(i-s))/(c*o-u*l);return[i+h*o,a+h*l]}function Vo(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[Xo[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[Xo[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,l,c,h,p,d,v,m,g,y,b;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x))a=r.leftBound(o),f=r.right(a),p=r.rightRegion(a),y=i.bisect(p,o),h=r.createHalfEdge(y,"l"),r.insert(a,h),m=i.intersect(a,h),m&&(s.del(a),s.insert(a,m,i.distance(m,o))),a=h,h=r.createHalfEdge(y,"r"),r.insert(a,h),m=i.intersect(h,f),m&&s.insert(h,m,i.distance(m,o)),o=n.list.shift();else{if(!!s.empty())break;a=s.extractMin(),l=r.left(a),f=r.right(a),c=r.right(f),p=r.leftRegion(a),d=r.rightRegion(f),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(f.edge,f.side,g),r.del(a),s.del(f),r.del(f),b="l",p.y>d.y&&(v=p,p=d,d=v,b="r"),y=i.bisect(p,d),h=r.createHalfEdge(y,b),r.insert(l,h),i.endPoint(y,Xo[b],g),m=i.intersect(l,h),m&&(s.del(l),s.insert(l,m,i.distance(m,p))),m=i.intersect(h,c),m&&s.insert(h,m,i.distance(m,p))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a))t(a.edge)}function $o(){return{leaf:!0,nodes:[],point:null}}function Jo(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*.5,u=(r+s)*.5,a=t.nodes;a[0]&&Jo(e,a[0],n,r,o,u),a[1]&&Jo(e,a[1],o,r,i,u),a[2]&&Jo(e,a[2],n,u,o,s),a[3]&&Jo(e,a[3],o,u,i,s)}}function Go(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function ou(e,t,n,r){var i,s,o=0,u=t.length,a=n.length;while(o<u){if(r>=a)return-1;i=t.charCodeAt(o++);if(i===37){s=yu[t.charAt(o++)];if(!s||(r=s(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function uu(e){return new RegExp("^(?:"+e.map(n.requote).join("|")+")","i")}function au(e){var t=new E,n=-1,r=e.length;while(++n<r)t.set(e[n].toLowerCase(),n);return t}function fu(e,t,n){e+="";var r=e.length;return r<n?(new Array(n-r+1)).join(t)+e:e}function bu(e,t,n){cu.lastIndex=0;var r=cu.exec(t.substring(n));return r?n+=r[0].length:-1}function wu(e,t,n){lu.lastIndex=0;var r=lu.exec(t.substring(n));return r?n+=r[0].length:-1}function Eu(e,t,n){du.lastIndex=0;var r=du.exec(t.substring(n));return r?(e.m=vu.get(r[0].toLowerCase()),n+=r[0].length):-1}function Su(e,t,n){hu.lastIndex=0;var r=hu.exec(t.substring(n));return r?(e.m=pu.get(r[0].toLowerCase()),n+=r[0].length):-1}function xu(e,t,n){return ou(e,gu.c.toString(),t,n)}function Tu(e,t,n){return ou(e,gu.x.toString(),t,n)}function Nu(e,t,n){return ou(e,gu.X.toString(),t,n)}function Cu(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+=r[0].length):-1}function ku(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+2));return r?(e.y=Lu(+r[0]),n+=r[0].length):-1}function Lu(e){return e+(e>68?1900:2e3)}function Au(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+=r[0].length):-1}function Ou(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+=r[0].length):-1}function Mu(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+=r[0].length):-1}function _u(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+=r[0].length):-1}function Du(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+=r[0].length):-1}function Pu(e,t,n){Hu.lastIndex=0;var r=Hu.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+=r[0].length):-1}function Bu(e,t,n){var r=ju.get(t.substring(n,n+=2).toLowerCase());return r==null?-1:(e.p=r,n)}function Fu(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+fu(r,"0",2)+fu(i,"0",2)}function qu(e){return e.toISOString()}function Ru(e,t,n){function r(t){var n=e(t),r=s(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new Ko(n-1)),1),n}function s(e,n){return t(e=new Ko(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1)while(o<r)n(o)%s||u.push(new Date(+o)),t(o,1);else while(o<r)u.push(new Date(+o)),t(o,1);return u}function u(e,t,n){try{Ko=Go;var r=new Go;return r._=e,o(r,t,n)}finally{Ko=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=Uu(e);return a.floor=a,a.round=Uu(r),a.ceil=Uu(i),a.offset=Uu(s),a.range=u,e}function Uu(e){return function(t,n){try{Ko=Go;var r=new Go;return r._=t,e(r,n)._}finally{Ko=Date}}}function zu(e,t,r){function i(t){return e(t)}return i.invert=function(t){return Xu(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain(t),i):e.domain().map(Xu)},i.nice=function(e){return i.domain(Vn(i.domain(),function(){return e}))},i.ticks=function(r,s){var o=Wu(i.domain());if(typeof r!="function"){var u=o[1]-o[0],a=u/r,f=n.bisect(Ku,a);if(f==Ku.length)return t.year(o,r);if(!f)return e.ticks(r).map(Xu);Math.log(a/Ku[f-1])<Math.log(Ku[f]/a)&&--f,r=t[f],s=r[1],r=r[0].range}return r(o[0],new Date(+o[1]+1),s)},i.tickFormat=function(){return r},i.copy=function(){return zu(e.copy(),t,r)},n.rebind(i,e,"range","rangeRound","interpolate","clamp")}function Wu(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Xu(e){return new Date(e)}function Vu(e){return function(t){var n=e.length-1,r=e[n];while(!r[1](t))r=e[--n];return r[0](t)}}function $u(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function Ju(e){var t=e.getFullYear(),n=$u(t),r=$u(t+1);return t+(e-n)/(r-n)}function ra(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function ia(e){var t=e.getUTCFullYear(),n=ra(t),r=ra(t+1);return t+(e-n)/(r-n)}var e=Math.PI,t=1e-6,n={version:"3.0.6"},r=e/180,i=180/e,s=document,o=window,f=".",l=",",c=[3,3];Date.now||(Date.now=function(){return+(new Date)});try{s.createElement("div").style.setProperty("opacity",0,"")}catch(h){var p=o.CSSStyleDeclaration.prototype,d=p.setProperty;p.setProperty=function(e,t,n){d.call(this,e,t+"",n)}}var m=y;try{m(s.documentElement.childNodes)[0].nodeType}catch(b){m=g}var w=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};n.map=function(e){var t=new E;for(var n in e)t.set(n,e[n]);return t},v(E,{has:function(e){return S+e in this},get:function(e){return this[S+e]},set:function(e,t){return this[S+e]=t},remove:function(e){return e=S+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===x&&e.call(this,t.substring(1),this[t])}});var S="\0",x=S.charCodeAt(0);n.functor=C,n.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r)e[i=arguments[n]]=k(e,t,t[i]);return e},n.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},n.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},n.mean=function(e,t){var n=e.length,r,i=0,s=-1,o=0;if(arguments.length===1)while(++s<n)L(r=e[s])&&(i+=(r-i)/++o);else while(++s<n)L(r=t.call(e,e[s],s))&&(i+=(r-i)/++o);return o?i:undefined},n.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(L),e.length?n.quantile(e.sort(n.ascending),.5):undefined},n.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},n.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},n.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},n.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=n.random.normal.apply(n,arguments);return function(){return Math.exp(e())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},n.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},n.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=+e[r-1],s=n-r;return s?i+s*(e[r]-i):i},n.shuffle=function(e){var t=e.length,n,r;while(t)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e},n.transpose=function(e){return n.zip.apply(n,e)},n.zip=function(){if(!(s=arguments.length))return[];for(var e=-1,t=n.min(arguments,A),r=new Array(t);++e<t;)for(var i=-1,s,o=r[e]=new Array(s);++i<s;)o[i]=arguments[i][e];return r},n.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var O=n.bisector(function(e){return e});n.bisectLeft=O.left,n.bisect=n.bisectRight=O.right,n.nest=function(){function s(n,o){if(o>=t.length)return i?i.call(e,n):r?n.sort(r):n;var u=-1,a=n.length,f=t[o++],l,c,h=new E,p,d={};while(++u<a)(p=h.get(l=f(c=n[u])))?p.push(c):h.set(l,[c]);return h.forEach(function(e,t){d[e]=s(t,o)}),d}function o(e,r){if(r>=t.length)return e;var i=[],s=n[r++],u;for(u in e)i.push({key:u,values:o(e[u],r)});return s&&i.sort(function(e,t){return s(e.key,t.key)}),i}var e={},t=[],n=[],r,i;return e.map=function(e){return s(e,0)},e.entries=function(e){return o(s(e,0),0)},e.key=function(n){return t.push(n),e},e.sortKeys=function(r){return n[t.length-1]=r,e},e.sortValues=function(t){return r=t,e},e.rollup=function(t){return i=t,e},e},n.keys=function(e){var t=[];for(var n in e)t.push(n);return t},n.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},n.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},n.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},n.merge=function(e){return Array.prototype.concat.apply([],e)},n.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity)throw new Error("infinite range");var r=[],i=_(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0)while((o=e+n*++s)>t)r.push(o/i);else while((o=e+n*++s)<t)r.push(o/i);return r},n.requote=function(e){return e.replace(D,"\\$&")};var D=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;n.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},n.xhr=function(e,t,r){function l(){var e=f.status;!e&&f.responseText||e>=200&&e<300||e===304?s.load.call(i,a.call(i,f)):s.error.call(i,f)}var i={},s=n.dispatch("progress","load","error"),u={},a=T,f=new(o.XDomainRequest&&/^(http(s)?:)?\/\//.test(e)?XDomainRequest:XMLHttpRequest);return"onload"in f?f.onload=f.onerror=l:f.onreadystatechange=function(){f.readyState>3&&l()},f.onprogress=function(e){var t=n.event;n.event=e;try{s.progress.call(i,f)}finally{n.event=t}},i.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?u[e]:(t==null?delete u[e]:u[e]=t+"",i)},i.mimeType=function(e){return arguments.length?(t=e==null?null:e+"",i):t},i.response=function(e){return a=e,i},["get","post"].forEach(function(e){i[e]=function(){return i.send.apply(i,[e].concat(m(arguments)))}}),i.send=function(n,r,s){arguments.length===2&&typeof r=="function"&&(s=r,r=null),f.open(n,e,!0),t!=null&&!("accept"in u)&&(u.accept=t+",*/*");if(f.setRequestHeader)for(var o in u)f.setRequestHeader(o,u[o]);return t!=null&&f.overrideMimeType&&f.overrideMimeType(t),s!=null&&i.on("error",s).on("load",function(e){s(null,e)}),f.send(r==null?null:r),i},i.abort=function(){return f.abort(),i},n.rebind(i,s,"on"),arguments.length===2&&typeof t=="function"&&(r=t,t=null),r==null?i:i.get(P(r))},n.text=function(){return n.xhr.apply(n,arguments).response(H)},n.json=function(e,t){return n.xhr(e,"application/json",t).response(B)},n.html=function(e,t){return n.xhr(e,"text/html",t).response(j)},n.xml=function(){return n.xhr.apply(n,arguments).response(F)};var I={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};n.ns={prefix:I,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),I.hasOwnProperty(n)?{space:I[n],local:e}:e}},n.dispatch=function(){var e=new q,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=R(e);return e},q.prototype.on=function(e,t){var n=e.indexOf("."),r="";return n>0&&(r=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(r):this[e].on(r,t)},n.format=function(e){var t=U.exec(e),r=t[1]||" ",i=t[2]||">",s=t[3]||"",o=t[4]||"",u=t[5],a=+t[6],l=t[7],c=t[8],h=t[9],p=1,d="",v=!1;c&&(c=+c.substring(1));if(u||r==="0"&&i==="=")u=r="0",i="=",l&&(a-=Math.floor((a-1)/4));switch(h){case"n":l=!0,h="g";break;case"%":p=100,d="%",h="f";break;case"p":p=100,d="%",h="r";break;case"b":case"o":case"x":case"X":o&&(o="0"+h.toLowerCase());case"c":case"d":v=!0,c=0;break;case"s":p=-1,h="r"}o==="#"&&(o=""),h=="r"&&!c&&(h="g"),h=z.get(h)||X;var m=u&&l;return function(e){if(v&&e%1)return"";var t=e<0||e===0&&1/e<0?(e=-e,"-"):s;if(p<0){var g=n.formatPrefix(e,c);e=g.scale(e),d=g.symbol}else e*=p;e=h(e,c),!u&&l&&(e=V(e));var y=o.length+e.length+(m?0:t.length),b=y<a?(new Array(y=a-y+1)).join(r):"";return m&&(e=V(b+e)),f&&e.replace(".",f),t+=o,(i==="<"?t+e+b:i===">"?b+t+e:i==="^"?b.substring(0,y>>=1)+t+e+b.substring(y):t+(m?e:b+e))+d}};var U=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,z=n.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=n.round(e,W(e,t))).toFixed(Math.max(0,Math.min(20,W(e*(1+1e-15),t))))}}),V=T;if(c){var $=c.length;V=function(e){var t=e.lastIndexOf("."),n=t>=0?"."+e.substring(t+1):(t=e.length,""),r=[],i=0,s=c[0];while(t>0&&s>0)r.push(e.substring(t-=s,t+s)),s=c[i=(i+1)%$];return r.reverse().join(l||"")+n}}var J=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(K);n.formatPrefix=function(e,t){var r=0;return e&&(e<0&&(e*=-1),t&&(e=n.round(e,W(e,t))),r=1+Math.floor(1e-12+Math.log(e)/Math.LN10),r=Math.max(-24,Math.min(24,Math.floor((r<=0?r+1:r-1)/3)*3))),J[8+r/3]};var Q=function(){return T},G=n.map({linear:Q,poly:st,quad:function(){return nt},cubic:function(){return rt},sin:function(){return ot},exp:function(){return ut},circle:function(){return at},elastic:ft,back:lt,bounce:function(){return ct}}),Y=n.map({"in":T,out:et,"in-out":tt,"out-in":function(e){return tt(et(e))}});n.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=G.get(n)||Q,r=Y.get(r)||T,Z(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},n.event=null,n.transform=function(e){var t=s.createElementNS(n.ns.prefix.svg,"g");return(n.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new vt(n?n.matrix:bt)})(e)},vt.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var bt={a:1,b:0,c:0,d:1,e:0,f:0};n.interpolate=function(e,t){var r=n.interpolators.length,i;while(--r>=0&&!(i=n.interpolators[r](e,t)));return i},n.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},n.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},n.interpolateString=function(e,t){var r,i,s,o=0,u=0,a=[],f=[],l,c;wt.lastIndex=0;for(i=0;r=wt.exec(t);++i)r.index&&a.push(t.substring(o,u=r.index)),f.push({i:a.length,x:r[0]}),a.push(null),o=wt.lastIndex;o<t.length&&a.push(t.substring(o));for(i=0,l=f.length;(r=wt.exec(e))&&i<l;++i){c=f[i];if(c.x==r[0]){if(c.i)if(a[c.i+1]==null){a[c.i-1]+=c.x,a.splice(c.i,1);for(s=i+1;s<l;++s)f[s].i--}else{a[c.i-1]+=c.x+a[c.i+1],a.splice(c.i,2);for(s=i+1;s<l;++s)f[s].i-=2}else if(a[c.i+1]==null)a[c.i]=c.x;else{a[c.i]=c.x+a[c.i+1],a.splice(c.i+1,1);for(s=i+1;s<l;++s)f[s].i--}f.splice(i,1),l--,i--}else c.x=n.interpolateNumber(parseFloat(r[0]),parseFloat(c.x))}while(i<l)c=f.pop(),a[c.i+1]==null?a[c.i]=c.x:(a[c.i]=c.x+a[c.i+1],a.splice(c.i+1,1)),l--;return a.length===1?a[0]==null?f[0].x:function(){return t}:function(e){for(i=0;i<l;++i)a[(c=f[i]).i]=c.x(e);return a.join("")}},n.interpolateTransform=function(e,t){var r=[],i=[],s,o=n.transform(e),u=n.transform(t),a=o.translate,f=u.translate,l=o.rotate,c=u.rotate,h=o.skew,p=u.skew,d=o.scale,v=u.scale;return a[0]!=f[0]||a[1]!=f[1]?(r.push("translate(",null,",",null,")"),i.push({i:1,x:n.interpolateNumber(a[0],f[0])},{i:3,x:n.interpolateNumber(a[1],f[1])})):f[0]||f[1]?r.push("translate("+f+")"):r.push(""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),i.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:n.interpolateNumber(l,c)})):c&&r.push(r.pop()+"rotate("+c+")"),h!=p?i.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:n.interpolateNumber(h,p)}):p&&r.push(r.pop()+"skewX("+p+")"),d[0]!=v[0]||d[1]!=v[1]?(s=r.push(r.pop()+"scale(",null,",",null,")"),i.push({i:s-4,x:n.interpolateNumber(d[0],v[0])},{i:s-2,x:n.interpolateNumber(d[1],v[1])})):(v[0]!=1||v[1]!=1)&&r.push(r.pop()+"scale("+v+")"),s=i.length,function(e){var t=-1,n;while(++t<s)r[(n=i[t]).i]=n.x(e);return r.join("")}},n.interpolateRgb=function(e,t){e=n.rgb(e),t=n.rgb(t);var r=e.r,i=e.g,s=e.b,o=t.r-r,u=t.g-i,a=t.b-s;return function(e){return"#"+Lt(Math.round(r+o*e))+Lt(Math.round(i+u*e))+Lt(Math.round(s+a*e))}},n.interpolateHsl=function(e,t){e=n.hsl(e),t=n.hsl(t);var r=e.h,i=e.s,s=e.l,o=t.h-r,u=t.s-i,a=t.l-s;return o>180?o-=360:o<-180&&(o+=360),function(e){return Ft(r+o*e,i+u*e,s+a*e)+""}},n.interpolateLab=function(e,t){e=n.lab(e),t=n.lab(t);var r=e.l,i=e.a,s=e.b,o=t.l-r,u=t.a-i,a=t.b-s;return function(e){return Qt(r+o*e,i+u*e,s+a*e)+""}},n.interpolateHcl=function(e,t){e=n.hcl(e),t=n.hcl(t);var r=e.h,i=e.c,s=e.l,o=t.h-r,u=t.c-i,a=t.l-s;return o>180?o-=360:o<-180&&(o+=360),function(e){return Ut(r+o*e,i+u*e,s+a*e)+""}},n.interpolateArray=function(e,t){var r=[],i=[],s=e.length,o=t.length,u=Math.min(e.length,t.length),a;for(a=0;a<u;++a)r.push(n.interpolate(e[a],t[a]));for(;a<s;++a)i[a]=e[a];for(;a<o;++a)i[a]=t[a];return function(e){for(a=0;a<u;++a)i[a]=r[a](e);return i}},n.interpolateObject=function(e,t){var n={},r={},i;for(i in e)i in t?n[i]=Et(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}};var wt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;n.interpolators=[n.interpolateObject,function(e,t){return t instanceof Array&&n.interpolateArray(e,t)},function(e,t){return(typeof e=="string"||typeof t=="string")&&n.interpolateString(e+"",t+"")},function(e,t){return(typeof t=="string"?Pt.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof Tt)&&n.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&n.interpolateNumber(e,t)}],Tt.prototype.toString=function(){return this.rgb()+""},n.rgb=function(e,t,n){return arguments.length===1?e instanceof Ct?Nt(e.r,e.g,e.b):At(""+e,Nt,Ft):Nt(~~e,~~t,~~n)};var kt=Ct.prototype=new Tt;kt.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?Nt(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),Nt(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},kt.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),Nt(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},kt.hsl=function(){return Ot(this.r,this.g,this.b)},kt.toString=function(){return"#"+Lt(this.r)+Lt(this.g)+Lt(this.b)};var Pt=n.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});Pt.forEach(function(e,t){Pt.set(e,At(t,Nt,Ft))}),n.hsl=function(e,t,n){return arguments.length===1?e instanceof Bt?Ht(e.h,e.s,e.l):At(""+e,Ot,Ht):Ht(+e,+t,+n)};var jt=Bt.prototype=new Tt;jt.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),Ht(this.h,this.s,this.l/e)},jt.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),Ht(this.h,this.s,e*this.l)},jt.rgb=function(){return Ft(this.h,this.s,this.l)},n.hcl=function(e,t,r){return arguments.length===1?e instanceof qt?It(e.h,e.c,e.l):e instanceof Wt?Gt(e.l,e.a,e.b):Gt((e=Mt((e=n.rgb(e)).r,e.g,e.b)).l,e.a,e.b):It(+e,+t,+r)};var Rt=qt.prototype=new Tt;Rt.brighter=function(e){return It(this.h,this.c,Math.min(100,this.l+Xt*(arguments.length?e:1)))},Rt.darker=function(e){return It(this.h,this.c,Math.max(0,this.l-Xt*(arguments.length?e:1)))},Rt.rgb=function(){return Ut(this.h,this.c,this.l).rgb()},n.lab=function(e,t,r){return arguments.length===1?e instanceof Wt?zt(e.l,e.a,e.b):e instanceof qt?Ut(e.l,e.c,e.h):Mt((e=n.rgb(e)).r,e.g,e.b):zt(+e,+t,+r)};var Xt=18,Vt=.95047,$t=1,Jt=1.08883,Kt=Wt.prototype=new Tt;Kt.brighter=function(e){return zt(Math.min(100,this.l+Xt*(arguments.length?e:1)),this.a,this.b)},Kt.darker=function(e){return zt(Math.max(0,this.l-Xt*(arguments.length?e:1)),this.a,this.b)},Kt.rgb=function(){return Qt(this.l,this.a,this.b)};var nn=function(e,t){return t.querySelector(e)},rn=function(e,t){return t.querySelectorAll(e)},sn=s.documentElement,on=sn.matchesSelector||sn.webkitMatchesSelector||sn.mozMatchesSelector||sn.msMatchesSelector||sn.oMatchesSelector,un=function(e,t){return on.call(e,t)};typeof Sizzle=="function"&&(nn=function(e,t){return Sizzle(e,t)[0]||null},rn=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},un=Sizzle.matchesSelector);var an=[];n.selection=function(){return Sn},n.selection.prototype=an,an.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=fn(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return tn(t)},an.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=ln(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=m(e.call(r,r.__data__,u))),n.parentNode=r;return tn(t)},an.attr=function(e,t){if(arguments.length<2){if(typeof e=="string"){var r=this.node();return e=n.ns.qualify(e),e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}for(t in e)this.each(cn(t,e[t]));return this}return this.each(cn(e,t))},an.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r)if(!t.contains(e[i]))return!1}else{t=n.className,t.baseVal!=null&&(t=t.baseVal);while(++i<r)if(!hn(e[i]).test(t))return!1}return!0}for(t in e)this.each(pn(t,e[t]));return this}return this.each(pn(e,t))},an.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.each(vn(n,e[n],t));return this}if(r<2)return o.getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(vn(e,t,n))},an.property=function(e,t){if(arguments.length<2){if(typeof e=="string")return this.node()[e];for(t in e)this.each(mn(t,e[t]));return this}return this.each(mn(e,t))},an.text=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},an.html=function(e){return arguments.length?this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},an.append=function(e){function t(){return this.appendChild(s.createElementNS(this.namespaceURI,e))}function r(){return this.appendChild(s.createElementNS(e.space,e.local))}return e=n.ns.qualify(e),this.select(e.local?r:t)},an.insert=function(e,t){function r(){return this.insertBefore(s.createElementNS(this.namespaceURI,e),nn(t,this))}function i(){return this.insertBefore(s.createElementNS(e.space,e.local),nn(t,this))}return e=n.ns.qualify(e),this.select(e.local?i:r)},an.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},an.data=function(e,t){function o(e,n){var r,i=e.length,s=n.length,o=Math.min(i,s),l=new Array(s),c=new Array(s),h=new Array(i),p,d;if(t){var v=new E,m=new E,g=[],y;for(r=-1;++r<i;)y=t.call(p=e[r],p.__data__,r),v.has(y)?h[r]=p:v.set(y,p),g.push(y);for(r=-1;++r<s;)y=t.call(n,d=n[r],r),(p=v.get(y))?(l[r]=p,p.__data__=d):m.has(y)||(c[r]=gn(d)),m.set(y,d),v.remove(y);for(r=-1;++r<i;)v.has(g[r])&&(h[r]=e[r])}else{for(r=-1;++r<o;)p=e[r],d=n[r],p?(p.__data__=d,l[r]=p):c[r]=gn(d);for(;r<s;++r)c[r]=gn(n[r]);for(;r<i;++r)h[r]=e[r]}c.update=l,c.parentNode=l.parentNode=h.parentNode=e.parentNode,u.push(c),a.push(l),f.push(h)}var n=-1,r=this.length,i,s;if(!arguments.length){e=new Array(r=(i=this[0]).length);while(++n<r)if(s=i[n])e[n]=s.__data__;return e}var u=xn([]),a=tn([]),f=tn([]);if(typeof e=="function")while(++n<r)o(i=this[n],e.call(i,i.parentNode.__data__,n));else while(++n<r)o(i=this[n],e);return a.enter=function(){return u},a.exit=function(){return f},a},an.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},an.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=yn(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return tn(t)},an.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;)if(s=n[r])i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s;return this},an.sort=function(e){e=bn.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},an.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e)this.each(wn(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(wn(e,t,n))},an.each=function(e){return En(this,function(t,n,r){e.call(t,t.__data__,n,r)})},an.call=function(e){var t=m(arguments);return e.apply(t[0]=this,t),this},an.empty=function(){return!this.node()},an.node=function(){for(var e=0,t=this.length;e<t;e++)for(var n=this[e],r=0,i=n.length;r<i;r++){var s=n[r];if(s)return s}return null},an.transition=function(){var e=Ln||++kn,t=[],n,r,i=Object.create(An);i.time=Date.now();for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(r=u[a])&&On(r,a,e,i),n.push(r)}return Nn(t,e)};var Sn=tn([[s]]);Sn[0].parentNode=sn,n.select=function(e){return typeof e=="string"?Sn.select(e):tn([[e]])},n.selectAll=function(e){return typeof e=="string"?Sn.selectAll(e):tn([m(e)])};var Tn=[];n.selection.enter=xn,n.selection.enter.prototype=Tn,Tn.append=an.append,Tn.insert=an.insert,Tn.empty=an.empty,Tn.node=an.node,Tn.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return tn(t)};var Cn=[],kn=0,Ln,An={ease:it,delay:0,duration:250};Cn.call=an.call,Cn.empty=an.empty,Cn.node=an.node,n.transition=function(e){return arguments.length?Ln?e.transition():e:Sn.transition()},n.transition.prototype=Cn,Cn.select=function(e){var t=this.id,n=[],r,i,s;typeof e!="function"&&(e=fn(e));for(var o=-1,u=this.length;++o<u;){n.push(r=[]);for(var a=this[o],f=-1,l=a.length;++f<l;)(s=a[f])&&(i=e.call(s,s.__data__,f))?("__data__"in s&&(i.__data__=s.__data__),On(i,f,t,s.__transition__[t]),r.push(i)):r.push(null)}return Nn(n,t)},Cn.selectAll=function(e){var t=this.id,n=[],r,i,s,o,u;typeof e!="function"&&(e=ln(e));for(var a=-1,f=this.length;++a<f;)for(var l=this[a],c=-1,h=l.length;++c<h;)if(s=l[c]){u=s.__transition__[t],i=e.call(s,s.__data__,c),n.push(r=[]);for(var p=-1,d=i.length;++p<d;)On(o=i[p],p,t,u),r.push(o)}return Nn(n,t)},Cn.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=yn(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return Nn(t,this.id,this.time).ease(this.ease())},Cn.attr=function(e,t){function s(){this.removeAttribute(i)}function o(){this.removeAttributeNS(i.space,i.local)}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var r=Et(e),i=n.ns.qualify(e);return _n(this,"attr."+e,t,function(e){function t(){var t=this.getAttribute(i),n;return t!==e&&(n=r(t,e),function(e){this.setAttribute(i,n(e))})}function n(){var t=this.getAttributeNS(i.space,i.local),n;return t!==e&&(n=r(t,e),function(e){this.setAttributeNS(i.space,i.local,n(e))})}return e==null?i.local?o:s:(e+="",i.local?n:t)})},Cn.attrTween=function(e,t){function i(e,n){var i=t.call(this,e,n,this.getAttribute(r));return i&&function(e){this.setAttribute(r,i(e))}}function s(e,n){var i=t.call(this,e,n,this.getAttributeNS(r.space,r.local));return i&&function(e){this.setAttributeNS(r.space,r.local,i(e))}}var r=n.ns.qualify(e);return this.tween("attr."+e,r.local?s:i)},Cn.style=function(e,t,n){function s(){this.style.removeProperty(e)}var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}var i=Et(e);return _n(this,"style."+e,t,function(t){function r(){var r=o.getComputedStyle(this,null).getPropertyValue(e),s;return r!==t&&(s=i(r,t),function(t){this.style.setProperty(e,s(t),n)})}return t==null?s:(t+="",r)})},Cn.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,o.getComputedStyle(this,null).getPropertyValue(e));return s&&function(t){this.style.setProperty(e,s(t),n)}})},Cn.text=function(e){return _n(this,"text",e,Mn)},Cn.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Cn.ease=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:(typeof e!="function"&&(e=n.ease.apply(n,arguments)),En(this,function(n){n.__transition__[t].ease=e}))},Cn.delay=function(e){var t=this.id;return En(this,typeof e=="function"?function(n,r,i){n.__transition__[t].delay=e.call(n,n.__data__,r,i)|0}:(e|=0,function(n){n.__transition__[t].delay=e}))},Cn.duration=function(e){var t=this.id;return En(this,typeof e=="function"?function(n,r,i){n.__transition__[t].duration=Math.max(1,e.call(n,n.__data__,r,i)|0)}:(e=Math.max(1,e|0),function(n){n.__transition__[t].duration=e}))},Cn.each=function(e,t){var n=this.id;if(arguments.length<2){var r=An,i=Ln;Ln=n,En(this,function(t,r,i){An=t.__transition__[n],e.call(t,t.__data__,r,i)}),An=r,Ln=i}else En(this,function(r){r.__transition__[n].event.on(e,t)});return this},Cn.transition=function(){var e=this.id,t=++kn,n=[],r,i,s,o;for(var u=0,a=this.length;u<a;u++){n.push(r=[]);for(var i=this[u],f=0,l=i.length;f<l;f++){if(s=i[f])o=Object.create(s.__transition__[e]),o.delay+=o.duration,On(s,f,t,o);r.push(s)}}return Nn(n,t)},Cn.tween=function(e,t){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(e):En(this,t==null?function(t){t.__transition__[n].tween.remove(e)}:function(r){r.__transition__[n].tween.set(e,t)})};var Dn=0,Pn={},Hn=null,Bn,jn;n.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var r=Pn[e.id];r&&r.callback===e?(r.then=n,r.delay=t):Pn[e.id=++Dn]=Hn={callback:e,then:n,delay:t,next:Hn},Bn||(jn=clearTimeout(jn),Bn=1,qn(Fn))},n.timer.flush=function(){var e,t=Date.now(),n=Hn;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;In()};var qn=o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame||function(e){setTimeout(e,17)};n.mouse=function(e){return Un(e,pt())};var Rn=/WebKit/.test(o.navigator.userAgent)?-1:0;n.touches=function(e,t){return arguments.length<2&&(t=pt().touches),t?m(t).map(function(t){var n=Un(e,t);return n.identifier=t.identifier,n}):[]},n.scale={},n.scale.linear=function(){return Jn([0,1],[0,1],n.interpolate,!1)},n.scale.log=function(){return nr(n.scale.linear(),ir)};var rr=n.format(".0e");ir.pow=function(e){return Math.pow(10,e)},sr.pow=function(e){return-Math.pow(10,-e)},n.scale.pow=function(){return or(n.scale.linear(),1)},n.scale.sqrt=function(){return n.scale.pow().exponent(.5)},n.scale.ordinal=function(){return ar([],{t:"range",a:[[]]})},n.scale.category10=function(){return n.scale.ordinal().range(fr)},n.scale.category20=function(){return n.scale.ordinal().range(lr)},n.scale.category20b=function(){return n.scale.ordinal().range(cr)},n.scale.category20c=function(){return n.scale.ordinal().range(hr)};var fr=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],lr=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],cr=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],hr=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];n.scale.quantile=function(){return pr([],[])},n.scale.quantize=function(){return dr(0,1,[0,1])},n.scale.threshold=function(){return vr([.5],[0,1])},n.scale.identity=function(){return mr([0,1])},n.svg={},n.svg.arc=function(){function s(){var s=t.apply(this,arguments),o=n.apply(this,arguments),u=r.apply(this,arguments)+gr,a=i.apply(this,arguments)+gr,f=(a<u&&(f=u,u=a,a=f),a-u),l=f<e?"0":"1",c=Math.cos(u),h=Math.sin(u),p=Math.cos(a),d=Math.sin(a);return f>=yr?s?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+ -o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+s+"A"+s+","+s+" 0 1,0 0,"+ -s+"A"+s+","+s+" 0 1,0 0,"+s+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+ -o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":s?"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+l+",1 "+o*p+","+o*d+"L"+s*p+","+s*d+"A"+s+","+s+" 0 "+l+",0 "+s*c+","+s*h+"Z":"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+l+",1 "+o*p+","+o*d+"L0,0"+"Z"}var t=br,n=wr,r=Er,i=Sr;return s.innerRadius=function(e){return arguments.length?(t=C(e),s):t},s.outerRadius=function(e){return arguments.length?(n=C(e),s):n},s.startAngle=function(e){return arguments.length?(r=C(e),s):r},s.endAngle=function(e){return arguments.length?(i=C(e),s):i},s.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+gr;return[Math.cos(s)*e,Math.sin(s)*e]},s};var gr=-e/2,yr=2*e-1e-6;n.svg.line=function(){return xr(T)};var Cr=n.map({linear:kr,"linear-closed":Lr,"step-before":Ar,"step-after":Or,basis:Br,"basis-open":jr,"basis-closed":Fr,bundle:Ir,cardinal:Dr,"cardinal-open":Mr,"cardinal-closed":_r,monotone:Jr});Cr.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Rr=[0,2/3,1/3,0],Ur=[0,1/3,2/3,0],zr=[0,1/6,2/3,1/6];n.svg.line.radial=function(){var e=xr(Kr);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Ar.reverse=Or,Or.reverse=Ar,n.svg.area=function(){return Qr(T)},n.svg.area.radial=function(){var e=Qr(Kr);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},n.svg.chord=function(){function o(e,r){var i=f(this,t,e,r),s=f(this,n,e,r);return"M"+i.p0+c(i.r,i.p1,i.a1-i.a0)+(l(i,s)?h(i.r,i.p1,i.r,i.p0):h(i.r,i.p1,s.r,s.p0)+c(s.r,s.p1,s.a1-s.a0)+h(s.r,s.p1,i.r,i.p0))+"Z"}function f(e,t,n,o){var u=t.call(e,n,o),a=r.call(e,u,o),f=i.call(e,u,o)+gr,l=s.call(e,u,o)+gr;return{r:a,a0:f,a1:l,p0:[a*Math.cos(f),a*Math.sin(f)],p1:[a*Math.cos(l),a*Math.sin(l)]}}function l(e,t){return e.a0==t.a0&&e.a1==t.a1}function c(t,n,r){return"A"+t+","+t+" 0 "+ +(r>e)+",1 "+n}function h(e,t,n,r){return"Q 0,0 "+r}var t=a,n=u,r=Gr,i=Er,s=Sr;return o.radius=function(e){return arguments.length?(r=C(e),o):r},o.source=function(e){return arguments.length?(t=C(e),o):t},o.target=function(e){return arguments.length?(n=C(e),o):n},o.startAngle=function(e){return arguments.length?(i=C(e),o):i},o.endAngle=function(e){return arguments.length?(s=C(e),o):s},o},n.svg.diagonal=function(){function r(r,i){var s=e.call(this,r,i),o=t.call(this,r,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(n),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var e=a,t=u,n=Yr;return r.source=function(t){return arguments.length?(e=C(t),r):e},r.target=function(e){return arguments.length?(t=C(e),r):t},r.projection=function(e){return arguments.length?(n=e,r):n},r},n.svg.diagonal.radial=function(){var e=n.svg.diagonal(),t=Yr,r=e.projection;return e.projection=function(e){return arguments.length?r(Zr(t=e)):t},e},n.svg.symbol=function(){function n(n,r){return(ri.get(e.call(this,n,r))||ni)(t.call(this,n,r))}var e=ti,t=ei;return n.type=function(t){return arguments.length?(e=C(t),n):e},n.size=function(e){return arguments.length?(t=C(e),n):t},n};var ri=n.map({circle:ni,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*si)),n=t*si;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/ii),n=t*ii/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/ii),n=t*ii/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}});n.svg.symbolTypes=ri.keys();var ii=Math.sqrt(3),si=Math.tan(30*r);n.svg.axis=function(){function c(c){c.each(function(){var c=n.select(this),h=a==null?e.ticks?e.ticks.apply(e,u):e.domain():a,p=f==null?e.tickFormat?e.tickFormat.apply(e,u):String:f,d=li(e,h,l),v=c.selectAll(".tick.minor").data(d,String),m=v.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1e-6),g=n.transition(v.exit()).style("opacity",1e-6).remove(),y=n.transition(v).style("opacity",1),b=c.selectAll(".tick.major").data(h,String),w=b.enter().insert("g","path").attr("class","tick major").style("opacity",1e-6),E=n.transition(b.exit()).style("opacity",1e-6).remove(),S=n.transition(b).style("opacity",1),x,T=Xn(e),N=c.selectAll(".domain").data([0]),C=(N.enter().append("path").attr("class","domain"),n.transition(N)),k=e.copy(),L=this.__chart__||k;this.__chart__=k,w.append("line"),w.append("text");var A=w.select("line"),O=S.select("line"),M=b.select("text").text(p),_=w.select("text"),D=S.select("text");switch(t){case"bottom":x=ai,m.attr("y2",i),y.attr("x2",0).attr("y2",i),A.attr("y2",r),_.attr("y",Math.max(r,0)+o),O.attr("x2",0).attr("y2",r),D.attr("x",0).attr("y",Math.max(r,0)+o),M.attr("dy",".71em").style("text-anchor","middle"),C.attr("d","M"+T[0]+","+s+"V0H"+T[1]+"V"+s);break;case"top":x=ai,m.attr("y2",-i),y.attr("x2",0).attr("y2",-i),A.attr("y2",-r),_.attr("y",-(Math.max(r,0)+o)),O.attr("x2",0).attr("y2",-r),D.attr("x",0).attr("y",-(Math.max(r,0)+o)),M.attr("dy","0em").style("text-anchor","middle"),C.attr("d","M"+T[0]+","+ -s+"V0H"+T[1]+"V"+ -s);break;case"left":x=fi,m.attr("x2",-i),y.attr("x2",-i).attr("y2",0),A.attr("x2",-r),_.attr("x",-(Math.max(r,0)+o)),O.attr("x2",-r).attr("y2",0),D.attr("x",-(Math.max(r,0)+o)).attr("y",0),M.attr("dy",".32em").style("text-anchor","end"),C.attr("d","M"+ -s+","+T[0]+"H0V"+T[1]+"H"+ -s);break;case"right":x=fi,m.attr("x2",i),y.attr("x2",i).attr("y2",0),A.attr("x2",r),_.attr("x",Math.max(r,0)+o),O.attr("x2",r).attr("y2",0),D.attr("x",Math.max(r,0)+o).attr("y",0),M.attr("dy",".32em").style("text-anchor","start"),C.attr("d","M"+s+","+T[0]+"H0V"+T[1]+"H"+s)}if(e.ticks)w.call(x,L),S.call(x,k),E.call(x,k),m.call(x,L),y.call(x,k),g.call(x,k);else{var P=k.rangeBand()/2,H=function(e){return k(e)+P};w.call(x,H),S.call(x,H)}})}var e=n.scale.linear(),t=oi,r=6,i=6,s=6,o=3,u=[10],a=null,f,l=0;return c.scale=function(t){return arguments.length?(e=t,c):e},c.orient=function(e){return arguments.length?(t=e in ui?e+"":oi,c):t},c.ticks=function(){return arguments.length?(u=arguments,c):u},c.tickValues=function(e){return arguments.length?(a=e,c):a},c.tickFormat=function(e){return arguments.length?(f=e,c):f},c.tickSize=function(e,t){if(!arguments.length)return r;var n=arguments.length-1;return r=+e,i=n>1?+t:r,s=n>0?+arguments[n]:r,c},c.tickPadding=function(e){return arguments.length?(o=+e,c):o},c.tickSubdivide=function(e){return arguments.length?(l=+e,c):l},c};var oi="bottom",ui={top:1,right:1,bottom:1,left:1};n.svg.brush=function(){function a(e){e.each(function(){var e=n.select(this),s=e.selectAll(".background").data([0]),o=e.selectAll(".extent").data([0]),u=e.selectAll(".resize").data(i,String),p;e.style("pointer-events","all").on("mousedown.brush",h).on("touchstart.brush",h),s.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.enter().append("rect").attr("class","extent").style("cursor","move"),u.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return ci[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),u.style("display",a.empty()?"none":null),u.exit().remove(),t&&(p=Xn(t),s.attr("x",p[0]).attr("width",p[1]-p[0]),l(e)),r&&(p=Xn(r),s.attr("y",p[0]).attr("height",p[1]-p[0]),c(e)),f(e)})}function f(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+s[+/e$/.test(e)][0]+","+s[+/^s/.test(e)][1]+")"})}function l(e){e.select(".extent").attr("x",s[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1][0]-s[0][0])}function c(e){e.select(".extent").attr("y",s[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",s[1][1]-s[0][1])}function h(){function N(){var e=n.event.changedTouches;return e?n.touches(i,e)[0]:n.mouse(i)}function C(){n.event.keyCode==32&&(y||(b=null,w[0]-=s[1][0],w[1]-=s[1][1],y=2),ht())}function k(){n.event.keyCode==32&&y==2&&(w[0]+=s[1][0],w[1]+=s[1][1],y=0,ht())}function L(){var e=N(),i=!1;E&&(e[0]+=E[0],e[1]+=E[1]),y||(n.event.altKey?(b||(b=[(s[0][0]+s[1][0])/2,(s[0][1]+s[1][1])/2]),w[0]=s[+(e[0]<b[0])][0],w[1]=s[+(e[1]<b[1])][1]):b=null),m&&A(e,t,0)&&(l(d),i=!0),g&&A(e,r,1)&&(c(d),i=!0),i&&(f(d),p({type:"brush",mode:y?"move":"resize"}))}function A(e,t,n){var r=Xn(t),i=r[0],o=r[1],a=w[n],f=s[1][n]-s[0][n],l,c;y&&(i-=a,o-=f+a),l=Math.max(i,Math.min(o,e[n])),y?c=(l+=a)+f:(b&&(a=Math.max(i,Math.min(o,2*b[n]-l))),a<l?(c=l,l=a):c=a);if(s[0][n]!==l||s[1][n]!==c)return u=null,s[0][n]=l,s[1][n]=c,!0}function O(){L(),d.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),n.select("body").style("cursor",null),S.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),p({type:"brushend"}),ht()}var i=this,h=n.select(n.event.target),p=e.of(i,arguments),d=n.select(i),v=h.datum(),m=!/^(n|s)$/.test(v)&&t,g=!/^(e|w)$/.test(v)&&r,y=h.classed("extent"),b,w=N(),E,S=n.select(o).on("mousemove.brush",L).on("mouseup.brush",O).on("touchmove.brush",L).on("touchend.brush",O).on("keydown.brush",C).on("keyup.brush",k);if(y)w[0]=s[0][0]-w[0],w[1]=s[0][1]-w[1];else if(v){var x=+/w$/.test(v),T=+/^n/.test(v);E=[s[1-x][0]-w[0],s[1-T][1]-w[1]],w[0]=s[x][0],w[1]=s[T][1]}else n.event.altKey&&(b=w.slice());d.style("pointer-events","none").selectAll(".resize").style("display",null),n.select("body").style("cursor",h.style("cursor")),p({type:"brushstart"}),L(),ht()}var e=dt(a,"brushstart","brush","brushend"),t=null,r=null,i=hi[0],s=[[0,0],[0,0]],u;return a.x=function(e){return arguments.length?(t=e,i=hi[!t<<1|!r],a):t},a.y=function(e){return arguments.length?(r=e,i=hi[!t<<1|!r],a):r},a.extent=function(e){var n,i,o,f,l;return arguments.length?(u=[[0,0],[0,0]],t&&(n=e[0],i=e[1],r&&(n=n[0],i=i[0]),u[0][0]=n,u[1][0]=i,t.invert&&(n=t(n),i=t(i)),i<n&&(l=n,n=i,i=l),s[0][0]=n|0,s[1][0]=i|0),r&&(o=e[0],f=e[1],t&&(o=o[1],f=f[1]),u[0][1]=o,u[1][1]=f,r.invert&&(o=r(o),f=r(f)),f<o&&(l=o,o=f,f=l),s[0][1]=o|0,s[1][1]=f|0),a):(e=u||s,t&&(n=e[0][0],i=e[1][0],u||(n=s[0][0],i=s[1][0],t.invert&&(n=t.invert(n),i=t.invert(i)),i<n&&(l=n,n=i,i=l))),r&&(o=e[0][1],f=e[1][1],u||(o=s[0][1],f=s[1][1],r.invert&&(o=r.invert(o),f=r.invert(f)),f<o&&(l=o,o=f,f=l))),t&&r?[[n,o],[i,f]]:t?[n,i]:r&&[o,f])},a.clear=function(){return u=null,s[0][0]=s[0][1]=s[1][0]=s[1][1]=0,a},a.empty=function(){return t&&s[0][0]===s[1][0]||r&&s[0][1]===s[1][1]},n.rebind(a,e,"on")};var ci={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},hi=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];n.behavior={},n.behavior.drag=function(){function r(){this.on("mousedown.drag",i).on("touchstart.drag",i)}function i(){function h(){var e=r.parentNode;return u!=null?n.touches(e).filter(function(e){return e.identifier===u})[0]:n.mouse(e)}function p(){if(!r.parentNode)return d();var e=h(),t=e[0]-f[0],n=e[1]-f[1];l|=t|n,f=e,ht(),i({type:"drag",x:e[0]+a[0],y:e[1]+a[1],dx:t,dy:n})}function d(){i({type:"dragend"}),l&&(ht(),n.event.target===s&&c.on("click.drag",v,!0)),c.on(u!=null?"touchmove.drag-"+u:"mousemove.drag",null).on(u!=null?"touchend.drag-"+u:"mouseup.drag",null)}function v(){ht(),c.on("click.drag",null)}var r=this,i=e.of(r,arguments),s=n.event.target,u=n.event.touches?n.event.changedTouches[0].identifier:null,a,f=h(),l=0,c=n.select(o).on(u!=null?"touchmove.drag-"+u:"mousemove.drag",p).on(u!=null?"touchend.drag-"+u:"mouseup.drag",d,!0);t?(a=t.apply(r,arguments),a=[a.x-f[0],a.y-f[1]]):a=[0,0],u==null&&ht(),i({type:"dragstart"})}var e=dt(r,"drag","dragstart","dragend"),t=null;return r.origin=function(e){return arguments.length?(t=e,r):t},n.rebind(r,e,"on")},n.behavior.zoom=function(){function p(){this.on("mousedown.zoom",w).on("mousemove.zoom",S).on(vi+".zoom",E).on("dblclick.zoom",x).on("touchstart.zoom",T).on("touchmove.zoom",N).on("touchend.zoom",T)}function d(t){return[(t[0]-e[0])/r,(t[1]-e[1])/r]}function v(t){return[t[0]*r+e[0],t[1]*r+e[1]]}function m(e){r=Math.max(s[0],Math.min(s[1],e))}function g(t,n){n=v(n),e[0]+=t[0]-n[0],e[1]+=t[1]-n[1]}function y(){f&&f.domain(a.range().map(function(t){return(t-e[0])/r}).map(a.invert)),c&&c.domain(l.range().map(function(t){return(t-e[1])/r}).map(l.invert))}function b(t){y(),n.event.preventDefault(),t({type:"zoom",scale:r,translate:e})}function w(){function f(){i=1,g(n.mouse(e),a),b(t)}function l(){i&&ht(),s.on("mousemove.zoom",null).on("mouseup.zoom",null),i&&n.event.target===r&&s.on("click.zoom",c,!0)}function c(){ht(),s.on("click.zoom",null)}var e=this,t=u.of(e,arguments),r=n.event.target,i=0,s=n.select(o).on("mousemove.zoom",f).on("mouseup.zoom",l),a=d(n.mouse(e));o.focus(),ht()}function E(){t||(t=d(n.mouse(this))),m(Math.pow(2,di()*.002)*r),g(n.mouse(this),t),b(u.of(this,arguments))}function S(){t=null}function x(){var e=n.mouse(this),t=d(e),i=Math.log(r)/Math.LN2;m(Math.pow(2,n.event.shiftKey?Math.ceil(i)-1:Math.floor(i)+1)),g(e,t),b(u.of(this,arguments))}function T(){var e=n.touches(this),s=Date.now();i=r,t={},e.forEach(function(e){t[e.identifier]=d(e)}),ht();if(e.length===1){if(s-h<500){var o=e[0],a=d(e[0]);m(r*2),g(o,a),b(u.of(this,arguments))}h=s}}function N(){var e=n.touches(this),r=e[0],s=t[r.identifier];if(o=e[1]){var o,a=t[o.identifier];r=[(r[0]+o[0])/2,(r[1]+o[1])/2],s=[(s[0]+a[0])/2,(s[1]+a[1])/2],m(n.event.scale*i)}g(r,s),h=null,b(u.of(this,arguments))}var e=[0,0],t,r=1,i,s=pi,u=dt(p,"zoom"),a,f,l,c,h;return p.translate=function(t){return arguments.length?(e=t.map(Number),y(),p):e},p.scale=function(e){return arguments.length?(r=+e,y(),p):r},p.scaleExtent=function(e){return arguments.length?(s=e==null?pi:e.map(Number),p):s},p.x=function(t){return arguments.length?(f=t,a=t.copy(),e=[0,0],r=1,p):f},p.y=function(t){return arguments.length?(c=t,l=t.copy(),e=[0,0],r=1,p):c},n.rebind(p,u,"on")};var pi=[0,Infinity],di,vi="onwheel"in document?(di=function(){return-n.event.deltaY*(n.event.deltaMode?120:1)},"wheel"):"onmousewheel"in document?(di=function(){return n.event.wheelDelta},"mousewheel"):(di=function(){return-n.event.detail},"MozMousePixelScroll");n.layout={},n.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r)t.push(mi(e[n]));return t}},n.layout.chord=function(){function c(){var t={},c=[],p=n.range(o),d=[],v,m,g,y,b;r=[],i=[],v=0,y=-1;while(++y<o){m=0,b=-1;while(++b<o)m+=s[y][b];c.push(m),d.push(n.range(o)),v+=m}a&&p.sort(function(e,t){return a(c[e],c[t])}),f&&d.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),v=(2*e-u*o)/v,m=0,y=-1;while(++y<o){g=m,b=-1;while(++b<o){var w=p[y],E=d[w][b],S=s[w][E],x=m,T=m+=S*v;t[w+"-"+E]={index:w,subindex:E,startAngle:x,endAngle:T,value:S}}i[w]={index:w,startAngle:g,endAngle:m,value:(m-g)/v},m+=u}y=-1;while(++y<o){b=y-1;while(++b<o){var N=t[y+"-"+b],C=t[b+"-"+y];(N.value||C.value)&&r.push(N.value<C.value?{source:C,target:N}:{source:N,target:C})}}l&&h()}function h(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var t={},r,i,s,o,u=0,a,f,l;return t.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,t):s},t.padding=function(e){return arguments.length?(u=e,r=i=null,t):u},t.sortGroups=function(e){return arguments.length?(a=e,r=i=null,t):a},t.sortSubgroups=function(e){return arguments.length?(f=e,r=null,t):f},t.sortChords=function(e){return arguments.length?(l=e,r&&h(),t):l},t.chords=function(){return r||c(),r},t.groups=function(){return i||c(),i},t},n.layout.force=function(){function g(e){return function(t,n,r,i){if(t.point!==e){var s=t.cx-e.x,o=t.cy-e.y,u=1/Math.sqrt(s*s+o*o);if((i-n)*u<c){var a=t.charge*u*u;return e.px-=s*a,e.py-=o*a,!0}if(t.point&&isFinite(u)){var a=t.pointCharge*u*u;e.px-=s*a,e.py-=o*a}}return!t.charge}}function y(t){t.px=n.event.x,t.py=n.event.y,e.resume()}var e={},t=n.dispatch("start","tick","end"),r=[1,1],i,s,o=.9,u=Ti,a=Ni,f=-30,l=.1,c=.8,h=[],p=[],d,v,m;return e.tick=function(){if((s*=.99)<.005)return t.end({type:"end",alpha:s=0}),!0;var e=h.length,i=p.length,u,a,c,y,b,w,E,S,x;for(a=0;a<i;++a){c=p[a],y=c.source,b=c.target,S=b.x-y.x,x=b.y-y.y;if(w=S*S+x*x)w=s*v[a]*((w=Math.sqrt(w))-d[a])/w,S*=w,x*=w,b.x-=S*(E=y.weight/(b.weight+y.weight)),b.y-=x*E,y.x+=S*(E=1-E),y.y+=x*E}if(E=s*l){S=r[0]/2,x=r[1]/2,a=-1;if(E)while(++a<e)c=h[a],c.x+=(S-c.x)*E,c.y+=(x-c.y)*E}if(f){xi(u=n.geom.quadtree(h),s,m),a=-1;while(++a<e)(c=h[a]).fixed||u.visit(g(c))}a=-1;while(++a<e)c=h[a],c.fixed?(c.x=c.px,c.y=c.py):(c.x-=(c.px-(c.px=c.x))*o,c.y-=(c.py-(c.py=c.y))*o);t.tick({type:"tick",alpha:s})},e.nodes=function(t){return arguments.length?(h=t,e):h},e.links=function(t){return arguments.length?(p=t,e):p},e.size=function(t){return arguments.length?(r=t,e):r},e.linkDistance=function(t){return arguments.length?(u=typeof t=="function"?t:+t,e):u},e.distance=e.linkDistance,e.linkStrength=function(t){return arguments.length?(a=typeof t=="function"?t:+t,e):a},e.friction=function(t){return arguments.length?(o=+t,e):o},e.charge=function(t){return arguments.length?(f=typeof t=="function"?t:+t,e):f},e.gravity=function(t){return arguments.length?(l=+t,e):l},e.theta=function(t){return arguments.length?(c=+t,e):c},e.alpha=function(r){return arguments.length?(r=+r,s?r>0?s=r:s=0:r>0&&(t.start({type:"start",alpha:s=r}),n.timer(e.tick)),e):s},e.start=function(){function y(e,n){var r=b(t),i=-1,s=r.length,o;while(++i<s)if(!isNaN(o=r[i][e]))return o;return Math.random()*n}function b(){if(!c){c=[];for(n=0;n<i;++n)c[n]=[];for(n=0;n<s;++n){var e=p[n];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}return c[t]}var t,n,i=h.length,s=p.length,o=r[0],l=r[1],c,g;for(t=0;t<i;++t)(g=h[t]).index=t,g.weight=0;for(t=0;t<s;++t)g=p[t],typeof g.source=="number"&&(g.source=h[g.source]),typeof g.target=="number"&&(g.target=h[g.target]),++g.source.weight,++g.target.weight;for(t=0;t<i;++t)g=h[t],isNaN(g.x)&&(g.x=y("x",o)),isNaN(g.y)&&(g.y=y("y",l)),isNaN(g.px)&&(g.px=g.x),isNaN(g.py)&&(g.py=g.y);d=[];if(typeof u=="function")for(t=0;t<s;++t)d[t]=+u.call(this,p[t],t);else for(t=0;t<s;++t)d[t]=u;v=[];if(typeof a=="function")for(t=0;t<s;++t)v[t]=+a.call(this,p[t],t);else for(t=0;t<s;++t)v[t]=a;m=[];if(typeof f=="function")for(t=0;t<i;++t)m[t]=+f.call(this,h[t],t);else for(t=0;t<i;++t)m[t]=f;return e.resume()},e.resume=function(){return e.alpha(.1)},e.stop=function(){return e.alpha(0)},e.drag=function(){i||(i=n.behavior.drag().origin(T).on("dragstart.force",bi).on("drag.force",y).on("dragend.force",wi));if(!arguments.length)return i;this.on("mouseover.force",Ei).on("mouseout.force",Si).call(i)},n.rebind(e,t,"on")};var Ti=20,Ni=1;n.layout.partition=function(){function r(e,t,n,i){var s=e.children;e.x=t,e.y=e.depth*i,e.dx=n,e.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;n=e.value?n/e.value:0;while(++o<u)r(a=s[o],t,f=a.value*n,i),t+=f}}function i(e){var t=e.children,n=0;if(t&&(s=t.length)){var r=-1,s;while(++r<s)n=Math.max(n,i(t[r]))}return 1+n}function s(n,s){var o=e.call(this,n,s);return r(o[0],0,t[0],t[1]/i(o[0])),o}var e=n.layout.hierarchy(),t=[1,1];return s.size=function(e){return arguments.length?(t=e,s):t},qi(s,e)},n.layout.pie=function(){function o(e){var u=e.map(function(e,n){return+t.call(o,e,n)}),a=+(typeof i=="function"?i.apply(this,arguments):i),f=((typeof s=="function"?s.apply(this,arguments):s)-i)/n.sum(u),l=n.range(e.length);r!=null&&l.sort(r===Ci?function(e,t){return u[t]-u[e]}:function(t,n){return r(e[t],e[n])});var c=[];return l.forEach(function(t){var n;c[t]={data:e[t],value:n=u[t],startAngle:a,endAngle:a+=n*f}}),c}var t=Number,r=Ci,i=0,s=2*e;return o.value=function(e){return arguments.length?(t=e,o):t},o.sort=function(e){return arguments.length?(r=e,o):r},o.startAngle=function(e){return arguments.length?(i=e,o):i},o.endAngle=function(e){return arguments.length?(s=e,o):s},o};var Ci={};n.layout.stack=function(){function u(a,f){var l=a.map(function(t,n){return e.call(u,t,n)}),c=l.map(function(e){return e.map(function(e,t){return[s.call(u,e,t),o.call(u,e,t)]})}),h=t.call(u,c,f);l=n.permute(l,h),c=n.permute(c,h);var p=r.call(u,c,f),d=l.length,v=l[0].length,m,g,y;for(g=0;g<v;++g){i.call(u,l[0][g],y=p[g],c[0][g][1]);for(m=1;m<d;++m)i.call(u,l[m][g],y+=c[m-1][g][1],c[m][g][1])}return a}var e=T,t=_i,r=Di,i=Ai,s=ki,o=Li;return u.values=function(t){return arguments.length?(e=t,u):e},u.order=function(e){return arguments.length?(t=typeof e=="function"?e:Oi.get(e)||_i,u):t},u.offset=function(e){return arguments.length?(r=typeof e=="function"?e:Mi.get(e)||Di,u):r},u.x=function(e){return arguments.length?(s=e,u):s},u.y=function(e){return arguments.length?(o=e,u):o},u.out=function(e){return arguments.length?(i=e,u):i},u};var Oi=n.map({"inside-out":function(e){var t=e.length,r,i,s=e.map(Pi),o=e.map(Hi),u=n.range(t).sort(function(e,t){return s[e]-s[t]}),a=0,f=0,l=[],c=[];for(r=0;r<t;++r)i=u[r],a<f?(a+=o[i],l.push(i)):(f+=o[i],c.push(i));return c.reverse().concat(l)},reverse:function(e){return n.range(e.length).reverse()},"default":_i}),Mi=n.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i,s,o,u,a,f,l,c,h,p=[];p[0]=c=h=0;for(s=1;s<r;++s){for(i=0,u=0;i<t;++i)u+=e[i][s][1];for(i=0,a=0,l=n[s][0]-n[s-1][0];i<t;++i){for(o=0,f=(e[i][s][1]-e[i][s-1][1])/(2*l);o<i;++o)f+=(e[o][s][1]-e[o][s-1][1])/l;a+=f*e[i][s][1]}p[s]=c-=u?a/u*l:0,c<h&&(h=c)}for(s=0;s<r;++s)p[s]-=h;return p},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:Di});n.layout.histogram=function(){function s(s,o){var u=[],a=s.map(t,this),f=r.call(this,a,o),l=i.call(this,f,a,o),c,o=-1,h=a.length,p=l.length-1,d=e?1:1/h,v;while(++o<p)c=u[o]=[],c.dx=l[o+1]-(c.x=l[o]),c.y=0;if(p>0){o=-1;while(++o<h)v=a[o],v>=f[0]&&v<=f[1]&&(c=u[n.bisect(l,v,1,p)-1],c.y+=d,c.push(s[o]))}return u}var e=!0,t=Number,r=Ii,i=ji;return s.value=function(e){return arguments.length?(t=e,s):t},s.range=function(e){return arguments.length?(r=C(e),s):r},s.bins=function(e){return arguments.length?(i=typeof e=="number"?function(t){return Fi(t,e)}:C(e),s):i},s.frequency=function(t){return arguments.length?(e=!!t,s):e},s},n.layout.hierarchy=function(){function r(i,o,u){var a=t.call(s,i,o);i.depth=o,u.push(i);if(a&&(l=a.length)){var f=-1,l,c=i.children=[],h=0,p=o+1,d;while(++f<l)d=r(a[f],p,u),d.parent=i,c.push(d),h+=d.value;e&&c.sort(e),n&&(i.value=h)}else n&&(i.value=+n.call(s,i,o)||0);return i}function i(e,t){var r=e.children,o=0;if(r&&(a=r.length)){var u=-1,a,f=t+1;while(++u<a)o+=i(r[u],f)}else n&&(o=+n.call(s,e,t)||0);return n&&(e.value=o),o}function s(e){var t=[];return r(e,0,t),t}var e=zi,t=Ri,n=Ui;return s.sort=function(t){return arguments.length?(e=t,s):e},s.children=function(e){return arguments.length?(t=e,s):t},s.value=function(e){return arguments.length?(n=e,s):n},s.revalue=function(e){return i(e,0),e},s},n.layout.pack=function(){function i(n,i){var s=e.call(this,n,i),o=s[0];o.x=0,o.y=0,cs(o,function(e){e.r=Math.sqrt(e.value)}),cs(o,Ki);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(t>0){var l=t*f/2;cs(o,function(e){e.r+=l}),cs(o,Ki),cs(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return Yi(o,u/2,a/2,1/f),s}var e=n.layout.hierarchy().sort(Xi),t=0,r=[1,1];return i.size=function(e){return arguments.length?(r=e,i):r},i.padding=function(e){return arguments.length?(t=+e,i):t},qi(i,e)},n.layout.cluster=function(){function i(n,i){var s=e.call(this,n,i),o=s[0],u,a=0;cs(o,function(e){var n=e.children;n&&n.length?(e.x=ts(n),e.y=es(n)):(e.x=u?a+=t(e,u):0,e.y=0,u=e)});var f=ns(o),l=rs(o),c=f.x-t(f,l)/2,h=l.x+t(l,f)/2;return cs(o,function(e){e.x=(e.x-c)/(h-c)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var e=n.layout.hierarchy().sort(null).value(null),t=is,r=[1,1];return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(e){return arguments.length?(r=e,i):r},qi(i,e)},n.layout.tree=function(){function i(n,i){function u(e,n){var r=e.children,i=e._tree;if(r&&(s=r.length)){var s,o=r[0],a,l=o,c,h=-1;while(++h<s)c=r[h],u(c,a),l=f(c,a,l),a=c;hs(e);var p=.5*(o._tree.prelim+c._tree.prelim);n?(i.prelim=n._tree.prelim+t(e,n),i.mod=i.prelim-p):i.prelim=p}else n&&(i.prelim=n._tree.prelim+t(e,n))}function a(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)a(n[r],t)}}function f(e,n,r){if(n){var i=e,s=e,o=n,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=os(o),i=ss(i),o&&i)u=ss(u),s=os(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+t(o,i),h>0&&(ps(ds(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!os(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!ss(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var s=e.call(this,n,i),o=s[0];cs(o,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),u(o),a(o,-o._tree.prelim);var l=us(o,fs),c=us(o,as),h=us(o,ls),p=l.x-t(l,c)/2,d=c.x+t(c,l)/2,v=h.depth||1;return cs(o,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),s}var e=n.layout.hierarchy().sort(null).value(null),t=is,r=[1,1];return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(e){return arguments.length?(r=e,i):r},qi(i,e)},n.layout.treemap=function(){function l(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function c(e){var t=e.children;if(t&&t.length){var n=s(e),r=[],i=t.slice(),o,u=Infinity,f,h=a==="slice"?n.dx:a==="dice"?n.dy:a==="slice-dice"?e.depth&1?n.dy:n.dx:Math.min(n.dx,n.dy),v;l(i,n.dx*n.dy/e.value),r.area=0;while((v=i.length)>0)r.push(o=i[v-1]),r.area+=o.area,a!=="squarify"||(f=p(r,h))<=u?(i.pop(),u=f):(r.area-=r.pop().area,d(r,h,n,!1),h=Math.min(n.dx,n.dy),r.length=r.area=0,u=Infinity);r.length&&(d(r,h,n,!0),r.length=r.area=0),t.forEach(c)}}function h(e){var t=e.children;if(t&&t.length){var n=s(e),r=t.slice(),i,o=[];l(r,n.dx*n.dy/e.value),o.area=0;while(i=r.pop())o.push(i),o.area+=i.area,i.z!=null&&(d(o,i.z?n.dx:n.dy,n,!r.length),o.length=o.area=0);t.forEach(h)}}function p(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*f/n,n/(t*s*f)):Infinity}function d(e,n,r,i){var s=-1,o=e.length,u=r.x,a=r.y,f=n?t(e.area/n):0,l;if(n==r.dx){if(i||f>r.dy)f=r.dy;while(++s<o)l=e[s],l.x=u,l.y=a,l.dy=f,u+=l.dx=Math.min(r.x+r.dx-u,f?t(l.area/f):0);l.z=!0,l.dx+=r.x+r.dx-u,r.y+=f,r.dy-=f}else{if(i||f>r.dx)f=r.dx;while(++s<o)l=e[s],l.x=u,l.y=a,l.dx=f,a+=l.dy=Math.min(r.y+r.dy-a,f?t(l.area/f):0);l.z=!1,l.dy+=r.y+r.dy-a,r.x+=f,r.dx-=f}}function v(t){var n=u||e(t),i=n[0];return i.x=0,i.y=0,i.dx=r[0],i.dy=r[1],u&&e.revalue(i),l([i],i.dx*i.dy/i.value),(u?h:c)(i),o&&(u=n),n}var e=n.layout.hierarchy(),t=Math.round,r=[1,1],i=null,s=vs,o=!1,u,a="squarify",f=.5*(1+Math.sqrt(5));return v.size=function(e){return arguments.length?(r=e,v):r},v.padding=function(e){function t(t){var n=e.call(v,t,t.depth);return n==null?vs(t):ms(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return ms(t,e)}if(!arguments.length)return i;var r;return s=(i=e)==null?vs:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,v},v.round=function(e){return arguments.length?(t=e?Math.round:Number,v):t!=Number},v.sticky=function(e){return arguments.length?(o=e,u=null,v):o},v.ratio=function(e){return arguments.length?(f=e,v):f},v.mode=function(e){return arguments.length?(a=e+"",v):a},qi(v,e)},n.csv=gs(",","text/csv"),n.tsv=gs("	","text/tab-separated-values"),n.geo={},n.geo.stream=function(e,t){bs.hasOwnProperty(e.type)?bs[e.type](e,t):ys(e,t)};var bs={Feature:function(e,t){ys(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,r=-1,i=n.length;while(++r<i)ys(n[r].geometry,t)}},ws={Sphere:function(e,t){t.sphere()},Point:function(e,t){var n=e.coordinates;t.point(n[0],n[1])},MultiPoint:function(e,t){var n=e.coordinates,r=-1,i=n.length,s;while(++r<i)s=n[r],t.point(s[0],s[1])},LineString:function(e,t){Es(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)Es(n[r],t,0)},Polygon:function(e,t){Ss(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,r=-1,i=n.length;while(++r<i)Ss(n[r],t)},GeometryCollection:function(e,t){var n=e.geometries,r=-1,i=n.length;while(++r<i)ys(n[r],t)}};n.geo.albersUsa=function(){function s(e){return o(e)(e)}function o(n){var s=n[0],o=n[1];return o>50?t:s<-140?r:o<21?i:e}var e=n.geo.albers(),t=n.geo.albers().rotate([160,0]).center([0,60]).parallels([55,65]),r=n.geo.albers().rotate([160,0]).center([0,20]).parallels([8,18]),i=n.geo.albers().rotate([60,0]).center([0,10]).parallels([8,18]);return s.scale=function(n){return arguments.length?(e.scale(n),t.scale(n*.6),r.scale(n),i.scale(n*1.5),s.translate(e.translate())):e.scale()},s.translate=function(n){if(!arguments.length)return e.translate();var o=e.scale(),u=n[0],a=n[1];return e.translate(n),t.translate([u-.4*o,a+.17*o]),r.translate([u-.19*o,a+.2*o]),i.translate([u+.58*o,a+.43*o]),s},s.scale(e.scale())},(n.geo.albers=function(){var e=29.5*r,t=45.5*r,n=Po(_s),s=n(e,t);return s.parallels=function(s){return arguments.length?n(e=s[0]*r,t=s[1]*r):[e*i,t*i]},s.rotate([98,0]).center([0,38]).scale(1e3)}).raw=_s;var Ds=Ro(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(n.geo.azimuthalEqualArea=function(){return Do(Ds)}).raw=Ds;var Ps=Ro(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},T);(n.geo.azimuthalEquidistant=function(){return Do(Ps)}).raw=Ps,n.geo.bounds=Hs(T),n.geo.centroid=function(e){Bs=js=Fs=Is=qs=0,n.geo.stream(e,Rs);var r;if(js&&Math.abs(r=Math.sqrt(Fs*Fs+Is*Is+qs*qs))>t)return[Math.atan2(Is,Fs)*i,Math.asin(Math.max(-1,Math.min(1,qs/r)))*i]};var Bs,js,Fs,Is,qs,Rs={sphere:function(){Bs<2&&(Bs=2,js=Fs=Is=qs=0)},point:Us,lineStart:Ws,lineEnd:Xs,polygonStart:function(){Bs<2&&(Bs=2,js=Fs=Is=qs=0),Rs.lineStart=zs},polygonEnd:function(){Rs.lineStart=Ws}};n.geo.circle=function(){function o(){var t=typeof e=="function"?e.apply(this,arguments):e,n=Bo(-t[0]*r,-t[1]*r,0).invert,o=[];return s(null,null,1,{point:function(e,t){o.push(e=n(e,t)),e[0]*=i,e[1]*=i}}),{type:"Polygon",coordinates:[o]}}var e=[0,0],t,n=6,s;return o.origin=function(t){return arguments.length?(e=t,o):e},o.angle=function(e){return arguments.length?(s=Vs((t=+e)*r,n*r),o):t},o.precision=function(e){return arguments.length?(s=Vs(t*r,(n=+e)*r),o):n},o.angle(90)};var to=Js(N,no,io);(n.geo.equirectangular=function(){return Do(uo).scale(250/e)}).raw=uo.invert=uo;var ao=Ro(function(e){return 1/e},Math.atan);(n.geo.gnomonic=function(){return Do(ao)}).raw=ao,n.geo.graticule=function(){function c(){return{type:"MultiLineString",coordinates:h()}}function h(){return n.range(Math.ceil(r/o)*o,e,o).map(a).concat(n.range(Math.ceil(s/u)*u,i,u).map(f))}var e,r,i,s,o=22.5,u=o,a,f,l=2.5;return c.lines=function(){return h().map(function(e){return{type:"LineString",coordinates:e}})},c.outline=function(){return{type:"Polygon",coordinates:[a(r).concat(f(i).slice(1),a(e).reverse().slice(1),f(s).reverse().slice(1))]}},c.extent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],s=+t[0][1],i=+t[1][1],r>e&&(t=r,r=e,e=t),s>i&&(t=s,s=i,i=t),c.precision(l)):[[r,s],[e,i]]},c.step=function(e){return arguments.length?(o=+e[0],u=+e[1],c):[o,u]},c.precision=function(t){return arguments.length?(l=+t,a=fo(s,i,l),f=lo(r,e,l),c):l},c.extent([[-180+t,-90+t],[180-t,90-t]])},n.geo.interpolate=function(e,t){return co(e[0]*r,e[1]*r,t[0]*r,t[1]*r)},n.geo.greatArc=function(){function l(){var r=t||e.apply(this,arguments),u=s||i.apply(this,arguments),a=f||n.geo.interpolate(r,u),l=0,c=o/a.distance,h=[r];while((l+=c)<1)h.push(a(l));return h.push(u),{type:"LineString",coordinates:h}}var e=a,t,i=u,s,o=6*r,f;return l.distance=function(){return(f||n.geo.interpolate(t||e.apply(this,arguments),s||i.apply(this,arguments))).distance},l.source=function(r){return arguments.length?(e=r,t=typeof r=="function"?null:r,f=t&&s?n.geo.interpolate(t,s):null,l):e},l.target=function(e){return arguments.length?(i=e,s=typeof e=="function"?null:e,f=t&&s?n.geo.interpolate(t,s):null,l):i},l.precision=function(e){return arguments.length?(o=e*r,l):o/r},l},ho.invert=function(t,n){return[2*e*t,2*Math.atan(Math.exp(2*e*n))-e/2]},(n.geo.mercator=function(){return Do(ho).scale(500)}).raw=ho;var po=Ro(function(){return 1},Math.asin);(n.geo.orthographic=function(){return Do(po)}).raw=po,n.geo.path=function(){function o(t){return t&&n.geo.stream(t,i(s.pointRadius(typeof e=="function"?+e.apply(this,arguments):e))),s.result()}var e=4.5,t,r,i,s;return o.area=function(e){return bo=0,n.geo.stream(e,i(Eo)),bo},o.centroid=function(e){return Bs=Fs=Is=qs=0,n.geo.stream(e,i(xo)),qs?[Fs/qs,Is/qs]:undefined},o.bounds=function(e){return Hs(i)(e)},o.projection=function(e){return arguments.length?(i=(t=e)?e.stream||mo(e):T,o):t},o.context=function(e){return arguments.length?(s=(r=e)==null?new go:new yo(e),o):r},o.pointRadius=function(t){return arguments.length?(e=typeof t=="function"?t:+t,o):e},o.projection(n.geo.albersUsa()).context(null)};var bo,wo,Eo={point:zn,lineStart:zn,lineEnd:zn,polygonStart:function(){wo=0,Eo.lineStart=So},polygonEnd:function(){Eo.lineStart=Eo.lineEnd=Eo.point=zn,bo+=Math.abs(wo/2)}},xo={point:To,lineStart:No,lineEnd:Co,polygonStart:function(){xo.lineStart=ko},polygonEnd:function(){xo.point=To,xo.lineStart=No,xo.lineEnd=Co}};n.geo.area=function(e){return Lo=0,n.geo.stream(e,Mo),Lo};var Lo,Ao,Oo,Mo={sphere:function(){Lo+=4*e},point:zn,lineStart:zn,lineEnd:zn,polygonStart:function(){Ao=1,Oo=0,Mo.lineStart=_o},polygonEnd:function(){var t=2*Math.atan2(Oo,Ao);Lo+=t<0?4*e+t:t,Mo.lineStart=Mo.lineEnd=Mo.point=zn}};n.geo.projection=Do,n.geo.projectionMutator=Po;var qo=Ro(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(n.geo.stereographic=function(){return Do(qo)}).raw=qo,n.geom={},n.geom.hull=function(e){if(e.length<3)return[];var t=e.length,n=t-1,r=[],i=[],s,o,u=0,a,f,l,c,h,p,d,v;for(s=1;s<t;++s)e[s][1]<e[u][1]?u=s:e[s][1]==e[u][1]&&(u=e[s][0]<e[u][0]?s:u);for(s=0;s<t;++s){if(s===u)continue;f=e[s][1]-e[u][1],a=e[s][0]-e[u][0],r.push({angle:Math.atan2(f,a),index:s})}r.sort(function(e,t){return e.angle-t.angle}),d=r[0].angle,p=r[0].index,h=0;for(s=1;s<n;++s)o=r[s].index,d==r[s].angle?(a=e[p][0]-e[u][0],f=e[p][1]-e[u][1],l=e[o][0]-e[u][0],c=e[o][1]-e[u][1],a*a+f*f>=l*l+c*c?r[s].index=-1:(r[h].index=-1,d=r[s].angle,h=s,p=o)):(d=r[s].angle,h=s,p=o);i.push(u);for(s=0,o=0;s<2;++o)r[o].index!==-1&&(i.push(r[o].index),s++);v=i.length;for(;o<n;++o){if(r[o].index===-1)continue;while(!Uo(i[v-2],i[v-1],r[o].index,e))--v;i[v++]=r[o].index}var m=[];for(s=0;s<v;++s)m.push(e[i[s]]);return m},n.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r*.5},e.centroid=function(t){var n=-1,r=e.length,i=0,s=0,o,u=e[r-1],a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=u,u=e[n],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var n,r=-1,i=e.length,s,o,u=e[i-1],a,f,l;while(++r<i){n=t.slice(),t.length=0,a=e[r],f=n[(o=n.length)-1],s=-1;while(++s<o)l=n[s],zo(l,u,a)?(zo(f,u,a)||t.push(Wo(f,l,u,a)),t.push(l)):zo(f,u,a)&&t.push(Wo(f,l,u,a)),f=l;u=a}return t},e},n.geom.voronoi=function(e){var r=e.map(function(){return[]}),i=1e6;return Vo(e,function(e){var t,n,s,o,u,a;e.a===1&&e.b>=0?(t=e.ep.r,n=e.ep.l):(t=e.ep.l,n=e.ep.r),e.a===1?(u=t?t.y:-i,s=e.c-e.b*u,a=n?n.y:i,o=e.c-e.b*a):(s=t?t.x:-i,u=e.c-e.a*s,o=n?n.x:i,a=e.c-e.a*o);var f=[s,u],l=[o,a];r[e.region.l.index].push(f,l),r[e.region.r.index].push(f,l)}),r=r.map(function(r,i){var s=e[i][0],o=e[i][1],u=r.map(function(e){return Math.atan2(e[0]-s,e[1]-o)}),a=n.range(r.length).sort(function(e,t){return u[e]-u[t]});return a.filter(function(e,n){return!n||u[e]-u[a[n-1]]>t}).map(function(e){return r[e]})}),r.forEach(function(n,r){var s=n.length;if(!s)return n.push([-i,-i],[-i,i],[i,i],[i,-i]);if(s>2)return;var o=e[r],u=n[0],a=n[1],f=o[0],l=o[1],c=u[0],h=u[1],p=a[0],d=a[1],v=Math.abs(p-c),m=d-h;if(Math.abs(m)<t){var g=l<h?-i:i;n.push([-i,g],[i,g])}else if(v<t){var y=f<c?-i:i;n.push([y,-i],[y,i])}else{var g=(p-c)*(h-l)<(c-f)*(d-h)?i:-i,b=Math.abs(m)-v;Math.abs(b)<t?n.push([m<0?g:-g,g]):(b>0&&(g*=-1),n.push([-i,g],[i,g]))}}),r};var Xo={l:"r",r:"l"};n.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return Vo(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},n.geom.quadtree=function(e,t,n,r,i){function l(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y))return;if(e.leaf){var o=e.point;o?Math.abs(o.x-t.x)+Math.abs(o.y-t.y)<.01?c(e,t,n,r,i,s):(e.point=null,c(e,o,n,r,i,s),c(e,t,n,r,i,s)):e.point=t}else c(e,t,n,r,i,s)}function c(e,t,n,r,i,s){var o=(n+i)*.5,u=(r+s)*.5,a=t.x>=o,f=t.y>=u,c=(f<<1)+a;e.leaf=!1,e=e.nodes[c]||(e.nodes[c]=$o()),a?n=o:i=o,f?r=u:s=u,l(e,t,n,r,i,s)}var s,o=-1,u=e.length;if(arguments.length<5)if(arguments.length===3)i=n,r=t,n=t=0;else{t=n=Infinity,r=i=-Infinity;while(++o<u)s=e[o],s.x<t&&(t=s.x),s.y<n&&(n=s.y),s.x>r&&(r=s.x),s.y>i&&(i=s.y)}var a=r-t,f=i-n;a>f?i=n+a:r=t+f;var h=$o();return h.add=function(e){l(h,e,t,n,r,i)},h.visit=function(e){Jo(e,h,t,n,r,i)},e.forEach(h.add),h},n.time={};var Ko=Date,Qo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Go.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Yo.setUTCDate.apply(this._,arguments)},setDay:function(){Yo.setUTCDay.apply(this._,arguments)},setFullYear:function(){Yo.setUTCFullYear.apply(this._,arguments)},setHours:function(){Yo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Yo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Yo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Yo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Yo.setUTCSeconds.apply(this._,arguments)},setTime:function(){Yo.setTime.apply(this._,arguments)}};var Yo=Date.prototype,Zo="%a %b %e %X %Y",eu="%m/%d/%Y",tu="%H:%M:%S",nu=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ru=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],iu=["January","February","March","April","May","June","July","August","September","October","November","December"],su=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.time.format=function(e){function n(n){var r=[],i=-1,s=0,o,u,a;while(++i<t)if(e.charCodeAt(i)===37){r.push(e.substring(s,i)),(u=mu[o=e.charAt(++i)])!=null&&(o=e.charAt(++i));if(a=gu[o])o=a(n,u==null?o==="e"?" ":"0":u);r.push(o),s=i+1}return r.push(e.substring(s,i)),r.join("")}var t=e.length;return n.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=ou(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+n.p*12);var i=new Ko;return i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},n.toString=function(){return e},n};var lu=uu(nu),cu=uu(ru),hu=uu(iu),pu=au(iu),du=uu(su),vu=au(su),mu={"-":"",_:" ",0:"0"},gu={a:function(e){return ru[e.getDay()]},A:function(e){return nu[e.getDay()]},b:function(e){return su[e.getMonth()]},B:function(e){return iu[e.getMonth()]},c:n.time.format(Zo),d:function(e,t){return fu(e.getDate(),t,2)},e:function(e,t){return fu(e.getDate(),t,2)},H:function(e,t){return fu(e.getHours(),t,2)},I:function(e,t){return fu(e.getHours()%12||12,t,2)},j:function(e,t){return fu(1+n.time.dayOfYear(e),t,3)},L:function(e,t){return fu(e.getMilliseconds(),t,3)},m:function(e,t){return fu(e.getMonth()+1,t,2)},M:function(e,t){return fu(e.getMinutes(),t,2)},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e,t){return fu(e.getSeconds(),t,2)},U:function(e,t){return fu(n.time.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return fu(n.time.mondayOfYear(e),t,2)},x:n.time.format(eu),X:n.time.format(tu),y:function(e,t){return fu(e.getFullYear()%100,t,2)},Y:function(e,t){return fu(e.getFullYear()%1e4,t,4)},Z:Fu,"%":function(){return"%"}},yu={a:bu,A:wu,b:Eu,B:Su,c:xu,d:Ou,e:Ou,H:Mu,I:Mu,L:Pu,m:Au,M:_u,p:Bu,S:Du,x:Tu,X:Nu,y:ku,Y:Cu},Hu=/^\s*\d+/,ju=n.map({am:0,pm:1});n.time.format.utc=function(e){function r(e){try{Ko=Go;var n=new Ko;return n._=e,t(n)}finally{Ko=Date}}var t=n.time.format(e);return r.parse=function(e){try{Ko=Go;var n=t.parse(e);return n&&n._}finally{Ko=Date}},r.toString=t.toString,r};var Iu=n.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");n.time.format.iso=Date.prototype.toISOString?qu:Iu,qu.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},qu.toString=Iu.toString,n.time.second=Ru(function(e){return new Ko(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()}),n.time.seconds=n.time.second.range,n.time.seconds.utc=n.time.second.utc.range,n.time.minute=Ru(function(e){return new Ko(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()}),n.time.minutes=n.time.minute.range,n.time.minutes.utc=n.time.minute.utc.range,n.time.hour=Ru(function(e){var t=e.getTimezoneOffset()/60;return new Ko((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()}),n.time.hours=n.time.hour.range,n.time.hours.utc=n.time.hour.utc.range,n.time.day=Ru(function(e){var t=new Ko(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),n.time.days=n.time.day.range,n.time.days.utc=n.time.day.utc.range,n.time.dayOfYear=function(e){var t=n.time.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)},Qo.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var r=n.time[e]=Ru(function(e){return(e=n.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var r=n.time.year(e).getDay();return Math.floor((n.time.dayOfYear(e)+(r+t)%7)/7)-(r!==t)});n.time[e+"s"]=r.range,n.time[e+"s"].utc=r.utc.range,n.time[e+"OfYear"]=function(e){var r=n.time.year(e).getDay();return Math.floor((n.time.dayOfYear(e)+(r+t)%7)/7)}}),n.time.week=n.time.sunday,n.time.weeks=n.time.sunday.range,n.time.weeks.utc=n.time.sunday.utc.range,n.time.weekOfYear=n.time.sundayOfYear,n.time.month=Ru(function(e){return e=n.time.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),n.time.months=n.time.month.range,n.time.months.utc=n.time.month.utc.range,n.time.year=Ru(function(e){return e=n.time.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),n.time.years=n.time.year.range,n.time.years.utc=n.time.year.utc.range;var Ku=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Qu=[[n.time.second,1],[n.time.second,5],[n.time.second,15],[n.time.second,30],[n.time.minute,1],[n.time.minute,5],[n.time.minute,15],[n.time.minute,30],[n.time.hour,1],[n.time.hour,3],[n.time.hour,6],[n.time.hour,12],[n.time.day,1],[n.time.day,2],[n.time.week,1],[n.time.month,1],[n.time.month,3],[n.time.year,1]],Gu=[[n.time.format("%Y"),N],[n.time.format("%B"),function(e){return e.getMonth()}],[n.time.format("%b %d"),function(e){return e.getDate()!=1}],[n.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1}],[n.time.format("%I %p"),function(e){return e.getHours()}],[n.time.format("%I:%M"),function(e){return e.getMinutes()}],[n.time.format(":%S"),function(e){return e.getSeconds()}],[n.time.format(".%L"),function(e){return e.getMilliseconds()}]],Yu=n.scale.linear(),Zu=Vu(Gu);Qu.year=function(e,t){return Yu.domain(e.map(Ju)).ticks(t).map($u)},n.time.scale=function(){return zu(n.scale.linear(),Qu,Zu)};var ea=Qu.map(function(e){return[e[0].utc,e[1]]}),ta=[[n.time.format.utc("%Y"),N],[n.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[n.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1}],[n.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],[n.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[n.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[n.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[n.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],na=Vu(ta);return ea.year=function(e,t){return Yu.domain(e.map(ia)).ticks(t).map(ra)},n.time.scale.utc=function(){return zu(n.scale.linear(),ea,na)},n}(),define("d3",function(e){return function(){var t,n;return t||e.d3}}(this)),function(e){"use strict";e.URL=e.URL||e.webkitURL;if(e.Blob&&e.URL)try{new Blob;return}catch(t){}var n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},r=function(t,n,r){this.data=t,this.size=t.length,this.type=n,this.encoding=r},i=n.prototype,s=r.prototype,o=e.FileReaderSync,u=function(e){this.code=this[this.name=e]},a="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),f=a.length,l=e.URL||e.webkitURL||e,c=l.createObjectURL,h=l.revokeObjectURL,p=l,d=e.btoa,v=e.atob,m=e.ArrayBuffer,g=e.Uint8Array;r.fake=s.fake=!0;while(f--)u.prototype[a[f]]=f+1;return l.createObjectURL||(p=e.URL={}),p.createObjectURL=function(e){var t=e.type,n;t===null&&(t="application/octet-stream");if(e instanceof r)return n="data:"+t,e.encoding==="base64"?n+";base64,"+e.data:e.encoding==="URI"?n+","+decodeURIComponent(e.data):d?n+";base64,"+d(e.data):n+","+encodeURIComponent(e.data);if(c)return c.call(l,e)},p.revokeObjectURL=function(e){e.substring(0,5)!=="data:"&&h&&h.call(l,e)},i.append=function(e){var n=this.data;if(g&&(e instanceof m||e instanceof g)){var i="",s=new g(e),a=0,f=s.length;for(;a<f;a++)i+=String.fromCharCode(s[a]);n.push(i)}else if(t(e)==="Blob"||t(e)==="File"){if(!o)throw new u("NOT_READABLE_ERR");var l=new o;n.push(l.readAsBinaryString(e))}else e instanceof r?e.encoding==="base64"&&v?n.push(v(e.data)):e.encoding==="URI"?n.push(decodeURIComponent(e.data)):e.encoding==="raw"&&n.push(e.data):(typeof e!="string"&&(e+=""),n.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new r(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},s.slice=function(e,t,n){var i=arguments.length;return i<3&&(n=null),new r(this.data.slice(e,i>1?t:this.data.length),n,this.encoding)},s.toString=function(){return"[object Blob]"},s.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(t,r){var i=r?r.type||"":"",s=new n;if(t)for(var o=0,u=t.length;o<u;o++)s.append(t[o]);return s.getBlob(i)}}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content||this),define("blob",function(e){return function(){var t,n;return t||e.Blob}}(this));var saveAs=saveAs||typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if(typeof navigator!="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent))return;var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i=!e.externalHost&&"download"in r,s=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(r)},o=e.webkitRequestFileSystem,u=e.requestFileSystem||o||e.mozRequestFileSystem,a=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f="application/octet-stream",l=0,c=[],h=function(){var e=c.length;while(e--){var t=c[e];typeof t=="string"?n().revokeObjectURL(t):t.remove()}c.length=0},p=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var i=e["on"+t[r]];if(typeof i=="function")try{i.call(e,n||e)}catch(s){a(s)}}},d=function(t,a){var h=this,d=t.type,v=!1,m,g,y=function(){var e=n().createObjectURL(t);return c.push(e),e},b=function(){p(h,"writestart progress write writeend".split(" "))},w=function(){if(v||!m)m=y(t);g?g.location.href=m:window.open(m,"_blank"),h.readyState=h.DONE,b()},E=function(e){return function(){if(h.readyState!==h.DONE)return e.apply(this,arguments)}},S={create:!0,exclusive:!1},x;h.readyState=h.INIT,a||(a="download");if(i){m=y(t),r.href=m,r.download=a,s(r),h.readyState=h.DONE,b();return}e.chrome&&d&&d!==f&&(x=t.slice||t.webkitSlice,t=x.call(t,0,t.size,f),v=!0),o&&a!=="download"&&(a+=".download");if(d===f||o)g=e;if(!u){w();return}l+=t.size,u(e.TEMPORARY,l,E(function(e){e.root.getDirectory("saved",S,E(function(e){var n=function(){e.getFile(a,S,E(function(e){e.createWriter(E(function(n){n.onwriteend=function(t){g.location.href=e.toURL(),c.push(e),h.readyState=h.DONE,p(h,"writeend",t)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&w()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=h["on"+e]}),n.write(t),h.abort=function(){n.abort(),h.readyState=h.DONE},h.readyState=h.WRITING}),w)}),w)};e.getFile(a,{create:!1},E(function(e){e.remove(),n()}),E(function(e){e.code===e.NOT_FOUND_ERR?n():w()}))}),w)}),w)},v=d.prototype,m=function(e,t){return new d(e,t)};return v.abort=function(){var e=this;e.readyState=e.DONE,p(e,"abort")},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,e.addEventListener("unload",h,!1),m.unload=function(){h(),e.removeEventListener("unload",h,!1)},m}(typeof self!="undefined"&&self||typeof window!="undefined"&&window||this.content);typeof module!="undefined"&&module!==null?module.exports=saveAs:typeof define!="undefined"&&define!==null&&define.amd!=null&&define("filesaver",[],function(){return saveAs}),define("DQX/Model",["jquery","DQX/Utils","DQX/Msg"],function(e,t,n){var r=function(t){var r={};return r.attributes=e.extend({},t),r.id="Model_"+DQX.getNextUniqueID(),r.get=function(e){return e?r.attributes[e]:r.attributes},r.set=function(t,i){var s={};typeof t=="object"?s=t:(s={})[t]=i;var o=[];return e.each(s,function(e,t){e in r.attributes?r.attributes[e]!=t&&(r.attributes[e]=t,o.push(e)):DQX.reportError("attr "+e+" not in model")}),e.each(o,function(e,t){n.broadcast({id:r.id,change:t})}),o.length>0&&n.broadcast({id:r.id,change:!0}),o.length>0},r.on=function(t,i){n.listen("",e.extend(t,{id:r.id}),i,r)},r};return r}),DataStream=function(e,t,n){this._byteOffset=t||0,e instanceof ArrayBuffer?this.buffer=e:typeof e=="object"?(this.dataView=e,t&&(this._byteOffset+=t)):this.buffer=new ArrayBuffer(e||0),this.position=0,this.endianness=n==null?DataStream.LITTLE_ENDIAN:n},DataStream.prototype={},DataStream.prototype.save=function(e){var t=new Blob(this.buffer),n=window.webkitURL||window.URL;if(!n||!n.createObjectURL)throw"DataStream.save: Can't create object URL.";var r=n.createObjectURL(t),i=document.createElement("a");i.setAttribute("href",r),i.setAttribute("download",e),i.click(),n.revokeObjectURL(r)},DataStream.BIG_ENDIAN=!1,DataStream.LITTLE_ENDIAN=!0,DataStream.prototype._dynamicSize=!0,Object.defineProperty(DataStream.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(e){e||this._trimAlloc(),this._dynamicSize=e}}),DataStream.prototype._byteLength=0,Object.defineProperty(DataStream.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(DataStream.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(e){this._buffer=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(DataStream.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(e){this._byteOffset=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(DataStream.prototype,"dataView",{get:function(){return this._dataView},set:function(e){this._byteOffset=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+e.byteLength}}),DataStream.prototype._realloc=function(e){if(!this._dynamicSize)return;var t=this._byteOffset+this.position+e,n=this._buffer.byteLength;if(t<=n){t>this._byteLength&&(this._byteLength=t);return}n<1&&(n=1);while(t>n)n*=2;var r=new ArrayBuffer(n),i=new Uint8Array(this._buffer),s=new Uint8Array(r,0,i.length);s.set(i),this.buffer=r,this._byteLength=t},DataStream.prototype._trimAlloc=function(){if(this._byteLength==this._buffer.byteLength)return;var e=new ArrayBuffer(this._byteLength),t=new Uint8Array(e),n=new Uint8Array(this._buffer,0,t.length);t.set(n),this.buffer=e},DataStream.prototype.seek=function(e){var t=Math.max(0,Math.min(this.byteLength,e));this.position=isNaN(t)||!isFinite(t)?0:t},DataStream.prototype.isEof=function(){return this.position>=this._byteLength},DataStream.prototype.mapInt32Array=function(e,t){this._realloc(e*4);var n=new Int32Array(this._buffer,this.byteOffset+this.position,e);return DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=e*4,n},DataStream.prototype.mapInt16Array=function(e,t){this._realloc(e*2);var n=new Int16Array(this._buffer,this.byteOffset+this.position,e);return DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=e*2,n},DataStream.prototype.mapInt8Array=function(e){this._realloc(e*1);var t=new Int8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,t},DataStream.prototype.mapUint32Array=function(e,t){this._realloc(e*4);var n=new Uint32Array(this._buffer,this.byteOffset+this.position,e);return DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=e*4,n},DataStream.prototype.mapUint16Array=function(e,t){this._realloc(e*2);var n=new Uint16Array(this._buffer,this.byteOffset+this.position,e);return DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=e*2,n},DataStream.prototype.mapUint8Array=function(e){this._realloc(e*1);var t=new Uint8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,t},DataStream.prototype.mapFloat64Array=function(e,t){this._realloc(e*8);var n=new Float64Array(this._buffer,this.byteOffset+this.position,e);return DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=e*8,n},DataStream.prototype.mapFloat32Array=function(e,t){this._realloc(e*4);var n=new Float32Array(this._buffer,this.byteOffset+this.position,e);return DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=e*4,n},DataStream.prototype.readInt32Array=function(e,t){e=e==null?(this.byteLength-this.position)/4:e;var n=new Int32Array(e);return DataStream.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=n.byteLength,n},DataStream.prototype.readInt16Array=function(e,t){e=e==null?(this.byteLength-this.position)/2:e;var n=new Int16Array(e);return DataStream.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=n.byteLength,n},DataStream.prototype.readInt8Array=function(e){e=e==null?this.byteLength-this.position:e;var t=new Int8Array(e);return DataStream.memcpy(t.buffer,0,this.buffer,this.byteOffset+this.position,e*t.BYTES_PER_ELEMENT),this.position+=t.byteLength,t},DataStream.prototype.readUint32Array=function(e,t){e=e==null?(this.byteLength-this.position)/4:e;var n=new Uint32Array(e);return DataStream.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=n.byteLength,n},DataStream.prototype.readUint16Array=function(e,t){e=e==null?(this.byteLength-this.position)/2:e;var n=new Uint16Array(e);return DataStream.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=n.byteLength,n},DataStream.prototype.readUint8Array=function(e){e=e==null?this.byteLength-this.position:e;var t=new Uint8Array(e);return DataStream.memcpy(t.buffer,0,this.buffer,this.byteOffset+this.position,e*t.BYTES_PER_ELEMENT),this.position+=t.byteLength,t},DataStream.prototype.readFloat64Array=function(e,t){e=e==null?(this.byteLength-this.position)/8:e;var n=new Float64Array(e);return DataStream.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=n.byteLength,n},DataStream.prototype.readFloat32Array=function(e,t){e=e==null?(this.byteLength-this.position)/4:e;var n=new Float32Array(e);return DataStream.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),DataStream.arrayToNative(n,t==null?this.endianness:t),this.position+=n.byteLength,n},DataStream.prototype.writeInt32Array=function(e,t){this._realloc(e.length*4);if(e instanceof Int32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt32Array(e.length,t);else for(var n=0;n<e.length;n++)this.writeInt32(e[n],t)},DataStream.prototype.writeInt16Array=function(e,t){this._realloc(e.length*2);if(e instanceof Int16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt16Array(e.length,t);else for(var n=0;n<e.length;n++)this.writeInt16(e[n],t)},DataStream.prototype.writeInt8Array=function(e){this._realloc(e.length*1);if(e instanceof Int8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt8Array(e.length);else for(var t=0;t<e.length;t++)this.writeInt8(e[t])},DataStream.prototype.writeUint32Array=function(e,t){this._realloc(e.length*4);if(e instanceof Uint32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint32Array(e.length,t);else for(var n=0;n<e.length;n++)this.writeUint32(e[n],t)},DataStream.prototype.writeUint16Array=function(e,t){this._realloc(e.length*2);if(e instanceof Uint16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint16Array(e.length,t);else for(var n=0;n<e.length;n++)this.writeUint16(e[n],t)},DataStream.prototype.writeUint8Array=function(e){this._realloc(e.length*1);if(e instanceof Uint8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint8Array(e.length);else for(var t=0;t<e.length;t++)this.writeUint8(e[t])},DataStream.prototype.writeFloat64Array=function(e,t){this._realloc(e.length*8);if(e instanceof Float64Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat64Array(e.length,t);else for(var n=0;n<e.length;n++)this.writeFloat64(e[n],t)},DataStream.prototype.writeFloat32Array=function(e,t){this._realloc(e.length*4);if(e instanceof Float32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)DataStream.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat32Array(e.length,t);else for(var n=0;n<e.length;n++)this.writeFloat32(e[n],t)},DataStream.prototype.readInt32=function(e){var t=this._dataView.getInt32(this.position,e==null?this.endianness:e);return this.position+=4,t},DataStream.prototype.readInt16=function(e){var t=this._dataView.getInt16(this.position,e==null?this.endianness:e);return this.position+=2,t},DataStream.prototype.readInt8=function(){var e=this._dataView.getInt8(this.position);return this.position+=1,e},DataStream.prototype.readUint32=function(e){var t=this._dataView.getUint32(this.position,e==null?this.endianness:e);return this.position+=4,t},DataStream.prototype.readUint16=function(e){var t=this._dataView.getUint16(this.position,e==null?this.endianness:e);return this.position+=2,t},DataStream.prototype.readUint8=function(){var e=this._dataView.getUint8(this.position);return this.position+=1,e},DataStream.prototype.readFloat32=function(e){var t=this._dataView.getFloat32(this.position,e==null?this.endianness:e);return this.position+=4,t},DataStream.prototype.readFloat64=function(e){var t=this._dataView.getFloat64(this.position,e==null?this.endianness:e);return this.position+=8,t},DataStream.prototype.writeInt32=function(e,t){this._realloc(4),this._dataView.setInt32(this.position,e,t==null?this.endianness:t),this.position+=4},DataStream.prototype.writeInt16=function(e,t){this._realloc(2),this._dataView.setInt16(this.position,e,t==null?this.endianness:t),this.position+=2},DataStream.prototype.writeInt8=function(e){this._realloc(1),this._dataView.setInt8(this.position,e),this.position+=1},DataStream.prototype.writeUint32=function(e,t){this._realloc(4),this._dataView.setUint32(this.position,e,t==null?this.endianness:t),this.position+=4},DataStream.prototype.writeUint16=function(e,t){this._realloc(2),this._dataView.setUint16(this.position,e,t==null?this.endianness:t),this.position+=2},DataStream.prototype.writeUint8=function(e){this._realloc(1),this._dataView.setUint8(this.position,e),this.position+=1},DataStream.prototype.writeFloat32=function(e,t){this._realloc(4),this._dataView.setFloat32(this.position,e,t==null?this.endianness:t),this.position+=4},DataStream.prototype.writeFloat64=function(e,t){this._realloc(8),this._dataView.setFloat64(this.position,e,t==null?this.endianness:t),this.position+=8},DataStream.endianness=(new Int8Array((new Int16Array([1])).buffer))[0]>0,DataStream.memcpy=function(e,t,n,r,i){var s=new Uint8Array(e,t,i),o=new Uint8Array(n,r,i);s.set(o)},DataStream.arrayToNative=function(e,t){return t==this.endianness?e:this.flipArrayEndianness(e)},DataStream.nativeToEndian=function(e,t){return this.endianness==t?e:this.flipArrayEndianness(e)},DataStream.flipArrayEndianness=function(e){var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);for(var n=0;n<e.byteLength;n+=e.BYTES_PER_ELEMENT)for(var r=n+e.BYTES_PER_ELEMENT-1,i=n;r>i;r--,i++){var s=t[i];t[i]=t[r],t[r]=s}return e},DataStream.prototype.failurePosition=0,DataStream.prototype.readStruct=function(e){var t={},n,r,i,s=this.position;for(var o=0;o<e.length;o+=2){n=e[o+1],r=this.readType(n,t);if(r==null)return this.failurePosition==0&&(this.failurePosition=this.position),this.position=s,null;t[e[o]]=r}return t},DataStream.prototype.readUCS2String=function(e,t){return String.fromCharCode.apply(null,this.readUint16Array(e,t))},DataStream.prototype.writeUCS2String=function(e,t,n){n==null&&(n=e.length);for(var r=0;r<e.length&&r<n;r++)this.writeUint16(e.charCodeAt(r),t);for(;r<n;r++)this.writeUint16(0)},DataStream.prototype.readString=function(e,t){return t==null||t=="ASCII"?String.fromCharCode.apply(null,this.mapUint8Array(e==null?this.byteLength-this.position:e)):(new TextDecoder(t)).decode(this.mapUint8Array(e))},DataStream.prototype.writeString=function(e,t,n){if(t==null||t=="ASCII")if(n!=null){var r=0,i=Math.min(e.length,n);for(r=0;r<i;r++)this.writeUint8(e.charCodeAt(r));for(;r<n;r++)this.writeUint8(0)}else for(var r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));else this.writeUint8Array((new TextEncoder(t)).encode(e.substring(0,n)))},DataStream.prototype.readCString=function(e){var t=this.byteLength-this.position,n=new Uint8Array(this._buffer,this._byteOffset+this.position),r=t;e!=null&&(r=Math.min(e,t));for(var i=0;i<r&&n[i]!=0;i++);var s=String.fromCharCode.apply(null,this.mapUint8Array(i));return e!=null?this.position+=r-i:i!=t&&(this.position+=1),s},DataStream.prototype.writeCString=function(e,t){if(t!=null){var n=0,r=Math.min(e.length,t);for(n=0;n<r;n++)this.writeUint8(e.charCodeAt(n));for(;n<t;n++)this.writeUint8(0)}else{for(var n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));this.writeUint8(0)}},DataStream.prototype.readType=function(e,t){if(typeof e=="function")return e(this,t);if(typeof e!="object"||e instanceof Array){if(e instanceof Array&&e.length!=3)return this.readStruct(e,t);var n=null,r=null,i="ASCII",s=this.position;if(typeof e=="string"&&/:/.test(e)){var o=e.split(":");e=o[0],r=parseInt(o[1])}if(typeof e=="string"&&/,/.test(e)){var o=e.split(",");e=o[0],i=parseInt(o[1])}switch(e){case"uint8":n=this.readUint8();break;case"int8":n=this.readInt8();break;case"uint16":n=this.readUint16(this.endianness);break;case"int16":n=this.readInt16(this.endianness);break;case"uint32":n=this.readUint32(this.endianness);break;case"int32":n=this.readInt32(this.endianness);break;case"float32":n=this.readFloat32(this.endianness);break;case"float64":n=this.readFloat64(this.endianness);break;case"uint16be":n=this.readUint16(DataStream.BIG_ENDIAN);break;case"int16be":n=this.readInt16(DataStream.BIG_ENDIAN);break;case"uint32be":n=this.readUint32(DataStream.BIG_ENDIAN);break;case"int32be":n=this.readInt32(DataStream.BIG_ENDIAN);break;case"float32be":n=this.readFloat32(DataStream.BIG_ENDIAN);break;case"float64be":n=this.readFloat64(DataStream.BIG_ENDIAN);break;case"uint16le":n=this.readUint16(DataStream.LITTLE_ENDIAN);break;case"int16le":n=this.readInt16(DataStream.LITTLE_ENDIAN);break;case"uint32le":n=this.readUint32(DataStream.LITTLE_ENDIAN);break;case"int32le":n=this.readInt32(DataStream.LITTLE_ENDIAN);break;case"float32le":n=this.readFloat32(DataStream.LITTLE_ENDIAN);break;case"float64le":n=this.readFloat64(DataStream.LITTLE_ENDIAN);break;case"cstring":n=this.readCString(r);break;case"string":n=this.readString(r,i);break;case"u16string":n=this.readUCS2String(r,this.endianness);break;case"u16stringle":n=this.readUCS2String(r,DataStream.LITTLE_ENDIAN);break;case"u16stringbe":n=this.readUCS2String(r,DataStream.BIG_ENDIAN);break;default:if(e.length==3){var u=e[1],a=e[2],f=0;typeof a=="function"?f=a(t,this,e):typeof a=="string"&&t[a]!=null?f=parseInt(t[a]):f=parseInt(a);if(typeof u=="string"){var l=u.replace(/(le|be)$/,""),c=null;/le$/.test(u)?c=DataStream.LITTLE_ENDIAN:/be$/.test(u)&&(c=DataStream.BIG_ENDIAN),a=="*"&&(f=null);switch(l){case"uint8":n=this.readUint8Array(f);break;case"uint16":n=this.readUint16Array(f,c);break;case"uint32":n=this.readUint32Array(f,c);break;case"int8":n=this.readInt8Array(f);break;case"int16":n=this.readInt16Array(f,c);break;case"int32":n=this.readInt32Array(f,c);break;case"float32":n=this.readFloat32Array(f,c);break;case"float64":n=this.readFloat64Array(f,c);break;case"cstring":case"utf16string":case"string":if(f==null){n=[];while(!this.isEof()){var h=this.readType(u,t);if(h==null)break;n.push(h)}}else{n=new Array(f);for(var p=0;p<f;p++)n[p]=this.readType(u,t)}}}else if(a=="*"){n=[],this.buffer;for(;;){var d=this.position;try{var v=this.readType(u,t);if(v==null){this.position=d;break}n.push(v)}catch(m){this.position=d;break}}}else{n=new Array(f);for(var p=0;p<f;p++){var h=this.readType(u,t);if(h==null)return null;n[p]=h}}break}}return r!=null&&(this.position=s+r),n}return e.get(this,t)},DataStream.prototype.writeStruct=function(e,t){for(var n=0;n<e.length;n+=2){var r=e[n+1];this.writeType(r,t[e[n]],t)}},DataStream.prototype.writeType=function(e,t,n){if(typeof e=="function")return e(this,t);if(!(typeof e!="object"||e instanceof Array))return e.set(this,t,n);var r=null,i="ASCII",s=this.position;if(typeof e=="string"&&/:/.test(e)){var o=e.split(":");e=o[0],r=parseInt(o[1])}if(typeof e=="string"&&/,/.test(e)){var o=e.split(",");e=o[0],i=parseInt(o[1])}switch(e){case"uint8":this.writeUint8(t);break;case"int8":this.writeInt8(t);break;case"uint16":this.writeUint16(t,this.endianness);break;case"int16":this.writeInt16(t,this.endianness);break;case"uint32":this.writeUint32(t,this.endianness);break;case"int32":this.writeInt32(t,this.endianness);break;case"float32":this.writeFloat32(t,this.endianness);break;case"float64":this.writeFloat64(t,this.endianness);break;case"uint16be":this.writeUint16(t,DataStream.BIG_ENDIAN);break;case"int16be":this.writeInt16(t,DataStream.BIG_ENDIAN);break;case"uint32be":this.writeUint32(t,DataStream.BIG_ENDIAN);break;case"int32be":this.writeInt32(t,DataStream.BIG_ENDIAN);break;case"float32be":this.writeFloat32(t,DataStream.BIG_ENDIAN);break;case"float64be":this.writeFloat64(t,DataStream.BIG_ENDIAN);break;case"uint16le":this.writeUint16(t,DataStream.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(t,DataStream.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(t,DataStream.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(t,DataStream.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(t,DataStream.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(t,DataStream.LITTLE_ENDIAN);break;case"cstring":this.writeCString(t,r);break;case"string":this.writeString(t,i,r);break;case"u16string":this.writeUCS2String(t,this.endianness,r);break;case"u16stringle":this.writeUCS2String(t,DataStream.LITTLE_ENDIAN,r);break;case"u16stringbe":this.writeUCS2String(t,DataStream.BIG_ENDIAN,r);break;default:if(e.length==3){var u=e[1];for(var a=0;a<t.length;a++)this.writeType(u,t[a]);break}this.writeStruct(e,t)}r!=null&&(this.position=s,this._realloc(r),this.position=s+r)},define("datastream",function(e){return function(){var t,n;return t||e.DataStream}}(this)),define("DQX/ArrayBufferClient",["datastream"],function(e){var t={},n=function(t){var n=t.readCString();n=="S"&&(n="|S");var r=t.readUint8(),i=[];for(var s=0;s<r;s++)i.push(t.readUint32());var o=t.readUint32(),u;switch(n[0]){case"<":u=e.LITTLE_ENDIAN;break;case">":u=e.BIG_ENDIAN;break;case"|":u=e.LITTLE_ENDIAN;break;default:DQX.reportError("dtype doesn't start with endianness");return}var a;switch(n.substring(1)){case"u1":a=t.readUint8Array(o);break;case"u2":a=t.readUint16Array(o,u);break;case"u4":a=t.readUint32Array(o,u);break;case"i1":a=t.readInt8Array(o);break;case"i2":a=t.readInt16Array(o,u);break;case"i4":a=t.readInt32Array(o,u);break;case"f4":a=t.readFloat32Array(o,u);break;case"f8":a=t.readFloat64Array(o,u);break;case"S":a=_.times(o,function(){return t.readCString()});break;default:DQX.reportError("unsupported dtype");return}var f={array:a,shape:i};return f},r=function(e){var t=e.readUint8(),r={};for(var i=0;i<t;i++){var s=e.readCString();r[s]=n(e)}return r},i=function(t,i,s){var o=new e(t);o.endianness=e.LITTLE_ENDIAN;var u=o.readString(2),a;if(u=="AB")a=n(o);else{if(u!="AS"){DQX.reportError("Not array buffer stream"),s();return}a=r(o)}i(a)};return t.request=function(e,t,n){$.ajax({url:e,success:function(e){e!=null?i(e,t,n):n()},error:n,dataType:"arraybuffer"})},t}),define("Utils/AnimatedIcon",[],function(){return function(t,n,r,i,s){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};var o={};return o.init=function(e,t,n,r,i){o.image=new Image,o.image.src=e,o.image.onload=function(){o.loaded=!0},o.height=n,o.width=t,o.num_frames=r,o.cycleTime=i},o.drawTo=function(e,t,n,r){o.startTime=o.startTime||r;var u=Math.floor((r-o.startTime)/s*i%i);e.drawImage(o.image,o.width*u,0,o.width,o.height,t,n,o.width,o.height)},o.init(t,n,r,i,s),o}}),define("Utils/Serialise",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","DQX/HistoryManager","Wizards/EditQuery","MetaData","Plots/GenericPlot"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y.createStoredURL=function(e){var t=y._store(),r=window.location.hostname,i=window.location.pathname,s=window.location.protocol,o="";window.location.port&&window.location.port!=80&&(o=":"+window.location.port),a.serverDataStore(m.serverUrl,t,function(t){a.customRequest(m.serverUrl,PnServerModule,"view_store",{database:m.database,workspaceid:m.workspaceid,id:t},function(u){var a="{protocol}//{hostname}{port}{pathname}?dataset={ds}&workspace={ws}&view={id}".DQXformat({protocol:s,hostname:r,port:o,pathname:i,ds:m.database,ws:m.workspaceid,id:t}),f=null;$.each(n.getViewList(),function(e,t){t.isActive()&&(f=t.getStateID())}),f&&(a+="&state="+f),e(a,f)})})},y.createLink=function(){y.createStoredURL(function(n,r){var s="",o=i.Textarea("",{size:80,linecount:4,value:n}).setHasDefaultFocus();s+="Permanent url to this view:<p>",s+=o.renderHtml(),s+="<p>Press Ctrl+C to copy the url to the clipboard";var u=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-external-link-square",width:120,height:45,content:"Open in browser"}).setOnChanged(function(){window.open(n,"_blank")});s+=u.renderHtml();if(m.isManager){var a=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-plus-square",width:130,height:45,content:"Add to start page <b>(full app state)</b>"}).setOnChanged(function(){e("Utils/IntroViews").createIntroView(t.encode(n),id,r,"Add view to start page")});s+=a.renderHtml();var a=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-plus-square",width:130,height:45,content:"Add to start page <b>(current view)</b>"}).setOnChanged(function(){y.createCurrentViewIntroView()});s+=a.renderHtml();var a=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-plus-square",width:130,height:45,content:"Add to start page <b>(predefined action)</b>"}).setOnChanged(function(){y.createPredefinedIntroView()});s+=a.renderHtml()}s+="<p></p>",l.create("Permanent link to view",s)})},y.createCurrentViewIntroView=function(){var r=null;$.each(n.getViewList(),function(e,t){t.isActive()&&(r=t)});if(!r||!r.storeSettings){alert("No view to store");return}var i={};i.tableData={},$.each(m.tableCatalog,function(e,t){i.tableData[t.id]=t.storeSettings()}),i.viewData={},i.viewData[r.getStateID()]=r.storeSettings(),i.activeView=r.getStateID();var s=t.encode(JSON.stringify(i));a.serverDataStore(m.serverUrl,s,function(t){a.customRequest(m.serverUrl,PnServerModule,"view_store",{database:m.database,workspaceid:m.workspaceid,id:t},function(n){e("Utils/IntroViews").createIntroView("view",t,r.getStateID(),"Add to start page")})})},y.createPredefinedIntroView=function(){var t=[];t.push({id:"find:_gene_",name:"Find gene"}),t.push({id:"find:_genomicregion_",name:"Find genomic region"}),$.each(m.tableCatalog,function(e,n){t.push({id:"find:"+n.id,name:"Find "+n.tableNameSingle})});var n="";$.each(t,function(t,s){var o=i.Button(null,{buttonClass:"DQXToolButton2",width:300,height:20,content:s.name}).setOnChanged(function(){l.closeIfNeeded(r),e("Utils/IntroViews").createIntroView(s.id,"-","-","Add to start page")});n+=o.renderHtml()+"<br>"});var r=l.create("Create predefined view button",n)},y.checkLoadView=function(e){var t=a.getUrlSearchString("view"),r=!1;if(t){ga("send","screenview",{screenName:"stored_view"}),r=!0,a.customRequest(m.serverUrl,PnServerModule,"view_get",{id:t},function(t){a.getUrlSearchString("state")&&(d.__preventSetFragment=!0,n.activateView(a.getUrlSearchString("state")),d.__preventSetFragment=!1),y._recall(t.settings),e()});return}var i=a.getUrlSearchString("tableid"),o=a.getUrlSearchString("itemid");i&&o&&(ga("send","screenview",{screenName:"item_url"}),r=!0,d.__preventSetFragment=!0,n.activateView("table_"+i),d.__preventSetFragment=!1,s.send({type:"ItemPopup"},{tableid:i,itemid:o})),r||ga("send","screenview",{screenName:"start"}),e()},y._store=function(){var r={};r.tableData={},$.each(m.tableCatalog,function(e,t){r.tableData[t.id]=t.storeSettings()}),r.viewData={},$.each(n.getViewList(),function(e,t){t.storeSettings&&(r.viewData[t.getStateID()]=t.storeSettings())}),r.plotData=g.store(),r.itemPopupData=e("InfoPopups/ItemPopup").store();var i=JSON.stringify(r);return t.encode(i)},y._recall=function(r){var i=t.decode(r),s=JSON.parse(i);s.tableData&&$.each(m.tableCatalog,function(e,t){s.tableData[t.id]&&t.recallSettings(s.tableData[t.id])}),$.each(n.getViewList(),function(e,t){t.recallSettings&&s.viewData[t.getStateID()]&&t.recallSettings(s.viewData[t.getStateID()])}),s.plotData&&g.recall(s.plotData),s.itemPopupData&&e("InfoPopups/ItemPopup").recall(s.itemPopupData)},s.listen("",{type:"LoadStoredView"},function(e,r){a.serverDataFetch(m.serverUrl,r,function(e){var r=JSON.parse(t.decode(e));n.activateView(r.activeView),r.tableData&&$.each(m.tableCatalog,function(e,t){r.tableData[t.id]&&t.recallSettings(r.tableData[t.id])}),$.each(n.getViewList(),function(e,t){t.recallSettings&&r.viewData[t.getStateID()]&&t.recallSettings(r.viewData[t.getStateID()])})})}),y}),define("Utils/RequestCounter",[],function(){var e=0;return function(){var n={};return n.increment=function(){e+=1},n.decrement=function(){e-=1},n.free=function(){return e<5},n}}),define("Utils/Interval",[],function(){function e(e,t){this.start=e,this.end=t,this.pages={},this.fetching=[],t<e&&DQX.reportError("Negative interval created")}return e.prototype.length=function(){return this.end-this.start},e.prototype.overlaps=function(e){return this.start<=e.end&&e.start<=this.end},e.prototype.equals=function(e){return this.start===e.start&&e.end===this.end},e.prototype.has_fetched=function(e){return _(this.pages).keys().contains(e.toString())},e.prototype.is_fetching=function(e){return _(this.fetching).contains(e)},e}),define("Utils/TwoDCache",["Utils/RequestCounter","Utils/Interval"],function(e,t){return function(r,s,o,u){var a={};return a.init=function(t,n,r,i){a.col_ordinal=t,a.provider=n,a.update_callback=r,a.request_counter=e(),a.intervals=[],a._intervals_being_fetched=[],a.provider_queue=[],a.current_provider_requests=0,a.row_data_pages={},a.row_page_length=i},a.merge=function(e){var t=_.map(e,DQX.attr("length")).reduce(function(e,t){return e+t}),n=new e[0].constructor(t),r=0;return _.forEach(e,function(e){if(n.set)n.set(e,r);else for(var t=0;t<e.length;t++)n[t+r]=e[t];r+=e.length}),n},a.merge2D=function(e){e=_.filter(e,function(e){return e.length>0});if(e.length==0)return[];var t=_.map(e,function(e){return e[0].length}).reduce(function(e,t){return e+t}),n=e[0].length,r=_.times(n,function(){return new e[0][0].constructor(t)}),i=0;return _.forEach(e,function(e){for(var t=0;t<n;t++)if(r[t].set)r[t].set(e[t],i);else for(var s=0;s<e[t].length;s++)r[t][s+i]=e[t][s];i+=e[0].length}),r.shape=[e[0].shape[0],t,e[0].shape[2]],r},a.find_start=function(e,t){var n=e.length,r=-1;while(++r<n)if(e[r]>=t)break;return r},a.find_end=function(e,t){var n=e.length;while(n--)if(e[n]<t)break;return n+1},a.slice=function(e,t,n){if(e.slice)return e.slice(t,n);if(e.subarray)return e.subarray(t,n);DQX.reportError("No slice available for array")},a.twoD_col_slice=function(e,t,n){var r=_.map(e,function(r){return a.slice(r,t*(e.shape[2]||1),n*(e.shape[2]||1))});return r.shape=[e.shape[0],n-t,e.shape[2]],r},a._collate_data_for=function(e,t){var n={row:a.row_data_pages[t]||{},col:{},twoD:{}},r=a.intervals.filter(function(n){return n.overlaps(e)&&n.has_fetched(t)}),s,o,u,f;if(r.length==1)s=r[0],o=s.col[a.col_ordinal],u=a.find_start(o,e.start),f=a.find_end(o,e.end),_.forEach(s.col,function(e,t){n.col[t]=a.slice(e,u,f)}),_.forEach(s.pages[t].twoD,function(e,t){n.twoD[t]=a.twoD_col_slice(e,u,f)});else if(r.length>1){s=r[0],o=s.col[a.col_ordinal],u=a.find_start(o,e.start),f=o.length,_.forEach(s.col,function(e,t){n.col[t]=[a.slice(e,u,f)]}),_.forEach(s.pages[t].twoD,function(e,t){n.twoD[t]=[a.twoD_col_slice(e,u,f)]});for(i=1;i<r.length-1;i++)s=r[i],_.forEach(s.col,function(e,t){n.col[t].push(e)}),_.forEach(s.pages[t].twoD,function(e,t){n.twoD[t].push(e)});s=r[r.length-1],o=s.col[a.col_ordinal],u=0,f=a.find_start(o,e.end),_.forEach(s.col,function(e,t){n.col[t].push(a.slice(e,u,f))}),_.forEach(s.pages[t].twoD,function(e,t){n.twoD[t].push(a.twoD_col_slice(e,u,f))}),_.forEach(s.col,function(e,t){n.col[t]=a.merge(n.col[t])}),_.forEach(s.pages[t].twoD,function(e,t){n.twoD[t]=a.merge2D(n.twoD[t])})}return n},a._create_missing_intervals=function(e){var n=a.intervals.filter(function(t){return t.overlaps(e)}),r=[];n.length===0&&r.push(new t(Math.floor(e.start/1e3)*1e3,Math.ceil(e.end/1e3)*1e3)),n.length>0&&e.start<n[0].start&&r.push(new t(Math.floor(e.start/1e3)*1e3,n[0].start));if(n.length>1)for(var i=1,s=n.length-1;i<=s;i++)n[i-1].end!==n[i].start&&r.push(new t(n[i-1].end,n[i].start));if(n.length>0){var o=n[n.length-1];e.end>o.end&&r.push(new t(o.end,Math.ceil(e.end/1e3)*1e3))}var u=[],f=2e6;for(i=0,s=r.length;i<s;i++){var l=r[i];if(l.length()<f)u.push(l);else{var c=l.start;while(c+f<l.end)u.push(new t(c,c+f)),c+=f;u.push(new t(c,l.end))}}r=u;var h=d3.bisector(function(e){return e.start}).left;for(i=0,s=r.length;i<s;i++)l=r[i],a.intervals.splice(h(a.intervals,l.start),0,l);return r},a.get_by_ordinal=function(e,n,r,i){var s,o,u,f,l,c;i==null&&(i=!0);var h=new t(e,n);if(h.length()===0)return{row:{},col:{},twoD:{}};var p=a._collate_data_for(h,r);if(!i)return p;a._create_missing_intervals(h);var d=a.intervals.filter(function(e){return e.overlaps(h)&&!e.has_fetched(r)&&!e.is_fetching(r)});return _.forEach(d,function(e){e.fetching.push(r),a._intervals_being_fetched.push(e),a._add_to_provider_queue(r,e)}),p.intervals_being_fetched=a._intervals_being_fetched,p},a._add_to_provider_queue=function(e,t){a.provider_queue.push({page:e,interval:t}),a.provider_queue.length==1&&a._process_provider_queue()},a._process_provider_queue=function(){if(a.request_counter.free()&&a.provider_queue.length>0){var e=a.provider_queue.pop();a.provider(e.interval.start,e.interval.end,e.page*a.row_page_length,(e.page+1)*a.row_page_length,a._insert_received_data),a.request_counter.increment()}a.provider_queue.length>0&&setTimeout(a._process_provider_queue,100)},a._insert_received_data=function(e,n,r,i,s){a.request_counter.decrement();var o,u=new t(e,n);o=a.intervals.filter(function(e){return e.equals(u)});var f=r/a.row_page_length;if(f!==Math.round(f)){console.log("Data for invalid page");return}if(o.length!==1){console.log("Got data for non-existant interval or multiples",e,n);return}o=o[0];if(!o.is_fetching(f)){console.log("Got data for page not being fetched",e,n);return}a._intervals_being_fetched=a._intervals_being_fetched.filter(function(e){return!e.equals(o)}),o.fetching=_.without(o.fetching,f);if(s){o.col={},o.pages[f]={twoD:{}},a.row_data_pages[f]={};var l=_.keys(s);for(var c=0,h=l.length;c<h;c++){var p=l[c],d=p.split("_")[0],v=p.substring(p.indexOf("_")+1);d=="col"&&(o.col[v]=s[p].array),d=="row"&&(a.row_data_pages[f][v]=s[p].array);if(d=="2D"){var m=s[p];o.pages[f].twoD[v]=_.times(m.shape[0],function(e){return a.slice(m.array,e*m.shape[1]*(m.shape[2]||1),(e+1)*m.shape[1]*(m.shape[2]||1))}),o.pages[f].twoD[v].shape=m.shape}}}a.update_callback()},a.init(r,s,o,u),a}}),define("Views/Genotypes/Model",["_","Utils/TwoDCache","MetaData","DQX/ArrayBufferClient","DQX/SQL"],function(e,t,n,r,i){return function(o,u,a,f){var l={};return l.init=function(t,n,r,s){l.table=t,l.chromosomes=n,l.update_callback=r,l.first_col_ordinal=0,l.last_col_ordinal=0,l.col_query=i.WhereClause.Trivial(),l.row_query=i.WhereClause.Trivial(),l.col_order="1",l.row_order="1",l.width_mode="auto",l.user_column_width=1,l.page_length=50,l.page=1,l.row_sort_columns=[],e.extend(l,s),l.data={},l.settings=t.settings.ShowInGenomeBrowser,l.properties=[],l.derived_properties=[],l.settings.Call&&(l.properties.push([l.settings.Call]),l.derived_properties.push(["call_summary"])),l.settings.AlleleDepth&&(l.properties.push([l.settings.AlleleDepth]),l.derived_properties.push(["fractional_reads"])),e.each(l.settings.ExtraProperties,function(e){l.properties.push(e)}),l.reset_cache()},l.update_params=function(t){var n=!1;e.each(["col_query","row_query","col_order","row_order","row_sort_columns","page_length"],function(e){l[e]!==t[e]&&(n=!0)}),e.extend(l,t),n&&l.reset_cache()},l.reset_cache=function(){l.cache_for_chrom={},e.each(l.chromosomes,function(e){l.cache_for_chrom[e]=t(l.col_order,function(t,n,r,i,s){l.data_provider(e,t,n,r,i,s)},function(){l.refresh_data()},l.page_length)}),l.col_ordinal=[],l.row_ordinal=[],e.each(l.properties,function(e){l.data[e]=[]}),e.each(l.derived_properties,function(e){l.data[e]=[]}),l.col_positions=[],l.col_width=0,l.row_index=[],l.genomic_start=0,l.genomic_end=0,l.intervals_being_fetched=[]},l.position_columns=function(e){var t=new Float64Array(e);l.width_mode=="manual"&&(l.col_width=l.user_column_width),l.width_mode=="auto"&&(l.col_ordinal.length>0?l.col_width=Math.max(3,.7*((l.col_end-l.col_start)/l.col_ordinal.length)):l.col_width=0);var n=l.col_width;if(l.width_mode=="auto"||l.width_mode=="manual"){var r=Math.floor(t.length/2);for(var i=.1;i<=1;i+=.1){var s=t[r];for(var o=r+1,u=t.length;o<u;o++)t[o]<s+i*n&&(t[o]=s+i*n),s=t[o];s=t[r];for(o=r-1;o>=0;o--)t[o]>s-i*n&&(t[o]=s-i*n),s=t[o];i+=.1,s=-Infinity;for(o=0,u=r;o<u;o++)t[o]<s+i*n&&(t[o]=s+i*n),s=t[o];s=Infinity;for(o=t.length-1;o>=r;o--)t[o]>s-i*n&&(t[o]=s-i*n),s=t[o]}s=-Infinity;for(o=0,u=t.length;o<t.length;o++)t[o]<s+n&&(t[o]=s+n),s=t[o];return t}if(l.width_mode=="fill"){l.col_width=(l.col_end-l.col_start)/l.col_ordinal.length;for(o=0,u=t.length;o<t.length;o++)t[o]=l.col_start+o*l.col_width+l.col_width/2;return t}DQX.reportError("Invalid width_mode")},l.interpolator=function(e,t,n){if(e.length==0)return n;if(e.length==1)return n+(t[0]-e[0]);var r=0,i=e.length-1;if(n<e[r])return t[r]+(n-e[r]);if(n>e[i])return t[i]+(n-e[i]);while(i>r+1){var s=Math.round((r+i)/2);e[s]<n?r=s:i=s}var o=.5;return e[i]>e[r]&&(o=(n-e[r])/(e[i]-e[r])),(1-o)*t[r]+o*t[i]},l.mapOrdinal2Pos=function(e){return l.interpolator(l.col_ordinal,l.col_positions,e)},l.mapPos2Ordinal=function(e){return l.interpolator(l.col_positions,l.col_ordinal,e)},l.refresh_data=function(){var t=(l.col_end-l.col_start)*0,n=l.cache_for_chrom[l.chrom].get_by_ordinal(l.col_start-t,l.col_end+t,l.page-1);l.col_ordinal=n.col[l.col_order]||[],l.row_order=="columns"?l.row_ordinal=n.row[l.table.row_table.primkey]||[]:l.row_ordinal=n.row[l.row_order]||[],l.row_primary_key=n.row[l.table.row_table.primkey]||[],l.col_primary_key=n.col[l.table.col_table.primkey]||[],e.each(l.properties,function(e){l.data[e]=n.twoD[e]||[]}),e.each(l.derived_properties,function(e){l.data[e]=n.twoD[e]||[]}),l.col_positions=l.position_columns(l.col_ordinal),l.intervals_being_fetched=n.intervals_being_fetched,l.row_ordinal.length>0?l.row_index=e.times(l.row_ordinal.length,function(e){return e}):l.row_index=[],l.update_callback()},l.change_col_range=function(e,t,n){l.chrom=e,l.col_start=t,l.col_end=n,l.refresh_data()},l.data_provider=function(e,t,s,o,u,a){var f=l.col_query;f.isTrivial?f=[]:f=[f],f.push(i.WhereClause.CompareFixed(l.table.col_table.ChromosomeField,"=",e)),f.push(i.WhereClause.CompareFixed(l.col_order,">=",t)),f.push(i.WhereClause.CompareFixed(l.col_order,"<",s)),f=i.WhereClause.AND(f);var c=DQX.Url(n.serverUrl);c.addUrlQueryItem("datatype","custom"),c.addUrlQueryItem("respmodule","panoptesserver"),c.addUrlQueryItem("respid","2d_query"),c.addUrlQueryItem("dataset",n.database),c.addUrlQueryItem("datatable",l.table.id),c.addUrlQueryItem("workspace",n.workspaceid),c.addUrlQueryItem("col_qry",i.WhereClause.encode(f)),c.addUrlQueryItem("row_qry",i.WhereClause.encode(l.row_query)),c.addUrlQueryItem("col_order",l.col_order),l.row_order=="columns"?(c.addUrlQueryItem("row_properties",l.table.row_table.primkey),c.addUrlQueryItem("row_sort_cols",l.row_sort_columns.join("~")),c.addUrlQueryItem("col_key",l.table.col_table.primkey),c.addUrlQueryItem("sort_mode",l.settings.Call?"call":"fraction"),l.settings.Call?c.addUrlQueryItem("row_sort_property",l.settings.Call):c.addUrlQueryItem("row_sort_property",l.settings.AlleleDepth)):l.table.row_table.primkey==l.row_order?c.addUrlQueryItem("row_properties",l.row_order):c.addUrlQueryItem("row_properties",l.row_order+"~"+l.table.row_table.primkey),c.addUrlQueryItem("row_order",l.row_order),c.addUrlQueryItem("row_offset",o),c.addUrlQueryItem("row_limit",u-o),c.addUrlQueryItem("first_dimension",l.table.first_dimension),l.table.col_table.primkey==l.col_order?c.addUrlQueryItem("col_properties",l.col_order):c.addUrlQueryItem("col_properties",l.col_order+"~"+l.table.col_table.primkey),c.addUrlQueryItem("2D_properties",l.properties.join("~")),r.request(c.toString(),function(e){l.calcDerivedProperties(e),a(t,s,o,u,e)},function(e){a(t,s,o,u,null)})},l.calcDerivedProperties=function(e){if(l.settings.Call){var t=e["2D_"+l.settings.Call],n=t.array,r=t.shape[2]||1,i=new Int8Array(n.length/r);for(var s=0,o=t.shape[0];s<o;s++)for(var u=0,a=t.shape[1];u<a;u++){var f=-2;for(var c=0;c<r;c++){var h=n[s*a*r+u*r+c];h=h>0?1:h;if(h==-1){f=-1;break}if(h==0&&f==1){f=2;break}if(h==1&&f==0){f=2;break}f=h}i[s*a+u]=f}i={array:i,shape:[t.shape[0],t.shape[1]]},e["2D_call_summary"]=i}if(l.settings.AlleleDepth){var p=e["2D_"+l.settings.AlleleDepth],d=p.array,v=p.shape[2]||1,m=new Uint8ClampedArray(d.length/v);for(var s=0,o=p.shape[0];s<o;s++)for(var u=0,a=p.shape[1];u<a;u++){var g=d[s*a*v+u*v],y=0;for(var c=1;c<v;c++)y+=d[s*a*v+u*v+c];var b=y/(g+y);b=Math.max(0,b),b=Math.min(1,b),m[s*a+u]=y+g>0?1+255*b:0}m={array:m,shape:[p.shape[0],p.shape[1]]},e["2D_fractional_reads"]=m}},l.init(o,u,a,f),l}}),define("Views/Genotypes/Components/Container",[],function(){return function(t){var n={};return n.contents=t,n.contents.forEach(function(e){e.t||(e.t=0),e.l||(e.l=0)}),n.contents_by_name=DQX.attrMap(n.contents,"name"),n.draw=function(e,t,r,i){n.contents.forEach(function(n){e.save(),e.translate(n.l,n.t),n.content.draw(e,{t:t.t-n.t,l:t.l-n.l,b:t.b-n.t,r:t.r-n.l},r,i),e.restore()})},n.getToolTipInfo=function(e,t,r,i){var s=null;return n.contents.forEach(function(n){if(n.content.getToolTipInfo){var o=n.content.getToolTipInfo(e-n.l,t-n.t,r,i);o&&(s=o,s.px+=n.l,s.py+=n.t)}}),s},n.event=function(e,r,i,s,o,u){var a=!1;for(var f=t.length-1;f>=0;--f){a=n.contents[f].content.event(e,r,{x:n.contents[f].l+i.x,y:n.contents[f].t+i.y},s,o,u);if(a)return a}return a},n}}),define("Views/Genotypes/Components/TabContainer",["_","DQX/Utils"],function(e,t){return function(n){var r={};return r.contents=n,r.contents.forEach(function(e){e.t||(e.t=0),e.l||(e.l=0)}),r.active_element=r.contents[0],r.contents=t.attrMap(r.contents,"name"),r.show_tab=function(e){r.active_element=r.contents[e]},r.draw=function(e,t){var n=r.active_element;e.save(),e.translate(n.l,n.t),n.content.draw(e,{t:t.t-n.t,l:t.l-n.l,b:t.b-n.t,r:t.r-n.l}),e.restore()},r.event=function(e,t,n){return r.active_element.content.event(e,t,{x:r.active_element.l+n.x,y:r.active_element.t+n.y})},r}});var TWEEN=TWEEN||function(){var e=[];return{REVISION:"10",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var n=e.indexOf(t);n!==-1&&e.splice(n,1)},update:function(t){if(e.length===0)return!1;var n=0,r=e.length;t=t!==undefined?t:window.performance!==undefined&&window.performance.now!==undefined?window.performance.now():Date.now();while(n<r)e[n].update(t)?n++:(e.splice(n,1),r--);return!0}}}();TWEEN.Tween=function(e,t){var n=e,r={},i={},s={},o=1e3,u=0,a=0,f=null,l=TWEEN.Easing.Linear.None,c=TWEEN.Interpolation.Linear,h=[],p=null,d=!1,v=null,m=null;if(t)t.forEach(function(t){r[t]=parseFloat(e[t],10)});else for(var g in e)r[g]=parseFloat(e[g],10);this.to=function(e,t){return t!==undefined&&(o=t),i=e,this},this.start=function(e){TWEEN.add(this),d=!1,f=e!==undefined?e:window.performance!==undefined&&window.performance.now!==undefined?window.performance.now():Date.now(),f+=a;for(var t in i){if(i[t]instanceof Array){if(i[t].length===0)continue;i[t]=[n[t]].concat(i[t])}r[t]=n[t],r[t]instanceof Array==0&&(r[t]*=1),s[t]=r[t]||0}return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(e){return a=e,this},this.repeat=function(e){return u=e,this},this.easing=function(e){return l=e,this},this.interpolation=function(e){return c=e,this},this.chain=function(){return h=arguments,this},this.onStart=function(e){return p=e,this},this.onUpdate=function(e){return v=e,this},this.onComplete=function(e){return m=e,this},this.update=function(e){if(e<f)return!0;d===!1&&(p!==null&&p.call(n),d=!0);var t=(e-f)/o;t=t>1?1:t;var g=l(t);for(var y in i){var b=r[y]||0,w=i[y];w instanceof Array?n[y]=c(w,g):(typeof w=="string"&&(w=b+parseFloat(w,10)),n[y]=b+(w-b)*g)}v!==null&&v.call(n,g);if(t==1){if(u>0){isFinite(u)&&u--;for(var y in s)typeof i[y]=="string"&&(s[y]=s[y]+parseFloat(i[y],10)),r[y]=s[y];return f=e+a,!0}m!==null&&m.call(n);for(var E=0,S=h.length;E<S;E++)h[E].start(e);return!1}return!0}},TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-0.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-0.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-0.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1,r=.4;return e===0?0:e===1?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)))},Out:function(e){var t,n=.1,r=.4;return e===0?0:e===1?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/r)+1)},InOut:function(e){var t,n=.1,r=.4;return e===0?0:e===1?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-0.5*n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r):n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?TWEEN.Easing.Bounce.In(e*2)*.5:TWEEN.Easing.Bounce.Out(e*2-1)*.5+.5}}},TWEEN.Interpolation={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),s=TWEEN.Interpolation.Utils.Linear;return t<0?s(e[0],e[1],r):t>1?s(e[n],e[n-1],n-r):s(e[i],e[i+1>n?n:i+1],r-i)},Bezier:function(e,t){var n=0,r=e.length-1,i=Math.pow,s=TWEEN.Interpolation.Utils.Bernstein,o;for(o=0;o<=r;o++)n+=i(1-t,r-o)*i(t,o)*e[o]*s(r,o);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),s=TWEEN.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(r=n*(1+t))),s(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(s(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(s(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):s(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=TWEEN.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1,r;if(e[t])return e[t];for(r=t;r>1;r--)n*=r;return e[t]=n}}(),CatmullRom:function(e,t,n,r,i){var s=(n-e)*.5,o=(r-t)*.5,u=i*i,a=i*u;return(2*t-2*n+s+o)*a+(-3*t+3*n-2*s-o)*u+s*i+t}}},TWEEN.manual=function(e,t,n,r,i,s){return r=r||TWEEN.Easing.Quadratic.InOut,i==undefined&&(i=0),s==undefined&&(s=1),e<=t&&t<=n||e>=t&&t>=n?i:e>=n&&t<=n||e<=n&&t>=n?s:i+r((e-t)/(n-t))*(s-i)},define("tween",function(e){return function(){var t,n;return t||e.TWEEN}}(this)),define("Views/Genotypes/Components/ColumnHeader",["tween","DQX/Utils","DQX/Msg"],function(e,t,n){return function(r,i){var s={};return s.height=r,s.clickSNPCallback=i,s.last_clip={l:0,t:0,r:0,b:0},s.draw=function(t,n,r,i){s.last_clip=n;var o=i.col_scale,u=o(r.col_width)-o(0);u=Math.min(u,150);var a=r.col_positions,f=r.col_primary_key,l=r.col_ordinal,c=r.table.col_table.isItemSelected,h=_.zipObject(r.row_sort_columns,_.times(r.row_sort_columns.length,function(){return!0})),p=e.manual(u,5,20);t.font="12px sans-serif",t.fillStyle="rgb(0,0,0)",t.strokeStyle="rgba(0,0,0,0.2)",t.lineWidth=1;var d=NaN;for(var v=0,m=a.length;v<m;++v){var g=a[v],y=f[v],b="rgba(190,190,190, 0.75)";t.strokeStyle="rgba(120,120,120, 0.75)";if(c(y)){var b="rgba(190,80,80, 0.75)";t.strokeStyle="rgba(150, 0, 0, 0.75)"}t.fillStyle=b;var w=0,E=s.height-w,S=Math.floor(o(g)-u*.5),x=Math.ceil(S+u);S<d&&(S=d),d=x;var T=x-S,N=Math.round(T/2);p>0?(t.save(),t.translate(S,E),t.beginPath(),t.moveTo(0,0),t.bezierCurveTo(0,-10,N,-10,N,-E),t.bezierCurveTo(N,-10,T,-10,T,0),t.closePath(),t.lineWidth=1,t.fill(),t.stroke(),w>0&&(t.beginPath(),t.moveTo(0,0),t.lineTo(T,0),t.lineTo(T,s.height-E),t.lineTo(0,s.height-E),t.closePath(),t.stroke()),h[f[v]]&&(t.fillStyle="rgba(0,0,0, 0.75)",t.textAlign="center",u<60?t.fillText("s",.5*u,-3):t.fillText("Sort",.5*u,-3)),t.restore()):(t.save(),t.beginPath(),t.moveTo(Math.round(S+T/2),0),t.lineTo(Math.round(S+T/2),s.height),t.closePath(),t.stroke(),t.restore())}},s.GetColIndexByPosition=function(e,t,n){var r=n.col_scale.invert(e);for(var i=0,s=t.col_positions.length;i<s;++i){var o=t.col_positions[i];if(r>o-t.col_width/2&&r<o+t.col_width/2)return i}return-1},s.getToolTipInfo=function(e,t,n,r){var i=s.GetColIndexByPosition(e,n,r);if(t<0||t>s.height)return null;if(i>=0){var o=n.col_primary_key[i];return{ID:"column_"+o,content:o,px:e,py:t,showPointer:!0}}return null},s.event=function(e,t,r,i,o,u){t={x:t.x-r.x,y:t.y-r.y};var a=s.last_clip;if(e=="click"){if(t.x<a.l||t.x>a.r||t.y<0||t.y>s.height)return!1;var f=s.GetColIndexByPosition(t.x,i,o);if(f>=0){var l=i.col_primary_key[f];if(!u.controlPressed&&!u.altPressed)return{type:"click_col",col_key:i.col_primary_key[f]};i.table.col_table.selectItem(l,!i.table.col_table.isItemSelected(l)),n.broadcast({type:"SelectionUpdated"},i.table.col_table.id)}}return!1},s}}),define("Views/Genotypes/Components/GenotypesTable",["_","tween","DQX/Utils"],function(e,t,n){return function(){var t={};t.last_clip={l:0,t:0,r:0,b:0},t.fractional_colourmap=[];for(var r=0;r<255;r++)t.fractional_colourmap[r+1]="hsla("+Math.round(240+r/256*120)+",100%,35%,";return t.fractional_colourmap[0]="hsl(0,50%,0%)",t.draw=function(e,r,i,s){t.last_clip=r;var o=s.col_scale,u=o(i.col_width)-o(0);u=Math.min(u,150);var a=Math.ceil(s.row_height),f=i.col_positions,l=n.niceColours.length,c=i.data[i.settings.Call]||!1;if(c.shape)var h=c.shape[2]||1;var p=i.data[i.settings.AlleleDepth]||!1;if(p.shape)var d=p.shape[2]||1;var v=i.data.call_summary||!1,m=i.data.fractional_reads||!1,g=s.alpha_channel=="__null"?!1:i.data[s.alpha_channel],y=s.height_channel=="__null"?!1:i.data[s.height_channel],b=s.alpha_channel=="__null"?0:i.table.properties[s.alpha_channel].settings.MinVal,w=s.alpha_channel=="__null"?1:i.table.properties[s.alpha_channel].settings.MaxVal-b,E=s.height_channel=="__null"?0:i.table.properties[s.height_channel].settings.MinVal,S=s.height_channel=="__null"?1:i.table.properties[s.height_channel].settings.MaxVal-E;if(!v&&!m||g==undefined||y==undefined)return i.row_index.length*a;e.save(),e.font=""+a+"px sans-serif",e.lineWidth=1;var x=e.measureText("88/88").width;for(var T=0,N=i.row_index.length;T<N;T++){var C=NaN,k=i.row_index[T],L=k*a;if(L+a*10<r.t||L-a*10>r.b)continue;var A=c[k],O=p[k],M=v[k],_=m[k],D=g[k],P=y[k];for(var H=0,B=f.length;H<B;++H){var j=M?M[H]:-1,F=_?_[H]:-1,I=D?(D[H]-b)/w*.8+.2:1;I=Math.min(Math.max(I,0),1);var q=P?(P[H]-E)/S*.8+.2:1;q=Math.min(Math.max(q,0),1);if(s.colour_channel=="call"){if(j==-1||j==-2)q=.2,I=.2,e.fillStyle="rgb(230,230,230)";j==0&&(e.fillStyle="rgba(0,55,135,"+I+")"),j==1&&(e.fillStyle="rgba(180,0,0,"+I+")"),j==2&&(e.fillStyle="rgba(78,154,0,"+I+")")}s.colour_channel=="fraction"&&(e.fillStyle=F>0?t.fractional_colourmap[F]+I+")":t.fractional_colourmap[F]);var R=Math.floor(o(f[H])-u*.5),U=Math.ceil(R+(u>x+38&&a>=6?u-x:u));R<C&&(R=C),C=U;if(R>=U)continue;e.fillRect(R,L+(1-q)*a*.5,U-R,q*a)}if(u>x+38&&a>=6){var z=(k+.5)*a;e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(40,40,40)";var W=1;for(H=0,B=f.length;H<B;++H){var j=M?M[H]:-1,X=O?O[H]:-1,V="";if(s.colour_channel=="call")for(var $=H*h,J=$+h;$<J;$++)V+=A[$],$<J-1&&(V+="/");else for(var $=H*d,J=$+d;$<J;$++)V+=O[$],$<J-1&&(V+=",");var K=o(f[H])+u/2-x/2;if(i.settings.Call){if(j==-1||j==-2){W!=0&&(e.fillStyle="rgb(150,150,150)",W=0),e.fillText("●",K,z);continue}j==0?(W!=0&&(e.fillStyle="rgb(150,150,150)",W=0),e.fillText(V,K,z)):(W!=1&&(e.fillStyle="rgb(40,40,40)",W=1),e.fillText(V,K,z))}else e.fillText(V,K,z)}}}e.restore();if(a>3){e.save(),e.strokeStyle="rgba(0,0,0,0.1)",e.lineWidth=1,e.beginPath();for(H=0;H<=i.row_index.length;H++){var Q=H*a;if(Q+a*10>r.t||Q-a*10<r.b)e.moveTo(r.l,Q+.5),e.lineTo(r.r,Q+.5)}e.stroke(),e.restore()}return i.row_index.length*a},t.getToolTipInfo=function(e,t,n,r){var i=Math.ceil(r.row_height),s=r.col_scale,o=s(n.col_width)-s(0),u=-1;for(var a=0,f=n.row_index.length;a<f;a++){var l=n.row_index[a],c=l*i;t>=c&&t<=c+i&&(u=a)}var h=n.col_positions,p=-1,d=0;for(var v=0,m=h.length;v<m;++v){var g=s(h[v])-o*.5;e>=g&&e<g+o&&(p=v,d=g+o)}if(p<0||u<0||u>=n.row_index.length)return null;var y=n.row_primary_key[u]+" / "+n.col_primary_key[p];for(var v=0;v<n.properties.length;v++){var b=n.properties[v],w=n.table.properties[b],E=n.data[b],S=E.shape[2]||1;y+="<br>"+w.name+":";for(var a=0;a<S;a++)y+=E[u][p*S+a],a<S-1&&(y+=",")}return{ID:u+"_"+p,content:y,px:d,py:(u+1)*i,showPointer:!0}},t.event=function(e,n,r,i,s){n={x:n.x-r.x,y:n.y-r.y};var o=t.last_clip;if(e=="click"){if(n.x<o.l||n.x>o.r||n.y<0||n.y>t.height)return!1;var u=s.col_scale.invert(n.x);for(var a=0,f=i.col_positions.length;a<f;++a){var l=i.col_positions[a];if(u>l-i.col_width/2&&u<l+i.col_width/2){var c=i.col_primary_key[a];break}}if(c){var h=Math.ceil(s.row_height),p=Math.floor(n.y/h);return{type:"click_cell",col_key:c,row_key:i.row_primary_key[p]}}}return!1},t}}),define("Views/Genotypes/Components/Link",["tween","DQX/Utils"],function(e,t){return function(n){var r={};return r.height=n,r.last_clip={l:0,t:0,r:0,b:0},r.draw=function(t,n,i,s){r.last_clip=n;var o=s.col_scale,u=o(i.col_width)-o(0);u=Math.min(u,150);var a=i.col_positions,f=i.col_ordinal,l=i.col_primary_key,c=i.table.col_table.isItemSelected;t.lineWidth=1;var h=r.height*.5,p=e.manual(u,5,20),d=NaN;for(var v=0,m=a.length;v<m;++v){var g=l[v],y=Math.floor(o(a[v])-u*.5),b=Math.ceil(y+u);y<d&&(y=d),d=b;var w=b-y,E=Math.round(y+w/2),S=o(f[v]);t.strokeStyle="rgba(80,80,80, 0.75)",c(g)&&(t.strokeStyle="rgba(150, 0, 0, 0.75)"),t.beginPath(),t.moveTo(S,0),t.bezierCurveTo(S,h,E,h,E,r.height),t.stroke()}},r.event=function(e,t,n){},r}}),define("Views/Genotypes/Components/Gradient",[],function(){return function(t,n,r,i,s){var o={};return o.colour=t,o.colour2=n,o.fraction_fade=r,o.height=i,o.width=s,o.draw=function(e,t){var n=o.width||t.r-t.l,i=o.height||t.b-t.t,s=e.createLinearGradient(0,0,0,i);s.addColorStop(0,o.colour),s.addColorStop(r,o.colour),s.addColorStop(1,o.colour2),e.fillStyle=s,e.fillRect(0,0,n,i)},o.event=function(e,t,n){},o}}),define("Views/Genotypes/Components/SamplesHeader",["DQX/Msg","MetaData"],function(e,t){return function(){var r={};return r.draw=function(e,n,i,s){var o=e.canvas.clientWidth,u=e.canvas.clientHeight,a=i.table.row_table,f=a.isItemSelected,l=s.samples_property,c=t.findProperty(a.id,l),h=i.row_primary_key;if(a.primkey==l)var p=function(e){return e};else{if(!a.fieldCache.requestAll(l,function(){i.update_callback()}))return;var p=function(e){return c.toDisplayString(a.fieldCache.getField(e,l))}}var d=s.row_height,v=Math.min(12,d-1);e.font=""+v+"px sans-serif",e.fillStyle="rgb(0,0,0)",r.showIndividualLines=d>10,e.strokeStyle="rgba(0,0,0,0.2)",e.lineWidth=1;if(r.showIndividualLines){e.beginPath();for(var m=0;m<=h.length;m++){var g=m*d;if(g+d*10>n.t||g-d*10<n.b)e.moveTo(0,g+.5),e.lineTo(o,g+.5)}e.stroke()}var y=!1,b=function(t,r,i){if(i<r)return;var s=r*d,u=(i+1)*d;if(u>s+3){e.beginPath(),y||(e.moveTo(0,s+.5),e.lineTo(o,s+.5)),e.moveTo(0,u+.5),e.lineTo(o,u+.5),e.stroke(),y=!0;if(u>s+5){var a=Math.min(12,u-s-1);e.font=""+a+"px sans-serif";var f=(u+s)/2-1+a/2;f<n.t+a&&u>n.t+a&&(f=n.t+a),f>n.b-2&&s<n.b-a&&(f=n.b-2),e.fillText(t,2,f)}}else y=!1},w=null,E=0;_.forEach(h,function(t,i){var s=(i+1)*d;if(s+d*10>n.t||s-d*10<n.b){var o=p(t);r.showIndividualLines?(f(t)?e.fillStyle="rgb(255,80,80)":e.fillStyle="rgb(255,255,255)",e.beginPath(),e.rect(1.5,s-d+2.5,10,d-4),e.fill(),e.stroke(),e.fillStyle="rgb(0,0,0)",e.fillText(o,13,s-1-(d-v)/2)):o!=w&&(b(w,E,i-1),w=o,E=i)}}),w!=null&&b(w,E,h.length-1)},r.getToolTipInfo=function(e,n,r,i){var s=r.row_primary_key,o=i.row_height,u=-1,a=0;_.forEach(s,function(e,t){var r=t*o;n>=r&&n<=r+o&&(u=t,a=(t+1)*o)});if(u<0)return;var f=s[u],l=f,c=r.table.row_table,h=i.samples_property,p=t.findProperty(c.id,h);return c.primkey!=h&&(l+="<br>"+p.toDisplayString(c.fieldCache.getField(f,h))),{ID:"sample_"+f,key:f,content:l,px:e,py:a,showPointer:!0}},r.event=function(t,n,i,s,o){var u=s.table.row_table;if(t=="click"){var a=r.getToolTipInfo(n.x-i.x,n.y-i.y,s,o);a&&(r.showIndividualLines&&n.x<12?(s.table.row_table.selectItem(a.key,!s.table.row_table.isItemSelected(a.key)),e.broadcast({type:"SelectionUpdated"},s.table.row_table.id)):e.send({type:"ItemPopup"},{tableid:u.id,itemid:a.key}))}},r}}),define("Views/Genotypes/View",["_","d3","Views/Genotypes/Components/Container","Views/Genotypes/Components/TabContainer","Views/Genotypes/Components/ColumnHeader","Views/Genotypes/Components/GenotypesTable","Views/Genotypes/Components/Link","Views/Genotypes/Components/Gradient","Views/Genotypes/Components/SamplesHeader"],function(e,t,n,r,i,s,o,u,a){return function(f){var l={};return l.init=function(r){l.col_header_height=30,l.link_height=40,l.row_header_width=150,l.col_scale=t.scale.linear(),e.extend(l,f),l.root_container=n([{name:"data_area",t:l.gene_map_height,content:n([{name:"body",t:l.col_header_height+l.link_height,content:n([{name:"table",content:s()}])},{name:"moving_header",content:n([{name:"gradient",content:u("rgba(255,255,255,1.0)","rgba(255,255,255,0.5)",.15,l.link_height+l.col_header_height)},{name:"column_header",t:l.link_height,content:i(l.col_header_height,l.clickSNP)},{name:"link",content:o(l.link_height)}])}])}]),l.samplesHeader=a()},l.update_params=function(t){e.extend(l,t)},l.draw=function(e,t,n,r){e.clearRect(n.l,n.t,n.r-n.l,n.b-n.t),l.root_container.contents_by_name.data_area.content.contents_by_name.moving_header.t=Math.max(0,n.t),l.col_scale.domain([r.col_start,r.col_end]).range([0,n.r-n.l]),l.root_container.draw(e,n,r,l),t.save();var i=l.col_header_height+l.link_height;t.translate(0,i);var s=$.extend({},n);s.t-=i,s.b-=i,l.samplesHeader.draw(t,s,r,l),t.restore(),e=t,e.save(),e.fillStyle="rgb(40,40,40)",e.font="11px sans serif",e.fillText(r.intervals_being_fetched.length>0?"LOADING...":r.table.tableCapNamePlural,5,15),e.textBaseline="top",l.colour_channel=="call"&&(e.fillStyle="rgb(0,55,135)",e.fillRect(5,25,10,10),e.fillStyle="rgb(180,0,0)",e.fillRect(5,40,10,10),e.fillStyle="rgb(78,154,0)",e.fillRect(5,55,10,10),e.fillStyle="rgb(40,40,40)",e.fillText("Hom - Ref",20,25),e.fillText("Hom - Alt",20,40),e.fillText("Het",20,55));if(l.colour_channel=="fraction"){e.fillText("Alt read fraction:",5,25),e.textAlign="center",e.fillText("0",5,49),e.fillText("0.5",5+(e.canvas.width-10)/2,49),e.fillText("1",e.canvas.width-5,49);var o=e.createLinearGradient(0,0,e.canvas.width-10,10);o.addColorStop(0,"hsl(240,100%,35%)"),o.addColorStop(1,"hsl(360,100%,35%)"),e.fillStyle=o,e.fillRect(5,37,e.canvas.width-10,10)}e.restore()},l.getToolTipInfo=function(e,t,n){var r=l.root_container.getToolTipInfo(e,t,n,l);return r},l.getLeftToolTipInfo=function(e,t,n){var r=l.col_header_height+l.link_height,i=l.samplesHeader.getToolTipInfo(e,t-r,n,l);return i&&(i.py+=r),i},l.event=function(e,t,n,r){return l.root_container.event(e,t,{x:0,y:0},n,l,r)},l.leftEvent=function(e,t,n){var r=l.col_header_height+l.link_height;return l.samplesHeader.event(e,t,{x:0,y:r},n,l)},l.init(f),l}}),define("Views/Genotypes/GenotypeChannel",["require","_","d3","blob","filesaver","DQX/Model","DQX/SQL","DQX/Framework","DQX/ArrayBufferClient","DQX/Controls","DQX/Msg","DQX/Utils","DQX/ChannelPlot/ChannelCanvas","Utils/QueryTool","Utils/AnimatedIcon","Utils/Serialise","MetaData","Views/Genotypes/Model","Views/Genotypes/View"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b={};return b.Channel=function(e,n,u){var a=e.id+"_genotypes",b=h.Base(a);b.init=function(e,n,r){b._height=400,b.loadIcon=d("Bitmaps/Icons/Canvas/preloader.png",35,35,12,1e3),b._toolTipHandler=null,b._clickHandler=null,b._always_call_draw=!0,b._title=e.name,b.parent_browser=r,b.table_info=e,b.rowTableInfo=b.table_info.row_table;var i=s({col_query:o.WhereClause.Trivial(),row_query:o.WhereClause.Trivial(),col_order:e.col_table.PositionField,row_order:e.row_table.primkey,width_mode:"auto",user_column_width:1,page_length:50,page:1,row_sort_columns:[]});b.model=g(e,t.map(m.chromosomes,c.attr("id")),b._draw,i.get()),b.download_button=f.Button(null,{content:"Download View",buttonClass:"PnButtonGrid",width:120,height:30,icon:"fa-download"}).setOnChanged(b.download_view);var u=f.CompoundVert([]);u.addControl(b.createVisibilityControl());var a=s({samples_property:b.rowTableInfo.primkey,row_height:11,alpha_channel:b.model.settings.ExtraProperties&&b.model.settings.ExtraProperties[0]?b.model.settings.ExtraProperties[0]:"__null",height_channel:b.model.settings.ExtraProperties&&b.model.settings.ExtraProperties[1]?b.model.settings.ExtraProperties[1]:"__null",colour_channel:b.model.settings.Call?"call":"fraction"});a.on({},function(){b.view.update_params(this.get()),b._draw()}),i.on({},function(){b.model.update_params(this.get()),b.draw(b.draw_info)});var h=[],v={};$.each(b.rowTableInfo.propertyGroups,function(e,t){$.each(t.properties,function(e,t){v[t.propid]=t.name,(t.settings.showInTable||t.isPrimKey)&&h.push({id:t.propid,name:t.name})})});var w=[],E=125,S=f.Combo(null,{label:"",states:h,width:E}).bindToModel(a,"samples_property").setClassID(b.table_info.id+"SamplesLabel"),x=f.Button(null,{content:"Current Label",buttonClass:"PnButtonGrid",width:120,height:10,iconWidth:16,icon:"fa-sort-amount-asc"}).setOnChanged(function(){i.set({row_order:a.get("samples_property"),row_sort_columns:[]})}),T=f.Button(null,{content:"Selected Columns",buttonClass:"PnButtonGrid",width:120,height:10,iconWidth:16,icon:"fa-sort-amount-asc"}).setOnChanged(function(){i.set({row_order:"columns",row_sort_columns:t.keys(b.table_info.col_table.currentSelection)})});b.sort_display=f.Html(null,b.model.row_order),b.sort_display.bindToModel(i,"row_order",null,function(e){return e=="columns"?b.table_info.col_table[b.model.row_sort_columns.length===1?"tableCapNameSingle":"tableCapNamePlural"]:v[e]||"Unset"}),w.push({label:"Current Sort",ctrl:b.sort_display}),w.push({label:null,ctrl:T}),w.push({label:null,ctrl:x}),w.push({label:"Row Label",ctrl:S});var N=[];b.model.settings.Call&&N.push({id:"call",name:"Call"}),b.model.settings.AlleleDepth&&N.push({id:"fraction",name:"Alt Read Fraction"});var C=f.Combo(null,{label:"",states:N,width:E}).bindToModel(a,"colour_channel").setClassID(b.table_info.id+"ChannelColour");w.push({label:"Cell",ctrl:C});var h=t.map(b.model.settings.ExtraProperties,function(e){return{id:e,name:b.table_info.properties[e].name}});h.push({id:"__null",name:"None"});var k=f.Combo(null,{label:"",states:h,width:E}).bindToModel(a,"alpha_channel").setClassID(b.table_info.id+"ChannelAlpha");w.push({label:"Cell Alpha",ctrl:k});var L=f.Combo(null,{label:"",states:h,width:E}).bindToModel(a,"height_channel").setClassID(b.table_info.id+"ChannelHeight");w.push({label:"Cell Height",ctrl:L});var h=[{id:"auto",name:"Automatic width"},{id:"fill",name:"Fill Width"},{id:"manual",name:"Manual Width"}],A=f.Combo(null,{label:"",states:h,width:E}).bindToModel(i,"width_mode").setClassID(b.table_info.id+"ColumnMode");w.push({label:"Columns",ctrl:A});var O=f.ValueSlider(null,{label:"Manual Column Width (bp)",width:E+75,minval:1,maxval:150,scaleDistance:20,value:i.get("user_column_width")}).bindToModel(i,"user_column_width").setClassID(b.table_info.id+"ColumnWidth"),M=f.ShowHide(O);i.on({change:"width_mode"},function(){M.setVisible(this.get("width_mode")=="manual")}),M.setVisible(!1);var h=[{id:"20",name:"20"},{id:"50",name:"50"},{id:"100",name:"100"},{id:"200",name:"200"},{id:"500",name:"500"},{id:"1000",name:"1000"},{id:"100000",name:"All"}],D=f.Combo(null,{label:"",states:h,width:E});D.bindToModel(i,"page_length",function(e){var t=parseInt(e);return t!=t?1:t}),i.on({change:"page_length"},function(){i.set({page:1})}),w.push({label:"Page size",ctrl:D});var P=f.CompoundGrid().setSeparation(2,4);$.each(w,function(e,t){t.label?P.setItem(e,0,f.Static('<span class="DescriptionText">'+t.label+":</span>")):P.setItem(e,0,f.Static('<span class="DescriptionText"></span>')),P.setItem(e,1,t.ctrl)});var H=f.CompoundVert([]).setMargin(0);b.controlsShowHide=f.ShowHide(H),u.addControl(b.controlsShowHide),H.addControl(f.VerticalSeparator(3)),H.addControl(P),H.addControl(M),H.addControl(f.VerticalSeparator(3));var B=f.ValueSlider(null,{label:"Row Height:",width:E+75,minval:1,maxval:20,scaleDistance:5,value:a.get("row_height")}).bindToModel(a,"row_height").setClassID(b.table_info.id+"RowHeight");H.addControl(B),H.addControl(f.VerticalSeparator(15)),H.addControl(b.download_button),b.col_query=p.Create(e.col_table.id,{includeCurrentQuery:!0}),b.col_query.notifyQueryUpdated=function(){i.set("col_query",b.col_query.get())},i.set("col_query",b.col_query.get());var j=b.col_query.createQueryControl({hasSection:!0,hasQueryString:!0,defaultHidden:!0});n.addControl(j),b.row_query=p.Create(e.row_table.id,{includeCurrentQuery:!0}),b.row_query.notifyQueryUpdated=function(){i.set("row_query",b.row_query.get()),i.set("page",1)},i.set("row_query",b.row_query.get());var F=b.row_query.createQueryControl({hasSection:!0,hasQueryString:!0,defaultHidden:!0});n.addControl(F),n.addControl(f.Section(u,{title:"Display settings",bodyStyleClass:"ControlsSectionBody"})),b.view=y(a.get()),l.listen("",{type:"SelectionUpdated"},function(e,t){t==b.model.table.row_table.id&&b._draw()}),b.model_params=i,b.view_params=a},b.draw=function(e){b.draw_info=e;if(!e)return;if(e.needZoomIn){b.download_button.enable(!1);return}var t=b.parent_browser.getCurrentChromoID();if(!t)return;var n=e.offsetX/e.zoomFactX,r=(e.sizeCenterX+e.offsetX)/e.zoomFactX;b.model.change_col_range(t,n,r);if(!b.page_controls){b.page_controls=$('<div class="PnGenotypePageControl" style="position:absolute"> </div>');var i=f.Button(null,{icon:"fa-chevron-up",vertShift:-2,width:12,height:12,hint:"Page Up",buttonClass:"PnGenotypesPageArrow"}).setOnChanged(function(){b.model_params.set("page",Math.max(b.model_params.get("page")-1,1))});i.modifyEnabled(b.model_params.get("page")>1);var s=f.Edit(null,{label:"Page:","class":"PnGenotypesPageEdit",size:2});s.bindToModel(b.model_params,"page",function(e){var t=parseInt(e);return t!=t?1:t}),b.page_down=f.Button(null,{icon:"fa-chevron-down",width:12,height:12,hint:"Page Down",buttonClass:"PnGenotypesPageArrow"}).setOnChanged(function(){b.model_params.set("page",b.model_params.get("page")+1)});var o=f.Wrapper(f.CompoundHor([i,f.HorizontalSeparator(6),s,f.HorizontalSeparator(6),b.page_down]),"PnGenotypesPageBox");b.page_controls.append(o.renderHtml()),b.getCanvasElementJQ("center").after(b.page_controls),f.ExecPostCreateHtml(),b.model_params.on({change:"page"},function(){i.modifyEnabled(b.model_params.get("page")>1)})}b.page_controls&&b.page_controls.css({top:Math.max(0,e.top_visible+10),left:e.sizeCenterX/2+e.sizeLeftX-100})},b._draw=function(){var e=b.draw_info;if(!e)return;if(e.needZoomIn){b.download_button.enable(!1);return}var t=5+b.view.link_height+b.view.col_header_height;b.model.row_ordinal.length?t+=b.view.row_height*b.model.row_ordinal.length:t+=b.view.row_height*b.model_params.get("page_length"),t=Math.min(t,8192);if(b._height!=t){b.modifyHeight(t),b._myPlotter.resizeHeight(!0);return}b.page_down&&b.page_down.modifyEnabled(!b.model.row_ordinal.length||b.model.row_ordinal.length==b.model_params.get("page_length")),b.drawStandardGradientLeft(e,1),b.drawStandardGradientRight(e,1),b.view.draw(e.centerContext,e.leftContext,{t:e.top_visible,b:e.bottom_visible,l:0,r:e.centerContext.canvas.clientWidth},b.model),b.drawMark(e),b.download_button.enable(b.model.intervals_being_fetched.length==0),b.drawing=!1;if(b.model.intervals_being_fetched.length>0&&!b.loading_id){var n=function(t){if(b.model.intervals_being_fetched.length>0&&!b.draw_info.needZoomIn){for(var r=0;r<b.model.intervals_being_fetched.length;r++){var i=b.model.intervals_being_fetched[r];for(var s=b.view.col_scale(i.start);s<b.view.col_scale(i.end);s+=b.loadIcon.width*2)b.loadIcon.drawTo(e.centerContext,Math.floor(s/(b.loadIcon.width*2))*b.loadIcon.width*2,10,t)}window.requestAnimationFrame(n)}};window.requestAnimationFrame(n)}},b.mapPositionsReverse=function(e){return b.model.mapPos2Ordinal(e)},b.drawMark=function(e,t){if(!b._isMarkVisible)return;if(!e.mark.present)return;var n=b.view.link_height,r=e.centerContext,i=Math.min(e.mark.pos1,e.mark.pos2),s=Math.max(e.mark.pos1,e.mark.pos2);mark1Pos=b.model.mapOrdinal2Pos(i),mark2Pos=b.model.mapOrdinal2Pos(s);var o=Math.round(i*e.zoomFactX-e.offsetX)-.5,u=Math.round(s*e.zoomFactX-e.offsetX)+.5,a=Math.round(mark1Pos*e.zoomFactX-e.offsetX)-.5,f=Math.round(mark2Pos*e.zoomFactX-e.offsetX)+.5,l=r.createLinearGradient(a,0,f,0),c=Math.max(1,f-a);l.addColorStop(0,"rgba(255,50,0,0.2)"),l.addColorStop(Math.min(.45,30/c),"rgba(255,50,0,0.05)"),l.addColorStop(Math.max(.55,1-30/c),"rgba(255,50,0,0.05)"),l.addColorStop(1,"rgba(255,50,0,0.2)"),r.fillStyle=l,r.fillRect(a,n,f-a,e.sizeY-n),r.beginPath(),r.moveTo(o,0),r.bezierCurveTo(o,n/2,a,n/2,a,n),r.lineTo(f,n),r.bezierCurveTo(f,n/2,u,n/2,u,0),r.closePath(),r.fill(),r.globalAlpha=.5,r.strokeStyle="rgb(255,50,0)",r.beginPath(),r.moveTo(o,0),r.bezierCurveTo(o,n/2,a,n/2,a,n),r.lineTo(a,e.sizeY),r.moveTo(u,0),r.bezierCurveTo(u,n/2,f,n/2,f,n),r.lineTo(f,e.sizeY),r.stroke(),r.globalAlpha=1},b.download_view=function(){var e="";e+="#Dataset: "+m.database+"\r\n",e+="#Workspace: "+m.workspaceid+"\r\n",e+="#Table:"+b.table_info.tableCapNamePlural+b.view.colour_channel=="call"?" Calls":" Allele Depths\r\n",e+="#"+b.table_info.col_table.tableCapNamePlural+" query: "+b.table_info.col_table.createQueryDisplayString(b.model.col_query)+"\r\n",e+="#"+b.table_info.row_table.tableCapNamePlural+" query: "+b.table_info.row_table.createQueryDisplayString(b.model.row_query)+"\r\n",e+="#Choromosome:"+b.model.chrom+"\r\n",e+="#Start:"+Math.floor(b.model.col_start)+"\r\n",e+="#End:"+Math.ceil(b.model.col_end)+"\r\n",v.createStoredURL(function(t){e+="#URL: "+t+"\r\n",e+="Position	";for(var n=0;n<b.model.row_primary_key.length;n++)e+=b.model.row_primary_key[n]+"	";e+="\r\n";var s=b.view.colour_channel=="call"?b.model.settings.Call:b.model.settings.AlleleDepth,o=b.model.data[s],u=o.shape[2]||1;for(n=0;n<b.model.col_ordinal.length;n++){e+=b.model.col_ordinal[n]+"	";for(var a=0;a<b.model.row_ordinal.length;a++){for(var f=0;f<u;f++)e+=o[a][n*u+f],f<u-1&&(e+=",");e+="	"}e+="\r\n"}var l=new r([e],{type:"text/plain;charset=utf-8"});i(l,m.database+"-"+b.view.colour_channel=="call"?" Calls":" Allele Depths-"+b.table_info.tableCapNamePlural+"-"+b.model.chrom+"-"+Math.floor(b.model.col_start)+"~"+Math.ceil(b.model.col_end))})},b.handleMouseClicked=function(e,t,n,r){if(n=="left")var i=b.view.leftEvent("click",{x:e,y:t},b.model,r);else if(n=="center"){var i=b.view.event("click",{x:e,y:t},b.model,r);i.type=="click_col"&&l.send({type:"ItemPopup"},{tableid:b.table_info.col_table.id,itemid:i.col_key})}},b.createVisibilityControl=function(){var e=f.Check(null,{label:"Display",value:!0}).setClassID(b._myID).setOnChanged(function(){b.modifyVisibility(e.getValue()),e.getValue()&&b.scrollInView()});return e},b.modifyVisibility=function(e,t){b._myPlotter.channelModifyVisibility(b.getID(),e,t),t||b._myPlotter.render(),b.controlsShowHide.setVisible(e)};var w=["row_order","row_sort_columns","page","page_length"];return b.storeSettings=function(){var e=t.zipObject(w,t.map(w,function(e){return b.model_params.get(e)}));return e.row_query=b.row_query.store(),e.col_query=b.col_query.store(),e},b.recallSettings=function(e){t.each(w,function(t){e[t]&&b.model_params.set(t,e[t])}),b.row_query.recall(e.row_query,!0),b.col_query.recall(e.col_query,!0)},b.getToolTipInfo=function(e,t){return b.view.getToolTipInfo(e,t,b.model)},b.getLeftToolTipInfo=function(e,t){return b.view.getLeftToolTipInfo(e,t,b.model)},b.init(e,n,u),b},b}),define("Views/GenomeBrowser",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/ChannelPlot/ChannelAnnotation","DQX/ChannelPlot/ChannelMultiCatDensity","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","DQX/DataFetcher/DataFetcherAnnotation","Wizards/EditTableBasedSummaryValues","MetaData","Utils/QueryTool","Views/Genotypes/GenotypeChannel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N={init:function(){var e=n.View("genomebrowser","Genome browser");return e.setEarlyInitialisation(),e.serialisableComponents={},s.listen("",{type:"SelectionUpdated"},function(t,n){var r=S.mapTableCatalog[n];(r.hasGenomePositions||r.hasGenomeRegions)&&e.panelBrowser.render()}),s.listen("",{type:"FindGenomeRegion"},function(t,n){e.genomeRangePopup(n.chromosome,n.start,n.end,n)}),e.storeSettings=function(){var t={};if(e.panelBrowser){t.chromoid=e.panelBrowser.getCurrentChromoID(),t.range=e.panelBrowser.getVisibleRange();var n=e.panelBrowser.getMark();n&&(t.mark=n),t.settings=i.storeSettings(e.visibilityControlsGroup),t.settingsButtons=i.storeSettings(e.buttonsGroup)}return t.datatables={},$.each(S.mapTableCatalog,function(e,n){if(n.hasGenomePositions||n.hasGenomeRegions){var r={};r.query=o.WhereClause.encode(n.genomeBrowserInfo.theQuery.get()),t.datatables[e]=r}}),t.extraComps={},$.each(e.serialisableComponents,function(e,n){t.extraComps[e]=n.storeSettings()}),t},e.recallSettings=function(t){e.recallingSettings=!0,e.panelBrowser.recallingSettings=!0,t.chromoid&&e.panelBrowser&&(e.panelBrowser.setChromosome(t.chromoid,!0,!1),e.panelBrowser.setPosition((t.range.max+t.range.min)/2,t.range.max-t.range.min),t.mark?e.panelBrowser.setMark(t.mark.min,t.mark.max):e.panelBrowser.delMark()),t.settings&&e.visibilityControlsGroup&&i.recallSettings(e.visibilityControlsGroup,t.settings,!1),t.settingsButtons&&e.buttonsGroup&&i.recallSettings(e.buttonsGroup,t.settingsButtons,!1),t.datatables&&$.each(S.mapTableCatalog,function(e,n){if(n.hasGenomePositions||n.hasGenomeRegions)if(t.datatables[e]){tableSett=t.datatables[e];if(tableSett.query){var r=o.WhereClause.decode(tableSett.query);n.genomeBrowserInfo.theQuery.modify(r)}}}),t.extraComps&&$.each(e.serialisableComponents,function(e,n){t.extraComps[e]&&n.recallSettings(t.extraComps[e])}),e.recallingSettings=!1,e.panelBrowser.recallingSettings=!1,$.each(S.tableCatalog,function(t,n){e.rebuildTableBasedSummaryValues(n.id)})},e.fetchers={},e.createFrames=function(t){this.frameControls=r.FrameFinal("",.25).setFrameClassClient("GenomeBrowserControlBackground"),this.frameBrowser=r.FrameFinal("",.75),t.MakeControlsFrame(this.frameControls,this.frameBrowser,280),s.listen("",{type:"JumpgenomeRegion"},e.onJumpGenomeRegion),s.listen("",{type:"JumpgenomePosition"},e.onJumpGenomePosition),s.listen("",{type:"TableBasedSummaryValueSelectionChanged"},function(t,n){e.rebuildTableBasedSummaryValues(n.tableid)})},e.createPanels=function(){this.panelControls=r.Form(this.frameControls);var t=null;$.each(S.mapTableCatalog,function(e,n){n.hasGenomePositions&&(t?t!=n.ChromosomeField&&a.reportError("Inconsistent chromosome field column over different datatables: "+t+", "+n.ChromosomeField):t=n.ChromosomeField)}),t||(t="chrom");var n={serverURL:S.serverUrl,database:S.database,annotTableName:S.tableAnnotation,chromoIdField:t,viewID:"",canZoomVert:!0};this.panelBrowser=h.Panel(this.frameBrowser,n),this.panelBrowser.setMaxXZoomFactor(30,2e6),$.each(S.chromosomes,function(t,n){e.panelBrowser.addChromosome(n.id,n.id,n.len)}),this.panelBrowser.getAnnotationFetcher().setFeatureType("gene","CDS"),this.panelBrowser.getAnnotationChannel().setMinDrawZoomFactX(1/99999999),e.panelBrowser.setOnRangeSelected(function(){var t=e.panelBrowser.getMark();t&&e.genomeRangePopup(e.panelBrowser.getCurrentChromoID(),Math.min(t.min,t.max),Math.max(t.min,t.max),{})}),S.generalSettings.AnnotMaxViewportSize&&this.panelBrowser.getAnnotationChannel().setMaxViewportSizeX(S.generalSettings.AnnotMaxViewportSize),this.panelBrowser.getAnnotationChannel().handleFeatureClicked=function(e){s.send({type:"GenePopup"},e)},S.generalSettings.RefSequenceSumm&&(SeqChannel=v.Channel(S.serverUrl,"SummaryTracks/"+S.database+"/Sequence","Summ"),this.panelBrowser.addChannel(SeqChannel,!0)),e.visibilityControlsGroup=i.CompoundVert([]).setMargin(0),e.buttonsGroup=i.CompoundVert([]).setMargin(0),$.each(S.tableCatalog,function(t,n){if(n.tableBasedSummaryValues.length>0){var r=i.Button(null,{buttonClass:"DQXToolButton2",content:"Select active "+n.tableNamePlural+"...",width:140,height:30,icon:"fa-crosshairs"}).setOnChanged(function(){E.prompt(n.id)});states=[],$.each(n.quickFindFields,function(e,t){states.push({id:t,name:S.findProperty(n.id,t).name})}),n.genomeBrowserFieldChoice=i.Combo(null,{label:"Label: ",states:states}).setClassID("genometrack_displayedfields_"+n.id),n.genomeBrowserFieldChoice.setOnChanged(function(){e.updateTableBasedSummaryValueHeaders()});var s=[];$.each(n.tableBasedSummaryValues,function(t,r){var o=i.Check(null,{label:r.trackname,value:r.settings.defaultVisible}).setClassID("trackactive_"+n.id+"_"+r.trackid).setOnChanged(function(){n.mapTableBasedSummaryValues[o.trackid].isVisible=o.getValue(),e.rebuildTableBasedSummaryValues(n.id)});o.trackid=r.trackid,s.push(o)}),e.buttonsGroup.addControl(i.Section(i.CompoundVert([r,n.genomeBrowserFieldChoice,i.CompoundVert(s)]).setMargin(10),{title:n.tableCapNameSingle+" tracks",headerStyleClass:"GenomeBrowserMainSectionHeader",bodyStyleClass:"ControlsSectionBody"}))}});var o="";o+='<img SRC="Bitmaps/GenomeBrowser.png" style="float:left;margin-right:10px;margin-bottom:5px;opacity:0.7" ></img>',o+='<span class="DescriptionText">'+(S.generalSettings.GenomeBrowserDescr||"Genome browser")+"</span>",e.introText=i.Html(null,o),this.panelControls.addControl(i.CompoundVert([i.Wrapper(e.introText,"ControlsSectionBody"),e.visibilityControlsGroup,e.buttonsGroup]).setMargin(0)),e.reLoad(),s.listen("",{type:"TableFieldCacheModified"},function(){e.updateTableBasedSummaryValueHeaders()})},e.onBecomeVisible=function(){ga("send","screenview",{screenName:e._myID}),e.visibilityControlsGroup&&e.reLoad()},e.onJumpGenomeRegion=function(t,n){if("chromoID"in n)var r=n.chromoID;else{a.assertPresence(n,"chromNr");var r=e.panelBrowser.getChromoID(n.chromNr)}a.assertPresence(n,"start"),a.assertPresence(n,"end"),e.activateState(),e.panelBrowser.highlightRegion(r,(n.start+n.end)/2,n.end-n.start)},e.onJumpGenomePosition=function(t,n){if("chromoID"in n)var r=n.chromoID;else{a.assertPresence(n,"chromNr");var r=e.panelBrowser.getChromoID(n.chromNr)}a.assertPresence(n,"position"),e.activateState(),e.panelBrowser.highlightRegion(r,n.position,0)},e.getSummaryFetcher=function(t){var n=null;return $.each(e.listDataFetcherProfiles,function(e,r){r.minblocksize==t&&r.usedChannelCount<12&&(n=r)}),n||(n=new b.Fetcher(S.serverUrl,t,800),n.usedChannelCount=0,n.minblocksize=t,e.listDataFetcherProfiles.push(n)),n.usedChannelCount++,n},e.createSummaryChannels=function(){if(S.summaryValues.length==0)return;var t=[];$.each(S.summaryValues,function(n,r){var s=!1;$.each(S.customProperties,function(e,t){t.tableid==r.tableid&&t.propid==r.propid&&t.settings.showInBrowser&&(s=!0)});if(!s){var o="smm"+r.tableid+"_"+r.propid,u=e.getSummaryFetcher(r.minblocksize),f=o,l=e.summaryFolder+"/"+r.propid;if(!r.settings.isCategorical){var c=e.channelMap[f];if(!c){var c=p.Channel(f,{minVal:r.minval,maxVal:r.maxval});c.setTitle(r.name).setHeight(120,!0).setChangeYScale(!0,!0),c.controls=i.CompoundVert([]),e.panelBrowser.addChannel(c),e.channelMap[f]=c}e.listSummaryChannels.push(f);var h=a.parseColorString(r.settings.channelColor),d=u.addFetchColumn(l,"Summ",r.propid+"_min"),v=u.addFetchColumn(l,"Summ",r.propid+"_max"),m=c.addComponent(p.YRange(null,u,d.myID,v.myID,h.changeOpacity(.25)),!0),y=u.addFetchColumn(l,"Summ",r.propid+"_avg"),b=c.addComponent(p.Comp(null,u,y.myID,!1),!0);b.setColor(h),b.myPlotHints.makeDrawLines(3e6),b.myPlotHints.interruptLineAtAbsent=!0,b.myPlotHints.drawPoints=!1;var w=c.createVisibilityControl(!r.settings.DefaultVisible);t.push(w)}else{var E=u.addFetchColumn(l,"Summ",r.propid+"_cats");u.activateFetchColumn(E.myID);var x=1;r.settings.MaxVal&&(x=r.settings.MaxVal);var c=e.channelMap[f];if(!c){var c=g.Channel(f,u,E,{maxVal:x,categoryColors:r.settings.categoryColors});c.setTitle(r.name).setHeight(120,!0).setChangeYScale(!0,!0),c.controls=i.CompoundVert([]),e.panelBrowser.addChannel(c),e.channelMap[f]=c}e.listSummaryChannels.push(f);var T=null;if(r.settings.categoryColors){var T={};$.each(r.settings.categoryColors,function(e,t){T[e]=a.parseColorString(t)})}var w=i.Check(null,{label:r.name,hint:r.settings.Description,value:r.settings.DefaultVisible}).setClassID("compvisib_"+r.propid).setOnChanged(function(){e.panelBrowser.channelModifyVisibility(c.getID(),w.getValue()),c.chk_percent&&c.chk_percent.modifyEnabled(w.getValue()),w.getValue()&&c.scrollInView()});e.panelBrowser.channelModifyVisibility(c.getID(),w.getValue()),t.push(w);if(T){var N=[];if(T){var C="";$.each(T,function(e,t){e!="_other_"&&(C&&(C+=" &nbsp; "),C+='<span style="background-color:{cl}">&nbsp;&nbsp;</span>&nbsp;'.DQXformat({cl:t.toString()})+e)}),N.push(i.Html(null,C))}if(c&&T){var k=i.Check(null,{label:"Show density as percentage"}).setClassID("denspercent"+r.propid).setOnChanged(function(t,n){c._scaleRelative=n.getValue(),e.panelBrowser.render()});k.modifyEnabled(r.settings.DefaultVisible),N.push(k),c.chk_percent=k}t.push(i.CompoundVert(N).setTreatAsBlock(!0).setLeftIndent(25))}}}});if(t.length>0){var n=i.CompoundVert(t).setMargin(10);e.visibilityControlsGroup.addControlTop(i.Section(n,{title:"Genome tracks",headerStyleClass:"GenomeBrowserMainSectionHeader",bodyStyleClass:"ControlsSectionBody"}))}},e.createPositionChannel=function(t,n,r,o){var u=t.id+"_"+n.propid;t.genomeBrowserInfo.currentCustomProperties.push(u);var f=!!n.settings.BrowserDefaultVisible,l=!!n.settings.BrowserShowOnTop;l&&(f=!0);var c=null;if(S.hasSummaryValue(n.tableid,n.propid)){var h=S.findSummaryValue(n.tableid,n.propid);h.isDisplayed=!0;var p=new b.Fetcher(S.serverUrl,h.minblocksize,800);p.usedChannelCount=0,p.minblocksize=h.minblocksize,e.listDataFetcherProfiles.push(p);var v=e.summaryFolder+"/"+n.propid,m=p.addFetchColumn(v,"Summ",n.propid+"_cats");p.activateFetchColumn(m.myID);var y=t.id+"_"+n.propid+"_dens",w=1;n.settings.SummaryValues.MaxDensity&&(w=n.settings.SummaryValues.MaxDensity);var c=g.Channel(y,p,m,{maxVal:w,categoryColors:n.settings.categoryColors}),E=120;t.settings.BrowserTrackHeightFactor&&(E=Math.round(E*t.settings.BrowserTrackHeightFactor)),c.setTitle(n.name).setHeight(E).setSubTitle(t.tableCapNamePlural),e.panelBrowser.addChannel(c,!1),e.panelBrowser.channelModifyVisibility(c.getID(),f,!0)}var x=d.Channel(u,o,t.primkey);if(!l)var T=n.name+"-"+t.tableCapNamePlural;else var T=t.tableCapNamePlural;x.setTitle(T).setMaxViewportSizeX(t.settings.GenomeMaxViewportSizeX),x.setSelectionStateHandler(t.isItemSelected);var N=null;if(n.settings.categoryColors){var N={};$.each(n.settings.categoryColors,function(e,t){N[e]=a.parseColorString(t)}),x.makeCategoricalColors(n.propid,N)}else n.isBoolean&&x.makeCategoricalColors(n.propid,{"":a.Color(.85,.25,0),0:a.Color(.85,.25,0),1:a.Color(0,.5,1)});x.setToolTipHandler(function(e,t){var r=o.getPosition(t),i=o.getColumnPoint(t,n.propid),s=e+"<br/>Position= "+r;return s+="<br/><b>"+n.name+"= "+n.toDisplayString(i)+"</b>",s}),x.setClickHandler(function(e){s.send({type:"ItemPopup"},{tableid:t.id,itemid:e})}),e.panelBrowser.addChannel(x,l),e.panelBrowser.channelModifyVisibility(x.getID(),f,!0);if(!l){var C=i.Check(null,{label:n.name,hint:n.settings.Description,value:f}).setClassID("compvisib_"+n.propid).setOnChanged(function(){e.panelBrowser.channelModifyVisibility(x.getID(),C.getValue()),c&&(e.panelBrowser.channelModifyVisibility(c.getID(),C.getValue()),c.chk_percent.modifyEnabled(C.getValue()),C.getValue()&&c.scrollInView())});r.addControl(C)}if(N){var k=[];if(N){var L="";$.each(N,function(e,t){e!="_other_"&&(L&&(L+=" &nbsp; "),L+='<span style="background-color:{cl}">&nbsp;&nbsp;</span>&nbsp;'.DQXformat({cl:t.toString()})+e)}),k.push(i.Html(null,L))}c&&N&&(chk_densPercent=i.Check(null,{label:"Show density as percentage"}).setClassID("denspercent"+n.propid).setOnChanged(function(t,n){c._scaleRelative=n.getValue(),e.panelBrowser.render()}),chk_densPercent.modifyEnabled(f),k.push(chk_densPercent),c.chk_percent=chk_densPercent),r&&r.addControl(i.CompoundVert(k).setTreatAsBlock(!0).setLeftIndent(25))}},e.createPropertyChannel=function(t,n,r,o){var u=t.id+"_"+n.propid;t.genomeBrowserInfo.currentCustomProperties.push(u);if(n.settings.channelName)var f=n.settings.channelName,l=n.settings.channelName,c=!1;else var f=u,l=n.name,c=!0;var h=e.channelMap[f];if(!h){h=p.Channel(u,{minVal:n.settings.MinVal,maxVal:n.settings.MaxVal});var d=150;t.settings.BrowserTrackHeightFactor&&(d=Math.round(d*t.settings.BrowserTrackHeightFactor)),h.setTitle(l).setSubTitle(t.tableCapNamePlural).setHeight(d,!0).setChangeYScale(!0,!0),e.panelBrowser.addChannel(h,!1),e.channelMap[f]=h,h.controls=i.CompoundVert([]),n.settings.channelName&&(r.addControl(i.Static(l+":")),h.controls.setTreatAsBlock(!0).setLeftIndent(20)),r.addControl(h.controls),h.getToolTipContent=function(e,r){var i=o.getColumnPoint(r,t.primkey),s=o.getPosition(r),u=o.getColumnPoint(r,e);return i+"<br/>Position= "+s+"<br/><b>"+S.findProperty(n.tableid,e).name+"= "+n.toDisplayString(u)+"</b>"},h.handlePointClicked=function(e,n){var r=o.getColumnPoint(n,t.primkey);s.send({type:"ItemPopup"},{tableid:t.id,itemid:r})}}var v=null;if(S.hasSummaryValue(n.tableid,n.propid)){var m=function(){return v?T._drawViewportSize>v._maxViewportSizeX?1:.2:1},g=S.findSummaryValue(n.tableid,n.propid);g.isDisplayed=!0;var y=a.parseColorString(g.settings.channelColor),b=e.getSummaryFetcher(g.minblocksize),w=e.summaryFolder+"/"+n.propid,E=b.addFetchColumn(w,"Summ",n.propid+"_min"),x=b.addFetchColumn(w,"Summ",n.propid+"_max"),T=h.addComponent(p.YRange(null,b,E.myID,x.myID,y.changeOpacity(.25)),!0);T.myPlotHints.getOpacity=m;var N=b.addFetchColumn(w,"Summ",n.propid+"_avg"),C=h.addComponent(p.Comp(null,b,N.myID,!1),!0);C.setColor(y),C.myPlotHints.getOpacity=m,C.myPlotHints.makeDrawLines(3e6),C.myPlotHints.interruptLineAtAbsent=!0,C.myPlotHints.drawPoints=!1}var k=!1;n.datatype=="HighPrecisionValue"&&(k=!0),v=h.addComponent(p.Comp(null,o,n.propid,k),!0),v.myPlotHints.pointStyle=1,v.myPlotHints.color=a.parseColorString(n.settings.channelColor),v.setMaxViewportSizeX(t.settings.GenomeMaxViewportSizeX),n.settings.connectLines&&v.myPlotHints.makeDrawLines(1e99);var L=n.name;v.myPlotHints.color.isBlack()||(L='&nbsp;<span style="background-color:{cl}">&nbsp;&nbsp;</span>&nbsp;'.DQXformat({cl:v.myPlotHints.color.toString()})+L);var A=n.settings.BrowserDefaultVisible;if(c)var O=h.createVisibilityControl(!A);else var O=h.createComponentVisibilityControl(n.propid,L,!1,!A);var M=i.ImageButton(null,{bitmap:"Bitmaps/actionbuttons/info.png",vertShift:-2}).setOnChanged(function(){s.send({type:"PropInfoPopup"},{tableid:t.id,propid:n.propid})});h.controls.addControl(i.CompoundHor([O,i.HorizontalSeparator(8),M]))},e.reLoad=function(){if(e.uptodate)return;e.uptodate=!0,e.visibilityControlsGroup&&e.visibilityControlsGroup.clear(),e.channelMap={},e.listDataFetcherProfiles&&$.each(e.listDataFetcherProfiles,function(t,n){e.panelBrowser.delDataFetcher(n)}),e.listSummaryChannels&&$.each(e.listSummaryChannels,function(t,n){e.panelBrowser.delChannel(n)}),e.listDataFetcherProfiles=[],e.listSummaryChannels=[],e.summaryFolder="SummaryTracks/"+S.database,e.createSummaryChannels(),$.each(S.mapTableCatalog,function(t,n){if(n.hasGenomePositions){n.genomeBrowserInfo.dataFetcher&&($.each(n.genomeBrowserInfo.currentCustomProperties,function(t,n){e.panelBrowser.delChannel(n)}),e.panelBrowser.delDataFetcher(n.genomeBrowserInfo.dataFetcher));var r=i.CompoundVert([]).setMargin(0);e.visibilityControlsGroup.addControl(i.Section(r,{title:n.tableCapNamePlural,headerStyleClass:"GenomeBrowserMainSectionHeader"})),n.genomeBrowserInfo.theQuery=x.Create(n.id,{includeCurrentQuery:!0}),n.genomeBrowserInfo.theQuery.notifyQueryUpdated=function(){n.genomeBrowserInfo.dataFetcher.setUserQuery2(o.WhereClause.Trivial()),e.panelBrowser.render()};var s=n.genomeBrowserInfo.theQuery.createQueryControl({hasSection:!0,hasQueryString:!0,defaultHidden:!0}),u=i.CompoundVert([]).setMargin(0);r.addControl(u);var a=new y.Curve(S.serverUrl,S.database,n.getQueryTableName(!1),n.PositionField);a.setMaxViewportSizeX(1.2*n.settings.GenomeMaxViewportSizeX),a.setReportIfError(!0),n.genomeBrowserInfo.dataFetcher=a,a.addFetchColumnActive(n.primkey,"String"),n.genomeBrowserInfo.dataFetcher.setUserQuery2(o.WhereClause.Trivial()),n.genomeBrowserInfo.currentCustomProperties=[],$.each(n.propertyGroups,function(t,r){var s=null,o=null;$.each(r.properties,function(t,f){var l=null;f.settings.showInBrowser&&(f.tableid==n.id&&f.isFloat&&(l=e.createPropertyChannel),f.tableid==n.id&&(f.isText||f.isBoolean)&&(l=e.createPositionChannel)),l&&(!o&&!f.settings.BrowserShowOnTop&&(o=i.CompoundVert([]).setMargin(5),s=i.Section(o,{title:r.Name,headerStyleClass:"DQXControlSectionHeader",bodyStyleClass:"ControlsSectionBodySubSection"}),u.addControl(s)),l(n,f,o,a))})})}}),$.each(S.mapTableCatalog,function(t,n){if(n.hasGenomeRegions){var r=i.CompoundVert([]).setMargin(0);e.visibilityControlsGroup.addControl(i.Section(r,{title:n.tableCapNamePlural,headerStyleClass:"GenomeBrowserMainSectionHeader"})),n.genomeBrowserInfo.theQuery=x.Create(n.id,{includeCurrentQuery:!0}),n.genomeBrowserInfo.theQuery.notifyQueryUpdated=function(){n.genomeBrowserInfo.dataFetcher.setUserQuery2(n.genomeBrowserInfo.theQuery.get()),e.panelBrowser.render()};var o=n.genomeBrowserInfo.theQuery.createQueryControl({hasSection:!0,hasQueryString:!0,defaultHidden:!0});r.addControl(o),states=[{id:"",name:"-None-"}],$.each(S.customProperties,function(e,t){t.tableid==n.id&&states.push({id:t.propid,name:t.name})}),n.genomeBrowserInfo.defaultRegionFieldName=n.primkey,n.settings.BrowserDefaultLabel&&(n.settings.BrowserDefaultLabel=="None"?n.genomeBrowserInfo.defaultRegionFieldName="":n.genomeBrowserInfo.defaultRegionFieldName=n.settings.BrowserDefaultLabel),n.genomeBrowserFieldChoice=i.Combo(null,{label:"Label: ",states:states,value:n.genomeBrowserInfo.defaultRegionFieldName}).setClassID("region_name_"+n.id),n.genomeBrowserFieldChoice.setOnChanged(function(){n.genomeBrowserInfo.dataFetcher.field_name=n.genomeBrowserFieldChoice.getValue(),n.genomeBrowserInfo.dataFetcher.clearData(),e.panelBrowser.render()}),n.genomeBrowserColorChoice=i.Combo(null,{label:"Color: ",states:states,value:""}).setClassID("region_color_"+n.id),n.genomeBrowserColorChoice.setOnChanged(function(){n.genomeBrowserInfo.dataFetcher.extrafield1=n.genomeBrowserColorChoice.getValue(),n.genomeBrowserInfo.dataFetcher.extrafield1||n.genomeBrowserColorLegend.modifyValue(""),n.genomeBrowserInfo.dataFetcher.clearData(),n.genomeBrowserInfo.regionChannel.funcMapExtraField2Color=function(e){var t=S.findProperty(n.id,n.genomeBrowserInfo.dataFetcher.extrafield1),r=t.mapColors(e),i=r.indices,s=r.colors,o=[];for(var u=0;u<i.length;u++)o.push(s[i[u]]);var a="";return $.each(r.legend,function(e,t){a&&(a+=" &nbsp; "),a+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}'.DQXformat({cl:t.color.toString(),name:t.state})}),n.genomeBrowserColorLegend.modifyValue(a),o},e.panelBrowser.render()}),n.genomeBrowserColorLegend=i.Html(null,""),dispSettingsControlsGroup=i.CompoundVert([]).setMargin(8),r.addControl(i.Section(dispSettingsControlsGroup,{title:"Display settings",bodyStyleClass:"ControlsSectionBody"}));var u={database:S.database,serverURL:S.serverUrl,annotTableName:n.getQueryTableName(!1)},a=new w.Fetcher(u);n.genomeBrowserInfo.dataFetcher=a,a.setFeatureType("",""),a.field_start=n.settings.RegionStart,a.field_stop=n.settings.RegionStop,a.field_chrom=n.settings.Chromosome,a.field_id=n.primkey,a.field_name=n.genomeBrowserInfo.defaultRegionFieldName,a.fetchSubFeatures=!1,e.panelBrowser.addDataFetcher(a);var f=m.Channel("regions_"+n.id,a),l=60;n.settings.BrowserTrackHeightFactor&&(l=Math.round(l*n.settings.BrowserTrackHeightFactor)),f.setHeight(l),f.setTitle(n.tableCapNamePlural),f.setMaxViewportSizeX(n.settings.GenomeMaxViewportSizeX),f.setMinDrawZoomFactX(1/99999999),e.panelBrowser.addChannel(f,!1),f.handleFeatureClicked=function(e){s.send({type:"ItemPopup"},{tableid:n.id,itemid:e})},n.genomeBrowserInfo.regionChannel=f;var c=f.createVisibilityControl(!n.settings.BrowserDefaultVisible,"Display");dispSettingsControlsGroup.addControl(c),dispSettingsControlsGroup.addControl(n.genomeBrowserFieldChoice),dispSettingsControlsGroup.addControl(n.genomeBrowserColorChoice),dispSettingsControlsGroup.addControl(n.genomeBrowserColorLegend)}}),$.each(S.map2DTableCatalog,function(t,n){if(!n.settings.ShowInGenomeBrowser)return;var r=i.CompoundVert([]).setMargin(0);e.visibilityControlsGroup.addControl(i.Section(r,{title:n.tableCapNamePlural,headerStyleClass:"GenomeBrowserMainSectionHeader"}));var s=T.Channel(n,r,e.panelBrowser);s.setMaxViewportSizeX(n.settings.GenomeMaxViewportSizeX),e.panelBrowser.addChannel(s,!1),e.serialisableComponents["genotypes_"+t]=s}),e.tableBasedSummaryValue_Add=function(t,n,r){var o=S.getTableInfo(t).mapTableBasedSummaryValues[n],u=n+"_"+r;if(e.panelBrowser.findChannel(u))e.panelBrowser.findChannelRequired(u).modifyVisibility(!0,!0);else{var f=e.getSummaryFetcher(o.minblocksize),l=e.summaryFolder+"/TableTracks/"+t+"/"+n+"/"+r,c=p.Channel(u,{minVal:o.minval,maxVal:o.maxval});c.setTitle(u).setHeight(Math.round(50*e.panelBrowser.variableHeightFactor),!0).setChangeYScale(!0,!0),c.controls=i.CompoundVert([]),c.fromTable_tableid=t,c.fromTable_trackid=n,c.fromTable_trackid=n,c.fromTable_recordid=r,c.setSubTitle(o.trackname),c.setOnClickHandler(function(){s.send({type:"ItemPopup"},{tableid:t,itemid:r})}),e.panelBrowser.addChannel(c),e.channelMap[u]=c;var h=a.parseColorString(o.settings.channelColor),d=f.addFetchColumn(l,"Summ",u+"_min"),v=f.addFetchColumn(l,"Summ",u+"_max"),m=c.addComponent(p.YRange(null,f,d.myID,v.myID,h.changeOpacity(.25)),!0),g=f.addFetchColumn(l,"Summ",u+"_avg"),y=c.addComponent(p.Comp(null,f,g.myID),!0);y.setColor(h),y.myPlotHints.makeDrawLines(3e6),y.myPlotHints.interruptLineAtAbsent=!0,y.myPlotHints.drawPoints=!1}return e.panelBrowser.findChannelRequired(u)},e.rebuildTableBasedSummaryValues=function(t){if(e.recallingSettings)return;var n=S.getTableInfo(t),r={},i=[];$.each(e.panelBrowser.getChannelList(),function(e,s){s.fromTable_tableid==t&&(s.getVisible()&&(!n.mapTableBasedSummaryValues[s.fromTable_trackid].isVisible||!n.genomeTrackSelectionManager.isItemSelected(s.fromTable_recordid))&&(s.modifyVisibility(!1,!0),i.push(s.getID())),r[s.fromTable_trackid+"_"+s.fromTable_recordid]=s.getVisible())}),$.each(i,function(t,n){e.panelBrowser.delChannel(n)});var s=n.genomeTrackSelectionManager.getSelectedList(),o=null;$.each(s,function(i,s){$.each(n.tableBasedSummaryValues,function(n,i){if(i.isVisible&&!r[i.trackid+"_"+s]){var u=e.tableBasedSummaryValue_Add(t,i.trackid,s);o||(o=u)}})}),o&&o.scrollInView(),e.panelBrowser.handleResize(),e.updateTableBasedSummaryValueHeaders()},e.updateTableBasedSummaryValueHeaders=function(){$.each(e.panelBrowser.getChannelList(),function(e,t){if(t.fromTable_tableid){var n=S.getTableInfo(t.fromTable_tableid),r=n.genomeBrowserFieldChoice.getValue(),i=n.fieldCache.getField(t.fromTable_recordid,r);t.setTitle(i);var s="";$.each(n.quickFindFields,function(e,r){s+="<b>"+S.findProperty(n.id,r).name+": </b>",s+=n.fieldCache.getField(t.fromTable_recordid,r),s+="<br/>"}),t.setHeaderTooltip(s)}}),e.panelBrowser.render()},e.formatBpValue=function(e){var t=e.toFixed(0);t=t.split("").reverse().join("");var n=[];for(var r=0;r<t.length;r++)r>0&&r%3==0&&n.push(","),n.push(t[r]);return t=n.reverse().join(""),t},e.genomeRangePopup=function(t,n,r,u){var a="",f=!1,h=t+":"+parseInt(n)+"-"+parseInt(r),p=i.CompoundGrid();p.setSeparation(12,2),p.setItem(0,0,i.Static("Chromosome")),p.setItem(0,1,i.Static(t)),p.setItem(1,0,i.Static("Begin")),p.setItem(1,1,i.Static(e.formatBpValue(n)+" bp")),p.setItem(2,0,i.Static("End")),p.setItem(2,1,i.Static(e.formatBpValue(r)+" bp")),p.setItem(3,0,i.Static("Length")),p.setItem(3,1,i.Static(e.formatBpValue(r-n+1)+" bp")),a+="<p>"+h+"<p>",a+=p.renderHtml(),a+="<p>";if(u&&u.buttonShowRegion){var d=i.Button(null,{buttonClass:"DQXToolButton2",content:"Show in genome browser",bitmap:"Bitmaps/GenomeBrowserSmall.png",width:160,height:50}).setOnChanged(function(){l.closeIfNeeded(v),c.minimiseAll({slow:!0}),s.send({type:"JumpgenomeRegion"},{chromoID:t,start:n,end:r})});a+=d.renderHtml()}$.each(S.mapTableCatalog,function(e,u){if(u.hasGenomePositions){f=!0;var c=u.genomeBrowserInfo.theQuery.get();c=o.WhereClause.createValueRestriction(c,u.ChromosomeField,t),c=o.WhereClause.createRangeRestriction(c,u.PositionField,n,r);var p=i.Button(null,{buttonClass:"DQXToolButton2",content:u.tableCapNamePlural+" in range",icon:u.settings.Icon?u.settings.Icon:"fa-table",width:160,height:50}).setOnChanged(function(){s.send({type:"DataItemTablePopup"},{tableid:u.id,query:c,title:u.tableCapNamePlural+" in "+h}),l.closeIfNeeded(v)});a+=p.renderHtml()}if(u.hasGenomeRegions){f=!0;var c=u.genomeBrowserInfo.theQuery.get();c=o.WhereClause.createValueRestriction(c,u.settings.Chromosome,t),c=o.WhereClause.createValueRestriction(c,u.settings.RegionStart,r,"<="),c=o.WhereClause.createValueRestriction(c,u.settings.RegionStop,n,">=");var p=i.Button(null,{buttonClass:"DQXToolButton2",content:u.tableCapNamePlural+" spanning range",icon:u.settings.Icon?u.settings.Icon:"fa-table",width:160,height:50}).setOnChanged(function(){s.send({type:"DataItemTablePopup"},{tableid:u.id,query:c,title:u.tableCapNamePlural+" spanning "+h}),l.closeIfNeeded(v)});a+=p.renderHtml()}});var v=l.create("Genome region",a)},this.panelControls.render(),e.panelBrowser.handleResize(),e.panelBrowser.setChromosome(S.chromosomes[0].id,!0,!0)},e}};return N}),define("InfoPopups/ItemGenomeTracksPopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/PopupFrame","DQX/Wizard","DQX/Popup","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","Views/GenomeBrowser"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y.show=function(e,t){var r="";$.each(e.tableBasedSummaryValues,function(s,u){var a=i.Button(null,{content:"Show <b>"+u.trackname+"</b>",buttonClass:"DQXToolButton2",bitmap:"Bitmaps/GenomeBrowserSmall.png",width:200,height:30}).setOnChanged(function(){e.genomeTrackSelectionManager.isItemSelected(t)||e.genomeTrackSelectionManager.selectItem(t,!0),e.mapTableBasedSummaryValues[u.trackid].isVisible||(e.mapTableBasedSummaryValues[u.trackid].isVisible=!0,n.getView("genomebrowser").rebuildTableBasedSummaryValues(e.id)),c.minimiseAll(),n.activateView("genomebrowser"),p.closeIfNeeded(o)});r+="<br>"+a.renderHtml()});var s=i.Button(null,{content:"Hide all",buttonClass:"DQXToolButton2",icon:"fa-ban",width:200,height:30}).setOnChanged(function(){e.genomeTrackSelectionManager.isItemSelected(t)&&e.genomeTrackSelectionManager.selectItem(t,!1),p.closeIfNeeded(o)});r+="<p>"+s.renderHtml();var o=p.create("Genome tracks",r)},y}),define("DQX/SVG",["DQX/Utils"],function(e){var t={};t.PieChart=function(){var t={};return t.myCallbackObject=null,t.myParts=[],t.addPart=function(e,n,r,i){t.myParts.push({frac:e,color:n,id:r,hint:i})},t.render=function(e,t,n){var r=0;for(var i=0;i<this.myParts.length;i++)r+=this.myParts[i].frac;if(r<=0)return;var s=0,o="<g>";if(n>1){o+='<circle class="pieshadow" cx="{cx}" cy="{cy}" r="{rd}"/>'.DQXformat({cx:e+3,cy:t+3,rd:n-1});for(var i=0;i<this.myParts.length;i++){var u=s+this.myParts[i].frac;this.myParts[i].frac>0&&n>1&&(o+=this._renderPie(e,t,s/r*2*Math.PI,u/r*2*Math.PI,n-1,this.myParts[i].color,i,this.myParts[i].hint),s=u)}}return o+="</g>",o},t._renderPie=function(t,n,r,i,s,o,u,a){s<0&&e.reportError("Negative radius");if(i-r>=2*Math.PI-1e-4)var f='<circle class="piepart" cx="{cx}" cy="{cy}" r="{rd}"'.DQXformat({cx:t,cy:n,rd:s}),l="circle";else{var l="path",f='<path class="piepart" d="',c=t.toFixed(3),h=n.toFixed(3),p=s.toFixed(3),d=(t+s*Math.cos(r)).toFixed(3),v=(n+s*Math.sin(r)).toFixed(3),m=(t+s*Math.cos(i)).toFixed(3),g=(n+s*Math.sin(i)).toFixed(3),y=i-r>Math.PI?1:0;f+="M"+c+","+h+" ",f+="L"+d+","+v+" ",f+="A"+p+","+p+" 0 "+y+",1 "+m+","+g+" ",f+='Z"'}return f+=' style="fill:'+o.toString()+'; "',this.myCallbackObject&&(f+='onclick="{fn}"'.DQXformat({fn:e.ObjectMapper.CreateCallBackFunctionString(this.myCallbackObject,"pieClick",u)})),f+=">",a&&(f+="<title>"+a+"</title>"),f+="</"+l+">",f},t},t.translate=function(t,n,r){t.attr("transform",function(t,i){return"translate("+e.functor(n)(t,i)+","+e.functor(r)(t,i)+")"})},t.length=function(e,t,n){e.attr(t,function(e,r){return n(e[t])-n(0)})},t.clamp_scale=function(e,t,n){var r=e.domain();if(r[0]<=t&&r[1]>=n)e.domain([t,n]);else{var i=r[1]-r[0];r[0]<t&&(r[0]=t,r[1]=r[0]+i,r[1]>n&&(r[1]=n)),r[1]>n&&(r[1]=n,r[0]=r[1]-i,r[0]<t&&(r[0]=t)),e.domain(r)}},t.scale_min_width=function(e,t){var n=e.domain(),r=n[1]-n[0];r<t&&(n[0]-=(t-r)/2,n[1]+=(t-r)/2,e.domain(n))},t.scale_integer_step=function(e){var t=e(1)-e(0),n=e.domain(),r=e.range();t>1&&(t=Math.ceil(t),e.range([r[0],r[0]+t*(n[1]-n[0])]))},t.update_zoom=function(e,t,n,r,i,s){var o=e.domain(),u=(r-n)/(o[1]-o[0]),a=d3.scale.linear().domain([n,r]).range([i,s]);t.scale(u).translate([i+ -a(o[0])*u,0])},t.transition=function(e,t){return t>0?e.transition().duration(t):e},t.hue_to_rgb=function(e,t,n){var r;return n<0?n+=1:n>1&&(n-=1),6*n<1?r=e+(t-e)*n*6:2*n<1?r=t:3*n<2?r=e+(t-e)*(2/3-n)*6:r=e,255*r},t.hsl_to_rgb=function(e,n,r){var i,s,o,u,a,f;return n/=100,r/=100,n==0?u=a=f=r*255:(r<=.5?s=r*(n+1):s=r+n-r*n,i=r*2-s,o=e/360,u=t.hue_to_rgb(i,s,o+1/3),a=t.hue_to_rgb(i,s,o),f=t.hue_to_rgb(i,s,o-1/3)),{r:u,g:a,b:f}},t.genotype_rgb=function(e,n,r){var i,s,o;return r==null&&(r=!1),i=e+n,r?s=Math.max(100-i*2.5,75):s=Math.max(100-i*5,50),i>0?r?o=Math.round(118-n/i*65):o=Math.round(240+n/i*120):o=0,t.hsl_to_rgb(o,100,s)};var n=document.createElement("canvas");n.height=1;var r=document.createElement("canvas");return r.height=1,t.data_uri_from_genotypes=function(e){if(e.length>0){n.width=e.length;var r=n.getContext("2d"),i=r.createImageData(n.width,n.height),s=i.data;return e.forEach(function(e,n){var r=n*4,i=t.genotype_rgb(e.ref,e.alt);s[r]=i.r,s[r+1]=i.g,s[r+2]=i.b,s[r+3]=255}),r.putImageData(i,0,0),n.toDataURL("image/png")}return"data:,"},t.fast_style_tween=function(e,t,n,r){e.tween?e.tween("style."+t,function(){if(this["val_"+t]==undefined&&r==undefined)return this.style.setProperty(t,n),this["val_"+t]=n,null;if(this["val_"+t]==n&&r==undefined)return null;var e;return r==undefined?e=d3.interpolate(this["val_"+t],n):e=d3.interpolate(r,n),function(n){this.style.setProperty(t,e(n)),this["val_"+t]=e(n)}}):e.style(t,n)},t}),define("InfoPopups/DataItemViews/ItemPropertyLine",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T={};return T.createTableLine=function(e,t,n){var r={};n.parents&&$.each(n.parents,function(e,t){r[t.tableid]=t.fields});var o="",u=null,f=null,l=null,c=null;if(t.indexOf("@")<0)l=E.findProperty(e.id,t),c=n.fields[t],l.relationParentTableId&&(u=function(){s.send({type:"ItemPopup"},{tableid:l.relationParentTableId,itemid:n.fields[t]})},f="fa-external-link-square"),l.settings.ExternalUrl&&(u=function(){var e=l.toDisplayString(n.fields[t]).split(";");e.forEach(function(e){var t=l.settings.ExternalUrl.DQXformat({value:e});window.open(t,"_blank")})},f="fa fa-external-link");else{var h=t.split("@")[1];t=t.split("@")[0],l=E.findProperty(h,t),r[h]||a.reportError("Missing parent item data for "+h),c=r[h][t]}var p=i.ImageButton(null,{bitmap:"Bitmaps/actionbuttons/info.png",vertShift:-2}).setOnChanged(function(){s.send({type:"PropInfoPopup"},{tableid:e.id,propid:l.propid,dataValues:[{name:n.fields[e.primkey],value:c}]})});o+="<tr>",o+='<td style="padding-bottom:3px;padding-top:3px;white-space:nowrap" title="{hint}"><b>{name}</b> {infobuttonhtml}</td>'.DQXformat({hint:l.settings.Description||"",name:l.name,infobuttonhtml:p.renderHtml()}),o+='<td style="padding-left:5px;word-wrap:break-word;">';var d=l.toDisplayString(c);if(!u)o+=d;else{var v=i.Hyperlink(null,{content:'<span class="fa {icon}" style="font-size: 120%"></span> {content}'.DQXformat({icon:f,content:d})});v.setOnChanged(u),o+=v.renderHtml()}return o+="</td>",o+="</tr>",o},T}),define("InfoPopups/DataItemViews/DefaultView",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","InfoPopups/DataItemViews/ItemPropertyLine"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N={};return N.create=function(e,t){var n={};return n.createFrames=function(t){return n.frameFields=r.FrameFinal("",1).setAllowScrollBars(!0,!0).setDisplayTitle(e.Name),t.addMemberFrame(n.frameFields),n.frameFields},n.setContent=function(e){function r(e){var n=E.mapTableCatalog[e.tableid];t+="<table>",$.each(E.customProperties,function(r,i){i.tableid==n.id&&(t+=T.createTableLine(n,i.propid,e))}),t+="</table>",$.each(e.parents,function(e,n){var o=E.mapTableCatalog[n.tableid];t+='<div style="padding-left:30px">',t+='<div style="color:rgb(128,0,0);background-color: rgb(240,230,220);padding:3px;padding-left:8px"><i>',t+=n.relation.forwardname+" "+o.tableNameSingle,t+="</i>&nbsp;&nbsp;";var u=i.Hyperlink(null,{content:'<span class="fa fa-external-link-square" style="font-size: 120%"></span> Open'});u.setOnChanged(function(){s.send({type:"ItemPopup"},{tableid:n.tableid,itemid:n.fields[o.primkey]})}),t+=u.renderHtml(),t+="</div>",r(n),t+="</div>"})}var t="";n.id=a.getNextUniqueID();var t='<div id="'+id+'" style="padding:8px">';r(e),t+="</div>",n.frameFields.setContentHtml(t)},n.createPanels=function(){n.setContent(t)},n.update=function(e){$("#"+n.id).remove(),n.setContent(e)},n.onClose=function(){},n},N}),define("InfoPopups/DataItemViews/ItemMap",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T={};return T.create=function(e,t,n){var i={},u=E.getTableInfo(t.tableid);return i.initialised=!1,i.currentData=!1,i.parent=n,u.hasGeoCoord||a.reportError("Table does not have geographic coordinates: "+u.id),i.createFrames=function(t){return i.frameMap=r.FrameFinal("",1).setAllowScrollBars(!1,!1).setInitialiseFunction(i.initialise).setDisplayTitle(e.Name),t.addMemberFrame(i.frameMap),i.frameMap},i.initialise=function(){i.theMap=l.GMap(i.frameMap),i.selectedPointSet=l.PointSet("selectedPoints",i.theMap,0,"",{showLabels:!1,showMarkers:!0}),i.unselectedPointSet=l.PointSet("unselectedPoints",i.theMap,0,"Bitmaps/circle_red_small.png",{showLabels:!1,showMarkers:!0}),s.listen("",{type:"ClickMapPoint",id:i.unselectedPointSet.myID},function(e,t){i.parent.render(t)});var e=t.tableid,n=E.getTableInfo(e);i.fetcher=b.Table(E.serverUrl,E.database,e+"CMB_"+E.workspaceid),i.fetcher.myDataConsumer=i,i.fetcher.setReportIfError(!0),i.fetcher.setMaxRecordCount(n.settings.MaxCountQueryAggregated||1e6),i.fetcher.positionField=n.primkey,i.latProp=n.propIdGeoCoordLattit,i.longProp=n.propIdGeoCoordLongit,i.primKey=n.primkey,i.fetcher.addFetchColumnActive(i.latProp,"String"),i.fetcher.addFetchColumnActive(i.longProp,"String"),i.fetcher.addFetchColumnActive(i.primKey,x.createEncoderId(e,i.primKey));var r=o.WhereClause.Trivial();i.fetcher.setUserQuery1(r),i.fetcher.IsDataReady(-1,1e6),i.initialised=!0,i.update(t)},i.notifyDataReady=function(){var e=[];for(var t=0;t<i.fetcher.totalRecordCount;t++){var n={lattit:i.fetcher.getColumnPoint(t,i.latProp),longit:i.fetcher.getColumnPoint(t,i.longProp),id:i.fetcher.getColumnPoint(t,i.primKey)};e.push(n)}i.allPoints=e,i.currentData&&i.update(i.currentData)},i.createPanels=function(){},i.update=function(e){i.currentData=e,i.initialised&&i.setPoints(e)},i.setPoints=function(t){var n=t.fields[u.propIdGeoCoordLongit],r=t.fields[u.propIdGeoCoordLattit],s=t.fields[u.primkey];i.selectedPointSet.setPoints([{id:s,longit:n,lattit:r,labelName:s}]);if(i.allPoints){var o=[];for(var a=0;a<i.allPoints.length;a++){var f=i.allPoints[a];f.longit!==n&&f.lattit!==r&&o.push(f)}i.unselectedPointSet.setPoints(o)}setTimeout(function(){var t=l.Coord(n,r),s=4;e.MapZoom&&(s=e.MapZoom),i.theMap.setCenter(t,s)},50)},i.onClose=function(){i.theMap&&i.theMap.tearDown()},i},T}),define("InfoPopups/DataItemViews/PieChartMap",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T={};return T.create=function(e,t){var n={},i=E.getTableInfo(t.tableid);return n.itemData=t,n.pies=[],n.initialised=!1,n.createFrames=function(t){return n.frameMap=r.FrameFinal("",1).setAllowScrollBars(!1,!1).setInitialiseFunction(n.initialise).setDisplayTitle(e.Name),t.addMemberFrame(n.frameMap),n.frameMap},n.initialise=function(){n.theMap=l.GMap(n.frameMap),setTimeout(function(){var t=l.Coord(0,0),r=2;e.MapCenter&&(t=l.Coord(e.MapCenter.Longitude,e.MapCenter.Lattitude)),e.MapZoom&&(r=e.MapZoom),n.theMap.setCenter(t,r)},50),e.LocationDataTable&&(n.locationTable=E.mapTableCatalog[e.LocationDataTable],n.locationTable||a.reportError("Unable to find pie chart locations table: "+e.LocationDataTable),n.locationTable.hasGeoCoord||a.reportError("Locations table does not have coordinates: "+e.LocationDataTable),n.locationTable.loadFullDataItemInfo(n._buildPieChartsFromLocationTable)),n.initialised=!0},n._buildPieChartsFromLocationTable=function(r){if(!e.pieCharts){e.pieCharts=[],$.each(r,function(t,r){var i=r[n.locationTable.primkey];e.LocationNameProperty&&(i=r[e.LocationNameProperty]);var s=1;e.LocationSizeProperty&&(s=10*Math.sqrt(r[e.LocationSizeProperty])),e.pieCharts.push({name:i,locid:r[n.locationTable.primkey],longit:r[n.locationTable.propIdGeoCoordLongit],lattit:r[n.locationTable.propIdGeoCoordLattit],sizeFac:s})});var i=500;e.PieChartSize&&(i=e.PieChartSize);var s=1e-9;$.each(e.pieCharts,function(e,t){s=Math.max(s,t.sizeFac)}),$.each(e.pieCharts,function(e,t){t.sizeFac*=i/s});if(e.PositionOffsetFraction){var o=l.MapItemLayouter(n.theMap,"",e.PositionOffsetFraction);$.each(e.pieCharts,function(e,t){o.addItem(t.longit,t.lattit,t.sizeFac)}),o.calculatePositions(),$.each(e.pieCharts,function(e,t){t.longit0=t.longit,t.lattit0=t.lattit,t.longit=o.items[e].longit2,t.lattit=o.items[e].lattit2})}}n._drawPies(t)},n._drawPies=function(t){$.each(n.pies,function(e,t){n.theMap.removeOverlay(t.myID)}),n.pies=[],$.each(e.pieCharts,function(r,i){var o=c.PieChart();if(e.ComponentColumns){var u=0;$.each(e.ComponentColumns,function(e,n){var r=n.Pattern.DQXformat({locid:i.locid});r in t.fields||a.reportError("Missing map pie chart column: "+r);var s=t.fields[r];if(s){var f=parseFloat(s);o.addPart(f,n.Color,r,i.name+"\n"+n.Name+": "+s),u+=f}});if(u<.99999)var f="Other";e.ResidualFractionName&&(f=e.ResidualFractionName),o.addPart(1-u,a.Color(.75,.75,.75),i.locid+"_rem_",i.name+"\n"+f+": "+(1-u).toFixed(3))}var h=l.Overlay.PieChart(n.theMap,a.getNextUniqueID(),l.Coord(i.longit,i.lattit),i.sizeFac,o);e.PositionOffsetFraction&&h.setOrigCoord(l.Coord(i.longit0,i.lattit0)),h.onClick=function(e,t){n.locationTable&&s.send({type:"ItemPopup"},{tableid:n.locationTable.id,itemid:i.locid})},n.pies.push(h)})},n.update=function(t){e.pieCharts&&n.initialised&&n._drawPies(t)},n.createPanels=function(){},n.onClose=function(){n.theMap&&n.theMap.tearDown()},n},T}),define("InfoPopups/DataItemViews/FieldList",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","InfoPopups/DataItemViews/ItemPropertyLine"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N={};return N.create=function(e,t){var n={},i=E.getTableInfo(t.tableid);return n.createFrames=function(t){return n.frameFields=r.FrameFinal("",1).setAllowScrollBars(!0,!0).setDisplayTitle(e.Name),t.addMemberFrame(n.frameFields),n.frameFields},n.createPanels=function(){n.setContent(t)},n.setContent=function(t){n.id=a.getNextUniqueID();var r='<div id="'+id+'"style="padding:8px">';e.Introduction&&(r+=e.Introduction+"<p>"),r+="<table>";var s="";$.each(e.Fields,function(e,n){r+=T.createTableLine(i,n,t)}),r+="</table>",r+="</div>",n.frameFields.setContentHtml(r)},n.update=function(e){$("#"+n.id).remove(),n.setContent(e)},n.onClose=function(){},n},N}),define("InfoPopups/DataItemViews/PropertyGroup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","InfoPopups/DataItemViews/ItemPropertyLine"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N={};return N.create=function(e,t){var n={},i=E.getTableInfo(t.tableid);return n.createFrames=function(t){var s="-Absent-",o=i.propertyGroupMap[e.GroupId];return o&&(s=o.Name),n.frameFields=r.FrameFinal("",1).setAllowScrollBars(!0,!0).setDisplayTitle(s),t.addMemberFrame(n.frameFields),n.frameFields},n.createPanels=function(){n.setContent(t)},n.setContent=function(t){n.id=a.getNextUniqueID();var r='<div id="'+id+'" style="padding:8px">';r+="<table>";var s=i.propertyGroupMap[e.GroupId];s&&$.each(s.properties,function(e,n){r+=T.createTableLine(i,n.propid,t)}),r+="</table>",r+="</div>",n.frameFields.setContentHtml(r)},n.update=function(e){$("#"+n.id).remove(),n.setContent(e)},n.onClose=function(){},n},N}),define("InfoPopups/DataItemViews/RelationTableView",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T={};return T.create=function(t,n){var u={};return u.itemData=t,u.relationInfo=n,u.tableInfo=E.getTableInfo(t.tableid),u.childTableInfo=E.mapTableCatalog[n.childtableid],u.createFrames=function(e){return u.frameRelation=r.FrameGroupHor("",.7).setDisplayTitle(u.relationInfo.reversename+" "+u.childTableInfo.tableNamePlural),e.addMemberFrame(u.frameRelation),u.frameButtons=u.frameRelation.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimX,150),u.frameTable=u.frameRelation.addMemberFrame(r.FrameFinal("",.7)).setAllowScrollBars(!0,!0),u.frameRelation},u.createPanels=function(){var t=b.Table(E.serverUrl,E.database,u.childTableInfo.getQueryTableName(!1));t.setReportIfError(!0),u.panelTable=f.Panel(u.frameTable,t,{leftfraction:50});var n=u.panelTable.getTable();n.fetchBuffer=300,n.recordCountFetchType=b.RecordCountFetchType.DELAYED,u.query=o.WhereClause.CompareFixed(u.relationInfo.childpropid,"=",u.itemData.fields[u.tableInfo.primkey]),n.setQuery(u.query),$.each(E.customProperties,function(e,t){if(t.tableid==u.childTableInfo.id&&t.propid!=u.relationInfo.childpropid)var r=x.createItemTableViewerColumn(n,u.childTableInfo.id,t.propid)}),u.panelTable.onResize();var a=[];u.panelButtons=r.Form(u.frameButtons),u.button_OpenInTable=i.Button(null,{content:"Show in table view",icon:"fa-table",buttonClass:"PnButtonGrid",width:135,height:35}).setOnChanged(function(){s.send({type:"DataItemTablePopup"},{tableid:u.childTableInfo.id,query:u.query,title:""}),s.listen("",{type:"LoadStoredDataItem"},e("InfoPopups/ItemPopup").loadStoredItem)}),a.push(u.button_OpenInTable);if(u.childTableInfo.hasGeoCoord){var l=i.Button(null,{content:"Show on map",icon:"fa-globe",buttonClass:"PnButtonGrid",width:135,height:35}).setOnChanged(function(){s.send({type:"CreateGeoMapPoint"},{tableid:u.childTableInfo.id,startQuery:u.query})});a.push(l)}u.panelButtons.addControl(i.CompoundHor(a))},u.update=function(e){u.itemData=e;var t=u.panelTable.getTable();u.query=o.WhereClause.CompareFixed(u.relationInfo.childpropid,"=",u.itemData.fields[u.tableInfo.primkey]),t.setQuery(u.query),t.reLoadTable()},u.onClose=function(){},u},T}),define("InfoPopups/DataItemViews/SubsetsView",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/SVG","DQX/Wizard","DQX/Popup","DQX/MessageBox","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){var N={};return N.create=function(e){var t={};return t.tableInfo=S.getTableInfo(e.tableid),t.createFrames=function(e){return t.frameGroup=r.FrameGroupVert("",.7).setDisplayTitle("Notes").setMargins(0),e.addMemberFrame(t.frameGroup),t.tableInfo.settings.DisableNotes||(t.frameNotesGroup=r.FrameGroupVert("",.7).setMargins(0).setSeparatorSize(0),t.frameGroup.addMemberFrame(t.frameNotesGroup),t.frameNotesButtons=r.FrameFinal("",.7).setFixedSize(r.dimY,55).setAllowScrollBars(!1,!1),t.frameNotesGroup.addMemberFrame(t.frameNotesButtons),t.frameNotes=r.FrameFinal("",.7).setMargins(0),t.frameNotesGroup.addMemberFrame(t.frameNotes)),t.tableInfo.settings.DisableSubsets||(t.frameSubsets=r.FrameFinal("",.7).setMargins(0).setFixedSize(r.dimY,50),t.frameGroup.addMemberFrame(t.frameSubsets)),t.frameGroup},t.createPanels=function(){t.itemid=e.fields[t.tableInfo.primkey],t.tableInfo.settings.DisableSubsets||(t.panelSubsets=r.Form(t.frameSubsets).setPadding(7),t.setContentSubsets(e)),t.tableInfo.settings.DisableNotes||t.setContentNotes();if(!t.tableInfo.settings.DisableNotes){t.panelNotesButtons=r.Form(t.frameNotesButtons),t.panelNotesButtons.setPadding(7);var n=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-comment",content:"Add note",width:160,height:30}).setOnChanged(function(){t.addNote()});t.panelNotesButtons.addControl(n)}},t.setContentSubsets=function(e){if(!t.tableInfo.settings.DisableSubsets){var n=[],r={};$.each(t.tableInfo.storedSubsets,function(s,u){var f=i.Check(null,{label:u.name});n.push(f),r[u.id]=f,f.modifyEnabled(!1),f.setOnChanged(function(){a.customRequest(S.serverUrl,PnServerModule,"subset_setitemselection",{database:S.database,tableid:t.tableInfo.id,workspaceid:S.workspaceid,itemid:e.fields[t.tableInfo.primkey],isnumericalkey:o?1:0,primkey:t.tableInfo.primkey,subsetid:u.id,ismember:f.getValue()?1:0},function(e){u.membercount+=e.diff})})});if(n.length==0)t.panelSubsets.addControl(i.Static('<span class="SupportingText">There are currently no {name} subsets defined</span>'.DQXformat({name:t.tableInfo.tableNameSingle})));else{var s=[];s.push(i.Static("Member of the following subsets:<p>")),$.each(n,function(e,t){s.push(i.HorizontalSeparator(12)),s.push(t)}),t.panelSubsets.addControl(i.CompoundHor(s))}var o=!!S.findProperty(t.tableInfo.id,t.tableInfo.primkey).isFloat;a.customRequest(S.serverUrl,PnServerModule,"subset_getitemselection",{database:S.database,tableid:t.tableInfo.id,workspaceid:S.workspaceid,itemid:e.fields[t.tableInfo.primkey],isnumericalkey:o?1:0,primkey:t.tableInfo.primkey},function(e){$.each(n,function(e,t){t.modifyEnabled(!0)}),$.each(e.subsetmemberlist,function(e,t){r[t]&&r[t].modifyValue(!0,!0)})})}},t.setContentNotes=function(){if(t.tableInfo.settings.DisableNotes)return;t.frameNotes.setContentHtml("<i>Downloading...</i>"),a.customRequest(S.serverUrl,PnServerModule,"note_getitemlist",{database:S.database,workspaceid:S.workspaceid,tableid:t.tableInfo.id,itemid:t.itemid},function(e){var n="";t.canEditNotes=e.canedit;for(var r=0;r<e.notes_id.length;r++){n+='<div class="PnItemNote" id="{id}">'.DQXformat({id:"note__"+e.notes_id[r]}),n+='<div class="PnItemHeaderText">'+e.notes_timestamp[r]+" ",n+=e.notes_userid[r]+"</div>",n+='<img class="PnItemNoteDelete" SRC="{bmp}"/>'.DQXformat({bmp:"Bitmaps/actionbuttons/delete.png"});var i=e.notes_content[r];i=i.replace(/(?:\r\n|\r|\n)/g,"<br />"),n+=i,n+="</div>"}t.frameNotes.setContentHtml(n);var s=$("#"+t.frameNotes.getClientDivID());s.find(".PnItemNoteDelete").click(function(e){e.preventDefault(),e.stopPropagation();var n=$(this).parent().attr("id").split("__")[1];d.confirmationBox("Are you sure you want to delete this note?",function(){a.setProcessing(),a.customRequest(S.serverUrl,PnServerModule,"note_del",{database:S.database,workspaceid:S.workspaceid,tableid:t.tableInfo.id,itemid:t.itemid,noteid:n},function(e){a.stopProcessing();if(e.error){d.errorBox("Unable to remove note",e.error);return}t.setContentNotes()})})}),s.stop().animate({scrollTop:s[0].scrollHeight},800)})},t.update=function(e){t.itemid=e.fields[t.tableInfo.primkey],t.tableInfo.settings.DisableSubsets||(t.panelSubsets.clear(),t.setContentSubsets(e),t.panelSubsets.render()),t.tableInfo.settings.DisableNotes||t.setContentNotes()},t.addNote_submit=function(e){a.setProcessing(),a.serverDataStoreLong(S.serverUrl,e,function(e){a.customRequest(S.serverUrl,PnServerModule,"note_add",{database:S.database,workspaceid:S.workspaceid,tableid:t.tableInfo.id,itemid:t.itemid,noteid:e},function(e){a.stopProcessing();if(e.error){d.errorBox("Error",e.error);return}t.setContentNotes()})})},t.addNote=function(){if(!t.canEditNotes){d.errorBox("Error","You do not have the right privilege to add notes");return}var e="",e="",n=i.Textarea("",{size:80,linecount:12,value:""}).setHasDefaultFocus();e+="Text:<p>",e+=n.renderHtml(),e+="<p>";var r=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-comment",width:130,height:45,content:"Add note"}).setOnChanged(function(){var e=n.getValue();t.addNote_submit(e),p.closeIfNeeded(s)});e+=r.renderHtml();var s=p.create("Add note",e)},t.onClose=function(){},t},N}),define("InfoPopups/DataItemViews/TemplatedView",["require","handlebars","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","MetaData","DQX/DataFetcher/DataFetchers","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p={};return p.create=function(e,n){var r={};r.template=e.Content,t.registerHelper("item_link",function(e,n,r){return code='<span onClick=\'require("DQX/Msg").send({ type: "ItemPopup" }, { tableid: "'+e+'", itemid: "'+n+"\" } )' class='DQXQueryTableLinkCell'><span class='fa fa-external-link-square DQXQueryTableLinkIcon'></span>"+r+"</span>",new t.SafeString(code)}),t.registerHelper("map",function(e,n,r,i){var s="<div style='overflow:hidden;height:400px;width:520px;'>\n                  <div id='gmap_canvas' style='height:400px;width:520px;'></div>\n                      <style>\n                          #gmap_canvas img {\n                          max-width: none!important;\n                          background: none!important\n                      }\n                      </style>\n                  </div>\n                  <script type='text/javascript'>\n                      var myOptions = {\n                          zoom: 12,\n                          center: new google.maps.LatLng(51.75, -1.25),\n                          mapTypeId: google.maps.MapTypeId.ROADMAP\n                      };\n                      map = new google.maps.Map(document.getElementById('gmap_canvas'), myOptions);var bound = new google.maps.LatLngBounds();\n";for(var o=0;o<e.length;o++){var u=e[o];s+="var marker = new google.maps.Marker({\nposition: new google.maps.LatLng("+u[r]+","+u[i]+"),\n"+"title:'"+u[n]+"'\n"+"});\n"+"marker.setMap(map);bound.extend(marker.getPosition());\n"+"var infowindow = new google.maps.InfoWindow({\n"+"content: '"+u[n]+"<br>'\n"+"});\n"+"infowindow.open(map, marker);google.maps.event.addListenerOnce(map, 'bounds_changed', function(event) {if (this.getZoom() > 10) {this.setZoom(10);}});\n"}return s+="map.fitBounds(bound);</script>",new t.SafeString(s)}),r.compiled_template=t.compile(r.template),r.tableInfo=l.getTableInfo(n.tableid);var s=f.attrMap(r.tableInfo.relationsParentOf,"childtableid"),o=t.fields_used(r.template,_.keys(s));return r.child_fetchers={},_.each(o,function(e){var t=l.getTableInfo(e),n=c.Table(l.serverUrl,l.database,e+"CMB_"+l.workspaceid);n.myDataConsumer=r,n.setReportIfError(!0),n.setMaxRecordCount(t.settings.MaxCountQueryAggregated||1e6),n.positionField=t.primkey,_.each(t.properties,function(t){n.addFetchColumnActive(t.propid,h.createEncoderId(e,t.propid))}),n.relationInfo=s[e],r.child_fetchers[e]=n}),r.createFrames=function(t){return r.frameFields=i.FrameFinal("",1).setAllowScrollBars(!0,!0).setDisplayTitle(e.Name),t.addMemberFrame(r.frameFields),r.frameFields},r.get_child_data_object=function(e){var t=r.child_fetchers[e],n=[];for(var i=0;i<t.totalRecordCount;i++){var s={};_.each(l.getTableInfo(e).properties,function(e){s[e.propid]=t.getColumnPoint(i,e.propid)}),n.push(s)}return n},r.notifyDataReady=function(){var e=!0;_.each(r.child_fetchers,function(t,n){t.IsDataReady(-1,1e6)||(e=!1)});if(e){var t=r.itemData.fields;_.each(r.child_fetchers,function(e,n){t[n]=r.get_child_data_object(n)});var n="";r.id=f.getNextUniqueID();var n='<div id="'+id+'" style="padding:8px">';n+=r.compiled_template(t),n+="</div>",r.frameFields.setContentHtml(n)}},r.setContent=function(e){r.itemData=e;var t=!1;_.each(r.child_fetchers,function(n,i){var s=u.WhereClause.CompareFixed(n.relationInfo.childpropid,"=",e.fields[r.tableInfo.primkey]);n.setUserQuery1(s),n.IsDataReady(-1,1e6),t=!0}),t||r.notifyDataReady()},r.createPanels=function(){r.setContent(n)},r.update=function(e){$("#"+r.id).remove(),r.setContent(e)},r.onClose=function(){},r},p}),define("Views/ItemView",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","InfoPopups/ItemGenomeTracksPopup","InfoPopups/DataItemViews/DefaultView","InfoPopups/DataItemViews/ItemMap","InfoPopups/DataItemViews/PieChartMap","InfoPopups/DataItemViews/FieldList","InfoPopups/DataItemViews/PropertyGroup","InfoPopups/ItemPopup","InfoPopups/DataItemViews/RelationTableView","InfoPopups/DataItemViews/SubsetsView","InfoPopups/DataItemViews/TemplatedView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_){var D=function(e,t,n,u){var f={};f.frameRoot=e,f.tableInfo=w.getTableInfo(t.tableid),f.itemid=t.itemid,f.eventids=[];var l=a.getNextUniqueID();return f.eventids.push(l),s.listen(l,{type:"SelectionUpdated"},function(e,t){f.tableInfo.id==t&&f._updateSelectButton()}),f.createFrames=function(){f.frameRoot.makeGroupVert();var e=f.frameRoot.addMemberFrame(r.FrameGroupTab("",.7));f.frameButtons=f.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,80).setFrameClassClient("DQXGrayClient").setAllowScrollBars(!1,!1).setMargins(0),f.itemViewObjects=[];if(f.tableInfo.settings.DataItemViews)var t=f.tableInfo.settings.DataItemViews;else{var t=[];t.push({Type:"Overview",Name:"Overview"}),f.tableInfo.hasGeoCoord&&t.push({Type:"ItemMap",Name:"Location"})}$.each(t,function(e,t){var r=null;t.Type=="Overview"&&(r=T.create(t,n)),t.Type=="PieChartMap"&&(r=C.create(t,n)),t.Type=="ItemMap"&&(r=N.create(t,n,u)),t.Type=="FieldList"&&(r=k.create(t,n)),t.Type=="PropertyGroup"&&(r=L.create(t,n)),t.Type=="Template"&&(r=_.create(t,n)),r||a.reportError("Invalid dataitem view type "+t.Type),f.itemViewObjects.push(r)}),$.each(f.tableInfo.relationsParentOf,function(e,t){if(t.reversename!=="_hide_"){var r=O.create(n,t);f.itemViewObjects.push(r)}});if(!f.tableInfo.settings.DisableSubsets||!f.tableInfo.settings.DisableNotes){var i=M.create(n);f.itemViewObjects.push(i)}$.each(f.itemViewObjects,function(t,n){n.createFrames(e)})},f.createButtons=function(e){f.buttonWidth=160,f.buttonHeight=30;var t=e.fields[f.tableInfo.primkey],n=[];if(f.tableInfo.hasGenomePositions){var r=e.fields[f.tableInfo.ChromosomeField],u=parseInt(e.fields[f.tableInfo.PositionField]);if(r){var l=i.Button(null,{content:"Show on genome",buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,bitmap:"Bitmaps/GenomeBrowserSmall.png"}).setOnChanged(function(){p.minimiseAll({slow:!0}),s.send({type:"JumpgenomePosition"},{chromoID:r,position:u})});n.push(l)}$.each(w.tableCatalog,function(e,t){if(t.hasGenomeRegions){var a=i.Button(null,{content:"Show "+t.tableNamePlural,buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,bitmap:t.settings.Icon?null:"Bitmaps/datagrid2Small.png",icon:t.settings.Icon}).setOnChanged(function(){var e=o.WhereClause.AND([o.WhereClause.CompareFixed(t.settings.Chromosome,"=",r),o.WhereClause.CompareFixed(t.settings.RegionStart,"<=",u),o.WhereClause.CompareFixed(t.settings.RegionStop,">=",u)]);s.send({type:"DataItemTablePopup"},{tableid:t.id,query:e,title:t.tableCapNamePlural+" at "+r+":"+u})});n.push(a)}})}if(f.tableInfo.hasGenomeRegions){var l=i.Button(null,{content:"Show on genome",buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,bitmap:"Bitmaps/GenomeBrowserSmall.png"}).setOnChanged(function(){p.minimiseAll({slow:!0}),s.send({type:"JumpgenomeRegion"},{chromoID:e.fields[f.tableInfo.settings.Chromosome],start:parseInt(e.fields[f.tableInfo.settings.RegionStart]),end:parseInt(e.fields[f.tableInfo.settings.RegionStop])})});n.push(l),$.each(w.tableCatalog,function(t,r){if(r.hasGenomePositions){var o=i.Button(null,{content:"Show "+r.tableNamePlural+" in range",buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,bitmap:r.settings.Icon?null:"Bitmaps/datagrid2Small.png",icon:r.settings.Icon}).setOnChanged(function(){s.send({type:"ShowItemsInGenomeRange",tableid:r.id},{preservecurrentquery:!1,chrom:e.fields[f.tableInfo.settings.Chromosome],start:parseInt(e.fields[f.tableInfo.settings.RegionStart]),stop:parseInt(e.fields[f.tableInfo.settings.RegionStop])})});n.push(o)}})}var c=S.getReverseCrossLinkList(f.tableInfo.id,t);$.each(c,function(e,t){var r=i.Button(null,{content:"Show associated "+t.dispName,buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,bitmap:t.bitmap,bitmapHeight:20}).setOnChanged(function(){S.openReverseCrossLink(t)});n.push(r)});if(f.tableInfo.tableBasedSummaryValues.length>0){var l=i.Button(null,{content:"Show genome tracks...",buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,bitmap:"Bitmaps/GenomeBrowserSmall.png"}).setOnChanged(function(){x.show(f.tableInfo,t)});n.push(l)}f.tableInfo.settings.ExternalLinks&&$.each(f.tableInfo.settings.ExternalLinks,function(t,r){var s=i.Button(null,{content:r.Name,buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,icon:"fa-link"}).setOnChanged(function(){var t=r.Url.DQXformat(e.fields);window.open(t,"_blank")});n.push(s)}),f._updateSelectButton=function(){var e=f.tableInfo.isItemSelected(t);e?f._btchk.changeIcon("fa-check-circle",a.Color(.8,.2,0),"Selected"):f._btchk.changeIcon("fa-circle-thin","inherit","Select")};var h=f.tableInfo.isItemSelected(t);f._btchk=i.Button(null,{buttonClass:"PnButtonGrid",width:f.buttonWidth,height:f.buttonHeight,content:h?"Selected":"Select",icon:h?"fa-check-circle":"fa-circle-thin",iconColor:h?a.Color(.8,.2,0):null}).setOnChanged(function(){f.tableInfo.selectItem(t,!f.tableInfo.isItemSelected(t)),f._updateSelectButton(),s.broadcast({type:"SelectionUpdated"},f.tableInfo.id)}),n.push(f._btchk);var d=null,v=[],m=99;return $.each(n,function(e,t){m>1&&(d=i.CompoundVert([]).setTreatAsBlock().setMargin(0),v.push(d),m=0),d.addControl(t),m+=1}),i.CompoundHor(v)},f.createPanels=function(){f.panelButtons=r.Form(f.frameButtons),f.panelButtons.addControl(f.createButtons(n)),$.each(f.itemViewObjects,function(e,t){t.createPanels()})},f.destroy=function(){$.each(f.itemViewObjects,function(e,t){t.onClose()}),$.each(f.eventids,function(e,t){s.delListener(t)})},f.render=function(){f.createFrames(),f.frameRoot.render(),f.createPanels(),f.frameRoot.applyOnPanels(function(e){e._panelfirstRendered==0&&e.render()})},f.update=function(e){f.panelButtons.clear(),f.panelButtons.addControl(f.createButtons(e)),f.panelButtons.render(),f.itemid=e.fields[f.tableInfo.primkey],$.each(f.itemViewObjects,function(t,n){n.update&&n.update(e)})},f.tearDown=function(){f.destroy(),f.frameRoot.applyOnPanels(function(e){e.tearDown&&e.tearDown()})},f};return D}),define("InfoPopups/ItemPopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Views/ItemView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x={};return x.activeList=[],x.init=function(){s.listen("",{type:"ItemPopup"},function(e,t){x.show(t)})},x.show=function(e){a.setProcessing("Downloading..."),E.Get(e.tableid,e.itemid,function(t){a.stopProcessing(),x.show_sub1(e,t)})},x.show_sub1=function(n,r){var i=w.getTableInfo(n.tableid),s=p.PopupFrame("ItemPopup"+n.tableid,{title:i.tableCapNameSingle+' "'+n.itemid+'"',icon:i.settings.Icon,blocking:!1,sizeX:700,sizeY:500}),o=S(s.frameRoot,n,r);s.createFrames=o.createFrames,s.createPanels=o.createPanels,w.isManager&&s.addTool("fa-link",function(){s.handleCreateLink()}),n.frameSettings&&p.setFrameSettingsHistory(s.typeID,n.frameSettings),s.onClose=function(){var e=-1;$.each(x.activeList,function(t,n){n===s&&(e=t)}),e>=0?x.activeList.splice(e,1):a.reportError("Plot not found!"),o.destroy()},s.store=function(){var e={};return e.itemid=o.itemid,e.tableid=o.tableInfo.id,e.frameSettings=s.frameRoot.settingsStreamOut(),e},s.handleCreateLink=function(){var n=t.encode(JSON.stringify(s.store()));a.serverDataStore(w.serverUrl,n,function(t){a.customRequest(w.serverUrl,PnServerModule,"view_store",{database:w.database,workspaceid:w.workspaceid,id:t},function(n){e("Utils/IntroViews").createIntroView("dataitem",t,"-","Add to start page")})})},x.activeList.push(s),s.create()},x.store=function(){var e=[];return $.each(x.activeList,function(t,n){e.push(n.store())}),e},x.recall=function(e){$.each(e,function(e,t){x.show(t)})},x.loadStoredItem=function(e,n){a.serverDataFetch(w.serverUrl,n,function(e){var n=JSON.parse(t.decode(e));x.recall([n])})},s.listen("",{type:"LoadStoredDataItem"},x.loadStoredItem),x}),define("Wizards/FindGeneControl",["require","DQX/Framework","DQX/Msg","DQX/Utils","DQX/DocEl","DQX/Controls","DQX/SQL","DQX/DataFetcher/DataFetchers"],function(e,t,n,r,i,s,o,u){return FindGeneControlModule={Instance:function(t,n){var i=s.CompoundVert([]);return i._myID=t,r.requireMember(n,"database"),r.requireMember(n,"annotationTableName"),i.database=n.database,i.annotationTableName=n.annotationTableName,i._currentSearchNr=0,i.getFullID=function(e){return this._myID+"_"+e},i._ajaxResponse_FindGene=function(t){var n=r.parseResponse(t);if("Error"in n){this.setSearchResultMessage(n.Error);return}var i=n.pattern,s=e("DQX/DataDecoders").ValueListDecoder(),o=s.doDecode(n.Hits),u=s.doDecode(n.Chroms),a=s.doDecode(n.Starts),f=s.doDecode(n.Ends),l=s.doDecode(n.IDs),c=s.doDecode(n.Descrs);if(l.length==0)this.setSearchResultMessage("<b>No hits were found</b>"),this.resultList.setItems([],""),this._hasValidGeneList=!1;else{this.idMap={};var h=[];for(var p=0;p<c.length;p++){var d=c[p];d=d.replace(/;/g,"; "),d=r.highlightText(d,i);var v=d+' <span style="color:rgb(160,140,110)">({id}; {chrom}:{p1}-{p2})</span>'.DQXformat({id:l[p],chrom:u[p],p1:a[p],p2:f[p]});v='<span style="word-wrap:break-word">'+v+"</span>",h.push({id:"id"+p,content:v}),this.idMap["id"+p]=l[p]}this.resultList.setItems(h,"id0"),this._hasValidGeneList=!0}},i.findMatchingGenes=function(){this._hasValidGeneList=!1,this.resultList.setItems([],"");var e=this.searchText.getValue();this._currentSearchNr++;var t=this._currentSearchNr;if(e.length==0){this.setSearchResultMessage("No search text provided");return}if(e.length<2){this.setSearchResultMessage("Search text too short");return}var n=r.Url(serverUrl);n.addUrlQueryItem("datatype","findgene"),n.addUrlQueryItem("pattern",e),n.addUrlQueryItem("count",100),n.addUrlQueryItem("reportall",1),n.addUrlQueryItem("database",this.database),n.addUrlQueryItem("table",this.annotationTableName),this.setSearchResultMessage("Fetching search hits..."),$.ajax({url:n.toString(),success:function(e){t==i._currentSearchNr&&$.proxy(i._ajaxResponse_FindGene,i)(e)},error:function(e){i.setSearchResultMessage("<b>Failed to fetch gene information</b>")}})},i.setSearchResultMessage=function(e){this.resultList.getJQElement("").html("<i> "+e+"</i>")},i.getValue=function(){var e=this.resultList.getValue();return e?this.idMap[e]:""},i.setHasDefaultFocus=function(){return this.searchText.setHasDefaultFocus(),this},i.getHasValidGeneList=function(){return i._hasValidGeneList},i.searchText=s.Edit(i.getFullID("SearchText"),{size:50}).setHasDefaultFocus(),i.searchText.setOnChanged($.proxy(i.findMatchingGenes,i)),i.resultList=s.List(i.getFullID("SearchResultList"),{width:-1,height:235}),n.notifyEnter&&(i.searchText.setNotifyEnter(n.notifyEnter),i.resultList.setOnDoubleClick(n.notifyEnter)),i.addControl(s.Static("Enter a keyword or partial keyword:<br>(This text will be searched in the gene name and description fields)").makeComment()),i.addControl(i.searchText),i.addControl(s.Static("<br>Select a gene from the list of matches:").makeComment()),i.addControl(i.resultList),i},end:!0},FindGeneControlModule}),define("Wizards/FindGene",["require","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Popup","DQX/Wizard","DQX/DataFetcher/DataFetchers","DQX/MessageBox","Wizards/FindGeneControl","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={};return h.theWizard=null,h.init=function(){if(h.theWizard)return;h.theWizard=u.Create("FindGeneWizard"),h.theWizard._currentSearchNr=0,h.theWizard._recentList=[],h.theWizard.addGeneHit=function(e){var t=!1;for(var n=0;n<h.theWizard._recentList.length;n++)h.theWizard._recentList[n]==e&&(t=!0);t||h.theWizard._recentList.unshift(e)},h.theWizard.setResult=function(e){h.theWizard.addGeneHit(e),h.theWizard.resultGeneID=e},h.theWizard.setTitle("Find Gene");var e=[{id:"choice1",name:"Name or description"},{id:"choice3",name:"Genomic region"}],t=[n.Static("Search for a gene by:").makeComment()];for(var r=0;r<e.length;r++){var s=n.Button(e[r].id,{width:500,content:e[r].name,fastTouch:!0}).setOnChanged(function(e){h.theWizard.jumpToPage(e)});t.push(s)}h.theWizard.addPage({id:"init",form:n.CompoundVert([n.CompoundVert(t),n.CompoundHor([])]),hideNext:!0}),h.theWizard.controlFindByKeyword=l.Instance("FindByKeyword",{database:c.database,annotationTableName:c.tableAnnotation,notifyEnter:function(){h.theWizard.controlFindByKeyword.getHasValidGeneList()&&h.theWizard._onNext()}}),h.theWizard.controlFindByKeyword.setHasDefaultFocus(),h.theWizard.addPage({id:"choice1",form:n.CompoundVert([h.theWizard.controlFindByKeyword]),reportValidationError:function(){var e=h.theWizard.controlFindByKeyword.getValue();if(!e)return"There is no gene selected"},onFinish:function(){h.theWizard.setResult(h.theWizard.controlFindByKeyword.getValue())}}),h.theWizard.searchChromosome=n.Combo("SearchRegionChromosome",{label:"Chromosome:",value:"NRAF",states:c.chromosomes}).setHasDefaultFocus(),h.theWizard.searchStart=n.Edit("SearchRegionStart",{size:10}),h.theWizard.searchEnd=n.Edit("SearchRegionEnd",{size:10});var o=function(){h.theWizard.handleModifiedStart()},f=function(){h.theWizard.findGenesInRegion()};h.theWizard.searchChromosome.setOnChanged(f),h.theWizard.searchStart.setOnChanged(o),h.theWizard.searchEnd.setOnChanged(f),h.theWizard.resultList_Region=n.List("SearchResultListRegion",{width:-1,height:250}),h.theWizard.searchRegionStatus=n.Html("SearchRegionStatus",""),h.theWizard.addPage({id:"choice3",form:n.CompoundVert([n.Static("Select a genomic region:").makeComment(),n.CompoundHor([h.theWizard.searchChromosome,n.Static("&nbsp;&nbsp;&nbsp; Start:&nbsp;"),h.theWizard.searchStart,n.Static("&nbsp;bp"),n.Static("&nbsp;&nbsp;&nbsp; End:&nbsp;"),h.theWizard.searchEnd,n.Static("&nbsp;bp")]),n.Static("<br>Select a gene from the list of matches:").makeComment(),h.theWizard.resultList_Region,h.theWizard.searchRegionStatus]),reportValidationError:function(){var e=h.theWizard.getPage("choice3").form.findControl("SearchResultListRegion").getValue();if(!e)return"There is no gene selected"},onFinish:function(){h.theWizard.setResult(h.theWizard.findRegionIDMap[h.theWizard.getPage("choice3").form.findControl("SearchResultListRegion").getValue()])}}),h.theWizard.execute=function(e){var t=h.theWizard.getPage("init").form._controls[1];t.clear(),h.theWizard._recentList.length==0?t.addControl(n.Static("")):t.addControl(n.Static("<br/><br/>Recent hits:&nbsp;"));for(var r=0;r<Math.min(10,h.theWizard._recentList.length);r++){r>0&&t.addControl(n.Static("&nbsp;&nbsp;&nbsp;"));var i=n.Hyperlink("RecentHit_"+r,{content:h.theWizard._recentList[r]});i.geneid=h.theWizard._recentList[r],i.setOnChanged(function(){h.theWizard.setResult(this.geneid),h.theWizard.performFinish()}),t.addControl(i)}h.theWizard.run(e)},h.theWizard.setSearchResultMessage_Region=function(e){h.theWizard.resultList_Region.getJQElement("").html("<i> "+e+"</i>")},h.theWizard._respond_findGenesInRegion=function(e){var t=h.theWizard.searchChromosome.getValue(),n=e.descr,r=e.fstart,i=e.fstop,s=e.fid,o=[];h.theWizard.findRegionIDMap={};for(var u=0;u<n.length;u++){var a="<b>{chrom}:{p1}-{p2}</b><br>{id}; {descr}".DQXformat({id:s[u],chrom:t,p1:r[u],p2:i[u],descr:n[u]});o.push({id:"id"+u,content:a}),h.theWizard.findRegionIDMap["id"+u]=s[u]}h.theWizard.resultList_Region.setItems(o,"id0"),n.length>200?h.theWizard.searchRegionStatus.modifyValue("<i>Result set limited to the first 100 hits</i>"):h.theWizard.searchRegionStatus.modifyValue("")},h.theWizard.handleModifiedStart=function(){var e=h.theWizard.searchStart.getValue(),t=h.theWizard.searchEnd.getValue();if(e){var n=parseInt(e);if(n>0){var r=parseInt(t);!r||r<n?h.theWizard.searchEnd.modifyValue(e):h.theWizard.findGenesInRegion()}}},h.theWizard.findGenesInRegion=function(){h.theWizard._currentSearchNr++;var e=h.theWizard._currentSearchNr;h.theWizard.resultList_Region.setItems([],"");var t=h.theWizard.searchChromosome.getValue(),n=h.theWizard.searchStart.getValue(),r=h.theWizard.searchEnd.getValue();if(n&&r){var s=parseInt(n),o=parseInt(r);h.theWizard.setSearchResultMessage_Region("Fetching search hits...");var u=i.WhereClause.AND([i.WhereClause.CompareFixed("chromid","=",t),i.WhereClause.CompareFixed("fstop",">=",n),i.WhereClause.CompareFixed("fstart","<=",r),i.WhereClause.CompareFixed("ftype","=","gene")]),f=a.RecordsetFetcher(serverUrl,c.database,c.tableAnnotation);f.setMaxResultCount(201),f.addColumn("fid","ST"),f.addColumn("fname","ST"),f.addColumn("descr","ST"),f.addColumn("fstart","IN"),f.addColumn("fstop","IN"),f.getData(u,"fstart",function(t){e==h.theWizard._currentSearchNr&&h.theWizard._respond_findGenesInRegion(t)},DQX.createMessageFailFunction())}}},h.execute=function(){h.theWizard.execute(function(){r.send({type:"GenePopup"},h.theWizard.resultGeneID)})},h.findRegion=function(){var e="",t=n.Combo("SearchRegionChromosome",{label:"",value:h.findRegion_chromosome?h.findRegion_chromosome:c.chromosomes[0].id,states:c.chromosomes}).setHasDefaultFocus(),i=n.Edit("SearchRegionStart",{size:10,value:h.findRegion_start?h.findRegion_start:""}),s=n.Edit("SearchRegionEnd",{size:10,value:h.findRegion_end?h.findRegion_end:""}),u=n.Combo("SearchRegionUnit",{label:"",value:h.findRegion_unit?h.findRegion_unit:"bp",states:[{id:"bp",name:"bp"},{id:"kb",name:"kb"},{id:"Mb",name:"Mb"}]}).setHasDefaultFocus(),a=n.CompoundGrid();a.setSeparation(16,5),a.setItem(0,0,n.Static("Chromosome:")),a.setItem(0,1,t),a.setItem(1,0,n.Static("Start:")),a.setItem(1,1,i),a.setItem(2,0,n.Static("End:")),a.setItem(2,1,s),a.setItem(3,0,n.Static("Unit:")),a.setItem(3,1,u);var f=n.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-arrow-circle-right",content:"Find",width:120,height:35}).setOnChanged(function(){var e=parseFloat(i.getValue()),n=parseFloat(s.getValue());if(!e){alert("Please provide a start position");return}if(!n){alert("Please provide an end position");return}if(n<e){alert("Invalid region");return}o.closeIfNeeded(l),h.findRegion_chromosome=t.getValue(),h.findRegion_unit=u.getValue(),h.findRegion_start=e,h.findRegion_end=n;var a=1;h.findRegion_unit=="kb"&&(a=1e3),h.findRegion_unit=="Mb"&&(a=1e6),r.send({type:"FindGenomeRegion"},{chromosome:t.getValue(),start:Math.round(e*a),end:Math.round(n*a),buttonShowRegion:!0})});e+='<div style="padding:5px">'+a.renderHtml()+"<p>"+f.renderHtml()+"</div>";var l=o.create("Find genomic region",e)},h}),define("Wizards/FindDataItem",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x={};return x.execute=function(e){var t=p.PopupFrame("DataItemTablePopup"+e,{title:"Find "+w.mapTableCatalog[e].tableNameSingle,blocking:!1,sizeX:700,sizeY:500});t.tableInfo=w.mapTableCatalog[e],t.eventids=[];var n=a.getNextUniqueID();t.eventids.push(n),s.listen(n,{type:"SelectionUpdated"},function(e,n){t.tableInfo.id==n&&t.myTable&&t.myTable.render()}),t.createFrames=function(){t.frameRoot.makeGroupVert(),t.frameButtons=t.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,80).setFrameClassClient("DQXGrayClient").setMargins(5),t.frameBody=t.frameRoot.addMemberFrame(r.FrameFinal("",.7))},t.updateQuery=function(){var e=t.ctrl_searchString.getValue();if(!e)t.myTable.setQuery(o.WhereClause.Trivial());else{var n=[];$.each(w.customProperties,function(r,i){i.tableid==t.tableInfo.id&&(i.settings.Search=="StartPattern"&&n.push(o.WhereClause.CompareFixed(i.propid,"STARTSWITH",e)),i.settings.Search=="Pattern"&&n.push(o.WhereClause.CompareFixed(i.propid,"CONTAINS",e)),i.settings.Search=="Match"&&n.push(o.WhereClause.CompareFixed(i.propid,"=",e)))}),n.length==0&&alert("No searchable properties defined for this data table"),t.myTable.setQuery(o.WhereClause.OR(n))}t.myTable.reLoadTable()},t.createPanels=function(){t.panelTable=S.createDataItemTable(t.frameBody,t.tableInfo,t.query,{hasSelection:!1,maxResultSet:100}),t.myTable=t.panelTable.getTable(),t.ctrl_searchString=i.Edit(null,{size:30,value:""}).setOnChanged(a.debounce(t.updateQuery,200)).setHasDefaultFocus(),t.panelButtons=r.Form(t.frameButtons);var e="";$.each(w.customProperties,function(n,r){r.tableid==t.tableInfo.id&&r.settings.Search!="None"&&(e&&(e+=", "),e+=r.name)}),t.panelButtons.addControl(i.CompoundVert([i.CompoundHor([i.Static("<b>Search for:</b>"),i.HorizontalSeparator(7),t.ctrl_searchString,i.HorizontalSeparator(7)]),i.Static(" in "+e)]))},t.onClose=function(){$.each(t.eventids,function(e,t){s.delListener(t)})},t.create()},x}),define("Utils/IntroViews",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","DQX/HistoryManager","Wizards/EditQuery","MetaData","Plots/GenericPlot","InfoPopups/ItemPopup","Wizards/FindGene","Wizards/FindDataItem"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E={};return E.setContainer=function(e,t){E.storedViewsContainerLeft=e,E.storedViewsContainerRight=t},E.loadIntroViews=function(){var e=p.ServerDataGetter();e.addTable("introviews",["id","name","section","description","viewicon","url","storedviewid"],"ordr",o.WhereClause.CompareFixed("workspaceid","=",m.workspaceid)),e.execute(m.serverUrl,m.database,function(){var n=i.CompoundVert([]).setMargin(0);if(E.storedViewsContainerRight)var r=i.CompoundVert([]).setMargin(0);var o={},u={},f=function(e,t,s){if(u[e])return u[e].group;if(o[e])return o[e];var a=i.CompoundHor([]),f=a;t&&(f=i.CompoundVert([i.Html(null,t),i.VerticalSeparator(4),a]));var l=s?r:n;if(e){var c=i.Section(i.Wrapper(f,"IntroViewSection"),{title:e,headerStyleClass:"IntroButtonsSectionHeader",canCollapse:!1});l.addControl(c)}else cntrolsGroup.addControl(a);return o[e]=a,a};m.generalSettings.IntroSections&&$.each(m.generalSettings.IntroSections,function(e,t){u[t.Id]=t,t.group=f(t.Name,t.Content,t.RightPanel)});var c=e.getTableRecords("introviews");$.each(c,function(e,n){n.description||(n.description="");var r=null,o=n.viewicon;o||(o="fa-angle-right"),o.indexOf("fa-")!=0&&(r="Bitmaps/CustomButtonBitmaps/"+o+".png",o=null);var u=i.Button(null,{content:n.name,buttonClass:"PnButtonGrid",width:180,height:50,icon:o,bitmap:r});content=u.renderHtml(),m.isManager&&(content+='<img class="IntroViewItemEdit" SRC="{bmp}"/>'.DQXformat({bmp:"Bitmaps/actionbuttons/edit.png"}),content+='<img class="IntroViewItemDelete" SRC="{bmp}"/>'.DQXformat({bmp:"Bitmaps/actionbuttons/delete.png"})),n.description&&(content+='<img class="IntroViewItemInfo" style="height:20px" SRC="{bmp}"/>'.DQXformat({bmp:"Bitmaps/actionbuttons/info3.png"}));var a=i.Html(null,content,"IntroViewItem");f(n.section).addControl(a),n.divid=a.getID(),n.theButton=u,u.setOnChanged(function(){var e=!1;n.url=="plot"&&(s.send({type:"LoadStoredPlot"},n.storedviewid),e=!0),n.url=="dataitem"&&(s.send({type:"LoadStoredDataItem"},n.storedviewid),e=!0),n.url=="itemtable"&&(s.send({type:"LoadStoredItemTable"},n.storedviewid),e=!0),n.url=="view"&&(s.send({type:"LoadStoredView"},n.storedviewid),e=!0),n.url=="find:_gene_"&&(b.execute(),e=!0),n.url=="find:_genomicregion_"&&(b.findRegion(),e=!0),$.each(m.tableCatalog,function(t,r){n.url=="find:"+r.id&&(e=!0,w.execute(r.id))}),e||(window.location.href=t.decode(n.url))})}),E.storedViewsContainerLeft.modifyValue(n.renderHtml()),n.postCreateHtml(),E.storedViewsContainerRight&&(E.storedViewsContainerRight.modifyValue("<p></p>"+r.renderHtml()),r.postCreateHtml()),$.each(c,function(e,t){m.isManager&&($("#"+t.divid).find(".IntroViewItemDelete").click(function(e){e.preventDefault(),e.stopPropagation(),confirm('Are you sure you want to delete the stored view "'+t.name+'"?')&&a.customRequest(m.serverUrl,PnServerModule,"view_intro_del",{database:m.database,id:t.id},function(e){E.loadIntroViews()})}),$("#"+t.divid).find(".IntroViewItemEdit").click(function(e){e.preventDefault(),e.stopPropagation(),E.editIntroView(t)}),$("#"+t.divid).find(".IntroViewItemInfo").click(function(e){e.preventDefault(),e.stopPropagation();var n='<div style="padding:10px;max-width:450px">';n+="<p></p>",n+="<b>"+t.name+"</b>",n+="<p></p>",n+=t.description,n+="<p></p>";var r=i.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-arrow-circle-right",content:"Show",width:90,height:30});r.setOnChanged(function(){l.closeIfNeeded(s),t.theButton.onChanged()}),n+=r.renderHtml(),n+="</div>";var s=l.create("",n)}))})})},E.editIntroView=function(e){var t="";t+="<b>Name:</b><br>";var n=i.Textarea("",{size:60,linecount:2,value:e.name}).setHasDefaultFocus();t+=n.renderHtml(),t+="<p><b>Section:</b><br>";var r=i.Textarea("",{size:60,linecount:2,value:e.section});t+=r.renderHtml(),t+="<p><b>Description:</b><br>";var o=i.Textarea("",{size:60,linecount:4,value:e.description});t+=o.renderHtml(),t+='<p><b>Icon:</b> (<a href="http://panoptes.readthedocs.org/en/latest/Misc/StartPageButtons.html" target="_blank">list</a>)<br>';var u=i.Textarea("",{size:60,linecount:1,value:e.viewicon?e.viewicon:""});t+=u.renderHtml();var f=i.Button(null,{content:"Update"}).setOnChanged(function(){if(!n.getValue()){alert("No name provided");return}if(!r.getValue()){alert("No section provided");return}a.customRequest(m.serverUrl,PnServerModule,"view_intro_updateinfo",{database:m.database,id:e.id,name:n.getValue(),section:r.getValue(),description:o.getValue(),viewicon:u.getValue()},function(e){s.send({type:"LoadIntroViews"},{})}),l.closeIfNeeded(h)});t+="<p>",t+=f.renderHtml(),t+="&nbsp;&nbsp;&nbsp;";var c=i.Button(null,{content:"Move to bottom"}).setOnChanged(function(){a.customRequest(m.serverUrl,PnServerModule,"view_intro_move",{database:m.database,workspaceid:m.workspaceid,id:e.id,tpe:"down"},function(e){s.send({type:"LoadIntroViews"},{})})});t+=c.renderHtml(),t+="<p>";var h=l.create("Edit view",t)},E.createIntroView=function(e,t,n,r){var o="";o+="<b>Name:</b><br>";var u=i.Textarea("",{size:60,linecount:2,value:""}).setHasDefaultFocus();o+=u.renderHtml(),o+="<p><b>Section:</b><br>";var f=i.Textarea("",{size:60,linecount:2,value:"Predefined views"});o+=f.renderHtml(),o+="<p><b>Description:</b><br>";var c=i.Textarea("",{size:60,linecount:4,value:""});o+=c.renderHtml(),o+='<p><b>Icon:</b> (<a href="http://panoptes.readthedocs.org/en/latest/Misc/StartPageButtons.html" target="_blank">list</a>)<br>';var h=i.Textarea("",{size:60,linecount:1,value:""});o+=h.renderHtml();var p=i.Button(null,{content:"Save to intro page"}).setOnChanged(function(){if(!u.getValue()){alert("No name provided");return}if(!f.getValue()){alert("No section provided");return}a.customRequest(m.serverUrl,PnServerModule,"view_intro_create",{database:m.database,workspaceid:m.workspaceid,name:u.getValue(),section:f.getValue(),description:c.getValue(),viewicon:h.getValue(),url:e,storeid:t,viewstate:n},function(e){s.send({type:"LoadIntroViews"},{})}),l.closeIfNeeded(d)});o+="<p>",o+=p.renderHtml(),o+="<p>";var d=l.create(r,o)},E}),define("InfoPopups/DocPopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","InfoPopups/ItemGenomeTracksPopup","InfoPopups/DataItemViews/DefaultView","InfoPopups/DataItemViews/ItemMap","InfoPopups/DataItemViews/PieChartMap","InfoPopups/DataItemViews/FieldList","InfoPopups/DataItemViews/PropertyGroup"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){var A={};return A.create=function(e){var t=p.PopupFrame("DocPopup",{title:"Documentation",icon:"fa-file-text",blocking:!1,sizeX:700,sizeY:500});t.topicStack=[],t.topicStackPointer=-1,t.createFrames=function(){t.frameRoot.makeGroupVert(),t.frameButtons=t.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,40).setFrameClassClient("DQXGrayClient").setAllowScrollBars(!1,!1).setMargins(0),t.frameContent=t.frameRoot.addMemberFrame(r.FrameFinal("",.7))},t.createPanels=function(){t.panelButtons=r.Form(t.frameButtons),t.buttonWidth=80,t.buttonHeight=30;var e=[];t.bt_back=i.Button(null,{content:"Back",buttonClass:"PnButtonGrid",width:t.buttonWidth,height:t.buttonHeight,icon:"fa-chevron-left"}).enable(!1).setOnChanged(function(){t.topicStackPointer>0&&(t.topicStackPointer--,t.loadUrl(t.topicStack[t.topicStackPointer].target,t.topicStack[t.topicStackPointer].scrollPos))}),e.push(t.bt_back),t.bt_forw=i.Button(null,{content:"Forward",buttonClass:"PnButtonGrid",width:t.buttonWidth,height:t.buttonHeight,icon:"fa-chevron-right"}).enable(!1).setOnChanged(function(){t.topicStackPointer<t.topicStack.length-1&&(t.topicStackPointer++,t.loadUrl(t.topicStack[t.topicStackPointer].target,t.topicStack[t.topicStackPointer].scrollPos))}),e.push(t.bt_forw),t.panelButtons.addControl(i.CompoundHor(e))},t.navigateUrl=function(e){t.topicStackPointer>=0&&(t.topicStack[t.topicStackPointer].scrollPos=$("#"+t.frameContent.getClientDivID()).scrollTop()),t.topicStack=t.topicStack.slice(0,t.topicStackPointer+1),t.topicStack.push({target:e,scrollPos:0}),t.topicStackPointer=t.topicStack.length-1,t.loadUrl(e,0)},t.loadUrl=function(e,n){t.bt_back.enable(t.topicStackPointer>0),t.bt_forw.enable(t.topicStackPointer<t.topicStack.length-1);var r="Docs/{datasetid}/{target}".DQXformat({datasetid:w.database,target:e});a.setProcessing(),$.get(r,{}).done(function(e){a.stopProcessing(),t.loadUrl_part2(e,n)}).fail(function(){a.stopProcessing(),t.loadUrl_part2('<body><div style="padding:15px;color:red; font-size:16px">Failed to download documentation item:<br/><b>{target}</b></div></body>'.DQXformat({target:e}),n)})},t.loadUrl_part2=function(e,n){var r=new DOMParser,i="";try{var s=r.parseFromString(e,"text/xml"),o=s.getElementsByTagName("body");$.each(o,function(e,t){i+=t.innerHTML})}catch(u){a.reportError("Unable to fetch document content:\n\n"+u)}var f=$("<div/>");f.append(i),f.find("img").map(function(){$(this).attr("src","Doc/"+$(this).attr("src"))}),i=f.html(),t.frameContent.setContentHtml('<div style="padding:5px">'+i+"</div>"),$("#"+t.frameContent.getClientDivID()).scrollTop(n),$("#"+t.frameContent.getClientDivID()).find("a").click(function(){var e=$(this).attr("href");return e.indexOf("http")==0||e.indexOf("mailto")==0?window.open(e,"_blank"):t.navigateUrl(e),!1})},t.create(),t.frameContent.setContentHtml('<div style="padding:20px"><i>Loading...</i></div>'),t.navigateUrl(e.target+".html")},s.listen("",{type:"OpenDoc"},function(e,t){A.create(t)}),A}),define("Views/Intro",["require","DQX/base64","DQX/Msg","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/Popup","DQX/DocEl","DQX/Utils","DQX/FrameTree","DQX/FrameList","DQX/DataFetcher/DataFetchers","DQX/SQL","MetaData","Utils/IntroViews","Wizards/FindGene","InfoPopups/DocPopup"],function(e,t,n,r,i,s,n,o,u,a,f,l,c,h,p,d,v,m){var g={init:function(){var e=r.View("start","Start");return e.createFrames=function(t){t.makeGroupHor(),t.setSeparatorSize(7);var n=parseFloat(p.generalSettings.IntroRightPanelFrac||.35);e.hasRightPanel=n>0,e.rightPanelHasSections=!1,p.generalSettings.IntroSections&&$.each(p.generalSettings.IntroSections,function(t,n){n.RightPanel&&(e.rightPanelHasSections=!0)}),e.rightPanelHasSections&&!e.hasRightPanel&&a.reportError("Sections are defined in the right intro panel, but the panel is not defined"),this.frameIntroLeft=t.addMemberFrame(i.FrameFinal("",1-n)),this.frameIntroLeft.setMargins(0),e.hasRightPanel&&(this.frameIntroRight=t.addMemberFrame(i.FrameFinal("",n)),this.frameIntroRight.setMargins(0))},e.createPanels=function(){e.hasRightPanel&&(this.panelIntroRight=i.Form(this.frameIntroRight),this.panelIntroRight.setPadding(0)),this.panelIntroLeft=i.Form(this.frameIntroLeft),this.panelIntroLeft.setPadding(0),n.listen("",{type:"LoadIntroViews"},function(){d.loadIntroViews()}),e.storedViewsLeft=s.Html(null,"","___"),this.panelIntroLeft.addControl(s.CompoundVert([s.Wrapper(s.CompoundVert([s.Static('<div style="font-weight:bold;font-size:17px;">'+p.generalSettings.Name+"</div><p>"),s.Static(p.generalSettings.Description||"<i>No description</i>")]).setMargin(0),"IntroPanelInfo"),e.storedViewsLeft])).setMargin(0),!e.rightPanelHasSections&&e.hasRightPanel&&e.createDefaultRightPanel(),e.rightPanelHasSections&&(e.storedViewsRight=s.Html(null,"","___"),this.panelIntroRight.addControl(e.storedViewsRight)),d.setContainer(e.storedViewsLeft,e.storedViewsRight),d.loadIntroViews()},e.createDefaultRightPanel=function(){var e=[],t=[];t.push(s.VerticalSeparator(10));if(p.generalSettings.hasGenomeBrowser){var i=r.getView("genomebrowser").createActivationButton({content:"Genome browser",buttonClass:"DQXToolButton2",bitmap:"Bitmaps/GenomeBrowserSmall.png",width:90}),o=s.Button(null,{buttonClass:"DQXToolButton2",content:"Find gene...",icon:"fa-search",width:100,height:35});o.setOnChanged(function(){v.execute()});var u=p.generalSettings.GenomeBrowserDescr||"<i>No description</i>",a=s.CompoundVert([s.Static(u),s.CompoundHor([i,o])]);t.push(s.Section(a,{title:"Genome browser",headerStyleClass:"IntroButtonsSectionHeader",bodyStyleClass:"ControlsSectionBodyIntro",canCollapse:!1}))}$.each(p.tableCatalog,function(e,i){if(!i.settings.IsHidden){if(i.settings.ListView)var o=r.getView("list_"+i.id).createActivationButton({content:"Show list",icon:"fa-list",width:85});else var o=r.getView("table_"+i.id).createActivationButton({content:"Show table",icon:"fa-table",width:85});if(!i.settings.DisablePlots)var u=s.Button(null,{content:"Create plot...",buttonClass:"DQXToolButton2",width:85,height:35,icon:"fa-bar-chart-o"}).setOnChanged(function(){n.send({type:"CreateDataItemPlot"},{query:null,tableid:i.id})});else var u=s.HorizontalSeparator(100);var a="";a+=i.settings.Description||"<i>No description</i>";var f=s.Static(a),l=s.CompoundVert([f,s.CompoundHor([s.Static(i.createIcon({floatLeft:!1})),s.HorizontalSeparator(12),s.CompoundVert([s.VerticalSeparator(5),s.CompoundHor([o,u])]).setTreatAsBlock().setMargin(0)]),s.Static("")]);t.push(s.Section(l,{title:i.tableCapNamePlural,headerStyleClass:"IntroButtonsSectionHeader",bodyStyleClass:"ControlsSectionBodyIntro",canCollapse:!1}))}}),this.panelIntroRight.addControl(s.CompoundVert([s.CompoundVert(t)]))},e.onBecomeVisible=function(){ga("send","screenview",{screenName:e._myID})},e}};return g}),define("DQX/ServerIO",["require","DQX/Framework","DQX/Popup","DQX/Msg","DQX/Utils","DQX/DocEl","DQX/Controls","DQX/base64"],function(e,t,n,r,i,s,o,u){var a={};return a.waitForCompletion=function(e,t,r,s,o){var u="Server is processing. This may take a while!<p>",f="calculationprogressbox"+i.getNextUniqueID(),l="logbox"+i.getNextUniqueID(),c="logbox"+i.getNextUniqueID();u+='<div id="{id}"  style="min-width:400px"></div><br>'.DQXformat({id:f}),u+='<div id="{id1}" class="DQXFloatBoxContent2" style="width:500px;height:300px; resize:both; overflow: scroll"><div id="{id2}"></div></div>'.DQXformat({id1:l,id2:c});var h=n.create("Processing",u,null,{}),p=function(){data={},i.customRequest(e,PnServerModule,"querycalculation",{calculationid:t,showlog:"1"},function(e){if(e.failed)alert(e.status),i.ClosePopup(h),o&&o(s);else if(e.completed)i.ClosePopup(h),r&&r(s);else{var t=e.status;e.progress&&(t+=" ("+(100*e.progress).toFixed(0)+"%)"),$("#"+f).length>0&&($("#"+f).html("<h3>"+t+"</h3>"),$("#"+c).html(a.formatLog(e.log)),$("#"+l).scrollTop($("#"+c).innerHeight()),setTimeout(p,1e3))}})};setTimeout(p,200)},a.customAsyncRequest=function(e,t,n,r,s,o){i.customRequest(e,t,n,r,function(t){a.waitForCompletion(e,t.calculationid,s,t,o)})},a.formatLog=function(e){if(!e)return"";var t=s.Div();t.setCssClass("DQXLogReport");var n="",r=-1,i=!1,o=e.split("\n");return $.each(o,function(e,t){var o=s.Div(),u=!0;o.setCssClass("DQXLogReportLine"),t.substring(0,3)=="==>"&&(o.setCssClass("DQXLogReportHeader"),t=t.substring(3),r+=1),t.substring(0,3)=="-->"&&(o.setCssClass("DQXLogReportHeaderSub"),t=t.substring(3),r+=1),t.substring(0,3)=="DD>"&&(r+=1,u=!1,i=!0),o.addStyle("margin-left",30*Math.max(0,r)+"px"),t.substring(0,3)=="<=="&&(r-=1,o.setCssClass("DQXLogReportFooter"),t=t.substring(3)),t.substring(0,3)=="<--"&&(r-=1,o.setCssClass("DQXLogReportFooterSub"),t=t.substring(3)),t.substring(0,3)=="<DD"&&(r-=1,u=!1,i=!1),t.substring(0,8)=="COMMAND:"&&(o.setCssClass("DQXLogReportCommand"),t=t.substring(8)),t.substring(0,4)=="SQL:"&&(o.setCssClass("DQXLogReportCommand"),t=t.substring(4)),t.substring(0,6)=="ERROR:"&&o.setCssClass("DQXLogReportError"),t.substring(0,8)=="WARNING:"&&o.setCssClass("DQXLogReportWarning"),t.substring(0,2)=="[<"&&(u=!1),t.substring(0,3)=="@@@"&&(u=!1),u&&(i&&(t=t.replace(/ /g,"&nbsp;"),t='<div class="DQXLogReportDataDump">'+t+"</div>"),o.addElem(t),n+=o.toString())}),t.addElem(n),t.toString()},a.showLog=function(e,t){i.setProcessing(),i.customRequest(e,PnServerModule,"getcalculationlog",{id:t},function(e){i.stopProcessing(),e.Error?n.create("Calculation log","No log data present"):n.create("Calculation log "+t,a.formatLog(e.Content))})},a}),define("Wizards/ManageStoredSubsets",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/FrameList","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","DQX/ServerIO"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y.manage=function(e){var t=m.mapTableCatalog[e],n=h.PopupFrame("ManageSubsets_"+e,{title:t.tableCapNameSingle+" subsets",blocking:!0,sizeX:500,sizeY:350});return n.tableInfo=t,n.createFrames=function(){n.frameRoot.makeGroupVert();var e=n.frameRoot.addMemberFrame(r.FrameGroupVert("",.7)).setSeparatorSize(2);n.frameInfo=e.addMemberFrame(r.FrameFinal("",.01)).setFrameClassClient("InfoBox").setMargins(8).setAutoSize().setAllowScrollBars(!1,!1),n.frameList=e.addMemberFrame(r.FrameFinal("",.99)).setAllowScrollBars(!1,!1),n.frameButtons=n.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,47).setFrameClassClient("DQXGrayClient").setAllowScrollBars(!1,!1)},n.createPanels=function(){var e=r.Form(this.frameInfo);e.addHtml("A subset is a named collection of {names} that is saved on the server, and can be shared with other users.".DQXformat({names:n.tableInfo.tableNamePlural})),e.render(),n.panelList=i(n.frameList),n.panelList.setOnOpen(n.handleOpenSubset);var t=35,o=s.Button(null,{buttonClass:"PnButtonGrid",content:"Open",bitmap:"Bitmaps/actionbuttons/open.png",width:90,height:t}).setOnChanged(n.handleOpenSubset),u=s.Button(null,{buttonClass:"PnButtonGrid",content:"Create new...",bitmap:"Bitmaps/actionbuttons/new.png",width:90,height:t}).setOnChanged(n.onAdd),a=s.Button(null,{buttonClass:"PnButtonGrid",content:"Edit content...",bitmap:"Bitmaps/actionbuttons/edit.png",width:90,height:t}).setOnChanged(n.onEdit),f=s.Button(null,{buttonClass:"PnButtonGrid",content:"Delete...",bitmap:"Bitmaps/actionbuttons/delete.png",width:90,height:t}).setOnChanged(n.onDel);n.panelButtons=r.Form(n.frameButtons),n.panelButtons.addControl(s.CompoundHor([o,u,a,f])),n.loadList()},n.loadList=function(e){var t=[];$.each(n.tableInfo.storedSubsets,function(e,r){var i='<div style="display:inline;margin-top:2px">'+r.name+"</div>";r.membercount!==null&&(countstring=r.membercount,r.membercount>m.subset_membercount_maxcount&&(countstring=">"+m.subset_membercount_maxcount),i+='<div style="margin-left:40px;margin-top:3px;color:rgb(120,120,120)">{count} {names}</div>'.DQXformat({count:countstring,names:n.tableInfo.tableNamePlural})),t.push({id:r.id,content:i,icon:"Bitmaps/list.png"})}),n.panelList.setItems(t,e),n.panelList.render()},n.checkSubsetHighlighted=function(){return n.panelList.getActiveItem()?!0:(c.create("Error","<p>There is currently no {name} subset defined.<p>".DQXformat({name:n.tableInfo.tableNamePlural})),!1)},n.onDel=function(){if(!n.checkSubsetHighlighted())return;var e=n.panelList.getActiveItem(),t=1;$.each(n.tableInfo.storedSubsets,function(n,r){r.id==e&&(t=n)}),t>=0&&window.confirm('Remove subset "{name}"?'.DQXformat({name:n.tableInfo.storedSubsets[t].name}))&&(n.tableInfo.storedSubsets.splice(t,1),n.loadList(),f.customRequest(m.serverUrl,PnServerModule,"subset_delete",{database:m.database,tableid:n.tableInfo.id,workspaceid:m.workspaceid,id:e},function(){}))},n.onAdd=function(){var e=prompt("Please enter a name for the new subset");e!=null&&f.customRequest(m.serverUrl,PnServerModule,"subset_create",{database:m.database,tableid:n.tableInfo.id,workspaceid:m.workspaceid,name:e},function(t){var r=t.id;n.tableInfo.storedSubsets.push({id:r,name:e}),n.loadList(r),n.storeSelection(r,"replace")})},n.handleOpenSubset=function(){if(!n.checkSubsetHighlighted())return;var e=n.panelList.getActiveItem(),r=n.tableInfo.createSubsetWhereclause(e);o.send({type:"DataItemTablePopup"},{tableid:n.tableInfo.id,query:r,subSamplingOptions:null,title:t.tableCapNamePlural+" subset"}),n.close()},n.onEdit=function(){if(!n.checkSubsetHighlighted())return;var e=n.panelList.getActiveItem(),r=1;$.each(n.tableInfo.storedSubsets,function(t,n){n.id==e&&(r=t)});var i="",o=s.Button(null,{buttonClass:"DQXToolButton2",content:"Clear subset",bitmap:"Bitmaps/circle_red_small.png",width:140,height:50}).setOnChanged(function(){c.closeIfNeeded(f),n.clearSubset(e)});i+="<p>",i+=o.renderHtml(),i+="<p><p>";var u=t.getSelectedList();if(u.length==0)i+='<div style="max-width:500px"><p><i>There are currently no {names} selected in the session. You can manipulate a subset by first creating a selection set (e.g. click on the box to the left of a {name} in a table)</i></p></div>'.DQXformat({name:n.tableInfo.tableNameSingle,names:n.tableInfo.tableNamePlural});else{i+='<div style="max-width:500px"><p><i>There are currently {count} {names} selected</i></p></div>'.DQXformat({count:u.length,names:n.tableInfo.tableNamePlural});var a=[];a.push({content:"Replace<br>by selection",bitmap:"Bitmaps/venn2.png",bitmapHeight:15,handler:function(){n.storeSelection(e,"replace")}}),a.push({content:"Add<br>selection",bitmap:"Bitmaps/venn3.png",bitmapHeight:15,handler:function(){n.storeSelection(e,"add")}}),a.push({content:"Remove<br>selection",bitmap:"Bitmaps/venn4.png",bitmapHeight:15,handler:function(){n.storeSelection(e,"remove")}}),$.each(a,function(e,t){var n=s.Button(null,{buttonClass:"DQXToolButton2",content:t.content,bitmap:t.bitmap,bitmapHeight:t.bitmapHeight,width:140,height:50}).setOnChanged(function(){t.handler(),c.closeIfNeeded(f)});i+=n.renderHtml()})}var f=c.create('Edit subset "'+n.tableInfo.storedSubsets[r].name+'"',i)},n.clearSubset=function(e){var t=!!m.findProperty(n.tableInfo.id,n.tableInfo.primkey).isFloat;f.setProcessing(),f.serverDataStoreLong(m.serverUrl,"",function(r){f.stopProcessing(),g.customAsyncRequest(m.serverUrl,PnServerModule,"subset_store",{database:m.database,workspaceid:m.workspaceid,tableid:n.tableInfo.id,keyid:n.tableInfo.primkey,subsetid:e,dataid:r,method:"replace",isnumericalkey:t?1:0},function(e){})})},n.storeSelection=function(e,r){var i=5e4,s="",o=t.getSelectedList();o.length>i&&alert("Selection list will be limited to "+i),$.each(o,function(e,t){e<=i&&(e>0&&(s+="	"),s+=t)});var u=!!m.findProperty(n.tableInfo.id,n.tableInfo.primkey).isFloat;f.setProcessing(),f.serverDataStoreLong(m.serverUrl,s,function(t){f.stopProcessing(),g.customAsyncRequest(m.serverUrl,PnServerModule,"subset_store",{database:m.database,workspaceid:m.workspaceid,tableid:n.tableInfo.id,keyid:n.tableInfo.primkey,subsetid:e,dataid:t,method:r,isnumericalkey:u?1:0},function(t){f.customRequest(m.serverUrl,PnServerModule,"subset_fetchmembercount",{database:m.database,workspaceid:m.workspaceid,tableid:n.tableInfo.id,subsetid:e},function(t){$.each(n.tableInfo.storedSubsets,function(n,r){r.id==e&&(r.membercount=t.membercount)}),n.loadList()})})})},n.create(),n},y}),define("Utils/SelectionTools",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","DQX/ServerIO","Wizards/EditQuery","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g={};return g.cmdStore=function(e){var t=[];$.each(m.customProperties,function(n,r){r.tableid==e.id&&r.datatype=="Boolean"&&r.settings.CanUpdate&&t.push({id:r.propid,name:r.name})});var n='<div style="padding:10px">',r=i.Combo(null,{label:"Store in property: ",states:t,value:"StoredSelection"});n+=r.renderHtml(),n+="<br>";var s=i.Button(null,{content:"<b>Store</b>",width:50,height:20});s.setOnChanged(function(){l.closeIfNeeded(o),g.executeStore(e,r.getValue())}),n+=s.renderHtml(),n+="</div>";var o=l.create("Store selection",n)},g.executeStore=function(e,t){var n=5e4,r="",i=e.getSelectedList();i.length>n&&alert("Selection list will be limited to "+n),$.each(i,function(e,t){e<=n&&(e>0&&(r+="	"),r+=t)}),a.setProcessing(),a.serverDataStoreLong(m.serverUrl,r,function(n){a.stopProcessing();var r=m.findProperty(e.id,t);d.customAsyncRequest(m.serverUrl,PnServerModule,"selectionstore",{database:m.database,workspaceid:m.workspaceid,tableid:e.id,keyid:e.primkey,propid:t,dataid:n,iscustom:r.isCustom?1:0,hassubsampling:e.settings.AllowSubSampling?1:0,cachedworkspace:e.settings.CacheWorkspaceData?1:0},function(n){s.broadcast({type:"PropertyContentChanged"},{tableid:e.id,propid:t}),s.send({type:"DataItemTablePopup"},{tableid:e.id,query:o.WhereClause.CompareFixed(t,"=",1),title:"Stored "+e.tableNamePlural+" selection"})})})},g}),define("Utils/ButtonChoiceBox",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Wizard","DQX/Popup","DQX/PopupFrame","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m={};return m.create=function(e,t,n){var r="<p>"+t+"<p>";$.each(n,function(e,t){e>0&&(r+="<br>"),$.each(t,function(e,t){var n=i.Button(null,{buttonClass:"DQXToolButton2",content:t.content,bitmap:t.bitmap,bitmapHeight:t.bitmapHeight,icon:t.icon,width:140,height:50}).setOnChanged(function(){c.closeIfNeeded(s),t.handler()});r+=n.renderHtml()})});var s=c.create(e,r)},m.createPlotItemSelectionOptions=function(e,t,n,r,i,o){var u=[];if(o){var a=[];a.push({content:"Select<br>(REPLACE)",bitmap:"Bitmaps/venn2.png",bitmapHeight:15,handler:function(){var e=o();t.currentSelection={},$.each(e,function(e,n){t.selectItem(n,!0)}),s.broadcast({type:"SelectionUpdated"},t.id)}}),a.push({content:"Select<br>(ADD)",bitmap:"Bitmaps/venn3.png",bitmapHeight:15,handler:function(){var e=o();$.each(e,function(e,n){t.selectItem(n,!0)}),s.broadcast({type:"SelectionUpdated"},t.id)}}),a.push({content:"Select<br>(RESTRICT)",bitmap:"Bitmaps/venn1.png",bitmapHeight:15,handler:function(){var e=t.getSelectedList(),n=o(),r={};$.each(n,function(e,t){r[t]=!0}),$.each(e,function(e,n){r[n]||t.selectItem(n,!1)}),s.broadcast({type:"SelectionUpdated"},t.id)}}),a.push({content:"Select<br>(EXCLUDE)",bitmap:"Bitmaps/venn4.png",bitmapHeight:15,handler:function(){var e=t.getSelectedList(),n=o(),r={};$.each(n,function(e,t){r[t]=!0}),$.each(e,function(e,n){r[n]&&t.selectItem(n,!1)}),s.broadcast({type:"SelectionUpdated"},t.id)}}),u.push(a)}if(i){var a=[];a.push({content:"Show items in query",icon:"fa-table",handler:function(){s.send({type:"DataItemTablePopup"},{tableid:t.id,query:i.query,subSamplingOptions:i.subSamplingOptions,title:n+" ("+t.tableCapNamePlural+")"})}}),a.push({content:"Restrict plot query",icon:"fa-filter",handler:function(){e.theQuery.modify(i.query)}}),u.push(a)}m.create(n,r,u)},m.createQuerySelectionOptions=function(e,t){var n=[],r=[];r.push({content:"REPLACE",bitmap:"Bitmaps/venn2.png",bitmapHeight:15,handler:function(){v.selectQuery(e,t,"replace")}}),r.push({content:"ADD",bitmap:"Bitmaps/venn3.png",bitmapHeight:15,handler:function(){v.selectQuery(e,t,"add")}}),r.push({content:"RESTRICT",bitmap:"Bitmaps/venn1.png",bitmapHeight:15,handler:function(){v.selectQuery(e,t,"restrict")}}),r.push({content:"EXCLUDE",bitmap:"Bitmaps/venn4.png",bitmapHeight:15,handler:function(){v.selectQuery(e,t,"exclude")}}),n.push(r);var i=e.tableViewer.getQueryDescription(t.get());i+="<p>Select the {names} in this query:<br>".DQXformat({names:e.tableNamePlural}),m.create("Select "+e.tableNamePlural,i,n)},m}),define("Views/TableViewer",["require","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/DocEl","DQX/Popup","DQX/PopupFrame","DQX/Utils","DQX/SQL","DQX/QueryTable","DQX/QueryBuilder","DQX/DataFetcher/DataFetchers","MetaData","Wizards/EditQuery","Wizards/ManageStoredSubsets","Utils/QueryTool","Utils/MiscUtils","Utils/SelectionTools","Utils/ButtonChoiceBox"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){var w={init:function(e){var s=p.getTableInfo(e),o=t.View("table_"+e,p.getTableInfo(e).tableCapNamePlural);return o.setEarlyInitialisation(),o.tableid=e,o.tableInfo=p.getTableInfo(e),o.theQuery=m.Create(e,{hasSubSampler:o.tableInfo.settings.AllowSubSampling,subSamplingOptions:m.getSubSamplingOptions_All()}),p.getTableInfo(o.tableid).tableViewer=o,i.listen("",{type:"SelectionUpdated"},function(e,t){o.tableid==t&&(o.selectedItemCountText&&o.selectedItemCountText.modifyValue(o.tableInfo.getSelectedCount()+" "+o.tableInfo.tableNamePlural+" selected"),o.myTable&&o.myTable.render())}),i.listen("",{type:"PropertyContentChanged"},function(e,t){if(o.tableid==t.tableid){var n=o.panelTable.getTable().findColumn(t.propid);n&&(o.panelTable.getTable().clearData(),o.panelTable.getTable().render())}}),p.getTableInfo(o.tableid).hasGenomePositions&&i.listen("",{type:"ShowItemsInGenomeRange",tableid:o.tableid},function(e,t){if(t.preservecurrentquery)var n=o.theQuery.get();else var n=f.WhereClause.Trivial();n=f.WhereClause.createValueRestriction(n,o.tableInfo.ChromosomeField,t.chrom),n=f.WhereClause.createRangeRestriction(n,o.tableInfo.PositionField,t.start,t.stop,!0),i.send({type:"DataItemTablePopup"},{tableid:o.tableInfo.id,query:n,title:o.tableInfo.tableCapNamePlural+" in genomic region "+t.chrom+":"+t.start+":"+t.stop})}),i.listen("",{type:"ShowItemsInSimpleQuery",tableid:o.tableid},function(e,t){o.activateState();var n=f.WhereClause.CompareFixed(t.propid,"=",t.value);o.theQuery.modify(n)}),i.listen("",{type:"ShowItemsInQuery",tableid:o.tableid},function(e,t){o.activateState(),t.subSamplingOptions&&o.theQuery.setSubSamplingOptions(t.subSamplingOptions),o.theQuery.modify(t.query),u.minimiseAll()}),o.storeSettings=function(){var e={};return e.tableSettings=o.myTable.storeSettings(),e.query=f.WhereClause.encode(o.theQuery.get()),e.subsampling=o.theQuery.getSubSamplingOptions(),o.visibilityControlsGroup&&(e.activecolumns=r.storeSettings(o.visibilityControlsGroup)),e},o.recallSettings=function(e){var t=f.WhereClause.decode(e.query);e.tableSettings&&(o.myTable.recallSettings(e.tableSettings),o._storedTableSettings=e.tableSettings),e.subsampling&&o.theQuery.setSubSamplingOptions(e.subsampling),o.theQuery.modify(t);var n=p.getTableInfo(o.tableid);n.currentQuery=t,e.activecolumns&&o.visibilityControlsGroup&&r.recallSettings(o.visibilityControlsGroup,e.activecolumns,!1)},o.activateWithQuery=function(e){o.activateState(),o.theQuery.modify(e)},o.createFrames=function(e){o.tableInfo.settings.IsHidden&&(e.isHiddenPanel=!0),this.frameControls=n.FrameFinal("",.2),this.frameTable=n.FrameFinal("",.8).setAllowScrollBars(!1,!1),e.MakeControlsFrame(this.frameControls,this.frameTable,250)},o.createPanels=function(){this.theTableFetcher=h.Table(p.serverUrl,p.database,o.tableid+"CMB_"+p.workspaceid),this.theTableFetcher.setReportIfError(!0),this.theTableFetcher.setMaxRecordCount(o.tableInfo.settings.MaxCountQueryAggregated||1e6),this.createPanelTableViewer(),this.createPanelControls(),this.reLoad(),o.panelsCreated=!0},o.postLoadAction=function(){o.hasBecomeVisible&&(o.myTable.preventFetch=!1,o.uptodate=!1,o.reLoad())},o.onBecomeVisible=function(){ga("send","screenview",{screenName:o.tableid}),o.hasBecomeVisible||(o.panelsCreated&&o.viewIsLoaded&&(o.myTable.preventFetch=!1,o.uptodate=!1,o.reLoad()),o.hasBecomeVisible=!0)},o.createPanelTableViewer=function(){var e=p.getTableInfo(o.tableid);this.panelTable=l.Panel(this.frameTable,this.theTableFetcher,{leftfraction:50}),this.myTable=this.panelTable.getTable(),this.myTable.fetchBuffer=300,this.myTable.recordCountFetchType=h.RecordCountFetchType.DELAYED,this.myTable.preventFetch=!0,o.myTable.setQuery(o.theQuery.get())},o.createPanelControls=function(){this.panelSimpleQuery=n.Form(this.frameControls),this.panelSimpleQuery.setPadding(0);if(!o.tableInfo.settings.DisableSubsets){var e=r.Button(null,{content:"Manage subsets",buttonClass:"PnButtonGrid",width:80,height:30,icon:"fa-list-ul",bitmapHeight:18});e.setOnChanged(function(){v.manage(o.tableid)})}else var e=r.HorizontalSeparator(80);if(!o.tableInfo.settings.DisablePlots){var t=r.Button(null,{content:"Create plot",buttonClass:"PnButtonGrid",width:80,height:30,icon:"fa-bar-chart-o",bitmapHeight:20});t.setOnChanged(function(){var e=null;o.theQuery.isSubSampling()&&(e=o.theQuery.getSubSamplingOptions()),i.send({type:"CreateDataItemPlot"},{tableid:o.tableid,subSamplingOptions:e})})}else var t=r.HorizontalSeparator(80);var s=o.theQuery.createQueryControl({hasQueryString:!0},[]),u=p.getTableInfo(o.tableid);o.selectedItemCountText=r.Html(null,"0 {names} selected".DQXformat({names:o.tableInfo.tableNamePlural}));var a=r.Button(null,{content:"Clear",buttonClass:"PnButtonGrid",width:80});a.setOnChanged(function(){u.clearSelection(),i.broadcast({type:"SelectionUpdated"},o.tableid)});var f=r.Button(null,{content:"Select",buttonClass:"PnButtonGrid",width:80});f.setOnChanged(function(){b.createQuerySelectionOptions(o.tableInfo,o.theQuery)}),o.visibilityControlsGroup=r.CompoundVert([]).setMargin(0),o.introText=r.Html(null,"");var l=r.Wrapper(r.CompoundVert([o.introText,r.AlignCenter(r.CompoundVert([s,r.VerticalSeparator(10),r.CompoundHor([t,e])]).setMargin(0)),r.VerticalSeparator(7),o.selectedItemCountText,r.AlignCenter(r.CompoundHor([a,f]))]),"ControlsSectionBody");o.controlsGroup=r.CompoundVert([l,o.visibilityControlsGroup]).setMargin(0),this.panelSimpleQuery.addControl(o.controlsGroup),o.setIntroText()},o.setIntroText=function(){var e="";e+=o.tableInfo.createIcon({floatLeft:!0}),o.tableInfo.settings.Description&&(e+='<span class="DescriptionText">'+o.tableInfo.settings.Description+"</span>",e+="<p>"),o.introText.modifyValue(e)},o.getQueryDescription=function(e){var t='<span style=""><b>Query:</b></span> <span style="">'+o.tableInfo.createQueryDisplayString(e)+"</span>";return t},o.getRecordCount=function(){return o.myTable?o.myTable.getRecordCount():null},o.getSortColumn=function(){return o.myTable?o.myTable.getSortColumn():p.getTableInfo(o.tableid).primkey},o.updateQuery2=function(){o.setIntroText();if(o.myTable){o.myTable.setQuery(o.theQuery.getForFetching()),o.myTable.setTable(o.tableInfo.getQueryTableName(o.theQuery.isSubSampling())),o.myTable.reLoadTable();var e=p.getTableInfo(o.tableid);e.currentQuery=o.theQuery.get(),i.broadcast({type:"QueryChanged"},o.tableid)}},o.reLoad=function(){var e=p.getTableInfo(o.tableid);if(o.uptodate)return;o.uptodate=!0,this.theTableFetcher.resetAll(),o.myTable.clearTableColumns(),o.myTable.createSelectionColumn("sel","",e.id,e.primkey,e,a.Color(.8,.2,0),function(){i.broadcast({type:"SelectionUpdated"},e.id)}),o.columnVisibilityChecks=[],o.visibilityControlsGroup.clear();var t={};$.each(e.propertyGroups,function(e,n){var i=!1;$.each(n.properties,function(e,t){t.settings.showInTable&&(i=!0)});if(i){var s=r.CompoundVert([]).setMargin(5),u=r.Section(s,{title:n.Name,headerStyleClass:"DQXControlSectionHeader",bodyStyleClass:"ControlsSectionBodySubSection"});u.checkboxes=[],u.onCollapsing=function(){u.memChkStates={},$.each(u.checkboxes,function(e,t){u.memChkStates[t.getID()]=t.getValue(),t.modifyValue(!1)})},u.onExpanding=function(){u.memChkStates&&$.each(u.checkboxes,function(e,t){t.modifyValue(u.memChkStates[t.getID()])})},o.visibilityControlsGroup.addControl(u),t[n.Id]={theList:s,theSection:u}}}),$.each(p.customProperties,function(n,i){if(i.tableid==o.tableid&&i.settings.showInTable){var s=g.createItemTableViewerColumn(o.myTable,o.tableid,i.propid);s.setHeaderClickHandler(function(e){o.createPropertyPopup(e)});var u=!0;i.isPrimKey&&(u=!1),i.propid==o.tableInfo.ChromosomeField&&(u=!1),i.propid==o.tableInfo.PositionField&&(u=!1);if(u){var a=r.Check(null,{label:i.name,value:e.isPropertyColumnVisible(s.myCompID),hint:i.settings.Description}).setClassID(i.propid).setOnChanged(function(){o.myTable.findColumnRequired(a.colID).setVisible(a.getValue()),o.myTable.render(),e.setPropertyColumnVisible(a.colID,a.getValue())});a.colID=s.myCompID,e.isPropertyColumnVisible(s.myCompID)||s.setVisible(!1),t[i.group.Id].theSection.checkboxes.push(a),o.columnVisibilityChecks.push(a);var f=r.ImageButton(null,{bitmap:"Bitmaps/actionbuttons/info.png",vertShift:-2}).setOnChanged(function(){o.createPropertyPopup(i.propid)}),l=r.CompoundHor([a,r.HorizontalSeparator(8),f]);t[i.group.Id].theList.addControl(l)}}}),o._storedTableSettings&&(o.myTable.recallSettings(o._storedTableSettings),o._storedTableSettings=null),o.myTable.reLoadTable(),this.panelSimpleQuery.render()},o.createPropertyPopup=function(e){var t=p.findProperty(o.tableInfo.id,e),n=o.panelTable.getTable().findColumn(e),s=[];n.sortOption&&(s.push(r.Button(null,{buttonClass:"DQXToolButton2",content:"Sort<br>ascending",bitmap:a.BMP("arrow7up.png"),width:120,height:40}).setOnChanged(function(){o.panelTable.getTable().sortByColumn(e,!1)})),s.push(r.Button(null,{buttonClass:"DQXToolButton2",content:"Sort<br>descending",bitmap:a.BMP("arrow7down.png"),width:120,height:40}).setOnChanged(function(){o.panelTable.getTable().sortByColumn(e,!0)}))),i.send({type:"PropInfoPopup"},{tableid:o.tableInfo.id,propid:e,query:o.theQuery.get(),buttons:s})},o.theQuery.notifyQueryUpdated=o.updateQuery2,o}};return w}),define("Views/ListViewer",["handlebars","require","DQX/Application","DQX/Framework","DQX/Controls","DQX/FrameList","DQX/Msg","DQX/DocEl","DQX/Popup","DQX/PopupFrame","DQX/Utils","DQX/SQL","DQX/QueryTable","DQX/QueryBuilder","DQX/DataFetcher/DataFetchers","MetaData","Wizards/EditQuery","Wizards/ManageStoredSubsets","Utils/QueryTool","Utils/MiscUtils","Utils/GetFullDataItemInfo","Views/ItemView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S={init:function(t){var o=n.View("list_"+t,v.getTableInfo(t).tableCapNamePlural);return o.cache={},o.setEarlyInitialisation(),o.tableid=t,o.tableInfo=v.getTableInfo(t),o.tableInfo.templatedViewer=o,o.titleTemplate=o.tableInfo.settings.ItemTitle||"{{"+o.tableInfo.primkey+"}}",o.compiledTitleTemplate=e.compile(o.titleTemplate),o.storeSettings=function(){var e={};return e.selectedItem=o.selectedItem,e},o.recallSettings=function(e){e.selectedItem&&(o.list_loaded?o.panelList.setActiveItem(e.selectedItem):o.load_item=e.selectedItem)},o.createFrames=function(e){e.makeGroupHor(),o.frameControls=r.FrameGroupVert("",.2),e.addMemberFrame(o.frameControls),o.frameRight=r.FrameGroupVert("",.8).setMargins(0).setSeparatorSize(0),e.addMemberFrame(o.frameRight),o.frameTitle=r.FrameFinal("",.1).setFixedSize(r.dimY,50).setAllowScrollBars(!1,!1),o.frameRight.addMemberFrame(o.frameTitle),o.frameTemplate=r.FrameDynamic("",.8),o.frameRight.addMemberFrame(o.frameTemplate),this.frameContext=this.frameControls.addMemberFrame(r.FrameFinal("",.01)).setMargins(0).setMinSize(r.dimY,80).setAllowScrollBars(!1,!1),this.frameList=this.frameControls.addMemberFrame(r.FrameFinal("",.8))},o.createPanels=function(){this.panelContext=r.Form(this.frameContext),this.panelContext.setPadding(0);var n="";n+=o.tableInfo.createIcon({floatLeft:!0}),o.tableInfo.settings.Description&&(n+='<span style="color:rgb(100,100,100)">'+o.tableInfo.settings.Description+"</span>",n+="<p>"),o.introText=i.Html(null,n);var u=i.Wrapper(i.CompoundVert([o.introText]),"ControlsSectionBody");o.controlsGroup=i.CompoundVert([u]).setMargin(0),this.panelContext.addControl(o.controlsGroup),this.panelList=s(this.frameList),this.panelList.setOnItemHighlighted(o.itemSelected),this.panelList.setHasFilter(),this.panelList.render(),this.tableFetcher=d.Table(v.serverUrl,v.database,o.tableid+"CMB_"+v.workspaceid),this.tableFetcher.myDataConsumer=o,this.tableFetcher.setReportIfError(!0),this.tableFetcher.setMaxRecordCount(o.tableInfo.settings.MaxCountQueryAggregated||1e6),this.tableFetcher.positionField=null,this.tableFetcher.addFetchColumnActive(o.tableInfo.primkey,b.createEncoderId(t,o.tableInfo.primkey)),o.titleFields=e.fields_used(o.titleTemplate,_.map(o.tableInfo.properties,l.attr("propid"))),_.forEach(o.titleFields,function(e){o.tableFetcher.addFetchColumnActive(e,b.createEncoderId(t,e))}),this.tableFetcher.IsDataReady(-1,1e6),o.panelsCreated=!0},o.postLoadAction=function(){},o.onBecomeVisible=function(){ga("send","screenview",{screenName:o.tableid}),o.hasBecomeVisible||(o.panelsCreated&&o.viewIsLoaded,o.hasBecomeVisible=!0)},o.itemSelected=function(e){o.selectedItem=e,o.render(e)},o.notifyDataReady=function(){o.list_loaded=!0,o.renderList(),o.load_item&&o.panelList.setActiveItem(o.load_item)},o.renderList=function(){function t(e){var t={};return _.forEach(o.titleFields,function(n){t[n]=o.tableFetcher.getColumnPoint(e,n)}),o.compiledTitleTemplate(t)}var e=[];for(var n=0;n<o.tableFetcher.totalRecordCount;n++)e.push({id:o.tableFetcher.getColumnPoint(n,o.tableInfo.primkey),content:t(n)});o.panelList.setItems(e,e[0].id),o.panelList.render(),o.render(e[0].id)},o.try_cache=function(e,t){o.cache[e]?t(o.cache[e]):(l.setProcessing("Downloading..."),w.Get(o.tableid,e,function(n){l.stopProcessing(),o.cache[e]=n,t(n)}))},o.render=function(e){o.try_cache(e,function(t){_.each(o.tableInfo.properties,function(e){t.fields[e.propid]=e.toDisplayString(t.fields[e.propid])}),o.frameTitle.setContentHtml('<div class="PnItemTitle">'+o.compiledTitleTemplate(t.fields)+"</div>"),o.itemView?o.itemView.update(t):(o.itemView=E(o.frameTemplate,{itemid:e,tableid:o.tableid},t,o),o.itemView.render())})},o}};return S}),define("InfoPopups/GenePopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y.init=function(){s.listen("",{type:"GenePopup"},function(e,t){y.show(t)})},y.show=function(e){var t=a.Url(g.serverUrl);t.addUrlQueryItem("datatype","recordinfo"),t.addUrlQueryItem("qry",o.WhereClause.encode(o.WhereClause.CompareFixed("fid","=",e))),t.addUrlQueryItem("database",g.database),t.addUrlQueryItem("tbname",g.tableAnnotation),$.ajax({url:t.toString(),success:function(e){a.stopProcessing();var t=a.parseResponse(e);if("Error"in t){alert(t.Error);return}y.show_sub1(t.Data)},error:a.createMessageFailFunction()}),a.setProcessing("Downloading...")},y.show_sub1=function(e){var t="";t+='<div style="padding:5px">',t+='<div style="max-width:600px;line-height: 150%">',t+="<b>Id</b>: "+e.fid+"<br/>",t+="<b>Name</b>: "+e.fname+"<br/>",t+="<b>Alternatives</b>: "+e.fnames.split(",").join(", ")+"<br/>",t+="<b>Description</b>: "+e.descr+"<br/>",t+="<b>Position</b>: "+e.chromid+":"+e.fstart+"-"+e.fstop+"<br/>",t+="</div>",t+="<p>";var n=i.Button(null,{buttonClass:"DQXToolButton2",content:"Show in genome browser",width:140,height:50,bitmap:"Bitmaps/GenomeBrowser.png"}).setOnChanged(function(){s.send({type:"JumpgenomeRegion"},{chromoID:e.chromid,start:parseInt(e.fstart),end:parseInt(e.fstop)}),l.closeIfNeeded(u)});t+=n.renderHtml(),$.each(g.tableCatalog,function(n,r){if(r.hasGenomePositions){var o=i.Button(null,{buttonClass:"DQXToolButton2",content:"{name} in this gene".DQXformat({name:r.tableCapNamePlural}),width:140,height:50,icon:r.settings.Icon?r.settings.Icon:"fa-table"}).setOnChanged(function(){s.send({type:"ShowItemsInGenomeRange",tableid:r.id},{preservecurrentquery:!1,chrom:e.chromid,start:e.fstart,stop:e.fstop}),l.closeIfNeeded(u)});t+=o.renderHtml()}}),$.each(g.tableCatalog,function(n,r){if(r.hasGenomeRegions){var a=i.Button(null,{content:"Show "+r.tableNamePlural,buttonClass:"DQXToolButton2",width:150,height:50,icon:r.settings.Icon?r.settings.Icon:"fa-table"}).setOnChanged(function(){var t=o.WhereClause.AND([o.WhereClause.CompareFixed(r.settings.Chromosome,"=",e.chromid),o.WhereClause.CompareFixed(r.settings.RegionStart,"<=",e.fstop),o.WhereClause.CompareFixed(r.settings.RegionStop,">=",e.fstart)]);s.send({type:"DataItemTablePopup"},{tableid:r.id,query:t,title:r.tableCapNamePlural+" in "+e.chromid+":"+e.fstart+"-"+e.fstop}),l.closeIfNeeded(u)});t+=a.renderHtml()}});if(g.generalSettings.ExternalGeneLinks){var r=JSON.parse(g.generalSettings.ExternalGeneLinks);$.each(r,function(n,r){var s=i.Button(null,{content:r.Name,buttonClass:"DQXToolButton2",width:150,height:50,bitmap:"Bitmaps/circle_cyan_small.png"}).setOnChanged(function(){l.closeIfNeeded(u);var t=r.Url.DQXformat({Id:e.fid});window.open(t,"_blank")});t+=s.renderHtml()})}t+="<br>",$.each(g.externalLinks,function(n,r){if(r.linktype=="annotation_gene"){var s=i.Button(null,{content:"Find in "+r.linkname}).setOnChanged(function(){window.open(r.linkurl.DQXformat({id:e.fid}),"_blank")});t+=s.renderHtml()}}),t+="</div>";var u=l.create("Gene",t)},y}),define("InfoPopups/DataItemTablePopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/Popup","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","Utils/ButtonChoiceBox","Utils/QueryTool"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,c,p,d,v,m,g,y,b,w,E,S,x,T){var N={};return N.init=function(){s.listen("",{type:"DataItemTablePopup"},function(e,t){N.show(t)})},N.show=function(n){var u=w.mapTableCatalog[n.tableid].tableCapNamePlural+" table";n.title&&(u=n.title);var f=p.PopupFrame("DataItemTablePopup"+n.tableid,{title:u,blocking:!1,sizeX:700,sizeY:500});w.isManager&&f.addTool("fa-link",function(){f.handleCreateLink()}),f.tableInfo=w.mapTableCatalog[n.tableid],f.tableInfo.settings.AllowSubSampling&&!n.subSamplingOptions&&(n.subSamplingOptions=T.getSubSamplingOptions_All()),f.updateQuery=function(){f.myTable.setQuery(f.theQuery.getForFetching()),f.myTable.setTable(f.tableInfo.getQueryTableName(f.theQuery.isSubSampling())),f.myTable.reLoadTable()},f.theQuery=T.Create(f.tableInfo.id,{includeCurrentQuery:!0,hasSubSampler:f.tableInfo.settings.AllowSubSampling,subSamplingOptions:n.subSamplingOptions}),n.serialisedquery&&f.theQuery.recall(n.serialisedquery),n.query&&f.theQuery.setStartQuery(n.query),f.theQuery.notifyQueryUpdated=f.updateQuery,f.eventids=[];var l=a.getNextUniqueID();f.eventids.push(l),s.listen(l,{type:"SelectionUpdated"},function(e,t){f.tableInfo.id==t&&f.myTable&&f.myTable.render()}),f.createFrames=function(){f.frameRoot.makeGroupHor(),f.frameControls=f.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setAllowScrollBars(!1,!0).setFixedSize(r.dimX,210),f.frameBody=f.frameRoot.addMemberFrame(r.FrameFinal("",.7))},f.createPanels=function(){f.introText=i.Html(null,"","_dummyclass_");var e=f.theQuery.createQueryControl({noDefine:!0,controlsWidth:165}),t=i.CompoundVert([f.introText,i.AlignCenter(i.CompoundVert([i.VerticalSeparator(10),e]))]);f.panelControls=r.Form(f.frameControls).setPadding(0),f.panelControls.addControl(i.Wrapper(t,"ControlsSectionBody")),f.panelTable=S.createDataItemTable(f.frameBody,f.tableInfo,f.theQuery.getForFetching(),{hasSelection:!0,subSampling:f.theQuery.isSubSampling()}),f.myTable=f.panelTable.getTable(),$.each(f.myTable.myColumns,function(e,t){t.propid&&t.setHeaderClickHandler(function(e){var n=[];t.sortOption&&(n.push(i.Button(null,{buttonClass:"DQXToolButton2",content:"Sort<br>ascending",bitmap:a.BMP("arrow7down.png"),width:120,height:40}).setOnChanged(function(){f.panelTable.getTable().sortByColumn(t.propid,!1)})),n.push(i.Button(null,{buttonClass:"DQXToolButton2",content:"Sort<br>descending",bitmap:a.BMP("arrow7up.png"),width:120,height:40}).setOnChanged(function(){f.panelTable.getTable().sortByColumn(t.propid,!0)}))),s.send({type:"PropInfoPopup"},{tableid:f.tableInfo.id,propid:t.propid,query:f.theQuery.get(),buttons:n})})});var n=i.Button(null,{content:"Selection...",buttonClass:"PnButtonGrid",width:130,height:30,icon:"fa-check-circle"}).setOnChanged(function(){x.createQuerySelectionOptions(f.tableInfo,f.theQuery)}),u=i.Button(null,{content:"Show in view",buttonClass:"PnButtonGrid",width:130,height:30,bitmap:"Bitmaps/datagridadd.png",bitmapHeight:19}).setOnChanged(function(){var e=[],t=function(e){s.send({type:"ShowItemsInQuery",tableid:f.tableInfo.id},{query:e,subSamplingOptions:f.theQuery.getSubSamplingOptions()})},n=f.tableInfo.currentQuery;if(!n||n.isTrivial)t(f.theQuery.get());else{e.push({content:"REPLACE<br>current query",bitmap:"Bitmaps/venn2.png",bitmapHeight:15,handler:function(){t(f.theQuery.get())}}),e.push({content:"ADD<br>to current query",bitmap:"Bitmaps/venn3.png",bitmapHeight:15,handler:function(){t(o.WhereClause.OR([n,f.theQuery.get()]))}}),e.push({content:"RESTRICT<br>current query",bitmap:"Bitmaps/venn1.png",bitmapHeight:15,handler:function(){t(o.WhereClause.AND([n,f.theQuery.get()]))}});var r='<div style="max-width:500px">';r+="<b>Current {name} query:</b><br>".DQXformat({name:f.tableInfo.tableNamePlural})+f.tableInfo.createQueryDisplayString(n),r+="<p>",r+="<b>New query:</b><br>"+f.tableInfo.createQueryDisplayString(f.theQuery.get()),r+="<p>",r+="</div>",$.each(e,function(e,t){var n=i.Button(null,{buttonClass:"DQXToolButton2",content:t.content,bitmap:t.bitmap,bitmapHeight:t.bitmapHeight,width:140,height:50}).setOnChanged(function(){t.handler(),c.closeIfNeeded(u)});r+=n.renderHtml()});var u=c.create("Show in view",r)}}),l=i.Button(null,{content:"Create plot...",buttonClass:"PnButtonGrid",width:130,height:30,icon:"fa-bar-chart-o"}).setOnChanged(function(){s.send({type:"CreateDataItemPlot"},{query:f.theQuery.get(),tableid:f.tableInfo.id,subSamplingOptions:f.theQuery.getSubSamplingOptions()})});t.addControl(i.VerticalSeparator(15)),t.addControl(i.AlignCenter(i.CompoundVert([n,u,l]).setMargin(0))),f.theQuery.notifyQueryUpdated=f.onQueryModified,f.setIntroText()},f.onClose=function(){$.each(f.eventids,function(e,t){s.delListener(t)})},f.setIntroText=function(){var e="";e+=f.tableInfo.createIcon({floatLeft:!0}),e+="<b>{Names}</b><br>".DQXformat({Names:f.tableInfo.tableCapNamePlural}),e+=f.theQuery.createQueryDisplayStringHtml(),f.introText.modifyValue(e)},f.onQueryModified=function(){f.setIntroText(),f.myTable.setQuery(f.theQuery.getForFetching()),f.myTable.setTable(f.tableInfo.getQueryTableName(f.theQuery.isSubSampling())),f.myTable.reLoadTable()},f.store=function(){var e={};return e.tableid=f.tableInfo.id,e.query=f.theQuery.store(),e},f.recall=function(e){e.query&&f.theQuery.recall(e.query),e.settings},f.handleCreateLink=function(){var n=t.encode(JSON.stringify(f.store()));a.serverDataStore(w.serverUrl,n,function(t){a.customRequest(w.serverUrl,PnServerModule,"view_store",{database:w.database,workspaceid:w.workspaceid,id:t},function(n){e("Utils/IntroViews").createIntroView("itemtable",t,"-","Add table to start page")})})},f.create()},N.loadStoredTable=function(e,n){a.serverDataFetch(w.serverUrl,n,function(e){var n=JSON.parse(t.decode(e));N.show({tableid:n.tableid,serialisedquery:n.query})})},s.listen("",{type:"LoadStoredItemTable"},N.loadStoredTable),N}),define("Plots/StandardLayoutPlot",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Utils/ButtonChoiceBox","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E={};return E.Create=function(e,t,n,r,u,a){var l=m.getTableInfo(e);n.title=l.tableCapNamePlural+" ("+n.title+")";var c=y.Create(e,t,n,r,u,a),h=f.getNextUniqueID();return c.eventids.push(h),o.listen(h,{type:"SelectionUpdated"},function(e,t){c.tableInfo.id==t&&c.reDraw()}),c.createFrames=function(){var e=!1;a&&a.controlsCollapsed&&(e=!0),c.frameButtons=i.FrameFinal("",.3).setAllowScrollBars(!1,!0).setFixedSize(i.dimX,240);var t=i.FrameGroupVert("",.7).setMargins(0).setSeparatorSize(0);c.frameRoot.MakeControlsFrame(c.frameButtons,t,240,e),c.frameWarning=t.addMemberFrame(i.FrameFinal("",.01)).setMargins(0).setAutoSize().setAllowScrollBars(!1,!1),n.scrollHorizontal=!!n.scrollHorizontal,n.scrollVertical=!!n.scrollVertical,c.framePlot=t.addMemberFrame(i.FrameFinal("",.99)).setAllowScrollBars(n.scrollHorizontal,n.scrollVertical)},c.createPanels=function(){c.panelPlot=p(c.framePlot),c.panelButtons=i.Form(c.frameButtons).setPadding(0),c.createPanelPlot(),c.createPanelButtons(),this.panelWarning=i.Form(this.frameWarning),this.warningContent=s.Html("","","____"),this.panelWarning.addControl(this.warningContent),this.panelWarning.render()},c.setWarning=function(e){e?c.warningContent.modifyValue('<div style="color:red;padding:2px;background-color:yellow;border-bottom: 1px solid black">'+e+"</div>"):c.warningContent.modifyValue(""),c.panelWarning.render()},c.setAssistText=function(e){var t=c.panelPlot.getDivID();$("#"+t).find("#dqxassisttext").remove();if(e){var n='<div id="dqxassisttext" style="position:absolute;z-index: 999;top:0;padding:1px;color:#cf0000;background-color:rgba(255,255,0,0.5);width:100%"><b>'+e+"</b></div>";$("#"+t).append(n)}},c},E}),define("Plots/Histogram",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Plots/StandardLayoutPlot","Utils/ButtonChoiceBox","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S={};return S.typeID="histogram",S.name="Histogram",S.description="Takes a <b>numerical property</b>, and plots the number of {items} for a set of bins defined over this value.",S.isCompatible=function(e){return!0},S.plotAspects=[{id:"value",name:"Value",dataType:"Value",requiredLevel:2}],S.Create=function(e,t,n,i){var o=b.Create(e,S.typeID,{title:S.name},t,n,i);return o.fetchCount=0,o.showRelative=!1,o.barW=16,o.scaleW=100,o.textH=130,o.overlayValueList=[],i&&i.dataValues!=null&&$.each(i.dataValues,function(e,t){o.overlayValueList.push(t)}),o.createPanelPlot=function(){o.panelPlot.draw=o.draw,o.panelPlot.getToolTipInfo=o.getToolTipInfo,o.panelPlot.onMouseClick=o.onMouseClick,o.panelPlot.onSelected=o.onSelected,o.panelPlot.selectionHorOnly=!0},o.createPanelButtons=function(){var e=[{id:"",name:"-- None --"}];$.each(m.customProperties,function(t,n){var r=!1;n.tableid==o.tableInfo.id&&n.isFloat&&e.push({id:n.propid,name:n.name,group:n.group.Name})}),o.ctrlValueProperty=s.Combo(null,{label:"Value:<br>",states:e,value:o.providedAspect2Property("value")}).setClassID("value"),o.ctrlValueProperty.setOnChanged(function(){o.fetchData()}),o.ctrl_binsizeAutomatic=s.Check(null,{label:"Automatic",value:!0}).setClassID("binsizeautomatic").setOnChanged(function(){o.ctrl_binsizeValue.modifyEnabled(!o.ctrl_binsizeAutomatic.getValue()),o.ctrl_binsizeUpdate.modifyEnabled(!o.ctrl_binsizeAutomatic.getValue()),o.ctrl_binsizeAutomatic.getValue()&&o.fetchData()}),o.ctrl_binsizeValue=s.Edit(null,{size:12}).setClassID("binsizevalue").setOnChanged(function(){}),o.ctrl_binsizeValue.modifyEnabled(!1),o.ctrl_binsizeUpdate=s.Button(null,{content:"Update",buttonClass:"PnButtonGrid"}).setOnChanged(function(){o.fetchData()}),o.ctrl_binsizeUpdate.modifyEnabled(!1);var t=s.CompoundHor([s.CompoundVert([o.ctrl_binsizeAutomatic,o.ctrl_binsizeValue]).setAutoFillX(!1),s.HorizontalSeparator(10),o.ctrl_binsizeUpdate]);o.ctrl_Gamma=s.ValueSlider(null,{label:"Gamma correction",width:180,minval:.1,maxval:1,value:1,digits:2,scaleDistance:.2}).setClassID("gamma").setOnChanged(f.debounce(function(){o.reDraw()},10));var n=s.CompoundVert([o.createIntroControls(),s.Section(s.CompoundVert([o.ctrlValueProperty]).setMargin(10),{title:"Plot data",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([t]),{title:"Bin size",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([o.ctrl_Gamma]).setMargin(10),{title:"Layout",bodyStyleClass:"ControlsSectionBody"})]).setMargin(0);o.addPlotSettingsControl("controls",n),o.panelButtons.addControl(n),o.hasProvidedAspects()&&o.reloadAll()},o.setActiveQuery=function(e){o.theQuery.modify(e)},o.updateQuery=function(){o.fetchData()},o.reloadAll=function(){o.fetchData()},o.fetchData=function(){o.propidValue=o.ctrlValueProperty.getValue();if(o.staging)return;o.bucketCounts=null;if(!o.propidValue){o.reDraw();return}f.setProcessing(),o.ctrl_PointCount.modifyValue("--- data points");var e={};e.database=m.database,e.workspaceid=m.workspaceid,e.tableid=o.tableInfo.getQueryTableName(o.theQuery.isSubSampling()),e.propid=o.propidValue,e.maxrecordcount=o.tableInfo.settings.MaxCountQueryAggregated||1e6,e.qry=u.WhereClause.encode(o.theQuery.getForFetching()),o.ctrl_binsizeAutomatic.getValue()||(e.binsize=o.ctrl_binsizeValue.getValue()),f.customRequest(m.serverUrl,PnServerModule,"histogram",e,function(e){f.stopProcessing();if("Error"in e){alert(e.Error);return}"Warning"in e?o.setWarning(e.Warning):o.setWarning("");if(!e.hasdata){o.setWarning("No data in result set"),o.reDraw();return}var t=r.ValueListDecoder(),n=t.doDecode(e.buckets),i=t.doDecode(e.counts);o.bucketSize=e.binsize;var s=1e99,u=-1e99;$.each(n,function(e,t){t<s&&(s=t),t>u&&(u=t)}),o.bucketNrOffset=s,o.bucketCounts=[],o.maxCount=1;var a=0;for(var l=s;l<=u;l++)o.bucketCounts.push(0);for(var l=0;l<n.length;l++)a+=i[l],o.bucketCounts[n[l]-s]=i[l],o.maxCount<i[l]&&(o.maxCount=i[l]);o.ctrl_binsizeAutomatic.getValue()&&o.ctrl_binsizeValue.modifyValue(o.bucketSize),o.ctrl_PointCount.modifyValue(a+" data points"),o.reDraw()})},o.reloadAll=function(){o.fetchData()},o.reDraw=function(){o.panelPlot.invalidate()},o.draw=function(e){o.drawImpl(e)},o.drawImpl=function(e){o.plotPresent=!1;var t=e.ctx,n=40,r=40;t.fillStyle="rgb(220,220,220)",t.fillRect(0,0,n,e.sizeY),t.fillRect(0,e.sizeY-r,e.sizeX,r);if(!o.bucketCounts)return;var i=null;o.propidValue&&(i=m.findProperty(o.tableInfo.id,o.propidValue));var s=Math.pow(o.ctrl_Gamma.getValue(),2),u=o.bucketNrOffset*o.bucketSize,a=(o.bucketNrOffset+o.bucketCounts.length)*o.bucketSize,l=a-u;u-=.1*l,a+=.1*l;var c=0,h=o.maxCount*1.1,p=(e.sizeX-n)/(a-u),d=n-u*p,v=-(e.sizeY-r)/(h-c),g=e.sizeY-r-c*v;o.scaleX=p,o.offsetX=d,o.scaleY=v,o.offsetY=g;var y=function(e){return Math.pow(e/o.maxCount,s)*o.maxCount};t.save(),t.font="10px Arial",t.fillStyle="rgb(0,0,0)",t.textAlign="center";var b=E.createPropertyScale(o.tableInfo.id,o.propidValue,p,u,a);$.each(b,function(n,i){var s=Math.round(i.value*p+d)-.5;i.label?(t.fillText(i.label,s,e.sizeY-r+13),i.label2&&t.fillText(i.label2,s,e.sizeY-r+23),t.strokeStyle="rgb(190,190,190)"):t.strokeStyle="rgb(230,230,230)",t.beginPath(),t.moveTo(s,0),t.lineTo(s,e.sizeY-r),t.stroke()}),i&&(t.font="bold 12px Arial",t.fillText(i.name,e.sizeX/2,e.sizeY-12)),t.restore(),t.save(),t.font="10px Arial",t.fillStyle="rgb(0,0,0)",t.textAlign="center";var w=f.DrawUtil.getScaleJump(30/Math.abs(v)/y(.05*o.maxCount)*.05*o.maxCount),S=1e9;for(var x=Math.ceil(c/w.Jump1);x<=Math.floor(h/w.Jump1);x++){var T=x*w.Jump1,N=y(T),C=Math.round(N*v+g)-.5;t.strokeStyle="rgb(230,230,230)",x%w.JumpReduc==0&&(t.strokeStyle="rgb(190,190,190)"),t.beginPath(),t.moveTo(n,C),t.lineTo(e.sizeX,C),t.stroke();if(x%w.JumpReduc==0){t.save(),t.translate(n-5,C),t.rotate(-Math.PI/2);var k=w.value2String(T),L=t.measureText(k).width;C+L/2<S&&(t.fillText(k,0,0),S=C-(L/2+7)),t.restore()}}t.font="bold 12px Arial",t.save(),t.translate(17,e.sizeY/2),t.rotate(-Math.PI/2),t.fillText("Number of "+o.tableInfo.tableNamePlural,0,0),t.restore(),t.restore(),t.fillStyle="rgb(210,210,210)",t.strokeStyle="rgb(100,100,100)",$.each(o.bucketCounts,function(e,n){n=y(n);var r=(o.bucketNrOffset+e+0)*o.bucketSize,i=(o.bucketNrOffset+e+1)*o.bucketSize,s=Math.round(r*p+d)-.5,u=Math.round(i*p+d)-.5,a=Math.round(0*v+g)-.5,f=Math.round(n*v+g)-.5;t.beginPath(),t.moveTo(s,f),t.lineTo(s,a),t.lineTo(u,a),t.lineTo(u,f),t.closePath(),t.fill(),t.stroke()}),t.strokeStyle="rgb(255,0,0)",t.fillStyle="rgb(255,0,0)",t.font="bold 12px Arial",$.each(o.overlayValueList,function(n,s){var o=Math.round(s.value*p+d)-.5;t.beginPath(),t.moveTo(o,0),t.lineTo(o,e.sizeY-r),t.stroke(),t.fillText(s.name,o+2,12);if(i){var u=i.toDisplayString(s.value);t.fillText(u,o+2,28)}}),o.plotPresent=!0},o.getToolTipInfo=function(e,t){if(!o.plotPresent)return null;var n=null;return $.each(o.bucketCounts,function(t,r){var i=(o.bucketNrOffset+t+0)*o.bucketSize,s=(o.bucketNrOffset+t+1)*o.bucketSize,u=Math.round(i*o.scaleX+o.offsetX)-.5,a=Math.round(s*o.scaleX+o.offsetX)-.5,f=Math.round(0*o.scaleY+o.offsetY)-.5,l=Math.round(r*o.scaleY+o.offsetY)-.5;if(e>=u&&e<=a&&r>0){var c="";c+="Count: "+r,n={ID:"IDX"+t,px:(u+a)/2,py:l,showPointer:!0,content:c,count:r,minval:i,maxval:s}}}),n},o.onMouseClick=function(e,t){var n=o.getToolTipInfo(t.x,t.y);if(n){var r=u.WhereClause.createRangeRestriction(o.theQuery.get(),o.propidValue,n.minval,n.maxval),i="Number of items: "+n.count;i+="<br>Range: "+n.minval+" - "+n.maxval+"<br>",w.createPlotItemSelectionOptions(o,o.tableInfo,"Histogram bar",i,{query:r,subSamplingOptions:o.theQuery.getSubSamplingOptions()},null)}},o.onSelected=function(e,t,n,r,i,s,a){var f=(e-o.offsetX)/o.scaleX,l=(n-o.offsetX)/o.scaleX,c="Range: "+f+" - "+l+"<br>",h=u.WhereClause.createRangeRestriction(o.theQuery.get(),o.propidValue,f,l);w.createPlotItemSelectionOptions(o,o.tableInfo,"Histogram range",c,{query:h,subSamplingOptions:o.theQuery.getSubSamplingOptions()},null)},o.create(),o},S}),define("Plots/BarGraph",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","DQX/MessageBox","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Plots/StandardLayoutPlot","Utils/ButtonChoiceBox"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S={};return S.typeID="bargraph",S.name="Bar graph",S.description="Takes a <b>categorical property</b>, and plots the number of {items} for each state of this property. Optionally, a second categorical property can be used to overlay as a colour.",S.isCompatible=function(e){return!0},S.plotAspects=[{id:"groupby",name:"Group by",dataType:"Category",requiredLevel:2},{id:"secgroup",name:"Secondary group",dataType:"Category",requiredLevel:0}],S.Create=function(e,t,n,i){var o=w.Create(e,S.typeID,{title:S.name,scrollHorizontal:!0},t,n,i);return o.fetchCount=0,o.showRelative=!1,o.barW=14,o.scaleW=20,o.textH=170,o.createPanelPlot=function(){o.panelPlot=p(o.framePlot),o.panelPlot.draw=o.draw,o.panelPlot.getToolTipInfo=o.getToolTipInfo,o.panelPlot.onMouseClick=o.onMouseClick,o.panelPlot.onSelected=o.onSelected},o.createPanelButtons=function(){o.ctrl_PointCount=s.Html(null,"");var e=[{id:"",name:"-- None --"}];$.each(g.customProperties,function(t,n){var r=!1;n.tableid==o.tableInfo.id&&(n.datatype=="Text"||n.datatype=="Boolean")&&e.push({id:n.propid,name:n.name,group:n.group.Name})}),o.ctrlCatProperty1=s.Combo(null,{label:"Group by:<br>",states:e,value:o.providedAspect2Property("groupby")}).setClassID("groupby"),o.ctrlCatProperty1.setOnChanged(function(){o.fetchData()}),o.ctrlCatSort1=s.Combo(null,{label:"Sort by:<br>",states:[{id:"cat",name:"Category"},{id:"count",name:"Count"}]}).setClassID("sortby"),o.ctrlCatSort1.setOnChanged(function(){o.fetchData()}),o.ctrlCatProperty2=s.Combo(null,{label:"Secondary group:<br>",states:e,value:o.providedAspect2Property("secgroup")}).setClassID("secgroup"),o.ctrlCatProperty2.setOnChanged(function(){o.ctrlCatType.modifyEnabled(o.ctrlCatProperty2.getValue()!=""),o.fetchData()}),o.ctrlCatType=s.Check(null,{label:"Sum to 100%"}).setClassID("sumto100"),o.ctrlCatType.setOnChanged(function(){o.showRelative=o.ctrlCatType.getValue(),o.reDraw()}),o.ctrlCatType.modifyEnabled(!1),o.colorLegend=s.Html(null,"");var t=s.CompoundVert([o.createIntroControls(),s.Section(s.CompoundVert([o.ctrlCatProperty1,o.ctrlCatSort1,o.ctrlCatProperty2,o.ctrlCatType]).setMargin(10),{title:"Plot data",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([o.colorLegend]),{title:"Color legend",bodyStyleClass:"ControlsSectionBody"})]).setMargin(0);o.addPlotSettingsControl("controls",t),o.panelButtons.addControl(t),o.hasProvidedAspects()&&o.reloadAll()},o.reloadAll=function(){o.fetchData()},o.fetchData=function(){o.catpropid1=o.ctrlCatProperty1.getValue(),o.catpropid2=o.ctrlCatProperty2.getValue();if(!o.catpropid1)return;if(o.catpropid2&&o.catpropid2==o.catpropid1){o.maxcount=0,o.categories=[],o.reDraw(),v.errorBox("Error","Secondary category should be different from first");return}if(o.staging)return;f.setProcessing(),o.ctrl_PointCount.modifyValue("--- data points");var e={};e.database=g.database,e.workspaceid=g.workspaceid,e.tableid=o.tableInfo.getQueryTableName(o.theQuery.isSubSampling()),e.propid1=o.catpropid1,o.catpropid2&&(e.propid2=o.catpropid2),e.qry=u.WhereClause.encode(o.theQuery.getForFetching()),e.maxrecordcount=o.tableInfo.settings.MaxCountQueryAggregated||1e6,f.customRequest(g.serverUrl,PnServerModule,"categorycounts",e,function(e){f.stopProcessing();if("Error"in e){alert(e.Error);return}"Warning"in e?o.setWarning(e.Warning):o.setWarning(""),o.catpropid2?o.prepareData2Cat(e):o.prepareData1Cat(e),o.sortCats();var t=o.scaleW+o.categories.length*o.barW;o.panelPlot.setFixedWidth(t+20),o.reDraw()})},o.prepareData1Cat=function(e){var t=r.ValueListDecoder(),n=t.doDecode(e.categories1),i=t.doDecode(e.categorycounts);o.maxcount=0,o.categories=[];var s=0;$.each(i,function(e,t){o.categories.push({name:n[e],count:t}),o.maxcount=Math.max(o.maxcount,t),s+=t}),o.colorLegend.modifyValue(""),o.ctrl_PointCount.modifyValue(s+" data points")},o.prepareData2Cat=function(e){var t=g.findProperty(o.tableInfo.id,o.catpropid2),n=r.ValueListDecoder(),i=n.doDecode(e.categories1),s=n.doDecode(e.categories2),u=n.doDecode(e.categorycounts);o.categories=[];var a={},f={},l=[],c=0;$.each(u,function(e,t){c+=t;if(!(i[e]in a)){var n={name:i[e],count:0,subcats:[]};o.categories.push(n),a[n.name]=n}var n=a[i[e]];if(!(s[e]in f)){var r={name:s[e]};l.push(r.name),f[r.name]=r}n.count+=t,n.subcats.push({name:s[e],count:t})}),o.maxcount=0,$.each(o.categories,function(e,t){o.maxcount=Math.max(o.maxcount,t.count)});var h=[];$.each(l,function(e,n){h.push(t.toDisplayString(n))}),t.mapColors(h);var p="";$.each(l,function(e,n){p+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}<br>'.DQXformat({cl:t.mapSingleColor(t.toDisplayString(n)).toString(),name:t.toDisplayString(n)})}),o.colorLegend.modifyValue(p),o.ctrl_PointCount.modifyValue(c+" data points")},o.sortCats=function(){o.ctrlCatSort1.getValue()=="cat"?o.categories=_.sortBy(o.categories,function(e){return e.name}):o.categories=_.sortBy(o.categories,function(e){return-e.count})},o.reloadAll=function(){o.fetchData()},o.reDraw=function(){o.panelPlot.invalidate()},o.updateQuery=function(){o.fetchData()},o.draw=function(e){o.drawImpl(e)},o.drawImpl=function(e){var t=e.ctx;if(!o.categories)return;var n=g.findProperty(o.tableInfo.id,o.catpropid1);if(o.catpropid2)var r=g.findProperty(o.tableInfo.id,o.catpropid2);o.plotH=e.sizeY-o.textH-40,o.hoverItems=[];var i=0;$.each(o.categories,function(e,t){i+=t.count}),t.font="11px Arial",$.each(o.categories,function(s,u){var a=o.maxcount;o.showRelative&&o.catpropid2&&(a=u.count),a=Math.max(1,a),t.fillStyle="rgb(220,220,220)";var l=u.count*1/a*o.plotH,c=o.scaleW+s*o.barW+.5,h=o.scaleW+(s+1)*o.barW+.5,p=e.sizeY-o.textH+.5,d=e.sizeY-o.textH-Math.round(l)+.5;t.beginPath(),t.moveTo(c,d),t.lineTo(c,p),t.lineTo(h,p),t.lineTo(h,d),t.closePath(),t.fill(),t.stroke(),t.fillStyle="black",t.textAlign="right",t.textBaseline="middle",t.save(),t.translate((c+h)/2,p+5),t.rotate(-Math.PI/2);var v=u.name,m=2;while(t.measureText(v).width>o.textH-25&&m<v.length)m+=1,v=f.truncateString(v,v.length-m);t.fillText(n.toDisplayString(v),0,0),t.restore(),t.fillStyle="rgb(150,150,150)",t.textAlign="left",t.textBaseline="middle",t.save(),t.translate((c+h)/2,d-2),t.rotate(-Math.PI/2),t.fillText(u.count,0,0),t.restore();var g=n.name+": "+n.toDisplayString(u.name);g+="<br>Count: {ct} ({fr}%)".DQXformat({ct:u.count,fr:(u.count/i*100).toFixed(2)});var y={};y[o.catpropid1]=u.name,o.hoverItems.push({ID:"i"+f.getNextUniqueID(),px:(c+h)/2,py:(p+d)/2,content:g,px1:c,px2:h,py1:p+5,py2:d-5,selectors:y}),o.hoverItems.push({ID:"i"+f.getNextUniqueID(),px:(c+h)/2,py:p+o.textH/2,content:g,px1:c,px2:h,py1:p+o.textH,py2:p+1,selectors:y});if(o.catpropid2){var b=0;$.each(u.subcats,function(s,l){var p=b*1/a*o.plotH,d=(b+l.count)*1/a*o.plotH,v=e.sizeY-o.textH-Math.round(p)+.5,m=e.sizeY-o.textH-Math.round(d)+.5;t.fillStyle=r.mapSingleColor(r.toDisplayString(l.name)).toString(),t.beginPath(),t.moveTo(c,m),t.lineTo(c,v),t.lineTo(h,v),t.lineTo(h,m),t.closePath(),t.fill(),t.stroke(),b+=l.count;var g=n.name+": "+n.toDisplayString(u.name);g+="<br>"+r.name+": "+r.toDisplayString(l.name),g+="<br>Count: {ct} (of class: {fr1}%, of total: {fr2}%)".DQXformat({ct:l.count,fr1:(l.count/a*100).toFixed(2),fr2:(l.count/i*100).toFixed(2)});var y={};y[o.catpropid1]=u.name,y[o.catpropid2]=l.name,o.hoverItems.push({ID:"i"+f.getNextUniqueID(),px:(c+h)/2,py:(v+m)/2,content:g,px1:c,px2:h,py1:v,py2:m,selectors:y})})}}),o.plotPresent=!0},o.getToolTipInfo=function(e,t){if(!o.plotPresent)return;var n=null;$.each(o.hoverItems,function(r,i){e>=i.px1&&e<=i.px2&&t>=i.py2&&t<=i.py1&&(n=i)});if(n!=null){var r=$.extend({},n);return r.showPointer=!0,r}return null},o.onMouseClick=function(e,t){var n=o.getToolTipInfo(t.x,t.y);if(n){var r=u.WhereClause.AND([]);o.theQuery.get().isTrivial||r.addComponent(o.theQuery.get()),$.each(n.selectors,function(e,t){r.addComponent(u.WhereClause.CompareFixed(e,"=",t))});var i=n.content;E.createPlotItemSelectionOptions(o,o.tableInfo,"Bargraph bar",i,{query:r,subSamplingOptions:o.theQuery.getSubSamplingOptions()},null)}},o.create(),o},S}),define("InfoPopups/DataItemPlotPopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/MessageBox","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils","Plots/GenericPlot","Plots/Histogram","Plots/BarGraph"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){var k={};return k.promptAspects=!0,k.legacyPropertySelection=!1,k.init=function(){s.listen("",{type:"CreateDataItemPlot"},function(e,t){k.create(t)}),s.listen("",{type:"CreateDefaultPropertyPlot"},function(e,t){var n=null;t.query&&(n=t.query);var r=E.findProperty(t.tableid,t.propid);r.isFloat?N.Create(r.tableid,n,{aspects:{value:r.propid}},{dataValues:t.dataValues}):C.Create(r.tableid,n,{aspects:{groupby:r.propid}})})},k.create=function(e){var t=E.mapTableCatalog[e.tableid],n="";n+='<table class="PlotTypeTable" style="max-width: 500px;padding:5px" cellspacing="0" cellpadding="0">',$.each(T.getCompatiblePlotTypes(t),function(e,r){var i="PlotTypeChoice_"+r.typeID;n+='<tr id="createplot_{id}">'.DQXformat({id:i}),n+='<td class="DQXLarge"><div style="padding:13px">'+r.name+"</div></td>",n+='<td><div style="padding:13px">'+r.description.DQXformat({item:t.tableNameSingle,items:t.tableNamePlural})+"</div></td>",n+="</tr>"}),n+="</div>",n+="</table>";var r=i.Check(null,{label:'<span style="color:rgb(80,80,80)"><i>Prompt for plot data before showing plot</i></span>',value:k.promptAspects});n+=r.renderHtml();var s=p.create(t.tableCapNamePlural+" plots",n);$.each(T.getCompatiblePlotTypes(t),function(n,i){var o="PlotTypeChoice_"+i.typeID;$("#createplot_"+o).click(function(){k.promptAspects=r.getValue(),p.closeIfNeeded(s),k.promptAspects?k.legacyPropertySelection?k.createAspectSelector(i,e):k.createPropertySelector(i,e):i.Create(t.id,e.query,{subSamplingOptions:e.subSamplingOptions})})})},k.isCompatibleProperty=function(e,t){if(!e)return!0;if(e==t.datatype)return!0;if(e=="Value")return t.isFloat;if(e=="Category"){if(t.isText)return!0;if(t.isBoolean)return!0}return!1},k.createPropertySelector=function(e,t){var n=E.mapTableCatalog[t.tableid],r=[];$.each(e.plotAspects,function(e,t){var s=[{id:"",name:""}];$.each(n.propertyGroups,function(e,n){$.each(n.properties,function(e,n){k.isCompatibleProperty(t.dataType,n)&&s.push({id:n.propid,name:n.name,group:n.group.Name})})});var o=i.Combo(null,{label:"",states:s,width:130});r.push({aspectInfo:t,ctrl:o,required:t.requiredLevel==2})});var s="",o=i.CompoundVert([]).setMargin(0);s+=o.renderHtml()+"<p>",groupList=i.CompoundGrid().setSeparation(4,2);var u=0;$.each(r,function(e,t){groupList.setItem(u,0,i.Static(t.aspectInfo.name+":")),groupList.setItem(u,1,t.ctrl),groupList.setItem(u,0,i.Static(t.aspectInfo.name+":")),groupList.setItem(u,2,i.Static(t.required?"":'<i><span style="color:rgb(128,128,128)">(optional)</span></i>')),u++}),o.addControl(groupList),s+=o.renderHtml();var a=i.Button(null,{content:"<b>Create plot</b>",buttonClass:"PnButtonLarge",width:120,height:40,icon:"fa-bar-chart-o"});a.setOnChanged(function(){var i={};$.each(r,function(e,t){t.ctrl.getValue()&&(i[t.aspectInfo.id]=t.ctrl.getValue())});var s=[];$.each(e.plotAspects,function(e,t){t.requiredLevel==2&&!i[t.id]&&s.push(t.name)});if(s.length>0){var o="Please associate the following plot aspect(s) to data properties:<br><b>"+s.join(", ")+"</b>";$("#plotaspectserrorbox").html(o);return}p.closeIfNeeded(f),e.Create(n.id,t.query,{subSamplingOptions:t.subSamplingOptions,aspects:i})}),s+="<p>"+a.renderHtml()+"<p>",s+='<div id="plotaspectserrorbox" style="color: red"></div>';var f=p.create(e.name+" aspects",s);o.postCreateHtml()},k.createAspectSelector=function(e,t){var n="",r=i.CompoundVert([]).setMargin(0),s=[],o=[];$.each(e.plotAspects,function(e,t){t.requiredLevel==2?s.push('"'+t.name+'"'):o.push('"'+t.name+'"')});var u="<b>Select {lst}:</b>".DQXformat({lst:s.join(", ")});o.length>0&&(u+="<br>(Optional: {lst})".DQXformat({lst:o.join(", ")}));var a=i.Html(null,u),f=E.mapTableCatalog[t.tableid],l=[];$.each(f.propertyGroups,function(t,n){var s=null,o=null,u=0;$.each(n.properties,function(t,a){var f=null;if(a.settings.showInTable){states=[{id:"",name:""}],$.each(e.plotAspects,function(e,t){k.isCompatibleProperty(t.dataType,a)&&states.push({id:t.id,name:t.name+" :"})});if(states.length>1){o||(o=i.CompoundGrid().setSeparation(4,0),s=i.Section(o,{title:n.Name,headerStyleClass:"DQXControlSectionHeader",bodyStyleClass:"ControlsSectionBodySubSection"}),r.addControl(s));var c=i.Combo(null,{label:"",states:states,width:130});c.setOnChanged(function(){$.each(l,function(e,t){t.propInfo.propid!=a.propid&&t.cmb.getValue()==c.getValue()&&t.cmb.modifyValue("")})}),l.push({cmb:c,propInfo:a}),o.setItem(u,0,c),o.setItem(u,1,i.Static('<span title="{title}">{name}</span> <span style="color:rgb(170,170,170)">({datatype})</span>'.DQXformat({name:a.name,title:a.settings.Description||"",datatype:a.dispDataType}))),u+=1}}})}),n+=a.renderHtml()+"<br>",n+='<div style="background-color:white; border:1px solid rgb(100,190,200); min-width: 450px; max-height:450px; overflow-y:auto">',n+=r.renderHtml()+"</div><p>";var c=i.Button(null,{content:"<b>Create plot</b>",buttonClass:"PnButtonLarge",width:120,height:40,icon:"fa-bar-chart-o"});c.setOnChanged(function(){var n={};$.each(l,function(e,t){t.cmb.getValue()&&(n[t.cmb.getValue()]=t.propInfo.propid)});var r=[];$.each(e.plotAspects,function(e,t){t.requiredLevel==2&&!n[t.id]&&r.push(t.name)});if(r.length>0){alert("Please associate the following plot aspect(s) to data properties: \n\n"+r.join(", "));return}p.closeIfNeeded(h),e.Create(f.id,t.query,{subSamplingOptions:t.subSamplingOptions,aspects:n})}),n+=c.renderHtml()+"<p>";var h=p.create(e.name+" aspects",n);r.postCreateHtml()},k}),define("InfoPopups/PropInfoPopup",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y.init=function(){s.listen("",{type:"PropInfoPopup"},function(e,t){y.show(t)})},y.show=function(e){var t=g.mapTableCatalog[e.tableid],n=g.findProperty(e.tableid,e.propid),r="<p>";n.settings.Description&&(r+='<div style="max-width: 450px">'+n.settings.Description+"</div><p>"),e.buttons&&e.buttons.length>0&&($.each(e.buttons,function(e,t){var n=t.onChanged;t.setOnChanged(function(){n(),l.closeIfNeeded(c)}),r+=t.renderHtml()}),r+="<br>");if(!t.settings.DisablePlots){var u=!1;t.currentQuery&&(t.currentQuery.isTrivial||(u=!0));var a="Create plot";u&&(a+="<br>(current query)");var f=i.Button(null,{buttonClass:"DQXToolButton2",content:a,width:120,height:40,icon:"fa-bar-chart-o"}).setOnChanged(function(){s.send({type:"CreateDefaultPropertyPlot"},{tableid:n.tableid,propid:n.propid,query:e.query,dataValues:e.dataValues}),l.closeIfNeeded(c)});r+=f.renderHtml();if(u){var f=i.Button(null,{buttonClass:"DQXToolButton2",content:"Create plot<br>(all data)",width:120,height:40,icon:"fa-bar-chart-o"}).setOnChanged(function(){s.send({type:"CreateDefaultPropertyPlot"},{tableid:n.tableid,propid:n.propid,query:o.WhereClause.Trivial(),dataValues:e.dataValues}),l.closeIfNeeded(c)});r+=f.renderHtml()}}var c=l.create(n.name,r)},y}),define("Wizards/PromptWorkspace",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/ServerIO","DQX/Wizard","DQX/Popup","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b={};return b.init=function(){},b.execute=function(e){b.proceedFunction=e;var t=m.ServerDataGetter();t.addTable("workspaces",["id","name"],"name"),t.execute(y.serverUrl,y.database,function(){b.workspaces=t.getTableRecords("workspaces"),y.workspaceid="",a.getUrlSearchString("workspace")&&(y.workspaceid=a.getUrlSearchString("workspace")),b.workspaces.length==0&&alert("ERROR: this dataset does not contain any workspace"),b.workspaces.length==1&&(y.workspaceid=b.workspaces[0].id),y.workspaceid?n.getChannelInfo(e):b.execute2()})},b.execute2=function(){var e=l.Create("SelectWorkSpace",{title:"Panoptes - Select workspace",sizeX:450,sizeY:400,canCancel:!1,noBackground:!0});b.ctrl_workspacelist=i.List(null,{width:400,height:250});var t=[];$.each(b.workspaces,function(e,n){t.push({id:n.id,content:n.name})}),b.ctrl_workspacelist.setItems(t,t.length>0?t[0].id:null),b.ctrl_workspacelist.setOnDoubleClick(function(){e.performFinish()});var r=i.CompoundVert([b.ctrl_workspacelist]);e.addPage({id:"page1",form:r,reportValidationError:function(){if(!b.ctrl_workspacelist.getValue())return"Please select a workspace"}}),e.run(function(){y.workspaceid=e.getResultValue(b.ctrl_workspacelist.getID()),n.getChannelInfo(b.proceedFunction)})},b.reload=function(e){var t=m.ServerDataGetter();t.addTable("workspaces",["id","name"],"name"),t.execute(y.serverUrl,y.database,function(){b.workspaces=t.getTableRecords("workspaces");var n=[];$.each(b.workspaces,function(e,t){n.push({id:t.id,content:t.name})});var r=e;r||(r=n.length>0?n[0].id:null),b.ctrl_workspacelist.setItems(n,r)})},b}),define("Wizards/PromptDataSet",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y={};return y.init=function(){},y.execute=function(e){y.proceedFunction=e,a.setProcessing(),a.customRequest(g.serverUrl,PnServerModule,"getdatasetlist",{},function(e){a.stopProcessing(),y.datasets=e.datasets,a.getUrlSearchString("dataset")?(g.database=a.getUrlSearchString("dataset"),y.proceedFunction()):y.datasets.length==1?(g.database=y.datasets[0].id,y.proceedFunction()):y.execute2()})},y.execute2=function(){var e=f.Create("SelectDataSet",{title:"Panoptes - Select dataset",sizeX:450,sizeY:400,canCancel:!1,noBackground:!0});y.ctrl_datasetlist=i.List(null,{width:400,height:210});var t=[];$.each(y.datasets,function(e,n){t.push({id:n.id,content:n.name})}),y.ctrl_datasetlist.setItems(t,t.length>0?t[0].id:null),y.ctrl_datasetlist.setOnDoubleClick(function(){e.performFinish()});var n=i.Hyperlink(null,{content:"Open admin page"}).setOnChanged(function(){var e=window.location.hostname,t=window.location.pathname,n=window.location.protocol,r="{protocol}//{hostname}{pathname}".DQXformat({protocol:n,hostname:e,pathname:t});window.open("admin.html")}),r=i.Hyperlink(null,{content:"Documentation"}).setOnChanged(function(){window.open("http://panoptes.readthedocs.org/en/latest/")}),s=i.CompoundVert([y.ctrl_datasetlist,n,r]);e.addPage({id:"page1",form:s,reportValidationError:function(){if(!y.ctrl_datasetlist.getValue())return"Please select a dataset"}}),e.run(function(){g.database=e.getResultValue(y.ctrl_datasetlist.getID()),y.proceedFunction()})},y}),define("Wizards/FindNote",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/QueryTable","DQX/Map","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/ChannelPlot/GenomePlotter","DQX/ChannelPlot/ChannelYVals","DQX/ChannelPlot/ChannelPositions","DQX/ChannelPlot/ChannelSequence","DQX/DataFetcher/DataFetchers","DQX/DataFetcher/DataFetcherSummary","MetaData","Utils/GetFullDataItemInfo","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x={};return x.execute=function(){var e=p.PopupFrame("FindNote",{title:"Find note",blocking:!1,sizeX:700,sizeY:500});e.maxcount=50,e.eventids=[];var t=a.getNextUniqueID();e.eventids.push(t),s.listen(t,{type:"SelectionUpdated"},function(t,n){e.tableInfo.id==n&&e.myTable&&e.myTable.render()}),e.createFrames=function(){e.frameRoot.makeGroupVert(),e.frameButtons=e.frameRoot.addMemberFrame(r.FrameFinal("",.3)).setFixedSize(r.dimY,120).setFrameClassClient("DQXGrayClient").setMargins(5),e.frameBody=e.frameRoot.addMemberFrame(r.FrameFinal("",.7))},e.updateQuery=function(){a.customRequest(w.serverUrl,PnServerModule,"note_search",{database:w.database,workspaceid:w.workspaceid,maxcount:parseInt(e.maxcount+1),searchtext:e.ctrl_searchString.getValue(),tableid:e.ctrl_searchIn.getValue(),sortby:e.ctrl_sortBy.getValue()},function(t){a.stopProcessing();var n="";for(var r=0;r<t.notes_id.length;r++){n+='<div class="PnItemNoteSearchResult" id="{id}">'.DQXformat({id:"note__"+r});var i=w.mapTableCatalog[t.notes_tableid[r]];n+='<div style="position: absolute">'+i.createIcon({floatLeft:!1})+"</div>",n+='<div style="margin-left: 80px;vertical-align: top;">',n+='<div class="PnItemHeaderText" style="position:absolute;right:10px;top:4px">'+t.notes_timestamp[r]+" ",n+=t.notes_userid[r]+"</div>",n+='<div style="padding-bottom:7px;color:rgb(0,122,132)">{itemname}: <b>{itemid}</b></div>'.DQXformat({itemname:i.tableCapNameSingle,itemid:t.notes_itemid[r]});var o=t.notes_content[r];o=o.replace(/(?:\r\n|\r|\n)/g,"<br />"),n+=o,n+="</div>",n+="</div>"}t.notes_id.length==0?(e.ctrl_comment.modifyValue(""),e.ctrl_searchString.getValue()?n="The search string did not match any notes in the data set":n='There are currently no notes present. You can add a note to a data item by clicking on the "Notes" tab in a data item popup window',n='<div class="SupportingText" style="padding: 20px">'+n+"</div>"):t.notes_id.length>e.maxcount?e.ctrl_comment.modifyValue("Showing the first {count} notes found".DQXformat({count:e.maxcount})):e.ctrl_comment.modifyValue("{count} notes found".DQXformat({count:t.notes_id.length})),e.frameBody.setContentHtml(n);var u=$("#"+e.frameBody.getClientDivID());u.find(".PnItemNoteSearchResult").click(function(e){e.preventDefault(),e.stopPropagation();var n=parseInt($(this).attr("id").split("__")[1]);s.send({type:"ItemPopup"},{tableid:t.notes_tableid[n],itemid:t.notes_itemid[n]})})})},e.createPanels=function(){e.ctrl_searchString=i.Edit(null,{size:25,value:""}).setOnChanged(a.debounce(e.updateQuery,200)).setHasDefaultFocus(),e.ctrl_sortBy=i.Combo(null,{label:"",value:"date",states:[{id:"date",name:"Most recent first"},{id:"score",name:"Most relevant first"}]}).setOnChanged(e.updateQuery);var t=[{id:"_all_",name:"All data items"}];$.each(w.tableCatalog,function(e,n){n.settings.DisableNotes||t.push({id:n.id,name:n.tableCapNamePlural})}),e.ctrl_searchIn=i.Combo(null,{label:"",value:"_all_",states:t}).setOnChanged(function(){e.checkShowQueryButton(),e.updateQuery()}),e.panelButtons=r.Form(e.frameButtons);var n=i.CompoundGrid();n.setItem(0,0,i.Static("<b>Search for:</b>")),n.setItem(0,1,e.ctrl_searchString),n.setItem(1,0,i.Static("<b>Sort by:</b>")),n.setItem(1,1,e.ctrl_sortBy),n.setItem(0,2,i.Static("<b>Search in:</b>")),n.setItem(0,3,e.ctrl_searchIn);var s=i.Button(null,{buttonClass:"DQXToolButton2",content:"Show as query"});e.showQuery=i.ShowHide(s),e.showQuery.setVisible(!1),s.setOnChanged(e.createQuery),n.setItem(0,4,e.showQuery),e.panelButtons.addControl(n),e.ctrl_comment=i.Html(null,"","PnItemNoteSearchComment"),e.panelButtons.addControl(e.ctrl_comment),e.updateQuery()},e.checkShowQueryButton=function(){var t=e.ctrl_searchIn.getValue();e.showQuery.setVisible(t!="_all_")},e.createQuery=function(){var t=e.ctrl_searchIn.getValue(),n=w.mapTableCatalog[t],r=n.createNoteWhereclause(e.ctrl_searchString.getValue());s.send({type:"DataItemTablePopup"},{tableid:n.id,query:r,subSamplingOptions:null,title:n.tableCapNamePlural})},e.onClose=function(){$.each(e.eventids,function(e,t){s.delListener(t)})},e.create()},x}),define("Plots/Histogram2D",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Plots/StandardLayoutPlot","Utils/ButtonChoiceBox","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){function T(e,t){t<0&&(t=0),t>1&&(t=1);if(e=="Gray (inverted)")return f.Color(t,t,t);if(e=="Rainbow 1"){var n=f.HSL2Color(.5-t*.75,1,.5);return n}if(e=="Rainbow 2"){var n=f.HSL2Color(.5-t*.75,1,.5);return t<.2&&(n=n.lighten(1-t/.2)),n}return e=="Heath"?(t>0&&(t=(t+.07)/.93),f.Color(1-Math.pow(Math.max(t-.66,0)/(1-.66),2),1-Math.pow(Math.max(t-.33,0)/(1-.33),.8),1-Math.pow(t,.6))):f.Color(1-t,1-t,1-t)}var S={};S.typeID="histogram2d",S.name="2D Histogram",S.description="Takes <b>two numerical properties</b>, bins the values, and plots the number of {items} in each cell as a colour density.",S.isCompatible=function(e){return!0},S.plotAspects=[{id:"xvalue",name:"X value",dataType:"Value",requiredLevel:2},{id:"yvalue",name:"Y value",dataType:"Value",requiredLevel:2}];var x=["Gray","Gray (inverted)","Rainbow 1","Rainbow 2","Heath"];return S.Create=function(e,t,n,i){var a=b.Create(e,S.typeID,{title:S.name},t,n,i);a.fetchCount=0,a.showRelative=!1,a.barW=16,a.scaleW=100,a.textH=130;var l=f.getNextUniqueID();return a.eventids.push(l),o.listen(l,{type:"SelectionUpdated"},function(e,t){a.tableInfo.id==t&&a.reDraw()}),a.createPanelPlot=function(){a.panelPlot=p(a.framePlot),a.panelPlot.draw=a.draw,a.panelPlot.getToolTipInfo=a.getToolTipInfo,a.panelPlot.onMouseClick=a.onMouseClick,a.panelPlot.onSelected=a.onSelected},a.createPanelButtons=function(){a.ctrl_PointCount=s.Html(null,"");var e=[{id:"",name:"-- None --"}];$.each(m.customProperties,function(t,n){var r=!1;n.tableid==a.tableInfo.id&&n.isFloat&&e.push({id:n.propid,name:n.name,group:n.group.Name})}),a.ctrlValueXProperty=s.Combo(null,{label:"X Value:<br>",states:e,value:a.providedAspect2Property("xvalue")}).setClassID("xvalue"),a.ctrlValueXProperty.setOnChanged(function(){a.fetchData()}),a.ctrlValueYProperty=s.Combo(null,{label:"Y Value:<br>",states:e,value:a.providedAspect2Property("yvalue")}).setClassID("yvalue"),a.ctrlValueYProperty.setOnChanged(function(){a.fetchData()}),a.ctrl_binsizeAutomatic=s.Check(null,{label:"Automatic",value:!0}).setClassID("autobinsize").setOnChanged(function(){a.ctrl_binsizeValueX.modifyEnabled(!a.ctrl_binsizeAutomatic.getValue()),a.ctrl_binsizeValueY.modifyEnabled(!a.ctrl_binsizeAutomatic.getValue()),a.ctrl_binsizeUpdate.modifyEnabled(!a.ctrl_binsizeAutomatic.getValue()),a.ctrl_binsizeAutomatic.getValue()&&a.fetchData()}),a.ctrl_binsizeValueX=s.Edit(null,{size:10,label:"X:"}).setClassID("binsizex").modifyEnabled(!1),a.ctrl_binsizeValueY=s.Edit(null,{size:10,label:"Y:"}).setClassID("binsizey").modifyEnabled(!1),a.ctrl_binsizeUpdate=s.Button(null,{content:"Update",buttonClass:"PnButtonGrid"}).setOnChanged(function(){a.fetchData()}),a.ctrl_binsizeUpdate.modifyEnabled(!1);var t=s.CompoundVert([a.ctrl_binsizeAutomatic,s.CompoundHor([s.CompoundVert([a.ctrl_binsizeValueX,a.ctrl_binsizeValueY]).setTreatAsBlock(!0),s.HorizontalSeparator(5),a.ctrl_binsizeUpdate])]),n=[];$.each(x,function(e,t){n.push({id:t,name:t})}),a.ctrlPalette=s.Combo(null,{label:"Colors",states:n,value:"Heath"}).setClassID("color").setOnChanged(function(){a.reDraw()}),a.ctrl_Gamma=s.ValueSlider(null,{label:"Gamma correction",width:180,minval:.1,maxval:1,value:.75,digits:2,scaleDistance:.2}).setNotifyOnFinished().setClassID("gamma").setOnChanged(function(){a.reDraw()});var r=s.Button(null,{icon:"fa-crosshairs",content:"Select points...",buttonClass:"PnButtonGrid",width:80,height:30}).setOnChanged(function(){var e=[];e.push({content:"Half plane selection",bitmap:"Bitmaps/circle_red_small.png",handler:function(){a.panelPlot.startHalfPlaneSelection(function(e,t){e.x=(e.x-a.offsetX)/a.scaleX,e.y=(e.y-a.offsetY)/a.scaleY,t.x=t.x/a.scaleX,t.y=t.y/a.scaleY;var n=E.createHalfPlaneRestrictionQuery(a.theQuery.get(),a.propidValueX,a.propidValueY,e,t);w.createPlotItemSelectionOptions(a,a.tableInfo,"Half plane","",{query:n.query,subSamplingOptions:a.theQuery.getSubSamplingOptions()},null)})}}),w.create("Select points","",[e])}),i=s.CompoundVert([a.createIntroControls(),s.AlignCenter(s.CompoundHor([r,s.HorizontalSeparator(95)])),s.VerticalSeparator(20),s.Section(s.CompoundVert([a.ctrlValueXProperty,a.ctrlValueYProperty]).setMargin(10),{title:"Plot data",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([t]),{title:"Bin size",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([a.ctrlPalette,a.ctrl_Gamma,r]).setMargin(10),{title:"Layout",bodyStyleClass:"ControlsSectionBody"})]).setMargin(0);a.addPlotSettingsControl("controls",i),a.panelButtons.addControl(i),a.hasProvidedAspects()&&a.reloadAll()},a.setActiveQuery=function(e){a.theQuery.modify(e)},a.updateQuery=function(){a.fetchData()},a.reloadAll=function(){a.fetchData()},a.fetchData=function(){a.propidValueX=a.ctrlValueXProperty.getValue(),a.propidValueY=a.ctrlValueYProperty.getValue();if(a.staging)return;a.bucketDens=null;if(!a.propidValueX||!a.propidValueY){a.reDraw();return}f.setProcessing(),a.ctrl_PointCount.modifyValue("--- data points");var e={};e.database=m.database,e.workspaceid=m.workspaceid,e.propidx=a.propidValueX,e.propidy=a.propidValueY,e.tableid=a.tableInfo.getQueryTableName(a.theQuery.isSubSampling()),e.maxrecordcount=a.tableInfo.settings.MaxCountQueryAggregated||1e6,e.qry=u.WhereClause.encode(a.theQuery.getForFetching()),a.ctrl_binsizeAutomatic.getValue()||(e.binsizex=a.ctrl_binsizeValueX.getValue(),e.binsizey=a.ctrl_binsizeValueY.getValue()),f.customRequest(m.serverUrl,PnServerModule,"histogram2d",e,function(e){f.stopProcessing();if("Error"in e){alert(e.Error);return}if(!e.hasdata){a.setWarning("No data in result set"),a.reDraw();return}"Warning"in e?a.setWarning(e.Warning):a.setWarning("");var t=r.ValueListDecoder(),n=t.doDecode(e.bucketsx),i=t.doDecode(e.bucketsy),s=t.doDecode(e.densities);a.bucketSizeX=e.binsizex,a.bucketSizeY=e.binsizey;var o=Math.min.apply(Math,n),u=Math.max.apply(Math,n),l=Math.min.apply(Math,i),c=Math.max.apply(Math,i);a.bucketNrOffsetX=o,a.bucketCountX=u-o+1,a.bucketNrOffsetY=l,a.bucketCountY=c-l+1,a.bucketDens=[];for(var h=0;h<a.bucketCountX;h++){var p=[];for(var d=0;d<a.bucketCountY;d++)p.push(0);a.bucketDens.push(p)}a.maxDens=1;var v=0;for(var h=0;h<s.length;h++)a.bucketDens[n[h]-o][i[h]-l]=s[h],a.maxDens=Math.max(a.maxDens,s[h]),v+=s[h];a.ctrl_binsizeAutomatic.getValue()&&(a.ctrl_binsizeValueX.modifyValue(a.bucketSizeX),a.ctrl_binsizeValueY.modifyValue(a.bucketSizeY)),a.panelPlot.setDirectDedraw(a.bucketCountX*a.bucketCountY<2e3),a.reDraw(),a.ctrl_PointCount.modifyValue(v+" data points")})},a.reloadAll=function(){a.fetchData()},a.reDraw=function(){a.panelPlot.invalidate()},a.draw=function(e){a.drawImpl(e)},a.drawImpl=function(e){a.plotPresent=!1;var t=e.ctx,n=a.ctrlPalette.getValue(),r=40,i=40;t.fillStyle="rgb(220,220,220)",t.fillRect(0,0,r,e.sizeY),t.fillRect(0,e.sizeY-i,e.sizeX,i);if(!a.bucketDens)return;var s=a.bucketNrOffsetX*a.bucketSizeX,o=(a.bucketNrOffsetX+a.bucketCountX)*a.bucketSizeX,u=o-s;s-=.02*u,o+=.02*u;var f=a.bucketNrOffsetY*a.bucketSizeY,l=(a.bucketNrOffsetY+a.bucketCountY)*a.bucketSizeY,c=l-f;f-=.02*c,l+=.02*c;var h=(e.sizeX-r)/(o-s),p=r-s*h,d=-(e.sizeY-i)/(l-f),v=e.sizeY-i-f*d;a.scaleX=h,a.offsetX=p,a.scaleY=d,a.offsetY=v;var g=Math.pow(a.ctrl_Gamma.getValue(),2);for(var y=0;y<a.bucketCountX;y++){var b=(a.bucketNrOffsetX+y+0)*a.bucketSizeX,w=(a.bucketNrOffsetX+y+1)*a.bucketSizeX,S=Math.round(b*h+p),x=Math.round(w*h+p);for(var N=0;N<a.bucketCountY;N++){var C=(a.bucketNrOffsetY+N+0)*a.bucketSizeY,k=(a.bucketNrOffsetY+N+1)*a.bucketSizeY,L=Math.round(C*d+v),A=Math.round(k*d+v),O=a.bucketDens[y][N]*1/a.maxDens;O=Math.pow(O,g);var M=T(n,O);t.fillStyle=M.toString(),t.fillRect(S,A,x-S,L-A)}}t.save(),t.font="10px Arial",t.fillStyle="rgb(0,0,0)",t.textAlign="center";var _=E.createPropertyScale(a.tableInfo.id,a.propidValueX,h,s,o);$.each(_,function(n,r){var s=Math.round(r.value*h+p)-.5;r.label?(t.fillText(r.label,s,e.sizeY-i+13),r.label2&&t.fillText(r.label2,s,e.sizeY-i+23),t.strokeStyle="rgba(0,0,0,0.25)"):t.strokeStyle="rgba(128,128,128,0.15)",t.beginPath(),t.moveTo(s,0),t.lineTo(s,e.sizeY-i),t.stroke()}),a.propidValueX&&(t.font="bold 11px Arial",t.fillText(m.findProperty(a.tableInfo.id,a.propidValueX).name,e.sizeX/2,e.sizeY-12)),t.restore(),t.font="10px Arial",t.fillStyle="rgb(0,0,0)",t.textAlign="center",t.save();var _=E.createPropertyScale(a.tableInfo.id,a.propidValueY,Math.abs(d),f,l);$.each(_,function(n,i){var s=Math.round(i.value*d+v)-.5;i.label?(t.save(),t.translate(r-5,s),t.rotate(-Math.PI/2),i.label2?(t.fillText(i.label,0,-10),t.fillText(i.label2,0,0)):t.fillText(i.label,0,0),t.restore(),t.strokeStyle="rgba(0,0,0,0.25)"):t.strokeStyle="rgba(128,128,128,0.15)",t.beginPath(),t.moveTo(r,s),t.lineTo(e.sizeX,s),t.stroke()}),a.propidValueY&&(t.font="bold 11px Arial",t.save(),t.translate(17,e.sizeY/2),t.rotate(-Math.PI/2),t.fillText(m.findProperty(a.tableInfo.id,a.propidValueY).name,0,0),t.restore()),t.restore(),a.plotPresent=!0},a.getToolTipInfo=function(e,t){if(!a.plotPresent)return;var n=Math.floor((e-a.offsetX)/a.scaleX/a.bucketSizeX)-a.bucketNrOffsetX,r=Math.floor((t-a.offsetY)/a.scaleY/a.bucketSizeY)-a.bucketNrOffsetY;if(n>=0&&n<a.bucketCountX&&r>=0&&r<a.bucketCountY&&a.bucketDens[n][r]>0){var i="";return i+="Count: "+a.bucketDens[n][r],{ID:"IDX"+n+"_"+r,px:(n+.5+a.bucketNrOffsetX)*a.bucketSizeX*a.scaleX+a.offsetX,py:(r+.5+a.bucketNrOffsetY)*a.bucketSizeY*a.scaleY+a.offsetY,showPointer:!0,count:a.bucketDens[n][r],minvalX:(n+0+a.bucketNrOffsetX)*a.bucketSizeX,maxvalX:(n+1+a.bucketNrOffsetX)*a.bucketSizeX,minvalY:(r+0+a.bucketNrOffsetY)*a.bucketSizeY,maxvalY:(r+1+a.bucketNrOffsetY)*a.bucketSizeY,content:i}}return null},a.onMouseClick=function(e,t){var n=a.getToolTipInfo(t.x,t.y);if(n){var r=a.theQuery.get();r=u.WhereClause.createRangeRestriction(r,a.propidValueX,n.minvalX,n.maxvalX),r=u.WhereClause.createRangeRestriction(r,a.propidValueY,n.minvalY,n.maxvalY);var i="X Range: "+n.minvalX+" - "+n.maxvalX+"<br>";i+="Y Range: "+n.minvalY+" - "+n.maxvalY+"<br>",i+="Number of items: "+n.count,w.createPlotItemSelectionOptions(a,a.tableInfo,"Histogram range",i,{query:r,subSamplingOptions:a.theQuery.getSubSamplingOptions()},null)}},a.onSelected=function(e,t,n,r,i,s,o){var f=(e-a.offsetX)/a.scaleX,l=(n-a.offsetX)/a.scaleX,c=(r-a.offsetY)/a.scaleY,h=(t-a.offsetY)/a.scaleY,p=a.theQuery.get();p=u.WhereClause.createRangeRestriction(p,a.propidValueX,f,l),p=u.WhereClause.createRangeRestriction(p,a.propidValueY,c,h);var d="X Range: "+f+" - "+l+"<br>";d+="Y Range: "+c+" - "+h+"<br>",w.createPlotItemSelectionOptions(a,a.tableInfo,"Histogram range",d,{query:p,subSamplingOptions:a.theQuery.getSubSamplingOptions()},null)},a.create(),a},S}),define("DQX/FrameCanvasXYPlot",["jquery","DQX/Utils","DQX/DocEl","DQX/Msg","DQX/FrameCanvas"],function(e,t,n,r,i){var s=function(e){var t={};return e&&(t.minVal=e.minVal,t.maxVal=e.maxVal,t.range=e.range,t.offset=e.offset),t.setRange=function(e,n){t.minVal=e,t.maxVal=n,t.range=t.maxVal-t.minVal,t.offset=t.minVal,t.isZoomed=!1},t.getRange=function(){return t.range},t.getOffset=function(){return t.offset},t.getMinVisibleRange=function(){return t.offset},t.getMaxVisibleRange=function(){return t.offset+t.range},t.toFraction=function(e){return(e-t.offset)/t.range},t.getViewPortFraction=function(){return{mn:(t.offset-t.minVal)/(t.maxVal-t.minVal),mx:(t.offset+t.range-t.minVal)/(t.maxVal-t.minVal)}},t.clipRange=function(){t.range>t.maxVal-t.minVal&&(t.range=t.maxVal-t.minVal);var e=0*t.range+t.offset;e<t.minVal&&(t.offset=t.minVal);var n=1*t.range+t.offset;n>t.maxVal&&(t.offset=t.maxVal-t.range)},t.zoom=function(e,n){var r=n*t.range+t.offset;t.range/=e,t.offset=(r/t.range-n)*t.range,t.clipRange(),e>1&&(t.isZoomed=!0)},t.panFraction=function(e){t.offset+=e*t.range,t.clipRange()},t.store=function(){var e={};return t.isZoomed?(e.range=t.range,e.offset=t.offset):e.default=!0,e},t.recall=function(e){e.default||(t.range=e.range,t.offset=e.offset,t.isZoomed=!0)},t};return function(n){var r=i(n);return r.scaleMarginX=37,r.scaleMarginY=37,r._dragActionPan=!0,r.xScaler=s(),r.yScaler=s(),r.setXRange=function(e,t){r.xScaler.setRange(e,t)},r.setYRange=function(e,t){r.yScaler.setRange(e,t)},r.getXScale=function(){return 1/r.xScaler.getRange()*(r.drawSizeX-r.scaleMarginX)},r.getXOffset=function(){return r.scaleMarginX-r.xScaler.getOffset()*r.getXScale()},r.getYScale=function(){return-1/r.yScaler.getRange()*(r.drawSizeY-r.scaleMarginY)},r.getYOffset=function(){return r.drawSizeY-r.scaleMarginY-r.yScaler.getOffset()*r.getYScale()},r.draw=function(e){r.drawSizeX=e.sizeX,r.drawSizeY=e.sizeY,r.drawCenter(e),r.drawScale(e)},r.drawScale=function(e){r.drawSizeX=e.sizeX,r.drawSizeY=e.sizeY;var t=e.ctx;t.fillStyle="rgb(220,220,220)",t.fillRect(0,0,r.scaleMarginX,e.sizeY),t.fillRect(0,e.sizeY-r.scaleMarginY,e.sizeX,r.scaleMarginY),r.drawXScale&&r.drawXScale(e),r.drawYScale&&r.drawYScale(e),t.fillStyle="rgba(0,0,0,0.2)";var n=r.xScaler.getViewPortFraction(),i=e.sizeX-r.scaleMarginX;t.fillRect(r.scaleMarginX+n.mn*i,e.sizeY-5,(n.mx-n.mn)*i,5);var n=r.yScaler.getViewPortFraction(),s=e.sizeY-r.scaleMarginY;t.fillRect(0,(1-n.mx)*s,5,(n.mx-n.mn)*s)},r.renderScale=function(){var e=r.getMyCanvasElement("main").getContext("2d");e.fillStyle="#FFFFFF";var t={ctx:e,sizeX:r._cnvWidth,sizeY:r._cnvHeight,scaleBorderOnly:!0};r.drawScale(t)},r.finishZoomPan=function(){r.zoompanProcessing&&(r.zoompanProcessing=!1,r.render())},r.ThrottledFinishZoomPan=t.debounce(r.finishZoomPan,250),r._setNewScalers=function(e,t){if(r._directRedraw)r.xScaler=e,r.yScaler=t,r.render();else{var n=r.getMyCanvasElement("main"),i=n.getContext("2d");r.zoompanProcessing||(r.zoompanProcessing=!0,r.zoompanImage=new Image,r.zoompanImage.id="tempzoompic",r.zoompanImage.src=n.toDataURL(),r.origXScaler=s(r.xScaler),r.origYScaler=s(r.yScaler)),r.xScaler=e,r.yScaler=t,r.zoompanProcessing||(r.zoompanProcessing=!0,r.zoompanImage=new Image,r.zoompanImage.id="tempzoompic",r.zoompanImage.src=n.toDataURL()),i.fillStyle="rgb(240,240,240)",i.fillRect(0,0,r._cnvWidth,r._cnvHeight);var o=r.xScaler.toFraction(r.origXScaler.getMinVisibleRange()),u=r.xScaler.toFraction(r.origXScaler.getMaxVisibleRange()),a=r.yScaler.toFraction(r.origYScaler.getMinVisibleRange()),f=r.yScaler.toFraction(r.origYScaler.getMaxVisibleRange()),l=r.zoompanImage.width-r.scaleMarginX,c=r.zoompanImage.height-r.scaleMarginY;i.drawImage(r.zoompanImage,r.scaleMarginX,0,l,c,r.scaleMarginX+l*o,c*(1-f),l*(u-o),c*(f-a)),r.renderScale(),r.ThrottledFinishZoomPan()}},r._handleMouseWheel=function(e){var n=t.getMouseWheelDelta(e);if(n!=0){if(n<0)var i=1/(1+.4*Math.abs(n));else var i=1+.4*Math.abs(n);var s=r.getEventPosX(e),o=r.getEventPosY(e);return r._handleZoom(i,s,o),e.returnValue=!1,!1}},r._handleZoom=function(e,t,n){var i=(t-r.scaleMarginX)*1/(r.drawSizeX-r.scaleMarginX),o=(r.drawSizeY-r.scaleMarginY-n)/(r.drawSizeY-r.scaleMarginY),u=s(r.xScaler);u.zoom(e,i);var a=s(r.yScaler);a.zoom(e,o),r._setNewScalers(u,a)},r.panningStart=function(e,t){r._panning_x0=e,r._panning_y0=t,r.origXScaler=s(r.xScaler),r.origYScaler=s(r.yScaler)},r.panningDo=function(e,t){var n=r.drawSizeX-r.scaleMarginX,i=r.drawSizeY-r.scaleMarginY,o=s(r.xScaler);o.panFraction(-(e-r._panning_x0)/n);var u=s(r.yScaler);u.panFraction((t-r._panning_y0)/i),r._panning_x0=e,r._panning_y0=t,r._setNewScalers(o,u)},r.panningStop=function(){r.finishZoomPan()},r.handleTouchStart=function(e,t){r.panningStart(e.elemX,e.elemY)},r.handleTouchMove=function(e,t){r.panningDo(e.elemX,e.elemY)},r.handleTouchEnd=function(e){r.panningStop()},r.handleTouchCancel=function(e){r.panningStop()},r.handleTouchClick=function(e,t){r.onMouseClick&&r.onMouseClick(t,e)},r.handleGestureStart=function(e){r.previousScale=1,r.scaleCenterPosX=r.getEventPosX(e),r.scaleCenterPosY=r.getEventPosY(e)},r.handleGestureChange=function(e){e.scale&&(r._handleZoom(e.scale/r.previousScale,r.scaleCenterPosX,r.scaleCenterPosY),r.previousScale=e.scale)},r.handleGestureEnd=function(e){r.finishZoomPan()},e("#"+r.clickLayerId).bind("DOMMouseScroll mousewheel",r._handleMouseWheel),t.augmentTouchEvents(r,r.clickLayerId,!0,!0),r}}),define("Plots/ItemScatterPlot",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvasXYPlot","DQX/DataFetcher/DataFetchers","DQX/MessageBox","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Plots/StandardLayoutPlot","Utils/ButtonChoiceBox","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S={};return S.typeID="scatterplot",S.name="Scatter plot",S.description="Takes <b>two numerical properties</b> and plot the {items} as points on a X-Y chart. Optionally, the colour and size of the points can be controlled by other properties.",S.isCompatible=function(e){return!0},S.plotAspects=[{id:"xaxis",name:"X value",dataType:"Value",requiredLevel:2},{id:"yaxis",name:"Y value",dataType:"Value",requiredLevel:2},{id:"color",name:"Point color",dataType:"",requiredLevel:0},{id:"size",name:"Point size",dataType:"Value",requiredLevel:0},{id:"style",name:"Point style",dataType:"Text",requiredLevel:0},{id:"label",name:"Hover label",dataType:"",requiredLevel:0}],S.PointStyles=[{id:"circle",name:"Circle",drawer:function(e,t,n,r){e.beginPath(),e.arc(t,n,r,0,2*Math.PI,!1),e.closePath()}},{id:"triangle",name:"Triangle",drawer:function(e,t,n,r){r*=1.25,e.beginPath(),e.moveTo(t-.866*r,n+.5*r),e.lineTo(t,n-r),e.lineTo(t+.866*r,n+.5*r),e.closePath()}},{id:"rectangle",name:"Rectangle",drawer:function(e,t,n,r){r*=.85,e.beginPath(),e.moveTo(t-r,n-r),e.lineTo(t-r,n+r),e.lineTo(t+r,n+r),e.lineTo(t+r,n-r),e.closePath()}},{id:"diamond",name:"Diamond",drawer:function(e,t,n,r){r*=1.1,e.beginPath(),e.moveTo(t,n-r),e.lineTo(t+r,n),e.lineTo(t,n+r),e.lineTo(t-r,n),e.closePath()}},{id:"",name:"",drawer:function(e,t,n,r){e.beginPath(),e.arc(t,n,.3*r,0,2*Math.PI,!1),e.closePath()}}],S.Create=function(e,t,n,r){var u=b.Create(e,S.typeID,{title:S.name},t,n,r);u.fetchCount=0,u.propDataMap={},u.maxrecordcount=u.tableInfo.settings.MaxCountQueryRecords||2e5,u.plotAspects=[{id:"id",name:"ID",datatype:"Text",propid:u.tableInfo.primkey,data:null,visible:!1,required:!0},{id:"xaxis",name:"X axis",datatype:"Value",propid:null,data:null,visible:!0,required:!0},{id:"yaxis",name:"Y axis",datatype:"Value",propid:null,data:null,visible:!0,required:!0},{id:"color",name:"Point color",datatype:"",propid:null,visible:!0,data:null},{id:"size",name:"Point size",datatype:"Value",propid:null,visible:!0,data:null},{id:"style",name:"Point style",datatype:"Category",propid:null,visible:!0,data:null},{id:"label",name:"Hover label",datatype:"",propid:null,visible:!0,data:null}],u.mapPlotAspects={},$.each(u.plotAspects,function(e,t){u.mapPlotAspects[t.id]=t}),u.createPanelPlot=function(){u.panelPlot=h(u.framePlot),u.panelPlot.drawXScale=u.drawXScale,u.panelPlot.drawYScale=u.drawYScale,u.panelPlot.drawCenter=u.drawCenter,u.panelPlot.getToolTipInfo=u.getToolTipInfo,u.panelPlot.onMouseClick=u.onMouseClick,u.panelPlot.onSelected=u.onSelected};var f=function(){return u.pointSelectingMode?(d.errorBox("Error","Points are already being selected"),!1):!0};return u.createPanelButtons=function(){var e=i.Button(null,{icon:"fa-crosshairs",content:"Select points...",buttonClass:"PnButtonGrid",width:80,height:30}).setOnChanged(function(){if(!f())return;var e=[];e.push({content:"Rectangle selection",bitmap:"Bitmaps/circle_red_small.png",handler:function(){if(!f())return;u.pointSelectingMode=!0,u.setAssistText("Click two times on the plot to define the selection bounding box"),u.panelPlot.startRectangleSelection(function(e,t){u.pointSelectingMode=!1,u.setAssistText("");var n=(Math.min(e.x,t.x)-u.offsetX)/u.scaleX,r=(Math.max(e.x,t.x)-u.offsetX)/u.scaleX,i=(Math.max(e.y,t.y)-u.offsetY)/u.scaleY,s=(Math.min(e.y,t.y)-u.offsetY)/u.scaleY,a=u.theQuery.get();a=o.WhereClause.createRangeRestriction(a,u.mapPlotAspects.xaxis.propid,n,r),a=o.WhereClause.createRangeRestriction(a,u.mapPlotAspects.yaxis.propid,i,s);var f="X Range: "+n+" - "+r+"<br>";f+="Y Range: "+i+" - "+s+"<br>";if(!u.plotPresent)return;var l=u.mapPlotAspects.id.data,c=u.mapPlotAspects.xaxis,h=u.mapPlotAspects.yaxis,p=c.data,d=h.data,v=function(){var e=[];for(var t=0;t<p.length;t++)p[t]!=null&&d[t]!=null&&p[t]>=n&&p[t]<=r&&d[t]>i&&d[t]<=s&&e.push(l[t]);return e};w.createPlotItemSelectionOptions(u,u.tableInfo,"Rectangular area",f,{query:a,subSamplingOptions:u.theQuery.getSubSamplingOptions()},v)})}}),e.push({content:"Lasso selection",bitmap:"Bitmaps/circle_red_small.png",handler:function(){if(!f())return;u.pointSelectingMode=!0,u.setAssistText("Click points on the plot to select the area. Double-click to finalise the selection"),u.panelPlot.startLassoSelection(function(e){function t(e,t){for(var n=!1,r=-1,i=e.length,s=i-1;++r<i;s=r)(e[r].y<=t.y&&t.y<e[s].y||e[s].y<=t.y&&t.y<e[r].y)&&t.x<(e[s].x-e[r].x)*(t.y-e[r].y)/(e[s].y-e[r].y)+e[r].x&&(n=!n);return n}u.pointSelectingMode=!1,u.setAssistText("");var n=[];$.each(e,function(e,t){n.push({x:(t.x-u.offsetX)/u.scaleX,y:(t.y-u.offsetY)/u.scaleY})});var r=E.createPolygonRestrictionQuery(u.theQuery.get(),u.mapPlotAspects.xaxis.propid,u.mapPlotAspects.yaxis.propid,n);if(!u.plotPresent)return;scaleX=u.scaleX,offsetX=u.offsetX,scaleY=u.scaleY,offsetY=u.offsetY;var i=u.mapPlotAspects.id.data,s=u.mapPlotAspects.xaxis,o=u.mapPlotAspects.yaxis,a=s.data,f=o.data,l=[];for(var c=0;c<a.length;c++)if(a[c]!=null&&f[c]!=null){var h=a[c]*scaleX+offsetX,p=f[c]*scaleY+offsetY;t(e,{x:h,y:p})&&l.push(i[c])}var d=function(){return l},v="",m=null;r.query&&(m={query:r.query,subSamplingOptions:u.theQuery.getSubSamplingOptions()}),w.createPlotItemSelectionOptions(u,u.tableInfo,"Scatterplot area",v,m,d)})}}),e.push({content:"Half plane selection",bitmap:"Bitmaps/circle_red_small.png",handler:function(){if(!f())return;u.pointSelectingMode=!0,u.setAssistText("Click two times on the plot to define the boundary line for the selection"),u.panelPlot.startHalfPlaneSelection(function(e,t){u.pointSelectingMode=!1,u.setAssistText(""),e.x=(e.x-u.offsetX)/u.scaleX,e.y=(e.y-u.offsetY)/u.scaleY,t.x=t.x/u.scaleX,t.y=t.y/u.scaleY;var n=E.createHalfPlaneRestrictionQuery(u.theQuery.get(),u.mapPlotAspects.xaxis.propid,u.mapPlotAspects.yaxis.propid,e,t),r=function(){var e=u.mapPlotAspects.xaxis.data,t=u.mapPlotAspects.yaxis.data,r=u.mapPlotAspects.id.data,i=n.selector,s=[];if(i)for(var o=0;o<e.length;o++)e[o]!=null&&t[o]!=null&&i(e[o],t[o])&&s.push(r[o]);return s};w.createPlotItemSelectionOptions(u,u.tableInfo,"Half plane","",{query:n.query,subSamplingOptions:u.theQuery.getSubSamplingOptions()},r)})}}),w.create("Select points","",[e])});u.ctrl_PointCount=i.Html(null,"");var t=i.CompoundVert([]).setMargin(10);$.each(u.plotAspects,function(e,n){if(n.visible){var r=[{id:"",name:"-- None --"}];$.each(m.customProperties,function(e,t){var i=!1;if(t.tableid==u.tableInfo.id){if(t.datatype==n.datatype||!n.datatype)i=!0;n.datatype=="Value"&&t.isFloat&&(i=!0),n.datatype=="Category"&&(t.datatype=="Text"||t.isBoolean)&&(i=!0)}i&&r.push({id:t.propid,name:t.name,group:t.group.Name})}),n.picker=i.Combo(null,{label:n.name+":<br>",states:r,value:u.providedAspect2Property(n.id)}).setClassID(n.id).setOnChanged(function(){u.fetchData(n.id)}),n.propid=u.providedAspect2Property(n.id),t.addControl(n.picker)}}),u.ctrl_SizeFactor=i.ValueSlider(null,{label:"Size factor",width:180,minval:0,maxval:2,value:1,digits:2}).setNotifyOnFinished().setClassID("sizefactor").setOnChanged(function(){u.reDraw()}),u.ctrl_Opacity=i.ValueSlider(null,{label:"Opacity",width:180,minval:0,maxval:1,value:1,digits:2}).setNotifyOnFinished().setClassID("opacity").setOnChanged(function(){u.reDraw()}),u.ctrl_Outline=i.Check(null,{label:"Outline",value:!1}).setClassID("outline").setOnChanged(function(){u.reDraw()}),u.colorLegend=i.Html(null,""),u.styleLegend=i.Html(null,"");var n=i.CompoundVert([u.createIntroControls(),i.AlignCenter(i.CompoundHor([e,i.HorizontalSeparator(95)])),i.VerticalSeparator(20),i.Section(t,{title:"Plot data",bodyStyleClass:"ControlsSectionBody"}),i.Section(i.CompoundVert([u.ctrl_SizeFactor,u.ctrl_Opacity,u.ctrl_Outline]).setMargin(10),{title:"Layout",bodyStyleClass:"ControlsSectionBody"}),i.Section(i.CompoundVert([u.colorLegend,u.styleLegend]),{title:"Legend",bodyStyleClass:"ControlsSectionBody"})]).setMargin(0);u.addPlotSettingsControl("controls",n),u.panelButtons.addControl(n),u.hasProvidedAspects()&&u.reloadAll()},u.setActiveQuery=function(e){u.theQuery.modify(e)},u.updateQuery=function(){u.reloadAll()},u.reloadAll=function(){u.propDataMap={},$.each(u.plotAspects,function(e,t){t.propid&&u.fetchData(t.id)})},u.reDraw=function(){u.panelPlot.invalidate()},u.fetchData=function(e){var t=u.mapPlotAspects[e];t.data=null,t.visible&&(t.propid=t.picker.getValue());if(u.staging)return;e=="xaxis"&&(u.mapPlotAspects.id.data||setTimeout(function(){u.fetchData("id")},150));if(t.propid){var n=m.findProperty(u.tableInfo.id,t.propid);if(u.propDataMap[t.propid])t.data=u.propDataMap[t.propid],u.processAspectData(e),u.panelPlot.invalidate();else{u.ctrl_PointCount.modifyValue("--- data points");var r=p.RecordsetFetcher(m.serverUrl,m.database,u.tableInfo.getQueryTableName(u.theQuery.isSubSampling()));r.setMaxResultCount(u.maxrecordcount);var i="ST";n.isFloat&&(i="F3",n.datatype=="HighPrecisionValue"&&(i="FH")),n.isInt&&(i="IN"),n.isBoolean&&(i="GN"),r.addColumn(t.propid,i),u.panelPlot.invalidate();var s=a.getNextUniqueID();t.requestID=s,u.fetchCount+=1;var o=u.tableInfo.primkey;u.theQuery.isSubSampling()&&(o="RandPrimKey"),r.getData(u.theQuery.getForFetching(),o,function(n){u.fetchCount-=1;if(t.requestID!=s){u.panelPlot.invalidate();return}t.data=n[t.propid],u.ctrl_PointCount.modifyValue(t.data.length+" data points"),u.propDataMap[t.propid]=t.data,u.processAspectData(e),u.panelPlot.invalidate(),t.data.length>=u.maxrecordcount?u.setWarning("Number of points truncated to "+u.maxrecordcount):u.setWarning("")},function(e){u.fetchCount-=1})}}else u.processAspectData(e),u.panelPlot.invalidate()},u.processAspectData=function(e){var t=u.mapPlotAspects[e];if(t.propid)var n=m.findProperty(u.tableInfo.id,t.propid);var r=t.data;if(t.datatype=="Value"&&r){var i=1e99,s=-1e99;for(var o=0;o<r.length;o++)r[o]!=null&&(i>r[o]&&(i=r[o]),s<r[o]&&(s=r[o]));t.minval=i,t.maxval=s;var a=t.maxval-t.minval;a<=0&&(a=1),t.maxval+=a/20,t.minval-=a/20,t.safeRange=t.maxval-t.minval}e=="xaxis"&&u.panelPlot.setXRange(t.minval,t.minval+t.safeRange),e=="yaxis"&&u.panelPlot.setYRange(t.minval,t.minval+t.safeRange);if(t.datatype=="Category"&&r)for(var o=0;o<r.length;o++)r[o]=n.toDisplayString(r[o]);if(e=="id"){var f=[];for(var o=0;o<r.length;o++)f.push(o);u.sortIndex=f,u.panelPlot.setDirectDedraw(r.length<1e4)}if(e=="size"&&r){var l=[];for(o=0;o<r.length;o++)l.push(o);u.sortIndex=_.sortBy(l,function(e,t){return-r[t]})}if(e=="style"){var c="";if(r){var n=m.findProperty(u.tableInfo.id,t.propid);c+="<b>"+n.name+"</b><br>",u.styleMapper={};var h=0;$.each(r,function(e,t){u.styleMapper[t]||(h<S.PointStyles.length?(u.styleMapper[t]=S.PointStyles[h],h++,u.styleMapper[t].name&&(c+=u.styleMapper[t].name+": "+t+"<br>")):u.styleMapper[t]=S.PointStyles[S.PointStyles.length-1])})}u.styleLegend.modifyValue(c)}if(e=="color"){t.catData=null;var c="";if(r){var n=m.findProperty(u.tableInfo.id,t.propid);c+="<b>"+n.name+"</b><br>";var p=n.mapColors(r);t.catData=p.indices,u.mappedColors=p.colors,$.each(p.legend,function(e,t){c+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}<br>'.DQXformat({cl:t.color.toString(),name:t.state})})}u.colorLegend.modifyValue(c)}},u.drawXScale=function(e){var t=u.mapPlotAspects.xaxis;if(!t.propid||!t.data)return;var n=e.ctx,r=u.panelPlot.getXScale(),i=u.panelPlot.getXOffset(),s=u.panelPlot.xScaler.getMinVisibleRange(),o=u.panelPlot.xScaler.getMaxVisibleRange();n.save(),n.font="10px Arial",n.fillStyle="rgb(0,0,0)",n.textAlign="center";var a=E.createPropertyScale(u.tableInfo.id,t.propid,r,t.minval,t.maxval);$.each(a,function(t,a){if(a.value>=s&&a.value<=o){var f=Math.round(a.value*r+i)-.5;a.label?(n.fillText(a.label,f,e.sizeY-u.panelPlot.scaleMarginY+13),a.label2&&n.fillText(a.label2,f,e.sizeY-u.panelPlot.scaleMarginY+23),n.strokeStyle="rgba(0,0,0,0.2)"):n.strokeStyle="rgba(0,0,0,0.1)",e.scaleBorderOnly||(n.beginPath(),n.moveTo(f,0),n.lineTo(f,e.sizeY-u.panelPlot.scaleMarginY),n.stroke())}});var f=u.mapPlotAspects.xaxis.propid;f&&(n.font="bold 11px Arial",n.fillText(m.findProperty(u.tableInfo.id,f).name,e.sizeX/2,e.sizeY-12)),n.restore()},u.drawYScale=function(e){var t=u.mapPlotAspects.yaxis;if(!t.propid||!t.data)return;var n=e.ctx,r=u.panelPlot.getYScale(),i=u.panelPlot.getYOffset(),s=u.panelPlot.yScaler.getMinVisibleRange(),o=u.panelPlot.yScaler.getMaxVisibleRange();n.save(),n.font="10px Arial",n.fillStyle="rgb(0,0,0)",n.textAlign="center";var a=E.createPropertyScale(u.tableInfo.id,t.propid,Math.abs(r),t.minval,t.maxval);$.each(a,function(t,a){if(a.value>=s&&a.value<=o){var f=Math.round(a.value*r+i)-.5;a.label?(n.save(),n.translate(u.panelPlot.scaleMarginX-5,f),n.rotate(-Math.PI/2),a.label2?(n.fillText(a.label,0,-10),n.fillText(a.label2,0,0)):n.fillText(a.label,0,0),n.restore(),n.strokeStyle="rgba(0,0,0,0.2)"):n.strokeStyle="rgba(0,0,0,0.1)",e.scaleBorderOnly||(n.beginPath(),n.moveTo(u.panelPlot.scaleMarginX,f),n.lineTo(e.sizeX,f),n.stroke())}});var f=u.mapPlotAspects.yaxis.propid;f&&(n.font="bold 11px Arial",n.save(),n.translate(17,e.sizeY/2),n.rotate(-Math.PI/2),n.fillText(m.findProperty(u.tableInfo.id,f).name,0,0),n.restore()),n.restore()},u.drawCenter=function(e){u.plotPresent=!1;var t=e.ctx;t.fillStyle="#FFFFFF",t.fillRect(0,0,e.sizeX,e.sizeY);if(u.fetchCount>0){t.font="20px Arial",t.textAlign="left",t.fillStyle="rgb(140,140,140)",t.fillText("Fetching data ... "+u.fetchCount,110,50);return}var n=[];$.each(u.plotAspects,function(e,t){t.required&&!t.data&&n.push(t.name)});if(n.length>0){t.font="italic 14px Arial",t.fillStyle="rgb(0,0,0)",t.fillText("Please provide data for "+n.join(", "),50,50);return}var r=u.mapPlotAspects.id.data,i=u.mapPlotAspects.xaxis,s=u.mapPlotAspects.yaxis,o=i.data,f=s.data,l=u.mapPlotAspects.color.catData,c=u.mapPlotAspects.size.data,h=u.mapPlotAspects.style.data,p=u.panelPlot.getXScale(),d=u.panelPlot.getXOffset(),v=u.panelPlot.getYScale(),m=u.panelPlot.getYOffset();u.scaleX=p,u.offsetX=d,u.scaleY=v,u.offsetY=m;var g=u.panelPlot.xScaler.getMinVisibleRange(),y=u.panelPlot.xScaler.getMaxVisibleRange(),b=u.panelPlot.yScaler.getMinVisibleRange(),w=u.panelPlot.yScaler.getMaxVisibleRange(),E=u.ctrl_SizeFactor.getValue(),S=u.ctrl_Opacity.getValue(),x=u.ctrl_Outline.getValue();if(l){var T=[];$.each(u.mappedColors,function(e,t){T.push(t.changeOpacity(S).toStringCanvas())})}t.fillStyle=t.strokeStyle=a.Color(0,0,0).changeOpacity(S).toStringCanvas();var N=u.tableInfo.currentSelection,C=[],k=[],L=!c&&!h&&E<.05,A=u.sortIndex,O=o.length;if(L)for(var M=0;M<O;M++){var _=A[M],D=o[_],P=f[_];if(D!=null&&P!=null&&D>=g&&D<=y&&P>=b&&P<=w){var H=Math.round(D*p+d),B=Math.round(P*v+m);l&&(t.strokeStyle=T[l[_]]),N[r[_]]&&(C.push(H),k.push(B)),t.beginPath(),t.moveTo(H-2,B-.5),t.lineTo(H+1,B-.5),t.moveTo(H-.5,B-2),t.lineTo(H-.5,B+1),t.stroke()}}if(!L&&!c){var j=2*E;for(var M=0;M<O;M++){var _=A[M],D=o[_],P=f[_];if(D!=null&&P!=null&&D>=g&&D<=y&&P>=b&&P<=w){var H=D*p+d,B=P*v+m;l&&(t.fillStyle=t.strokeStyle=T[l[_]]),N[r[_]]&&(C.push(H),k.push(B));if(!h||!u.styleMapper)t.beginPath(),t.arc(H,B,j,0,2*Math.PI,!1),t.closePath(),x?t.stroke():t.fill();else{var F=u.styleMapper[h[_]];F&&(F.drawer(t,H,B,j*3),x?t.stroke():t.fill())}}}}l?(t.fillStyle=a.Color(0,0,0,0*(.5+.5*S)).toStringCanvas(),t.strokeStyle=a.Color(0,0,0,1*(.5+.5*S)).toStringCanvas()):(t.fillStyle=a.Color(1,0,0,.25*(.5+.5*S)).toStringCanvas(),t.strokeStyle=a.Color(1,0,0,.75*(.5+.5*S)).toStringCanvas());for(var M=0;M<C.length;M++)t.beginPath(),t.arc(C[M],k[M],2*E+2,0,2*Math.PI,!1),t.closePath(),x||t.fill(),t.stroke();if(c){t.fillStyle=a.Color(.8,.8,.8,S).toStringCanvas(),t.strokeStyle=a.Color(.5,.5,.5,S).toStringCanvas();var I=u.mapPlotAspects.size.minval,q=u.mapPlotAspects.size.maxval;for(var M=0;M<O;M++){var _=A[M];if(o[_]!=null&&f[_]!=null){var H=o[_]*p+d,B=f[_]*v+m,R=Math.max(.1,((c[_]-I)/(q-I)*10+2)*E);l&&(t.fillStyle=T[l[_]]),h?(u.styleMapper[h[_]].drawer(t,H,B,R),x||t.fill(),t.stroke()):(t.beginPath(),t.arc(H,B,R,0,2*Math.PI,!1),t.closePath(),x||t.fill(),t.stroke())}}}u.plotPresent=!0},u.storeCustomSettings=function(){},u.recallCustomSettings=function(e){},u.getToolTipInfo=function(e,t){if(!u.plotPresent)return;scaleX=u.scaleX,offsetX=u.offsetX,scaleY=u.scaleY,offsetY=u.offsetY;var n=u.mapPlotAspects.id.data,r=u.mapPlotAspects.xaxis,i=u.mapPlotAspects.yaxis,s=r.data,o=i.data,a=10,f=-1;for(var l=0;l<s.length;l++)if(s[l]!=null&&o[l]!=null){var c=s[l]*scaleX+offsetX,h=o[l]*scaleY+offsetY,p=Math.abs(c-e)+Math.abs(h-t);p<=a&&(a=p,f=l)}if(f<0)return null;var d="";return $.each(u.plotAspects,function(e,t){if(t.data){var n=m.findProperty(u.tableInfo.id,t.propid);d.length>0&&(d+="<br>"),t.id=="label"&&(d+="<b>"),d+=n.name+": "+n.toDisplayString(t.data[f]),t.id=="label"&&(d+="</b>")}}),{itemid:n[f],ID:"IDX"+f,px:s[f]*scaleX+offsetX,py:o[f]*scaleY+offsetY,showPointer:!0,content:d}},u.onMouseClick=function(e,t){var n=u.getToolTipInfo(t.x,t.y);n&&s.send({type:"ItemPopup"},{tableid:u.tableInfo.id,itemid:n.itemid})},u.onSelected=function(e,t,n,r,i,s,a){if(!u.plotPresent)return;var f=u.mapPlotAspects.id.data,l=u.mapPlotAspects.xaxis,c=u.mapPlotAspects.yaxis,h=l.data,p=c.data,d=(e-u.offsetX)/u.scaleX,v=(n-u.offsetX)/u.scaleX,m=(r-u.offsetY)/u.scaleY,g=(t-u.offsetY)/u.scaleY,y=u.theQuery.get();y=o.WhereClause.createRangeRestriction(y,l.propid,d,v),y=o.WhereClause.createRangeRestriction(y,c.propid,m,g);var b="X Range: "+d+" - "+v+"<br>";b+="Y Range: "+m+" - "+g+"<br>";var E=function(){var i=[];for(var s=0;s<h.length;s++)if(h[s]!=null&&p[s]!=null){var o=h[s]*scaleX+offsetX,u=p[s]*scaleY+offsetY;o>=e&&o<=n&&u>t&&u<=r&&i.push(f[s])}return i};w.createPlotItemSelectionOptions(u,u.tableInfo,"Scatter plot area",b,{query:y,subSamplingOptions:u.theQuery.getSubSamplingOptions()},E)},u.create(),u},S}),define("Plots/MultiCategoryHistogram",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvas","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Plots/StandardLayoutPlot","Utils/ButtonChoiceBox","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S={};return S.typeID="MultiCategoryHistogram",S.name="Multiple category histograms",S.description="Takes a <b>numerical property</b> and a <b>categorical property</b>, and plots a separate histogram for each state of the categorical property.",S.isCompatible=function(e){return!0},S.plotAspects=[{id:"value",name:"Value",dataType:"Value",requiredLevel:2},{id:"groupby",name:"Group by",dataType:"Category",requiredLevel:2}],S.Create=function(e,t,n,i){var o=b.Create(e,S.typeID,{title:S.name,scrollVertical:!0},t,n,i);return o.fetchCount=0,o.showRelative=!1,o.createPanelPlot=function(){o.panelPlot.draw=o.draw,o.panelPlot.getToolTipInfo=o.getToolTipInfo,o.panelPlot.onMouseClick=o.onMouseClick,o.panelPlot.onSelected=o.onSelected,o.panelPlot.selectionHorOnly=!0},o.createPanelButtons=function(){o.ctrl_PointCount=s.Html(null,"");var e=[{id:"",name:"-- Select --"}];$.each(m.customProperties,function(t,n){n.tableid==o.tableInfo.id&&n.isFloat&&e.push({id:n.propid,name:n.name,group:n.group.Name})});var t=[{id:"",name:"-- Select --"}];$.each(m.customProperties,function(e,n){n.tableid==o.tableInfo.id&&(n.datatype=="Text"||n.datatype=="Boolean")&&t.push({id:n.propid,name:n.name,group:n.group.Name})}),o.ctrlValueProperty=s.Combo(null,{label:"Value:<br>",states:e,value:o.providedAspect2Property("value")}).setClassID("value"),o.ctrlValueProperty.setOnChanged(function(){o.fetchData()}),o.ctrlCatProperty=s.Combo(null,{label:"Group by:<br>",states:t,value:o.providedAspect2Property("groupby")}).setClassID("groupby"),o.ctrlCatProperty.setOnChanged(function(){o.fetchData()}),o.ctrl_binsizeAutomatic=s.Check(null,{label:"Automatic",value:!0}).setClassID("binsizeautomatic").setOnChanged(function(){o.ctrl_binsizeValue.modifyEnabled(!o.ctrl_binsizeAutomatic.getValue()),o.ctrl_binsizeUpdate.modifyEnabled(!o.ctrl_binsizeAutomatic.getValue()),o.ctrl_binsizeAutomatic.getValue()&&o.fetchData()}),o.ctrl_binsizeValue=s.Edit(null,{size:10}).setClassID("binsizevalue").setOnChanged(function(){}),o.ctrl_binsizeValue.modifyEnabled(!1),o.ctrl_binsizeUpdate=s.Button(null,{content:"Update",buttonClass:"PnButtonGrid"}).setOnChanged(function(){o.fetchData()}),o.ctrl_binsizeUpdate.modifyEnabled(!1);var n=s.CompoundHor([s.CompoundVert([o.ctrl_binsizeAutomatic,o.ctrl_binsizeValue]).setAutoFillX(!1),s.HorizontalSeparator(10),o.ctrl_binsizeUpdate]);o.ctrlOverlap=s.Check(null,{label:"Show in single plot"}).setClassID("singleplot").setOnChanged(function(){o.fetchData()}),o.isSinglePlot=function(){return o.ctrlOverlap.getValue()},o.ctrlNormalised=s.Check(null,{label:"Normalise per category"}).setClassID("normcategories").setOnChanged(function(){o.reDraw()});var r=[{id:"state",name:"Name"},{id:"count",name:"Size"},{id:"mean",name:"Average value"}];o.ctrlSort=s.Combo(null,{label:"Sort by",states:r,value:"state"}).setClassID("sortby").setOnChanged(function(){o.sortCategories(),o.reDraw()}),o.ctrl_VertSize=s.ValueSlider(null,{label:"Vertical size",width:180,minval:1,maxval:10,value:5,digits:1}).setClassID("vertsize").setOnChanged(f.debounce(function(){o.reDraw()},20)),o.ctrl_Gamma=s.ValueSlider(null,{label:"Gamma correction",width:180,minval:.1,maxval:1,value:1,digits:2,scaleDistance:.2}).setClassID("gamma").setOnChanged(f.debounce(function(){o.reDraw()},20)),o.colorLegend=s.Html(null,"");var i=s.CompoundVert([o.createIntroControls(),s.Section(s.CompoundVert([o.ctrlValueProperty,o.ctrlCatProperty]).setMargin(10),{title:"Plot data",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([n]),{title:"Bin size",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([o.ctrlOverlap,o.ctrlNormalised,o.ctrlSort,o.ctrl_VertSize,o.ctrl_Gamma,o.colorLegend]).setMargin(10),{title:"Layout",bodyStyleClass:"ControlsSectionBody"})]).setMargin(0);o.addPlotSettingsControl("controls",i),o.panelButtons.addControl(i),o.hasProvidedAspects()&&o.reloadAll()},o.setActiveQuery=function(e){o.theQuery.modify(e)},o.updateQuery=function(){o.fetchData()},o.getVertSize=function(){var e=(3+o.ctrl_VertSize.getValue())/13,t=200*e*e;return o.isSinglePlot()&&(t*=3),t},o.reloadAll=function(){o.fetchData()},o.fetchData=function(){o.propidValue=o.ctrlValueProperty.getValue(),o.propidCat=o.ctrlCatProperty.getValue();if(o.staging)return;o.bucketCounts=null;if(!o.propidValue||!o.propidCat){o.reDraw();return}var e=m.findProperty(o.tableInfo.id,o.propidCat);f.setProcessing(),o.ctrl_PointCount.modifyValue("--- data points");var t={};t.database=m.database,t.workspaceid=m.workspaceid,t.tableid=o.tableInfo.getQueryTableName(o.theQuery.isSubSampling()),t.propidvalue=o.propidValue,t.propidcat=o.propidCat,t.maxrecordcount=o.tableInfo.settings.MaxCountQueryAggregated||1e6,t.qry=u.WhereClause.encode(o.theQuery.getForFetching()),o.ctrl_binsizeAutomatic.getValue()||(t.binsize=o.ctrl_binsizeValue.getValue()),f.customRequest(m.serverUrl,PnServerModule,"histogrammulticat",t,function(t){f.stopProcessing();if("Error"in t){alert(t.Error);return}"Warning"in t?o.setWarning(t.Warning):o.setWarning("");if(!t.hasdata){o.setWarning("No data in result set"),o.reDraw();return}var n=r.ValueListDecoder(),i=n.doDecode(t.cats),s=n.doDecode(t.buckets),u=n.doDecode(t.counts);o.bucketSize=t.binsize;var a=1e99,l=-1e99;$.each(s,function(e,t){t<a&&(a=t),t>l&&(l=t)}),o.numberOfBuckets=Math.round(l-a+1),o.categories=[];var c={};$.each(i,function(t,n){if(!c[n]){var r=[];for(var i=a;i<=l;i++)r.push(0);var s={name:n,dispname:e.toDisplayString(n),bucketCounts:r};o.categories.push(s),c[n]=s}}),o.bucketNrOffset=a,o.maxCount=1;var h=0;for(var p=0;p<s.length;p++){h+=u[p];var d=c[i[p]];d.bucketCounts[s[p]-a]+=u[p],o.maxCount<u[p]&&(o.maxCount=u[p])}$.each(o.categories,function(e,t){t.count=0,t.mean=0,$.each(t.bucketCounts,function(e,n){var r=(o.bucketNrOffset+e+0)*o.bucketSize;t.count+=n,t.mean+=r*n}),t.count>0&&(t.mean/=t.count)}),o.ctrl_binsizeAutomatic.getValue()&&o.ctrl_binsizeValue.modifyValue(o.bucketSize),o.sortCategories();if(o.isSinglePlot()){var v=[];$.each(o.categories,function(e,t){v.push(t.name)});var m=e.mapColors(v),g="";$.each(m.legend,function(e,t){g+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}<br>'.DQXformat({cl:t.color.toString(),name:t.state})}),o.colorLegend.modifyValue(g),o.panelPlot.setFixedHeight(o.getVertSize()+50)}else o.colorLegend.modifyValue(""),o.panelPlot.setFixedHeight(o.categories.length*o.getVertSize()+50);o.reDraw(),o.ctrl_PointCount.modifyValue(h+" data points")})},o.sortCategories=function(){if(!o.numberOfBuckets)return;var e=o.ctrlSort.getValue();e=="state"&&o.categories.sort(f.ByProperty("dispname")),e=="count"&&o.categories.sort(f.ByPropertyReverse("count")),e=="mean"&&o.categories.sort(f.ByProperty("mean"))},o.reloadAll=function(){o.fetchData()},o.reDraw=function(){o.categories&&o.categories.length>0&&(o.isSinglePlot()?o.panelPlot.setFixedHeight(o.getVertSize()+50):o.panelPlot.setFixedHeight(o.categories.length*o.getVertSize()+50)),o.panelPlot.invalidate()},o.draw=function(e){o.drawImpl(e)},o.drawImpl=function(e){o.isSinglePlot()?o.drawImpl_Overlap(e):o.drawImpl_Separate(e)},o.drawImpl_Overlap=function(e){var t=o.getVertSize(),n=o.ctrlNormalised.getValue();o.plotPresent=!1;var r=e.ctx,i=40,s=40;r.fillStyle="rgb(220,220,220)",r.fillRect(0,0,i,e.sizeY),r.fillRect(0,e.sizeY-s,e.sizeX,s);if(!o.numberOfBuckets)return;var u=o.bucketNrOffset*o.bucketSize,a=(o.bucketNrOffset+o.numberOfBuckets)*o.bucketSize,l=a-u;u-=.1*l,a+=.1*l;var c=t,h=m.findProperty(o.tableInfo.id,o.propidCat),p=(e.sizeX-i)/(a-u),d=i-u*p;o.scaleX=p,o.offsetX=d,r.save(),r.font="10px Arial",r.fillStyle="rgb(0,0,0)",r.textAlign="center";var v=E.createPropertyScale(o.tableInfo.id,o.propidValue,p,u,a);$.each(v,function(t,n){var i=Math.round(n.value*p+d)-.5;n.label?(r.fillText(n.label,i,e.sizeY-s+13),n.label2&&r.fillText(n.label2,i,e.sizeY-s+23),r.strokeStyle="rgb(190,190,190)"):r.strokeStyle="rgb(230,230,230)",r.beginPath(),r.moveTo(i,0),r.lineTo(i,e.sizeY-s),r.stroke()}),o.propidValue&&(r.font="bold 11px Arial",r.fillText(m.findProperty(o.tableInfo.id,o.propidValue).name,e.sizeX/2,e.sizeY-12)),r.restore();var g=o.maxCount;n&&(g=1e-9,$.each(o.categories,function(e,t){var n=t.bucketCounts,r=0;$.each(n,function(e,t){r+=t}),r==0&&(r=1);var i=[];$.each(n,function(e,t){i.push(t/r),g=Math.max(g,t/r)}),t.bucketFracs=i}));var y=Math.pow(o.ctrl_Gamma.getValue(),2),b=function(e){return Math.pow(e/g,y)*g};r.save(),r.font="10px Arial",r.fillStyle="rgb(0,0,0)",r.textAlign="center";var w=f.DrawUtil.getScaleJump(30/Math.abs(t/g)/b(.05*g)*.05*g),S=1e9;for(var x=Math.ceil(0);x<=Math.floor(g/w.Jump1);x++){var T=x*w.Jump1,N=Math.pow(T/g,y),C=Math.round(-N*(t-7)+c)-.5;r.strokeStyle="rgb(230,230,230)",x%w.JumpReduc==0&&(r.strokeStyle="rgb(190,190,190)"),r.beginPath(),r.moveTo(i,C),r.lineTo(e.sizeX,C),r.stroke();if(x%w.JumpReduc==0){r.save(),r.translate(i-5,C),r.rotate(-Math.PI/2);var k=w.value2String(T),L=r.measureText(k).width;C+L/2<S&&(r.fillText(k,0,0),S=C-(L/2+7)),r.restore()}}r.font="bold 11px Arial",r.save(),r.translate(17,e.sizeY/2),r.rotate(-Math.PI/2),r.fillText(n?"Relative count":"Count",0,0),r.restore(),r.restore(),o._clickDataPoints=[],$.each(o.categories,function(e,i){var s=i.bucketCounts,u=i.bucketCounts;n&&(u=i.bucketFracs);var a=h.mapSingleColor(i.name);r.strokeStyle=a.toString(),r.fillStyle=a.toString();var f=[],l=[];$.each(u,function(e,n){var u=Math.pow(n/g,y),a=(o.bucketNrOffset+e+0)*o.bucketSize,h=(o.bucketNrOffset+e+1)*o.bucketSize,v=Math.round((a+h)/2*p+d)-.5,m=Math.round(-u*(t-7)+c)-.5;f.push(v),l.push(m),o._clickDataPoints.push({x:v,y:m,catval:i.name,bidx:e,freq:s[e],minval:a,maxval:h}),r.beginPath(),r.arc(v,m,2,0,2*Math.PI,!1),r.closePath(),r.stroke(),r.fill()}),r.beginPath(),$.each(u,function(e,t){var n=f[e],i=l[e];e==0?r.moveTo(n,i):r.lineTo(n,i)}),r.stroke()}),o.plotPresent=!0},o.drawImpl_Separate=function(e){var t=o.getVertSize(),n=Math.pow(o.ctrl_Gamma.getValue(),2);o.plotPresent=!1;var r=e.ctx,i=40,s=40;r.fillStyle="rgb(220,220,220)",r.fillRect(0,0,i,e.sizeY),r.fillRect(0,e.sizeY-s,e.sizeX,s);if(!o.numberOfBuckets)return;var u=o.bucketNrOffset*o.bucketSize,a=(o.bucketNrOffset+o.numberOfBuckets)*o.bucketSize,f=a-u;u-=.1*f,a+=.1*f;var l=(e.sizeX-i)/(a-u),c=i-u*l;o.scaleX=l,o.offsetX=c,r.save(),r.font="10px Arial",r.fillStyle="rgb(0,0,0)",r.textAlign="center";var h=E.createPropertyScale(o.tableInfo.id,o.propidValue,l,u,a);$.each(h,function(t,n){var i=Math.round(n.value*l+c)-.5;n.label?(r.fillText(n.label,i,e.sizeY-s+13),n.label2&&r.fillText(n.label2,i,e.sizeY-s+23),r.strokeStyle="rgb(190,190,190)"):r.strokeStyle="rgb(230,230,230)",r.beginPath(),r.moveTo(i,0),r.lineTo(i,e.sizeY-s),r.stroke()}),o.propidValue&&(r.font="bold 11px Arial",r.fillText(m.findProperty(o.tableInfo.id,o.propidValue).name,e.sizeX/2,e.sizeY-12)),r.restore(),$.each(o.categories,function(s,u){var a=u.bucketCounts,f=t-5+s*t;r.strokeStyle="rgb(200,200,200)",r.beginPath(),r.moveTo(0,f),r.lineTo(e.sizeX,f),r.stroke();var h=o.maxCount;o.ctrlNormalised.getValue()&&(h=1,$.each(a,function(e,t){t>h&&(h=t)})),r.fillStyle="rgb(190,190,190)",r.strokeStyle="rgb(0, 0, 0)",$.each(a,function(e,i){if(i>0){fr=Math.pow(i/h,n);var s=(o.bucketNrOffset+e+0)*o.bucketSize,u=(o.bucketNrOffset+e+1)*o.bucketSize,a=Math.round(s*l+c)-.5,p=Math.round(u*l+c)-.5,d=Math.round(+f)-.5,v=Math.round(-fr*(t-7)+f)-.5;r.beginPath(),r.moveTo(a,v),r.lineTo(a,d),r.lineTo(p,d),r.lineTo(p,v),r.closePath(),r.fill(),r.stroke()}}),r.font="11px Arial",r.fillStyle="rgba(0,0,0,0.6)",r.textAlign="left",r.fillText(u.dispname,i+5,f-t+20)}),o.plotPresent=!0},o.getToolTipInfo=function(e,t){if(!o.plotPresent)return null;var n=null,r=o.getVertSize(),i=m.findProperty(o.tableInfo.id,o.propidCat);if(o.isSinglePlot()){var s=15,u=null;return $.each(o._clickDataPoints,function(n,r){var i=Math.abs(r.x-e)+Math.abs(r.y-t);i<s&&(s=i,u=r)}),u?{ID:"IDX"+u.catval+"_"+u.bidx,px:u.x,py:u.y,showPointer:!0,content:i.toDisplayString(u.catval)+"<br>"+u.freq,cat:u.catval,count:u.freq,minval:u.minval,maxval:u.maxval}:null}var a=Math.floor(t/r),f=o.categories[a];return f?($.each(f.bucketCounts,function(t,i){var s=(o.bucketNrOffset+t+0)*o.bucketSize,u=(o.bucketNrOffset+t+1)*o.bucketSize,l=Math.round(s*o.scaleX+o.offsetX)-.5,c=Math.round(u*o.scaleX+o.offsetX)-.5;if(e>=l&&e<=c&&i>0){var h="";h+="Count: "+i,n={ID:"IDX"+t,px:(l+c)/2,py:(a+1)*r-20,showPointer:!0,content:h,count:i,cat:f.name,minval:s,maxval:u}}}),n):null},o.onMouseClick=function(e,t){var n=o.getToolTipInfo(t.x,t.y);if(n){var r=u.WhereClause.createRangeRestriction(o.theQuery.get(),o.propidValue,n.minval,n.maxval);r=u.WhereClause.createValueRestriction(r,o.propidCat,n.cat,"=");var i="Number of items: "+n.count;i+="<br>Range: "+n.minval+" - "+n.maxval+"<br>";var s=m.findProperty(o.tableInfo.id,o.propidCat);i+=s.name+"= "+s.toDisplayString(n.cat)+"<br>",w.createPlotItemSelectionOptions(o,o.tableInfo,"Multiple Category Histogram bar",i,{query:r,subSamplingOptions:o.theQuery.getSubSamplingOptions()},null)}},o.onSelected=function(e,t,n,r,i,s,a){var f=(e-o.offsetX)/o.scaleX,l=(n-o.offsetX)/o.scaleX,c="Range: "+f+" - "+l+"<br>",h=u.WhereClause.createRangeRestriction(o.theQuery.get(),o.propidValue,f,l);w.createPlotItemSelectionOptions(o,o.tableInfo,"MultiCategoryHistogram range",c,{query:h,subSamplingOptions:o.theQuery.getSubSamplingOptions()},null)},o.create(),o},S}),define("DQX/GMaps/CanvasLayer",["jquery"],function(e){function n(e){function r(e,t){return function(){t.apply(e)}}this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=n.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var t=document.createElement("canvas");t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.pointerEvents="none",this.canvas=t,this.repositionFunction_=r(this,this.repositionCanvas_),this.resizeFunction_=r(this,this.resize_),this.requestUpdateFunction_=r(this,this.update_),e&&this.setOptions(e)}var t={};try{n.prototype=new google.maps.OverlayView}catch(r){return}return n.DEFAULT_PANE_NAME_="overlayLayer",n.CSS_TRANSFORM_=function(){var e=document.createElement("div"),t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];for(var n=0;n<t.length;n++){var r=t[n];if(e.style[r]!==undefined)return r}return t[0]}(),n.prototype.requestAnimFrame_=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},n.prototype.cancelAnimFrame_=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(e){},n.prototype.setOptions=function(e){e.animate!==undefined&&this.setAnimate(e.animate),e.paneName!==undefined&&this.setPaneName(e.paneName),e.updateHandler!==undefined&&this.setUpdateHandler(e.updateHandler),e.resizeHandler!==undefined&&this.setResizeHandler(e.resizeHandler),e.map!==undefined&&this.setMap(e.map)},n.prototype.setAnimate=function(e){this.isAnimated_=!!e,this.isAnimated_&&this.scheduleUpdate()},n.prototype.isAnimated=function(){return this.isAnimated_},n.prototype.setPaneName=function(e){this.paneName_=e,this.setPane_()},n.prototype.getPaneName=function(){return this.paneName_},n.prototype.setPane_=function(){if(!this.isAdded_)return;var e=this.getPanes();if(!e[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');e[this.paneName_].appendChild(this.canvas)},n.prototype.setResizeHandler=function(e){this.resizeHandler_=e},n.prototype.setUpdateHandler=function(e){this.updateHandler_=e},n.prototype.onAdd=function(){if(this.isAdded_)return;this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_()},n.prototype.onRemove=function(){if(!this.isAdded_)return;this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(window,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null)},n.prototype.resize_=function(){if(!this.isAdded_)return;var e=this.getMap(),t=e.getDiv().offsetWidth,n=e.getDiv().offsetHeight,r=this.canvas.width,i=this.canvas.height;if(r!==t||i!==n)this.canvas.width=t,this.canvas.height=n,this.canvas.style.width=t+"px",this.canvas.style.height=n+"px",this.needsResize_=!0,this.scheduleUpdate()},n.prototype.draw=function(){this.repositionCanvas_()},n.prototype.repositionCanvas_=function(){var e=this.getMap().getBounds();this.topLeft_=new google.maps.LatLng(e.getNorthEast().lat(),e.getSouthWest().lng());var t=this.getProjection(),r=t.fromLatLngToDivPixel(this.topLeft_);this.canvas.style[n.CSS_TRANSFORM_]="translate("+Math.round(r.x)+"px,"+Math.round(r.y)+"px)",this.scheduleUpdate()},n.prototype.update_=function(){this.requestAnimationFrameId_=null;if(!this.isAdded_)return;this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_()},n.prototype.getTopLeft=function(){return this.topLeft_},n.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(window,this.requestUpdateFunction_))},t.CanvasLayer=n,t}),define("DQX/GMaps/PointSet",["jquery","DQX/data/countries","DQX/lib/geo_json","DQX/lib/StyledMarker","DQX/Msg","DQX/DocEl","DQX/Utils","DQX/FramePanel","DQX/Map","DQX/GMaps/CanvasLayer"],function(e,t,n,r,i,s,o,u,a,f){var l={};return l.Create=function(t,n){var r={};r.myMapObject=t,r.myPointSet=[],r.pointSize=6,r.pieChartSize=30,r.opacity=.75,r.pointShape=0,r.aggregatePieChart=!0,r.maxAggrCount=0,r.colorMap=o.standardColors;var i={map:r.myMapObject.myMap,resizeHandler:function(){r._resize()},animate:!1,updateHandler:function(){r.draw()}};return r.canvasLayer=new f.CanvasLayer(i),r.context=r.canvasLayer.canvas.getContext("2d"),r.googleEventListeners=[],r.googleEventListeners.push(google.maps.event.addListener(r.myMapObject.myMap,"click",function(e){r.onMouseClick(e)})),r.googleEventListeners.push(google.maps.event.addListener(r.myMapObject.myMap,"mousemove",function(e){r.onMouseMove(e)})),r.googleEventListeners.push(google.maps.event.addListener(r.myMapObject.myMap,"mouseout",function(e){r.removeTooltip()})),r.onCloseCustom=function(){e.each(r.googleEventListeners,function(e,t){google.maps.event.removeListener(t)})},r.setColorMap=function(e){r.colorMap=e},r.setPointStyle=function(e){r.opacity=e.opacity,r.pointSize=e.pointSize,r.pointShape=-1,e.pointShape=="rectangle"&&(r.pointShape=0),e.pointShape=="circle"&&(r.pointShape=1),e.pointShape=="fuzzy"&&(r.pointShape=2),e.pointShape=="marker"&&(r.pointShape=3),r.pointShape<0&&o.reportError("Invalid point shape"),r.pieChartSize=e.aggrSize,r.aggregatePieChart=!0,e.aggregateStyle=="cluster"&&(r.aggregatePieChart=!1),r.usePiechartOffset=!!e.usePiechartOffset},r._resize=function(){},r.findPointAtPosition=function(t){var n=r.myMapObject.myMap.getProjection();if(!n)return null;if(!r.canvasLayer||!r.canvasLayer.getTopLeft())return;var i=r.canvasLayer.getTopLeft();if(!i)return null;var s=n.fromLatLngToPoint(i),o=Math.pow(2,r.myMapObject.myMap.zoom),u=n.fromLatLngToPoint(t);u.x=(u.x-s.x)*o,u.y=(u.y-s.y)*o;var a=r.pointSize*r.pointSize*1,f=Math.max(5,a/2),l=null;return e.each(r.myPointSet,function(e,t){if(!r.isPointFiltered(t)&&t.pt&&(!t.isAggregated||!r.aggregatePieChart)){var n=Math.sqrt(Math.pow(u.x-t.pt.x,2)+Math.pow(u.y-t.pt.y,2));n<=f&&(f=n,l=t)}}),l},r.findPieChartAtPosition=function(t){if(!r.aggregatePieChart||!r.aggregators)return;var n=r.myMapObject.myMap.getProjection();if(!n)return null;if(!r.canvasLayer||!r.canvasLayer.getTopLeft())return;var i=n.fromLatLngToPoint(r.canvasLayer.getTopLeft()),s=Math.pow(2,r.myMapObject.myMap.zoom),o=n.fromLatLngToPoint(t);o.x=(o.x-i.x)*s,o.y=(o.y-i.y)*s;var u=null;return e.each(r.aggregators,function(e,t){if(t.pt){var n=Math.sqrt(Math.pow(o.x-t.pt.x,2)+Math.pow(o.y-t.pt.y,2));n<=t.rd&&(u=t)}}),u},r.removeTooltip=function(){r.toolTipShowingID&&(e("#DQXUtilContainer").find(".DQXChannelToolTip").remove(),r.toolTipShowingID=null)},r.showTooltip=function(t,n){var i=n.id;if(r.toolTipShowingID!=i){r.toolTipShowingID&&r.removeTooltip(),r.toolTipShowingID=i;var o=n.id+"<br>";o+=n.longit.toFixed(5)+", "+n.lattit.toFixed(5)+"<br>",r.pointSettings.catData&&(o+=n.catName),r.pointSettings.numData&&(o+=n.numProp);var u=s.Div();u.setCssClass("DQXChannelToolTip"),u.addStyle("position","absolute");var a=e("#"+r.myMapObject.getID()).offset().left,f=e("#"+r.myMapObject.getID()).offset().top;u.addStyle("left",a+t.pixel.x+10+"px"),u.addStyle("top",f+t.pixel.y+10+"px"),u.addStyle("z-index","9999999"),u.addElem(o),e("#DQXUtilContainer").append(u.toString())}},r.onMouseMove=function(e){if(r.myMapObject.isSelecting())return;var t=r.findPointAtPosition(e.latLng);if(t){r.myMapObject.myMap.set("draggableCursor","pointer"),r.showTooltip(e,t);return}r.removeTooltip();if(r.aggregatePieChart&&r.aggregators){var n=r.findPieChartAtPosition(e.latLng);if(n){r.myMapObject.myMap.set("draggableCursor","pointer");return}}r.myMapObject.myMap.set("draggableCursor","default")},r.onMouseClick=function(e){if(r.myMapObject.isSelecting())return;var t=r.findPointAtPosition(e.latLng);if(t&&r._pointClickCallBack){r._pointClickCallBack(t.id);return}if(r.aggregatePieChart&&r._pieChartClickCallBack&&r.aggregators){var n=r.findPieChartAtPosition(e.latLng);if(n){r._pieChartClickCallBack(n);return}}},r.draw=function(){var t=[],n=[],i=[];e.each(r.colorMap,function(e,s){t.push(s.changeOpacity(r.opacity).toStringCanvas()),n.push(s.changeOpacity(r.opacity).toStringCanvas()),i.push(s.changeOpacity(0).toStringCanvas())});var s=r.canvasLayer.canvas.width,u=r.canvasLayer.canvas.height,f=r.context;f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,s,u);if(!r.myPointSet||r.myPointSet.length==0)return;f.fillStyle="rgba(0, 128, 0, 0.5)";var l=r.myMapObject.myMap.getProjection();if(!l)return;f.setTransform(1,0,0,1,0,0);var c=Math.pow(2,r.myMapObject.myMap.zoom),h=r.pointSize*r.pointSize*1,p=h/2,d=r.pieChartSize;if(!r.canvasLayer||!r.canvasLayer.getTopLeft())return;var v=l.fromLatLngToPoint(r.canvasLayer.getTopLeft()),m=r.pointSettings.catData,g=r.pointSettings.numData;if(r.aggregatePieChart&&r.aggregators){if(r.usePiechartOffset){var y=a.MapItemLayouter(r.myMapObject,"",100/c);e.each(r.aggregators,function(e,t){var n=Math.sqrt(t.totCount*1/r.maxAggrCount)*r.pieChartSize;y.addItem(t.longit0,t.lattit0,2.5*n)}),y.calculatePositions(),e.each(r.aggregators,function(e,t){t.longit=y.items[e].longit2,t.lattit=y.items[e].lattit2})}else e.each(r.aggregators,function(e,t){t.longit=t.longit0,t.lattit=t.lattit0});e.each(r.aggregators,function(n,i){var s=l.fromLatLngToPoint(new google.maps.LatLng(i.lattit0,i.longit0));s.x=(s.x-v.x)*c,s.y=(s.y-v.y)*c;var u=l.fromLatLngToPoint(new google.maps.LatLng(i.lattit,i.longit));u.x=(u.x-v.x)*c,u.y=(u.y-v.y)*c,i.pt=u;var a=Math.sqrt(i.totCount*1/r.maxAggrCount)*d;i.rd=a;var h=0,p=0;if(r.usePiechartOffset){var m=u.x-s.x,y=u.y-s.y,b=4,w=Math.sqrt(m*m+y*y);if(w>0){m/=w,y/=w;var E=u.x-a*m,S=u.y-a*y;f.strokeStyle=o.Color(0,0,0,.5+.5*r.opacity).toStringCanvas(),f.fillStyle=o.Color(0,0,0,.5*r.opacity).toStringCanvas(),f.lineWidth=1,f.beginPath(),f.moveTo(s.x,s.y),f.lineTo(E-b*y,S+b*m),f.lineTo(E+b*y,S-b*m),f.closePath(),f.stroke(),f.fill()}}if(!g)e.each(i.catsCount,function(e,n){f.fillStyle=t[e],h+=n;var r=h*1/i.totCount*2*Math.PI;f.beginPath(),f.moveTo(u.x,u.y),f.arc(u.x,u.y,a,p,r,!1),f.lineTo(u.x,u.y),f.closePath(),f.fill(),p=r});else if(i.numPropFracs.length>0){var x=i.numPropFracs[0],T=0,N=null,C=null,k=i.numPropFracs.length,L=function(){if(C<=T)return;var e=(x+N)/2;f.fillStyle=o.HSL2Color(.5-e*.75,1,.5).changeOpacity(r.opacity).toStringCanvas(),f.beginPath(),f.moveTo(u.x,u.y),f.arc(u.x,u.y,a,T,C+(C-T)*.05,!1),f.lineTo(u.x,u.y),f.closePath(),f.fill()};for(var A=0;A<k;A++)N=i.numPropFracs[A],C=(A+1)/k*2*Math.PI,N-x>.0025&&(L(),x=N,T=C);L()}f.lineWidth=1,f.beginPath(),f.arc(u.x,u.y,a,0,2*Math.PI,!1),f.closePath(),f.stroke(),i.selCount>0&&(f.lineWidth=5,f.beginPath(),f.arc(u.x,u.y,a,0,i.selCount*1/i.totCount*2*Math.PI,!1),f.stroke())})}var b=[],w=[];e.each(r.myPointSet,function(e,t){if(!r.isPointFiltered(t)&&(!t.isAggregated||!r.aggregatePieChart)){var s=l.fromLatLngToPoint(new google.maps.LatLng(t.lattit,t.longit));t.pt=s,g?f.fillStyle=o.HSL2Color(.5-t.numPropFrac*.75,1,.5).changeOpacity(r.opacity).toStringCanvas():f.fillStyle=n[t.catNr],s.x=(s.x-v.x)*c,s.y=(s.y-v.y)*c,s.x+=t.offsetX*d,s.y+=t.offsetY*d,r.pointShape==0&&f.fillRect(s.x-p,s.y-p,h,h),r.pointShape==1&&(f.beginPath(),f.moveTo(s.x,s.y),f.arc(s.x,s.y,p,0,2*Math.PI,!1),f.closePath(),f.fill()),r.pointShape==3&&(f.strokeStyle="rgb0(0,0,0)",f.beginPath(),f.moveTo(s.x,s.y),f.arc(s.x,s.y-p,.4*p,Math.PI*.9,2.1*Math.PI,!1),f.closePath(),f.fill(),f.stroke());if(r.pointShape==2){var u=f.createRadialGradient(s.x,s.y,0,s.x,s.y,p);if(g){var a=o.HSL2Color(.5-t.numPropFrac*.75,1,.5).changeOpacity(r.opacity);u.addColorStop(0,a.toStringCanvas()),u.addColorStop(1,a.changeOpacity(0).toStringCanvas())}else u.addColorStop(0,n[t.catNr]),u.addColorStop(1,i[t.catNr]);f.fillStyle=u,f.beginPath(),f.moveTo(s.x,s.y),f.arc(s.x,s.y,p,0,2*Math.PI,!1),f.closePath(),f.fill()}t.sel&&(b.push(s.x),w.push(s.y))}}),f.lineWidth=1,f.strokeStyle=o.Color(0,0,0,.5+.5*r.opacity).toStringCanvas();for(var E=0;E<b.length;E++)f.beginPath(),f.arc(b[E],w[E],p+2,0,2*Math.PI,!1),f.closePath(),f.stroke()},r.clearPoints=function(){this.myPointSet=[]},r.remove=function(){this.clearPoints()},r.setPointClickCallBack=function(e,t){r._pointClickCallBack=e,r._pieChartClickCallBack=t},r._pointFilters={},r.setPointFilter=function(e,t){r._pointFilters[e]=t},r.isPointFiltered=function(t){var n=!1;return e.each(r._pointFilters,function(e,r){r&&r(t)&&(n=!0)}),n},r.setPoints=function(t,n){function i(){var e,t,n;do e=2*Math.random()-1,t=2*Math.random()-1,n=e*e+t*t;while(n>=1||n==0);var r=Math.sqrt(-2*Math.log(n)/n);return e*r}r.pointSettings=n,r.myPointSet=t;var s={};e.each(r.myPointSet,function(e,t){var n=Math.round(t.lattit*1e4).toString()+"_"+Math.round(t.longit*1e4).toString();if(s[n]){var r=Math.sqrt(s[n]/1e3);t.offsetX=i()*r,t.offsetY=i()*r,s[n]+=1}else t.offsetX=0,t.offsetY=0,s[n]=1}),r.aggregators=[],r.aggregatorMap={},e.each(s,function(e,t){if(t>1){var n={longit:0,lattit:0,totCount:0,catsCount:[],numPropFracs:[]};r.aggregators.push(n),r.aggregatorMap[e]=n}}),e.each(r.myPointSet,function(e,t){if(!r.isPointFiltered(t)){var n=Math.round(t.lattit*1e4).toString()+"_"+Math.round(t.longit*1e4).toString();t.isAggregated=!!r.aggregatorMap[n];if(t.isAggregated){t.aggregid=n;var i=r.aggregatorMap[n];i.numPropFracs.push(t.numPropFrac),i.longit=t.longit,i.lattit=t.lattit,i.longit0=t.longit,i.lattit0=t.lattit,i.totCount+=1;while(i.catsCount.length<=t.catNr)i.catsCount.push(0);i.catsCount[t.catNr]+=1}}}),e.each(r.aggregators,function(e,t){r.maxAggrCount=Math.max(r.maxAggrCount,t.totCount),t.numPropFracs.sort()}),r.countAggregateSelection()},r.countAggregateSelection=function(){e.each(r.aggregators,function(e,t){t.selCount=0}),e.each(r.myPointSet,function(e,t){var n=Math.round(t.lattit*1e4).toString()+"_"+Math.round(t.longit*1e4).toString();t.isAggregated=!!r.aggregatorMap[n],t.isAggregated&&t.sel&&(r.aggregatorMap[t.aggregid].selCount+=1)})},r.updateSelection=function(){r.countAggregateSelection(),r.draw()},r.zoomFit=function(t){if(r.myPointSet.length==0)return;var n=new google.maps.LatLngBounds;e.each(r.myPointSet,function(e,t){n.extend(new google.maps.LatLng(t.lattit,t.longit))});var i=n.getNorthEast(),s=n.getSouthWest(),o=i.lat()-s.lat(),u=t/4e4*360;o<u&&(n.extend(new google.maps.LatLng(Math.min(89.9,i.lat()+(u-o)/2),i.lng())),n.extend(new google.maps.LatLng(Math.max(-89.9,s.lat()-(u-o)/2),s.lng()))),r.myMapObject.myMap.fitBounds(n)},r},l}),define("Utils/TimeLineView",["require","DQX/base64","DQX/Application","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/ChannelPlot/ChannelPlotter","DQX/ChannelPlot/ChannelCanvas","Utils/MiscUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={};return h.ChannelScale=function(e){var t=l.Base("_TimeScale");return t._height=31,t.myTimeLine=e,t.draw=function(e){this.drawStandardGradientCenter(e,.84),this.drawStandardGradientLeft(e,.84),this.drawStandardGradientRight(e,.84);if(!t.myTimeLine.hasDataPoints)return;if(!t.myTimeLine.minJD&&!t.myTimeLine.maxJD)return;e.centerContext.fillStyle=a.Color(.3,.3,.3).toString(),e.centerContext.font="11px sans-serif",e.centerContext.textBaseline="top",e.centerContext.textAlign="center";var n=c.createDateScaleInfo(80,e.zoomFactX),r=c.createDateScaleInfo(20,e.zoomFactX),i=function(e){return e<10?"0"+e:e},s=Math.floor(t.myTimeLine.minJD),o=Math.ceil(t.myTimeLine.maxJD);for(var u=s;u<=o;u++){var f=Math.round((u-t.myTimeLine.minJD)*e.zoomFactX-e.offsetX)+.5,l=a.JD2DateTime(u),h=l.getUTCFullYear(),p=l.getUTCMonth()+1,d=l.getUTCDate();if(n.isOnScale(h,p,d)){var v=h;e.centerContext.fillText(v,f,6);if(!n.yearInterval){var m="-"+i(p)+"-"+i(d);e.centerContext.fillText(m,f,16),e.centerContext.beginPath(),e.centerContext.moveTo(f,0),e.centerContext.lineTo(f,7),e.centerContext.stroke()}}else r.isOnScale(h,p,d)&&(e.centerContext.beginPath(),e.centerContext.moveTo(f,0),e.centerContext.lineTo(f,3),e.centerContext.stroke())}this.drawMark(e,!0)},t},h.ChannelData=function(e){var t=l.Base("_TimeData");return t.myTimeLine=e,t._height=25,t.setAutoFillHeight(!0),t.rateScale=1e-99,t.reset=function(){t.rateScale=1e-99},t.draw=function(e){this.drawStandardGradientCenter(e,1),this.drawStandardGradientLeft(e,.84),this.drawStandardGradientRight(e,.84);if(!t.myTimeLine.hasDataPoints)return;var n=t.myTimeLine.myPointSet;if(n.length==0)return;var r=t.myTimeLine.mySettings,i=r.catData,s=[];i?$.each(t.myTimeLine.colorMap,function(e,t){s.push(t.lighten(.3).toStringCanvas())}):s.push(a.Color(.7,.7,.7).toStringCanvas());var o=Math.max(1,Math.round(7/e.zoomFactX)),u=Math.floor(t.myTimeLine.minJD),f=Math.ceil(t.myTimeLine.maxJD),l=(-100+e.offsetX)/e.zoomFactX+t.myTimeLine.minJD,c=(e.sizeCenterX+100+e.offsetX)/e.zoomFactX+t.myTimeLine.minJD,h=Math.round(l/o),p=Math.round(c/o)-h,d=[];for(var v=0;v<p;v++){var m={memberCount:0,selectedMemberCount:0,memberCategoriesCount:[]};d.push(m)}for(var g=0;g<n.length;g++){var y=n[g];if(y.dateJD>=l&&y.dateJD<=c){var v=Math.round(y.dateJD/o)-h;if(v>=0&&v<p){var m=d[v];m.memberCount+=1,y.sel&&(m.selectedMemberCount+=1);while(m.memberCategoriesCount.length<=y.catNr)m.memberCategoriesCount.push(0);m.memberCategoriesCount[y.catNr]+=1}}}$.each(d,function(e,n){t.rateScale=Math.max(t.rateScale,n.memberCount*1/o)});var b=e.sizeY,w=e.sizeY*.9,E=Math.max(2,.33*o*e.zoomFactX);e.centerContext.strokeStyle="rgb(0,0,0)",e.centerContext.lineWidth=.25,$.each(d,function(n,r){var i=(n+h)*o,u=(i-o/2-t.myTimeLine.minJD)*e.zoomFactX-e.offsetX,a=(i+o/2-t.myTimeLine.minJD)*e.zoomFactX-e.offsetX,f=o*t.rateScale;t.myTimeLine.drawStyle.showTimeBarsAsPercentage&&(f=Math.max(1,r.memberCount));var l=0;$.each(r.memberCategoriesCount,function(t,n){var r=Math.round(l*1/f*w),i=Math.round((l+n)*1/f*w);e.centerContext.fillStyle=s[t],e.centerContext.fillRect(u,b-i,a-u,i-r),l+=n});var c=Math.round(r.memberCount*1/f*w);e.centerContext.strokeStyle="rgb(0,0,0)",e.centerContext.beginPath(),e.centerContext.rect(u,b-c,a-u,c),e.centerContext.stroke();if(r.selectedMemberCount>0){var c=Math.round(r.selectedMemberCount*1/f*w);e.centerContext.fillStyle="rgb(64,0,0)",e.centerContext.fillRect(u,b-c,E,c)}}),e.centerContext.fillStyle=a.Color(.3,.3,.3).toString(),e.centerContext.font="11px sans-serif",e.centerContext.textBaseline="top",e.centerContext.textAlign="center",this.drawMark(e,!1),t.drawVertScale(e,0,t.rateScale,{offsetFrac:0,rangeFrac:.9}),e.leftContext.font="11px sans-serif",e.leftContext.fillStyle="black",e.leftContext.fillText("1/d",20,Math.round(e.sizeY*.5)+7)},t},h.Create=function(e){var t=f.Panel(e,{hasHeader:!1,hasFooter:!1,hasXScale:!1,leftWidth:80});return t.scaleConversionFactor=1,t.myPointSet=[],t.colorMap=a.standardColors,t.drawStyle={showTimeBarsAsPercentage:!1},t.storeSettings=function(){var e={};e.range=t.getVisibleRange();var n=t.getMark();return n&&(e.mark=n),e.minJD=t.minJD,e.maxJD=t.maxJD,e},t.recallSettings=function(e){t.setRangeJD(e.minJD,e.maxJD),t.setPosition((e.range.max+e.range.min)/2,e.range.max-e.range.min),e.mark&&t.setMark(e.mark.min,e.mark.max)},t.channelData=h.ChannelData(t),t.addChannel(t.channelData,!0),t.addChannel(h.ChannelScale(t),!0),s.listen("",{type:"PosOrZoomFactorXChanged",id:t.myID},function(){t._onViewPortModified&&t._onViewPortModified()}),t.setOnRangeSelected(function(){var e=t.getMark();t.delMark(),t._onTimeRangeSelected&&t._onTimeRangeSelected(e.min+t.minJD,e.max+t.minJD)}),t.handleResize(),t.setOnViewPortModified=function(e){t._onViewPortModified=e},t.setOnTimeRangeSelected=function(e){t._onTimeRangeSelected=e},t.getVisibleTimeRange=function(){var e=t.getVisibleRange();return e.min+=t.minJD,e.max+=t.minJD,e},t.setRangeJD=function(e,n){t.minJD=e,t.maxJD=n,t.rangeJD=t.maxJD-t.minJD,t.setRange(0,t.rangeJD,t.rangeJD/4)},t.setColorMap=function(e){t.colorMap=e},t.setPoints=function(e,n){t.myPointSet=e,t.mySettings=n;var r=1e99,i=-1e99;t.hasDataPoints=!1,$.each(t.myPointSet,function(e,n){n.dateJD!=null&&(r=Math.min(r,n.dateJD-.5),i=Math.max(i,n.dateJD+.5),t.hasDataPoints=!0)}),t.hasDataPoints?(!t.minJD||!t.maxJD||Math.abs(t.minJD-r)>.001||Math.abs(t.maxJD-i)>.001)&&t.setRangeJD(r,i):t.setRangeJD(2456873.5,2456973.5)},t.clearPoints=function(){this.myPointSet=[],t.channelData.reset()},t.setDrawStyle=function(e){t.drawStyle=e},t.draw=function(){t.hasDataPoints&&t.render()},t.updateSelection=function(){t.render()},t},h}),define("Plots/GeoTemporal/TimeLine",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/Map","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","DQX/GMaps/PointSet","MetaData","Utils/QueryTool","Plots/GenericPlot","Utils/ButtonChoiceBox","Utils/TimeLineView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S={};return S.Create=function(e){var t={};return t.thePlot=e,t.tableInfo=e.tableInfo,t.createView=function(){t.myTimeLine=E.Create(t.frame),t.myTimeLine.setOnViewPortModified(f.ratelimit(t.updateTimeViewPort,50)),t.myTimeLine.setOnTimeRangeSelected(t.onTimeRangeSelected)},t.createControls=function(){var e=[{id:"",name:"-None-"}];$.each(g.customProperties,function(n,r){r.tableid==t.tableInfo.id&&r.isDate&&e.push({id:r.propid,name:r.name})}),t.ctrlDateProperty=s.Combo(null,{label:"Date:",states:e,value:e[0].id,value:t.thePlot.providedAspect2Property("dateprop")}).setClassID("dateprop"),t.ctrlDateProperty.setOnChanged(function(){t.thePlot.fetchData()}),t.ctrl_restrictToTimeViewPort=s.Check(null,{label:"Restrict to viewport"}).setClassID("restricttotimeviewport"),t.ctrl_restrictToTimeViewPort.setOnChanged(function(){t.ctrl_restrictToTimeViewPort.getValue()?t.updateTimeViewPort():(t.thePlot.pointSet.setPointFilter("timeFilter",null),t.thePlot.updateMapPoints(),t.thePlot.reDraw())}),t.ctrl_showTimeBarsAsPercentage=s.Check(null,{label:"Show as percentage"}).setClassID("showtimeaspercentage"),t.ctrl_showTimeBarsAsPercentage.setOnChanged(function(){t.thePlot.reDraw()});var n=s.CompoundVert([t.ctrlDateProperty,t.ctrl_showTimeBarsAsPercentage,t.ctrl_restrictToTimeViewPort]);return s.Section(n,{title:"Time line",bodyStyleClass:"ControlsSectionBody"})},t.addFetchProperties=function(e){t.datePropId=t.ctrlDateProperty.getValue(),t.datePropId&&e.addColumn(t.datePropId,"F4")},t.processFetchedPoints=function(e,n){if(t.datePropId){var r=e[t.datePropId];for(var i=0;i<n.length;i++)n[i].dateJD=r[i]}},t.clearPoints=function(){t.myTimeLine.clearPoints()},t.setPoints=function(e,n){t.myTimeLine.setPoints(e,n)},t.setColorMap=function(e){t.myTimeLine.setColorMap(e)},t.draw=function(){t.myTimeLine.setDrawStyle({showTimeBarsAsPercentage:t.ctrl_showTimeBarsAsPercentage.getValue()}),t.myTimeLine.draw()},t.updateSelection=function(){t.myTimeLine.updateSelection()},t.updateTimeViewPort=function(){if(t.ctrl_restrictToTimeViewPort.getValue()){var e=t.myTimeLine.getVisibleTimeRange();t.thePlot.pointSet.setPointFilter("timeFilter",function(t){return t.dateJD<e.min||t.dateJD>e.max}),t.thePlot.updateMapPoints(),t.thePlot.pointSet.draw()}},t.onTimeRangeSelected=function(e,n){if(!t.thePlot.points)return;var r=t.ctrlDateProperty.getValue(),i=t.thePlot.theQuery.get();i=u.WhereClause.createRangeRestriction(i,r,e,n),selectionCreationFunction=function(){var r=t.thePlot.points,i=[];return $.each(r,function(r,s){if(!t.thePlot.pointSet.isPointFiltered(s)){var o=s.dateJD>=e&&s.dateJD<=n;o&&i.push(s.id)}}),i};var s=g.findProperty(t.tableInfo.id,r),o=s.name+" between "+s.toDisplayString(e)+" and "+s.toDisplayString(n);w.createPlotItemSelectionOptions(t.thePlot,t.tableInfo,"Date range",o,{query:i,subSamplingOptions:t.thePlot.theQuery.getSubSamplingOptions()},selectionCreationFunction)},t.storeSettings=function(){var e={};return e.timeLine=t.myTimeLine.storeSettings(),e},t.recallSettings=function(e){t.myTimeLine.recallSettings(e.timeLine)},t},S}),define("Plots/GeoTemporal/GeoTemporal",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/Map","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","DQX/GMaps/PointSet","MetaData","Utils/QueryTool","Utils/ButtonChoiceBox","Plots/GenericPlot","Utils/MiscUtils","Plots/GeoTemporal/TimeLine"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x={};return x.typeID="GeoTemporal",x.name="Map",x.description="Takes a <b>geographic lattitude & longitude property pair</b>, and maps the {items} on a world map. Optionally, a date property can be used to add a time line.",x.isCompatible=function(e){return e.hasGeoCoord},x.plotAspects=[{id:"dateprop",name:"Date",dataType:"Date",requiredLevel:1},{id:"pointcolor",name:"Color",dataType:"",requiredLevel:0}],o.listen("",{type:"CreateGeoMapPoint"},function(e,t){x.Create(t.tableid,t.startQuery,{},{zoomFit:!0,showAsMarker:!0})}),x.Create=function(e,t,n,r){var a=g.getTableInfo(e),l=w.Create(e,x.typeID,{title:a.tableCapNamePlural+" ("+x.name+")"},t,n,r,r);l.pointData={},l.maxrecordcount=l.tableInfo.settings.MaxCountQueryRecords||2e5,l.hasTimeLine=!1,$.each(g.customProperties,function(e,t){t.tableid==l.tableInfo.id&&t.isDate&&(l.hasTimeLine=!0)});var c=f.getNextUniqueID();return l.eventids.push(c),o.listen(c,{type:"SelectionUpdated"},function(e,t){l.tableInfo.id==t&&l.updateSelection()}),l.plotComponents={},l.hasTimeLine&&(l.plotComponents.timeLine=S.Create(l)),l.createFrames=function(){var e=!1;r&&r.controlsCollapsed&&(e=!0),l.frameButtons=i.FrameFinal("",.3).setAllowScrollBars(!1,!0).setFixedSize(i.dimX,240);var t=i.FrameGroupVert("",.7).setMargins(0).setSeparatorSize(0);l.frameRoot.MakeControlsFrame(l.frameButtons,t,240,e),l.frameWarning=t.addMemberFrame(i.FrameFinal("",.01)).setMargins(0).setAutoSize().setAllowScrollBars(!1,!1);var n=t.addMemberFrame(i.FrameGroupVert("",.99));l.hasTimeLine&&(l.plotComponents.timeLine.frame=n.addMemberFrame(i.FrameFinal("",.3)).setAllowScrollBars(!1,!1)),l.frameGeoMap=n.addMemberFrame(i.FrameFinal("",.7)).setAllowScrollBars(!1,!1)},l.createControlsMap=function(){var e="rectangle",t=2.5;r&&r.showAsMarker&&(e="marker",t=6),l.ctrl_PointShape=s.Combo(null,{label:"Point shape:",states:[{id:"rectangle",name:"Rectangle"},{id:"circle",name:"Circle"},{id:"fuzzy",name:"Fuzzy"},{id:"marker",name:"Marker"}],value:e}).setClassID("pointShape").setOnChanged(function(){l.reDraw()}),l.ctrl_PointSize=s.ValueSlider(null,{label:"Point size",width:170,minval:.1,maxval:10,value:t,digits:2}).setClassID("pointSize").setNotifyOnFinished().setOnChanged(function(){l.reDraw()}),l.ctrl_Opacity=s.ValueSlider(null,{label:"Point opacity",width:170,minval:0,maxval:1,value:.8,digits:2}).setClassID("pointOpacity").setNotifyOnFinished().setOnChanged(function(){l.reDraw()}),l.ctrl_AggrType=s.Combo(null,{label:"Style:",states:[{id:"piechart",name:"Pie chart"},{id:"cluster",name:"Cluster"}],value:"piechart"}).setClassID("aggrStyle").setOnChanged(function(){l.reDraw()}),l.ctrl_AggrSize=s.ValueSlider(null,{label:"Size",width:150,minval:10,maxval:100,value:20,digits:0}).setClassID("aggrSize").setNotifyOnFinished().setOnChanged(function(){l.reDraw()}),l.ctrl_PieOffset=s.Check(null,{label:"Use offset",value:!0}).setClassID("pieOffset").setOnChanged(function(){l.reDraw()});var n=s.CompoundVert([l.ctrl_PointShape,l.ctrl_PointSize,l.ctrl_Opacity,s.CompoundVert([l.ctrl_AggrType,l.ctrl_AggrSize,s.VerticalSeparator(5),l.ctrl_PieOffset]).setLegend("Aggregated points")]);return s.Section(n,{title:"Map",bodyStyleClass:"ControlsSectionBody"})},l.createPanels=function(){this.panelWarning=i.Form(this.frameWarning),this.warningContent=s.Html("","","____"),this.panelWarning.addControl(this.warningContent),this.panelWarning.render(),l.panelButtons=i.Form(l.frameButtons).setPadding(0);var e=s.Button(null,{icon:"fa-crosshairs",content:"Select points...",buttonClass:"PnButtonGrid",width:80,height:30}).setOnChanged(function(){var e=[];e.push({content:"Rectangular latt-long area",handler:function(){l.theMap.startRectSelection(l.fetchRectSelection)}}),e.push({content:"Lasso tool",handler:function(){l.theMap.startLassoSelection(l.fetchLassoSelection)}}),b.create("Select points","",[e])});l.ctrl_PointCount=s.Html(null,"");var t=[{id:"",name:"-- None --"}];$.each(g.customProperties,function(e,n){var r=!1;n.tableid==l.tableInfo.id&&(n.datatype=="Text"||n.datatype=="Boolean"||n.datatype=="Value"||n.datatype=="Date")&&t.push({id:n.propid,name:n.name,group:n.group.Name})}),l.ctrlColorProperty=s.Combo(null,{label:"Color:",states:t,value:l.providedAspect2Property("pointcolor")}).setClassID("pointcolor"),l.ctrlColorProperty.setOnChanged(function(){l.fetchData()}),l.colorLegend=s.Html(null,"");var n=[l.createIntroControls(),s.AlignCenter(s.CompoundHor([e,s.HorizontalSeparator(95)])),s.VerticalSeparator(20),s.Section(s.CompoundVert([l.ctrlColorProperty,l.colorLegend]).setMargin(10),{title:"Color overlay",bodyStyleClass:"ControlsSectionBody"})];$.each(l.plotComponents,function(e,t){n.push(t.createControls())});var r=l.createControlsMap();n.push(r);var a=s.CompoundVert(n).setMargin(0);l.addPlotSettingsControl("controls",a),l.panelButtons.addControl(a),$.each(l.plotComponents,function(e,t){t.createView()}),l.theMap=p.GMap(this.frameGeoMap),l.pointSet=m.Create(l.theMap,{}),l.pointSet.setPointClickCallBack(function(e){o.send({type:"ItemPopup"},{tableid:l.tableInfo.id,itemid:e})},function(e){var t=l.theQuery.get(),n=1e-4;t=u.WhereClause.createRangeRestriction(t,l.tableInfo.propIdGeoCoordLongit,e.longit0-n,e.longit0+n),t=u.WhereClause.createRangeRestriction(t,l.tableInfo.propIdGeoCoordLattit,e.lattit0-n,e.lattit0+n),o.send({type:"DataItemTablePopup"},{tableid:l.tableInfo.id,query:t,title:l.tableInfo.tableCapNamePlural+" at "+e.longit+", "+e.lattit})}),l.startZoomFit=!0,l.reloadAll()},l.setWarning=function(e){e?l.warningContent.modifyValue('<div style="color:red;padding:2px;background-color:yellow;border-bottom: 1px solid black">'+e+"</div>"):l.warningContent.modifyValue(""),l.panelWarning.render()},l.storeCustomSettings=function(){var e={};return e.mapSettings=l.theMap.storeSettings(),$.each(l.plotComponents,function(t,n){e[t]=n.storeSettings()}),e},l.recallCustomSettings=function(e){l.startZoomFit=!1,l.theMap.recallSettings(e.mapSettings),$.each(l.plotComponents,function(t,n){e[t]&&n.recallSettings(e[t])})},l.reloadAll=function(){l.fetchData()},l.fetchData=function(){var e=d.RecordsetFetcher(g.serverUrl,g.database,l.tableInfo.getQueryTableName(l.theQuery.isSubSampling()));e.setMaxResultCount(l.maxrecordcount),l.ctrl_PointCount.modifyValue("--- data points"),l.pointSet.clearPoints(),$.each(l.plotComponents,function(e,t){t.clearPoints()}),l.points=null,l.colorLegend.modifyValue("");var t=l.tableInfo.primkey;$.each(l.plotComponents,function(t,n){n.addFetchProperties(e)}),l.pointData[l.tableInfo.primkey]||e.addColumn(l.tableInfo.primkey,"ST"),l.pointData[l.tableInfo.propIdGeoCoordLongit]||e.addColumn(l.tableInfo.propIdGeoCoordLongit,"F4"),l.pointData[l.tableInfo.propIdGeoCoordLattit]||e.addColumn(l.tableInfo.propIdGeoCoordLattit,"F4"),l.catPropId=null,l.numPropId=null;if(l.ctrlColorProperty.getValue()){var n=g.findProperty(l.tableInfo.id,l.ctrlColorProperty.getValue());if(n.datatype=="Text"||n.datatype=="Boolean")l.catPropId=l.ctrlColorProperty.getValue(),l.pointData[l.catPropId]||e.addColumn(l.catPropId,"ST");n.isFloat&&(l.numPropId=l.ctrlColorProperty.getValue(),l.pointData[l.numPropId]||e.addColumn(l.numPropId,"ST"))}if(e.getColumnIDs().length<=0){l.setPoints();return}var r=f.getNextUniqueID();l.requestID=r;var i=l.tableInfo.currentSelection;f.setProcessing();var s=l.theQuery.getForFetching(),o=u.WhereClause.whcClassGenerator.ispresent;s=u.WhereClause.createRestriction(s,o({ColName:l.tableInfo.propIdGeoCoordLongit})),s=u.WhereClause.createRestriction(s,o({ColName:l.tableInfo.propIdGeoCoordLattit})),e.getData(s,t,function(e){f.stopProcessing();if(l.requestID==r){var t=0;$.each(e,function(e,n){l.pointData[e]=n,t=n.length}),l.ctrl_PointCount.modifyValue(t+" data points"),l.setPoints(),l.startZoomFit&&(l.pointSet.zoomFit(100),l.startZoomFit=!1),t>=l.maxrecordcount?l.setWarning("Number of points truncated to "+l.maxrecordcount):l.setWarning("")}},function(e){f.stopProcessing(),l.fetchCount-=1})},l.setPoints=function(){var e=l.pointData[l.tableInfo.primkey],t=l.pointData[l.tableInfo.propIdGeoCoordLongit],n=l.pointData[l.tableInfo.propIdGeoCoordLattit],r=l.tableInfo.currentSelection;l.mappedColors=f.standardColors,l.mappedColors=[f.Color(1,0,0)];if(l.catPropId){var i=g.findProperty(l.tableInfo.id,l.catPropId),s=l.pointData[l.catPropId];for(var o=0;o<s.length;o++)s[o]=i.toDisplayString(s[o]);var u=i.mapColors(s),a=u.indices;l.mappedColors=u.colors;var c="";$.each(u.legend,function(e,t){c+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}<br>'.DQXformat({cl:t.color.toString(),name:t.state})}),l.colorLegend.modifyValue(c)}if(l.numPropId){var h=g.findProperty(l.tableInfo.id,l.numPropId),p=l.pointData[l.numPropId];l.numPropMin=h.settings.minval,l.numPropMax=h.settings.maxval,l.numPropRange=l.numPropMax-l.numPropMin,l.numPropRange<=0&&(l.numPropRange=1)}l.points=[];for(var d=0;d<e.length;d++){var v=e[d],m={id:v,longit:t[d],lattit:n[d],sel:!!r[v]};s?(m.catName=s[d],m.catNr=a[d]):m.catNr=0,p&&(m.numProp=p[d],m.numPropFrac=(p[d]-l.numPropMin)/l.numPropRange),l.points.push(m)}$.each(l.plotComponents,function(e,t){t.processFetchedPoints(l.pointData,l.points)}),l.updateMapPoints(),$.each(l.plotComponents,function(e,t){t.setPoints(l.points,{catData:!!l.catPropId,numData:!!l.numPropId})}),l.reDraw()},l.updateMapPoints=function(){l.points&&(l.pointSet.setPoints(l.points,{catData:!!l.catPropId,numData:!!l.numPropId}),l.pointSet.setColorMap(l.mappedColors),l.plotComponents.timeLine&&l.plotComponents.timeLine.setColorMap(l.mappedColors))},l.updateSelection=function(){if(!l.points)return;var e=l.points,t=l.tableInfo.currentSelection;for(var n=0;n<e.length;n++)e[n].sel=!!t[e[n].id];l.pointSet.updateSelection(),$.each(l.plotComponents,function(e,t){t.updateSelection()})},l.fetchLassoSelection=function(){if(!l.points)return;var e=function(){var e=[];return $.each(l.points,function(t,n){l.pointSet.isPointFiltered(n)||l.theMap.isCoordInsideLassoSelection(p.Coord(n.longit,n.lattit))&&e.push(n.id)}),e},t=[];$.each(l.theMap.selectionPolygonLattLongPoints,function(e,n){t.push({x:n.longit,y:n.lattit})});var n=E.createPolygonRestrictionQuery(l.theQuery.get(),l.tableInfo.propIdGeoCoordLongit,l.tableInfo.propIdGeoCoordLattit,t),r="",i=null;n.query&&(i={query:n.query,subSamplingOptions:l.theQuery.getSubSamplingOptions()}),b.createPlotItemSelectionOptions(l,l.tableInfo,"Geographic area",r,i,e)},l.fetchRectSelection=function(e,t){var n=Math.min(e.longit,t.longit),r=Math.max(e.longit,t.longit),i=Math.min(e.lattit,t.lattit),s=Math.max(e.lattit,t.lattit),o=l.theQuery.get();o=u.WhereClause.createRangeRestriction(o,l.tableInfo.propIdGeoCoordLongit,n,r),o=u.WhereClause.createRangeRestriction(o,l.tableInfo.propIdGeoCoordLattit,i,s),selectionCreationFunction=function(){var e=[];return $.each(l.points,function(t,o){if(!l.pointSet.isPointFiltered(o)){var u=o.longit>=n&&o.longit<=r&&o.lattit>=i&&o.lattit<=s;u&&e.push(o.id)}}),e},b.createPlotItemSelectionOptions(l,l.tableInfo,"Geographic range","",{query:o,subSamplingOptions:l.theQuery.getSubSamplingOptions()},selectionCreationFunction)},l.notifyPropertyContentChanged=function(e){l.pointData[e]&&(l.pointData[e]=null,l.fetchData())},l.reloadAll=function(){l.pointData={},l.fetchData()},l.reDraw=function(){l.pointSet.setPointStyle({opacity:Math.pow(l.ctrl_Opacity.getValue(),1.5),pointSize:l.ctrl_PointSize.getValue(),pointShape:l.ctrl_PointShape.getValue(),aggrSize:l.ctrl_AggrSize.getValue(),aggregateStyle:l.ctrl_AggrType.getValue(),usePiechartOffset:l.ctrl_PieOffset.getValue()}),l.pointSet.draw(),$.each(l.plotComponents,function(e,t){t.draw()})},l.updateQuery=function(){l.reloadAll()},l.create(),l},x}),define("Plots/Tree/Tree",["require","DQX/Utils"],function(e,t){var n=function(){var e={};return e.load=function(n,r){e.settings=n,e.root=null;try{e.loadNewick(r)}catch(i){t.reportError(i)}},e.loadNewick=function(t){var n=[],r=0;for(var i=0;i<t.length;i++)t.charAt(i)=="("&&r++,t.charAt(i)==")"&&r--,n.push(r);var s=function(e){while(e.start<e.end&&t.charAt(e.start)==" ")e.start++;while(e.start<e.end&&t.charAt(e.end)==" ")e.end--;t.charAt(e.start)=="("&&t.charAt(e.end)==")"&&(e.start++,e.end--)},o=function(e){var n="";for(var r=e.start;r<=e.end;r++)n+=t.charAt(r);return n},u=function(e,r){var i={children:[],parent:null,itemid:null,distance:0},a=function(e){},f=function(i){var s=[e.start-1];for(var o=e.start;o<=e.end;o++)n[o]==r&&t.charAt(o)==i&&s.push(o);s.push(e.end+1);var u=[];for(var o=0;o<s.length-1;o++)u.push({start:s[o]+1,end:s[o+1]-1});return u};a(o(e));var l=f(":");l.length>1&&(e=l[0],distrange=l[1],s(distrange),i.distance=parseFloat(o(distrange))),s(e),r+=1;var c=f(",");return c.length>1?$.each(c,function(e,t){var n=u(t,r);n.parent=i,i.children.push(n)}):(s(e),i.itemid=o(e)),i},a=0;while(a<t.length&&(t.charAt(a)!=")"||n[a]>0))a++;var f={start:0,end:a};e.root=u(f,0)},e.layout=function(t){if(!e.root)return;var n=function(e){var t=0;return $.each(e.children,function(e,r){t+=n(r)}),e.itemid&&(t+=1),e.itemCount=t,t};n(e.root);var r={},i=function(e,t,n,s,o,u){e.relativeAngle=(t+n)/2,e.absoluteAngle=u+e.relativeAngle,e.itemid&&(r[e.itemid]=e.absoluteAngle),e.posX=s+e.distance*Math.cos(e.absoluteAngle),e.posY=o+e.distance*Math.sin(e.absoluteAngle),e.pointingLeft=Math.cos(e.absoluteAngle)<0;var a=0,f=n-t;$.each(e.children,function(t,n){var r=-f/2+a*1/e.itemCount*f;a+=n.itemCount;var s=-f/2+a*1/e.itemCount*f;i(n,r,s,e.posX,e.posY,e.absoluteAngle)})};i(e.root,0,2*Math.PI,0,0,0);if(t){var s=0,o=0;for(var u=0;u<Math.PI;u+=Math.PI/100){var a=0;$.each(r,function(e,n){if(t[e]){var r=t[e],i=r-n-u;while(i>+Math.PI)i-=2*Math.PI;while(i<-Math.PI)i+=2*Math.PI;a+=1/(1+10*Math.pow(i,2))}}),a>s&&(s=a,o=u)}var f=function(e,t,n){e.absoluteAngle+=o,e.posX=t+e.distance*Math.cos(e.absoluteAngle),e.posY=n+e.distance*Math.sin(e.absoluteAngle),e.pointingLeft=Math.cos(e.absoluteAngle)<0,$.each(e.children,function(t,n){f(n,e.posX,e.posY)})};f(e.root,0,0)}e.calcBoundingBox()},e.calcBoundingBox=function(){e.boundingBox={minX:1e99,maxX:-1e99,minY:1e99,maxY:-1e99};var t=function(n){e.boundingBox.minX=Math.min(e.boundingBox.minX,n.posX),e.boundingBox.maxX=Math.max(e.boundingBox.maxX,n.posX),e.boundingBox.minY=Math.min(e.boundingBox.minY,n.posY),e.boundingBox.maxY=Math.max(e.boundingBox.maxY,n.posY),$.each(n.children,function(e,n){t(n)})};t(e.root)},e.optimizeOrdering=function(n){var r=function(e){var i=0,s=0;return $.each(e.children,function(e,t){var n=r(t);s+=n[0],i+=n[1]}),e.itemid&&(i=1,s=n[e.itemid]),e.avIndex=s/i,e.children.sort(t.ByProperty("avIndex")),[s,i]};r(e.root)},e};return n}),define("Plots/Tree/TreePlot",["require","DQX/base64","DQX/Application","DQX/DataDecoders","DQX/Framework","DQX/Controls","DQX/Msg","DQX/SQL","DQX/DocEl","DQX/Utils","DQX/Wizard","DQX/Popup","DQX/PopupFrame","DQX/FrameCanvasXYPlot","DQX/DataFetcher/DataFetchers","Wizards/EditQuery","MetaData","Utils/QueryTool","Plots/GenericPlot","Plots/StandardLayoutPlot","Utils/ButtonChoiceBox","Utils/MiscUtils","Plots/Tree/Tree"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x={};return o.listen("",{type:"OpenTree"},function(e,t){var n={treeid:t.treeid};x.Create(t.tableid,u.WhereClause.Trivial(),n)}),x.typeID="TreePlot",x.name="Tree",x.description="Displays a pre-calculated, unrooted tree of {items}.",x.isCompatible=function(e){return e.trees.length>0},x.plotAspects=[{id:"label",name:"Label",dataType:"",requiredLevel:0},{id:"color",name:"Node color",dataType:"",requiredLevel:0},{id:"colorbranch",name:"Branch color",dataType:"Text",requiredLevel:0}],x.Create=function(e,t,n,r){var i=b.Create(e,x.typeID,{title:x.name},t,n,r);i.treesMap={},i.fetchCount=0,i.pointData={};var u=f.getNextUniqueID();return i.eventids.push(u),o.listen(u,{type:"SelectionUpdated"},function(e,t){i.tableInfo.id==t&&i.reDraw()}),i.createPanelPlot=function(){i.panelPlot=p(i.framePlot),i.panelPlot.scaleMarginX=0,i.panelPlot.scaleMarginY=0,i.panelPlot.getToolTipInfo=i.getToolTipInfo,i.panelPlot.onMouseClick=i.onMouseClick,i.panelPlot.onSelected=i.onSelected,i.panelPlot.drawCenter=i.drawCenter},i.createPanelButtons=function(){var e=i.tableInfo.trees[0].id;n&&n.treeid&&(e=n.treeid),i.ctrlTree=s.Combo(null,{label:"Tree:<br>",states:i.tableInfo.trees,value:e}).setClassID("tree"),i.ctrlTree.setOnChanged(i.loadTree);var t=[{id:"",name:"-- None --"}],r=[{id:"",name:"-- None --"}];$.each(m.customProperties,function(e,n){var s=!1;n.tableid==i.tableInfo.id&&(t.push({id:n.propid,name:n.name,group:n.group.Name}),n.isText&&r.push({id:n.propid,name:n.name,group:n.group.Name}))}),i.ctrlValueLabel=s.Combo(null,{label:"Label:<br>",states:t,value:i.providedAspect2Property("label")}).setClassID("label"),i.ctrlValueLabel.setOnChanged(function(){i.fetchData()}),i.ctrlValueColorNode=s.Combo(null,{label:"Node colour:<br>",states:t,value:i.providedAspect2Property("color")}).setClassID("color"),i.ctrlValueColorNode.setOnChanged(function(){i.fetchData()}),i.ctrlValueColorBranch=s.Combo(null,{label:"Branch colour:<br>",states:r,value:i.providedAspect2Property("colorbranch")}).setClassID("colorbranch"),i.ctrlValueColorBranch.setOnChanged(function(){i.fetchData()}),i.ctrl_ColorDrawing=s.Combo(null,{label:"Draw branch colour on:<br>",states:[{id:"consensus",name:"Consensus branches"},{id:"leaf",name:"Leaf branches"}],value:"consensus"}).setClassID("drawcolor").setOnChanged(function(){i.reDraw()}),i.ctrl_SelDrawing=s.Combo(null,{label:"Draw selection on:<br>",states:[{id:"node",name:"Nodes only"},{id:"leaf",name:"Leaf branches"},{id:"consensus1",name:"Branches (all selected)"},{id:"consensus2",name:"Branches (some selected)"}],value:"node"}).setClassID("drawsel").setOnChanged(function(){i.reDraw()}),i.ctrl_RotateLabels=s.Check(null,{label:"Rotate labels",value:!0}).setClassID("rotatelabels").setOnChanged(function(){i.reDraw()}),i.ctrl_ShowInternalNodes=s.Check(null,{label:"Show internal nodes",value:!1}).setClassID("showinternalnodes").setOnChanged(function(){i.reDraw()}),i.ctrl_Stabilise=s.Check(null,{label:"Stabilise",value:!1}).setClassID("stabilise").setOnChanged(function(){i.tuneTree(),i.reDraw()}),i.colorLegend=s.Html(null,""),i.ctrl_Description=s.Html(null,""),i.ctrl_crossLink=s.Hyperlink(null,{content:"xxx"}).setOnChanged(function(){E.openCrossLink(i.crossLinkInfo)}),i.ctrl_ShowHideCrossLink=s.ShowHide(i.ctrl_crossLink),i.ctrl_ShowHideCrossLink.setVisible(!1);var o=s.Button(null,{icon:"fa-crosshairs",content:"Select points...",buttonClass:"PnButtonGrid",width:80,height:30}).setOnChanged(function(){var e=[];e.push({content:"Lasso selection",bitmap:"Bitmaps/circle_red_small.png",handler:function(){i.panelPlot.startLassoSelection(function(e){function t(e,t){for(var n=!1,r=-1,i=e.length,s=i-1;++r<i;s=r)(e[r].y<=t.y&&t.y<e[s].y||e[s].y<=t.y&&t.y<e[r].y)&&t.x<(e[s].x-e[r].x)*(t.y-e[r].y)/(e[s].y-e[r].y)+e[r].x&&(n=!n);return n}var n=[];$.each(e,function(e,t){n.push({x:(t.x-i.offsetX)/i.scaleX,y:(t.y-i.offsetY)/i.scaleY})});if(!i.allDataPresent())return;var r=function(){var n=[],r=function(i){i.itemid&&t(e,{x:i.screenX,y:i.screenY})&&n.push(i.itemid),$.each(i.children,function(e,t){r(t)})};return r(i.currentTree.root),n};w.createPlotItemSelectionOptions(i,i.tableInfo,"Tree lasso selection","",null,r)})}}),w.create("Select points","",[e])});i.ctrl_SizeFactor=s.ValueSlider(null,{label:"Point size factor",width:180,minval:0,maxval:2,value:1,digits:2}).setNotifyOnFinished().setClassID("sizefactor").setOnChanged(function(){i.reDraw()}),i.ctrl_Opacity=s.ValueSlider(null,{label:"Point opacity",width:180,minval:0,maxval:1,value:1,digits:2}).setNotifyOnFinished().setClassID("opacity").setOnChanged(function(){i.reDraw()}),i.ctrl_BranchOpacity=s.ValueSlider(null,{label:"Branch opacity",width:180,minval:0,maxval:1,value:.25,digits:2}).setNotifyOnFinished().setClassID("branchopacity").setOnChanged(function(){i.reDraw()});var u=s.CompoundVert([i.createIntroControls([i.ctrl_Description,i.ctrl_ShowHideCrossLink]),s.AlignCenter(s.CompoundHor([o,s.HorizontalSeparator(95)])),s.VerticalSeparator(10),s.VerticalSeparator(20),s.Section(s.CompoundVert([i.ctrlTree,i.ctrlValueLabel,i.ctrlValueColorNode,i.ctrlValueColorBranch]).setMargin(10),{title:"Plot data",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([i.ctrl_SizeFactor,i.ctrl_Opacity,i.ctrl_BranchOpacity,i.ctrl_ColorDrawing,i.ctrl_SelDrawing,i.ctrl_RotateLabels,i.ctrl_ShowInternalNodes,i.ctrl_Stabilise]).setMargin(10),{title:"Layout",bodyStyleClass:"ControlsSectionBody"}),s.Section(s.CompoundVert([i.colorLegend]).setMargin(10),{title:"Color legend",bodyStyleClass:"ControlsSectionBody"})]).setMargin(0);i.addPlotSettingsControl("controls",u),i.panelButtons.addControl(u),i.loadTree(),i.reloadAll()},i.setActiveQuery=function(e){i.theQuery.modify(e)},i.updateQuery=function(){i.fetchData()},i.reloadAll=function(){i.pointData={},i.fetchData()},i.fetchData=function(){var e=d.RecordsetFetcher(m.serverUrl,m.database,i.tableInfo.getQueryTableName(i.theQuery.isSubSampling()));e.setMaxResultCount(i.tableInfo.settings.MaxCountQueryRecords),i.itemDataLoaded=!1,i.colorLegend.modifyValue("");var t=i.tableInfo.primkey;i.pointData[i.tableInfo.primkey]||e.addColumn(i.tableInfo.primkey,"ST"),i.colorNodePropId=null,i.ctrlValueColorNode.getValue()&&(i.colorNodePropId=i.ctrlValueColorNode.getValue(),i.pointData[i.colorNodePropId]||e.addColumn(i.colorNodePropId,"ST")),i.colorBranchPropId=null,i.ctrlValueColorBranch.getValue()&&(i.colorBranchPropId=i.ctrlValueColorBranch.getValue(),i.pointData[i.colorBranchPropId]||e.addColumn(i.colorBranchPropId,"ST")),i.labelPropId=null,i.ctrlValueLabel.getValue()&&(i.labelPropId=i.ctrlValueLabel.getValue(),i.pointData[i.labelPropId]||e.addColumn(i.labelPropId,"ST"));if(e.getColumnIDs().length<=0){i.itemDataLoaded=!0,i.reDraw();return}var n=f.getNextUniqueID();i.requestID=n;var r=i.tableInfo.currentSelection;f.setProcessing();var s=i.theQuery.getForFetching();e.getData(s,t,function(e){f.stopProcessing();if(i.requestID==n){var t=0;i.pointData[i.tableInfo.primkey]||(i.pointIndex={},$.each(e[i.tableInfo.primkey],function(e,t){i.pointIndex[t]=e})),$.each(e,function(e,n){i.pointData[e]=n,t=n.length}),i.itemDataLoaded=!0,i.tuneTree(),i.reDraw()}},function(e){f.stopProcessing(),i.fetchCount-=1})},i.loadTree=function(){i.currentTreeId=i.ctrlTree.getValue(),i.currentTree=i.treesMap[i.currentTreeId];if(i.currentTree){i.updateTreeInfo(),i.reDraw();return}f.setProcessing();var e={};e.database=m.database,e.tableid=i.tableInfo.id,e.graphid=i.currentTreeId,f.customRequest(m.serverUrl,PnServerModule,"getgraph",e,function(e){f.stopProcessing();if("Error"in e){alert(e.Error);return}i.currentTree=S(),i.currentTree.name=e.name,i.currentTree.load(JSON.parse(e.settings),e.data),i.tuneTree(),i.currentTree.layout(i.ctrl_Stabilise.getValue()?i.mapItemAngles:null),i.panelPlot.setXRange(0,1),i.panelPlot.setYRange(0,1),i.updateTreeInfo(),i.reDraw()})},i.tuneTree=function(){if(!i.currentTree||!i.pointIndex)return;if(i.ctrl_Stabilise.getValue()){var e=function(e){for(var t=0;t<5;t++)e=(e*9301+49297)%233280;return e},t={};$.each(i.pointIndex,function(n,r){t[n]=e(r)}),i.currentTree.optimizeOrdering(t)}},i.updateTreeInfo=function(){var e="";i.currentTree.name&&(e+="<b>"+i.currentTree.name+".</b> "),i.currentTree.settings.Description&&(e+=i.currentTree.settings.Description),i.ctrl_Description.modifyValue(e),i.crossLinkInfo=null,i.currentTree.settings.CrossLink&&(i.crossLinkInfo=E.parseCrossLink(i.currentTree.settings.CrossLink),i.ctrl_crossLink.modifyValue('<span class="fa fa-external-link-square" style="font-size: 120%"></span> Open associated <b>'+i.crossLinkInfo.dispName+"</b>"),i.ctrl_ShowHideCrossLink.setVisible(!0))},i.allDataPresent=function(){return i.currentTree&&i.currentTree.root&&i.itemDataLoaded},i.reDraw=function(){i.panelPlot.render()},i.drawCenter=function(e){var t=e.ctx;t.globalAlpha=1;if(!i.allDataPresent())return;var n=i.ctrl_SizeFactor.getValue(),r=i.ctrl_Opacity.getValue(),s=i.ctrl_BranchOpacity.getValue(),o=i.ctrl_ColorDrawing.getValue()=="consensus",u=i.ctrl_SelDrawing.getValue()!="node",a=i.ctrl_SelDrawing.getValue()=="consensus1",l=i.ctrl_SelDrawing.getValue()=="consensus2",c=i.ctrl_ShowInternalNodes.getValue(),h=i.ctrl_RotateLabels.getValue(),p=i.tableInfo.currentSelection,d=i.currentTree.boundingBox.maxX-i.currentTree.boundingBox.minX,v=i.currentTree.boundingBox.maxY-i.currentTree.boundingBox.minY,g=Math.max(d,v),y=Math.abs(i.panelPlot.getXScale()/e.sizeX),b=i.panelPlot.getXOffset(),w=Math.abs(i.panelPlot.getYScale()/e.sizeY),E=i.panelPlot.getYOffset(),S=.2,x=e.sizeX/d,T=e.sizeY/v,N=Math.min(x,T);scaleX=N/(1+2*S),scaleY=N/(1+2*S),offsetX=-1*i.currentTree.boundingBox.minX*scaleX+d*scaleX*S,offsetY=-1*i.currentTree.boundingBox.minY*scaleY+v*scaleY*S,offsetX=offsetX*y+b,offsetY=offsetY*w+E-e.sizeY*w,scaleX*=y,scaleY*=w;var C=f.Color(0,0,0,r).toStringCanvas(),k=f.Color(0,0,0,s).toStringCanvas(),L=f.Color(0,0,0,.5*r).toStringCanvas(),A=f.Color(1,0,0,s).toStringCanvas();t.font="11px Arial",t.fillStyle="rgba(0,0,0,0.5)",t.strokeStyle=k;var O="",M=null;if(i.colorNodePropId){var _=m.findProperty(i.tableInfo.id,i.colorNodePropId),D=i.pointData[i.colorNodePropId];for(var P=0;P<D.length;P++)D[P]=_.toDisplayString(D[P]);var H=_.mapColors(D);M=H.indices,i.mappedNodeColorStrings=[],$.each(H.colors,function(e,t){i.mappedNodeColorStrings.push(t.changeOpacity(r).toStringCanvas())}),i.colorBranchPropId&&i.colorBranchPropId!=i.colorNodePropId&&(O+="<b>Node colors:</b><br>"),$.each(H.legend,function(e,t){O+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}<br>'.DQXformat({cl:t.color.toString(),name:t.state})})}var B=null;if(i.colorBranchPropId){var _=m.findProperty(i.tableInfo.id,i.colorBranchPropId),D=i.pointData[i.colorBranchPropId];for(var P=0;P<D.length;P++)D[P]=_.toDisplayString(D[P]);var H=_.mapColors(D);B=H.indices,i.mappedBranchColorStrings=[],$.each(H.colors,function(e,t){i.mappedBranchColorStrings.push(t.changeOpacity(s).toStringCanvas())}),i.colorBranchPropId!=i.colorNodePropId&&(O+="<br><b>Branch colours:</b><br>",$.each(H.legend,function(e,t){O+='<span style="background-color:{cl}">&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;{name}<br>'.DQXformat({cl:t.color.toString(),name:t.state})}))}i.colorLegend.modifyValue(O),i.mapItemAngles={};var j=function(e){e.colorIndexNode=-1,e.colorIndexBranch=-1,e.selected=!1;if(e.itemid){var r=i.pointIndex[e.itemid];r!=null&&(i.mapItemAngles[e.itemid]=e.absoluteAngle,M&&(e.colorIndexNode=M[r]),B&&(e.colorIndexBranch=B[r]),p[e.itemid]&&(e.selected=!0))}var s=Math.round(e.posX*scaleX+offsetX),f=Math.round(e.posY*scaleY+offsetY);e.screenX=s,e.screenY=f;var d=-1,v=!1,m=!1;$.each(e.children,function(e,t){j(t),o&&(d==-1?d=t.colorIndexBranch:d!=t.colorIndexBranch&&(d=-2)),t.selected?v=!0:m=!0}),e.itemid||(e.colorIndexBranch=d,a&&(e.selected=!m),l&&(e.selected=v));if(e.parent){var g=e.parent.screenX,y=e.parent.screenY;i.colorBranchPropId&&(e.colorIndexBranch>=0?t.strokeStyle=i.mappedBranchColorStrings[e.colorIndexBranch]:t.strokeStyle=k),u&&(e.selected?t.strokeStyle=A:t.strokeStyle=k),t.beginPath(),t.moveTo(g,y),t.lineTo(s,f),t.stroke()}if(e.itemid){if(r!=null){e.selected&&(F.push(e.screenX),I.push(e.screenY)),e.colorIndexNode>=0?t.fillStyle=i.mappedNodeColorStrings[e.colorIndexNode]:t.fillStyle=C,t.beginPath(),t.arc(s,f,3*n,0,2*Math.PI,!1),t.fill();if(i.labelPropId){var b=3*n+1;e.pointingLeft?(t.textAlign="right",b=-b):t.textAlign="left";if(h){t.save(),t.translate(s,f);var w=e.absoluteAngle;e.pointingLeft&&(w-=Math.PI),t.rotate(w),t.fillText(i.pointData[i.labelPropId][r],b,4),t.restore()}else t.fillText(i.pointData[i.labelPropId][r],s+b,f+4)}}}else c&&(t.fillStyle=L,t.beginPath(),t.arc(s,f,2*n,0,2*Math.PI,!1),t.fill())},F=[],I=[];t.strokeStyle=k,t.lineWidth=1,j(i.currentTree.root),i.colorNodePropId?(t.fillStyle=f.Color(0,0,0,0*(.5+.5*r)).toStringCanvas(),t.strokeStyle=f.Color(0,0,0,1*(.5+.5*r)).toStringCanvas(),t.lineWidth=2):(t.fillStyle=f.Color(1,0,0,.25*r).toStringCanvas(),t.strokeStyle=f.Color(1,0,0,r).toStringCanvas());for(var P=0;P<F.length;P++)t.beginPath(),t.arc(F[P],I[P],2*n+3,0,2*Math.PI,!1),t.closePath(),t.fill(),t.stroke()},i.getToolTipInfo=function(e,t){if(!i.allDataPresent())return;var n=12,r=null,s=function(i){if(i.itemid){var o=Math.abs(e-i.screenX)+Math.abs(t-i.screenY);o<=n&&(n=o,r=i)}$.each(i.children,function(e,t){s(t)})};s(i.currentTree.root);if(r){var o=i.pointIndex[r.itemid],u=r.itemid;return i.labelPropId&&i.labelPropId!=i.tableInfo.primkey&&(u+="<br>"+i.pointData[i.labelPropId][o]),i.colorNodePropId&&i.colorNodePropId!=i.tableInfo.primkey&&(u+="<br>"+i.pointData[i.colorNodePropId][o]),{itemid:r.itemid,ID:r.itemid,px:r.screenX,py:r.screenY,showPointer:!0,content:u}}return null},i.onMouseClick=function(e,t){var n=i.getToolTipInfo(t.x,t.y);n&&o.send({type:"ItemPopup"},{tableid:i.tableInfo.id,itemid:n.itemid})},i.onSelected=function(e,t,n,r,s,o,u){if(!i.allDataPresent())return;var a=function(){var s=[],o=function(i){i.itemid&&i.screenX>=e&&i.screenX<=n&&i.screenY>=t&&i.screenY<=r&&s.push(i.itemid),$.each(i.children,function(e,t){o(t)})};return o(i.currentTree.root),s};w.createPlotItemSelectionOptions(i,i.tableInfo,"Tree selection","",null,a)},i.updateQuery=function(){i.reloadAll()},i.create(),i},x}),define("Plots/PlotStarter",["require","Plots/GenericPlot","Plots/Histogram","Plots/BarGraph","Plots/Histogram2D","Plots/ItemScatterPlot","Plots/MultiCategoryHistogram","Plots/GeoTemporal/GeoTemporal","Plots/Tree/TreePlot"],function(e,t,n,r,i,s,o,u,a){var f={};return t.registerPlotType(n),t.registerPlotType(r),t.registerPlotType(i),t.registerPlotType(s),t.registerPlotType(o),t.registerPlotType(u),t.registerPlotType(a),f}),typeof versionString=="undefined"&&alert("Fatal error: versionString is missing"),require.config({baseUrl:"scripts",paths:{jquery:"DQX/Externals/jquery",d3:"DQX/Externals/d3",handlebars:"DQX/Externals/handlebars",markdown:"DQX/Externals/markdown",DQX:"DQX",_:"DQX/Externals/lodash",tween:"Externals/Tween",datastream:"DQX/Externals/DataStream",blob:"DQX/Externals/Blob",filesaver:"DQX/Externals/FileSaver",lzstring:"DQX/Externals/lz-string"},shim:{d3:{exports:"d3"},handlebars:{exports:"Handlebars"},tween:{exports:"TWEEN"},datastream:{exports:"DataStream"},blob:{exports:"Blob"},filesaver:{exports:"saveAs"},lzstring:{exports:"LZString"}},waitSeconds:15,urlArgs:"version="+versionString}),require(["_","jquery","DQX/Application","DQX/Framework","DQX/Msg","DQX/Utils","DQX/Controls","DQX/SQL","DQX/Popup","DQX/PopupFrame","DQX/DataFetcher/DataFetchers","MetaData","Utils/Initialise","Views/Intro","Views/GenomeBrowser","Views/TableViewer","Views/ListViewer","InfoPopups/GenePopup","InfoPopups/ItemPopup","InfoPopups/DataItemTablePopup","InfoPopups/DataItemPlotPopup","InfoPopups/PropInfoPopup","Wizards/PromptWorkspace","Wizards/PromptDataSet","Wizards/FindGene","Wizards/FindDataItem","Wizards/FindNote","Utils/Serialise","Utils/ButtonChoiceBox","Plots/PlotStarter","DQX/DocEl","DQX/HistoryManager"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){t(function(){function A(){t(document).on("click",".doclink",function(){var e=t(this).attr("href");return i.send({type:"OpenDoc"},{target:e}),!1}),f.setHasThumbNails(),s.customRequest(c.serverUrl,PnServerModule,"serverstatus",{},function(e){if("issue"in e){var t=e.issue;t=t.replace(/\n/g,"<br>");var n='<div style="margin:30px"><p><h2>Server configuration problem</h2><p>'+t,r=o.Button(null,{buttonClass:"DQXToolButton2",icon:"fa-arrow-circle-right",content:"Proceed anyway",width:120,height:35}).setOnChanged(function(){a.closeIfNeeded(i),D()});n+='<p><span style="color:red"><b>The software will not work correctly!</b></span></p>',n+="<br>"+r.renderHtml(),n+="</div>";var i=a.create("Fatal error",n,null,{canClose:!1});return}c.userId=e.userid,D()})}function D(){x.execute(function(){var e=l.ServerDataGetter();e.addTable("chromosomes",["id","len"],null),e.execute(c.serverUrl,c.database,function(){c.chromosomes=e.getTableRecords("chromosomes"),t.each(c.chromosomes,function(e,t){t.name=t.id}),H()})})}function H(){s.customRequest(c.serverUrl,PnServerModule,"datasetinfo",{database:c.database},function(e){e.manager&&(c.isManager=!0);var t=function(e){var t='<div style="padding:10px">';t+='<span class="fa fa-exclamation-triangle" style="font-size: 36px; color:rgb(150,0,0);float:left;padding:10px"></span>',t+="The database schema of this dataset is outdated.<br>Please actualise it by running a <b>{tpe}</b>.<p>The application is aborted.".DQXformat({tpe:e});var n=o.Button(null,{content:"Open admin section"});n.setOnChanged(function(){window.open("admin.html","_self")}),t+=n.renderHtml(),t+="</div>",a.create("Fatal error",t,null,{canClose:!1})};if(e.needfullreload){t("full data reload import");return}if(e.needconfigreload){t("config update import");return}B()})}function B(){var e=l.ServerDataGetter();e.addTable("tablecatalog",["id","name","primkey","IsPositionOnGenome","defaultQuery","settings"],"ordr"),e.addTable("customdatacatalog",["tableid","sourceid","settings"],"tableid"),e.addTable("2D_tablecatalog",["id","name","col_table","row_table","first_dimension","settings"],"ordr"),e.addTable("settings",["id","content"],"id"),e.addTable("graphs",["graphid","tableid","tpe","dispname","crosslnk"],"graphid"),e.execute(c.serverUrl,c.database,function(){c.tableCatalog=e.getTableRecords("tablecatalog");var r=e.getTableRecords("customdatacatalog");c.twoDTableCatalog=e.getTableRecords("2D_tablecatalog"),c.generalSettings={},t.each(e.getTableRecords("settings"),function(e,t){t.content=="False"&&(t.content=!1),t.id=="IntroSections"&&(t.content=JSON.parse(t.content)),c.generalSettings[t.id]=t.content}),c.generalSettings.GoogleAnalyticsId?(function(e,t,n,r,i,s,o){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,s=t.createElement(n),o=t.getElementsByTagName(n)[0],s.async=1,s.src=r,o.parentNode.insertBefore(s,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",c.generalSettings.GoogleAnalyticsId,"auto"),ga("set",{appName:c.database}),ga("send","pageview"),ga("send","screenview",{screenName:"loading"})):window.ga=function(){},c.mapTableCatalog={},t.each(c.tableCatalog,function(e,t){h.parseTableSettings(t),P(t,r),h.augmentTableInfo(t),c.mapTableCatalog[t.id]=t}),h.createLetterCodes(),c.map2DTableCatalog={},t.each(c.twoDTableCatalog,function(e,t){h.augment2DTableInfo(t),c.map2DTableCatalog[t.id]=t}),t.each(c.tableCatalog,function(e,t){t.trees=[]}),t.each(e.getTableRecords("graphs"),function(e,t){t.tpe=="tree"&&c.mapTableCatalog[t.tableid].trees.push({id:t.graphid,name:t.dispname,crossLink:t.crosslnk})}),g.init(),y.init(),b.init(),w.init(),T.init(),E.init(),p.init(),c.generalSettings.hasGenomeBrowser&&d.init(),t.each(c.tableCatalog,function(e,t){t.settings.ListView?(m.init(t.id),t.listViewId="list_"+t.id):(v.init(t.id),t.tableViewId="table_"+t.id)}),n.showViewsAsTabs(),n.addNavigationButton("","fa-search",35,function(){var e=[],n=!1;t.each(c.tableCatalog,function(e,t){t.settings.DisableNotes||(n=!0)}),n&&e.push({content:"Find note",icon:"fa-comment",handler:function(){C.execute()}}),c.generalSettings.hasGenomeBrowser&&(e.push({content:"Find gene",bitmap:"Bitmaps/GenomeBrowserSmall.png",handler:function(){T.execute()}}),e.push({content:"Find genomic region",bitmap:"Bitmaps/GenomeBrowserSmall.png",handler:function(){T.findRegion()}})),t.each(c.tableCatalog,function(n,r){var i=!1;t.each(c.customProperties,function(e,t){t.tableid==r.id&&t.settings.Search&&t.settings.Search!="None"&&(i=!0)});if(i){var s="";s+="Find "+r.tableNameSingle,e.push({content:s,icon:r.settings.Icon?r.settings.Icon:"fa-table",handler:function(){N.execute(r.id)}})}});var r=[],i=99;t.each(e,function(e,t){i>=3&&(r.push([]),i=0),r[r.length-1].push(t),i++}),L.create("Find item","Please select what kind of element you want to search for:",r)}),n.addNavigationButton("","fa-link",35,function(){k.createLink()});var i='<div id="PanoptesAppHeader">'+'<div class="PanoptesLogoPlaceholder"></div><img class="PanoptesLogoBox" src="Bitmaps/PanoptesLogoSmall2.png" alt="Panoptes logo" align="top"/><div style="display:inline-block"><div class="PnTitleBox">{datasetname}</div><div class="DQXThumbNailBox"></div></div><img class="OrgLogoBox" src="Bitmaps/malariagen_logo_bw.png" alt="MalariaGEN"/></div>'.DQXformat({datasetname:c.generalSettings.NameBanner||c.generalSettings.Name});n.setHeaderHeight(48),n.setHeader(i),n.customInitFunction=function(e){var t=l.ServerDataGetter(),r=function(){e(),k.checkLoadView(n.postLoadAction)};t.execute(c.serverUrl,c.database,function(){S.execute(r)})},n.init("Panoptes"),n.getChannelInfo=function(e){var t=l.ServerDataGetter();t.addTable("propertycatalog",["propid","datatype","tableid","source","name","settings"],"ordr",u.WhereClause.OR([u.WhereClause.CompareFixed("workspaceid","=",c.workspaceid),u.WhereClause.CompareFixed("workspaceid","=","")])),t.addTable("2D_propertycatalog",["id","tableid","col_table","row_table","name","dtype","settings"],"ordr",u.WhereClause.Trivial()),t.addTable("summaryvalues",["propid","name","minval","maxval","minblocksize","tableid","settings"],"ordr",u.WhereClause.AND([u.WhereClause.OR([u.WhereClause.CompareFixed("workspaceid","=",c.workspaceid),u.WhereClause.CompareFixed("workspaceid","=","")]),u.WhereClause.CompareFixed("tableid","<>","")])),t.addTable("tablebasedsummaryvalues",["tableid","trackid","trackname","minval","maxval","minblocksize","settings"],"ordr",u.WhereClause.Trivial()),t.addTable("relations",["childtableid","childpropid","parenttableid","parentpropid","forwardname","reversename"],"childtableid",u.WhereClause.Trivial()),t.addTable("externallinks",["linktype","linkname","linkurl"],"linkname"),t.addTable("storedsubsets",["subsetid","name","tableid"],"name",u.WhereClause.CompareFixed("workspaceid","=",c.workspaceid)),t.execute(c.serverUrl,c.database,function(){c.externalLinks=t.getTableRecords("externallinks"),c.summaryValues=t.getTableRecords("summaryvalues"),c.customProperties=t.getTableRecords("propertycatalog"),c.twoDProperties=t.getTableRecords("2D_propertycatalog"),c.tableBasedSummaryValues=t.getTableRecords("tablebasedsummaryvalues"),h.parseSummaryValues(),h.parseCustomProperties(),h.parse2DProperties(),h.parseTableBasedSummaryValues(),h.parseRelations(t.getTableRecords("relations")),h.parseStoredSubsets(t.getTableRecords("storedsubsets")),e&&h.waitForCompletion(e)})}})}function j(){var e=[];e.push({content:"Documentation",bitmap:"Bitmaps/Icons/Small/documentation.png",handler:function(){window.open("http://panoptes.readthedocs.org/en/latest/")}}),e.push({content:"Load new instance",bitmap:"Bitmaps/actionbuttons/reload.png",handler:function(){window.open("index.html")}}),c.isManager&&e.push({content:"Open admin page",bitmap:"Bitmaps/Icons/Small/tools.png",handler:function(){window.open("admin.html")}}),L.create("Panoptes","",[e])}n._createNavigationButton=function(e,t,n,r,i,s,u){if(n.indexOf("fa-")===0)var a=o.Button(e,{icon:n,content:r,buttonClass:i,width:s,height:22});else var a=o.Button(e,{bitmap:n,content:r,buttonClass:i,width:s,height:22});a.setOnChanged(u),t.addElem(a.renderHtml())},n._createNavigationSection=function(){var e=O.Div();e.addStyle("position","absolute"),e.addStyle("right","0px"),e.addStyle("top","0px"),e.addStyle("padding-top","0px"),e.addStyle("padding-right","0px"),this._createNavigationButton("HeaderHelp",e,"fa-question-circle","","PnTopLevelNav",22,function(){i.send({type:"Home"})}),t.each(n._customNavigationButtons,function(t,r){n._createNavigationButton("",e,r.bitmap,r.name,"PnTopLevelNav",22,r.handler)}),t("#Div1").append(e.toString()),s.ExecPostCreateHtml(),i.listen("",{type:"Home"},function(){f.minimiseAll(),M.setState(n._views[0].getStateKeys())}),i.listen("",{type:"Back"},function(){M.back()})},r.FrameGroupTab=function(e,t){return r.Frame(e,"Tab",t).setFrameClassClient("DQXForm").setMarginsIndividual(0,0,0,0)},t(document).ajaxStart(function(){d3.select(".PanoptesLogoBox").transition().duration(1e3).attr("style","opacity: 1")}),t(document).ajaxStop(function(){d3.select(".PanoptesLogoBox").transition().duration(1e3).attr("style","opacity: 0")});var P=function(e,n){var r=["DataItemViews","PropertyGroups"];t.each(n,function(n,i){if(i.tableid==e.id){var s=JSON.parse(i.settings);t.each(r,function(n,r){s[r]&&(e.settings[r]?t.each(s[r],function(t,n){e.settings[r].push(n)}):e.settings[r]=s[r])})}})};n.postLoadAction=function(){t.each(n.getViewList(),function(e,t){t.viewIsLoaded=!0,t.postLoadAction&&t.postLoadAction()}),t(".PanoptesLogoBox").click(j);var r=window.location.search.substring(1),o=r.split("&");for(var u=0;u<o.length;u++){var a=o[u].split("=");if(decodeURIComponent(a[0])=="genome_region"){var f=decodeURIComponent(a[1]),l=f.split(":")[0];e.contains(e.pluck(c.chromosomes,"id"),l)||s.reportError("Unknown chrom in URL");var h=f.split(":")[1];if(h){var p=h.split("-")[0],d=h.split("-")[1];p&&d&&i.send({type:"FindGenomeRegion"},{chromosome:l,start:parseInt(p),end:parseInt(d),buttonShowRegion:!0})}}}},A()})}),define("main",function(){});