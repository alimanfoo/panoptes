#Getting started - a little rough at the mo until we come to fix up the build and deploy system

sudo apt-get install git gcc gfortran python-dev python-virtualenv libblas-dev liblapack-dev cython libhdf5-serial-dev

sudo apt-add-repository "http://dev.monetdb.org/downloads/deb/ xenial monetdb"
wget --output-document=- https://www.monetdb.org/downloads/MonetDB-GPG-KEY | sudo apt-key add -
sudo apt-get update
sudo apt-get install -y --allow-unauthenticated monetdb5-sql monetdb-client

git clone git@github.com:cggh/panoptes.git
cd panoptes
cp config.py.example config.py
nano config.py #Edit config for DB, paths

#Install all the things:
./scripts/build.sh

#Then you can run panoptes:
./scripts/run.sh

#Navigate to http://localhost:8000/index.html and you should see an ugly error as we have no datasets and the mechanism for dealing with this is not complete in 2.0
#So we manually import one of the sample datasets - not that the dataset is chosen manually in webapp/src/index.html for now
curl 'http://localhost:8000/api?datatype=custom&respmodule=panoptesserver&respid=fileload_dataset&ScopeStr=all&SkipTableTracks=false&datasetid=Samples_and_Variants'

#Wait for a few mins and then http://localhost:8000/index.html should show the dataset!

#Now if you want to edit the JS we need to setup the JS build env
sudo apt-get install nodejs npm
#Update npm
sudo npm install -g npm
#Update node
sudo npm cache clean -f
sudo npm install -g n
sudo n stable

#Now install dependancies
cd webapp
npm install

#Now run the dev html/js server
npm run dev          #(options are dev, build, serveprod)

#Navigate to (NOTE DIFFERENT PORT) http://localhost:8080/webpack-dev-server/index.html
#Any changes you save to files will now be detected and applied on refresh, experimental hot loading is via "npm run devhot"




